(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0b6cc9"],{"1f64":function(e,t,s){"use strict";(function(e){function a(e,t){const s=Object.create(null),a=e.split(",");for(let o=0;o<a.length;o++)s[a[o]]=!0;return t?e=>!!s[e.toLowerCase()]:e=>!!s[e]}s.d(t,"a",(function(){return lx}));const o=()=>{},n=Object.assign,r=Object.prototype.hasOwnProperty,i=(e,t)=>r.call(e,t),l=Array.isArray,c=e=>"[object Map]"===f(e),d=e=>"function"===typeof e,u=e=>"string"===typeof e,m=e=>"symbol"===typeof e,p=e=>null!==e&&"object"===typeof e,h=Object.prototype.toString,f=e=>h.call(e),g=e=>f(e).slice(8,-1),_=e=>u(e)&&"NaN"!==e&&"-"!==e[0]&&""+parseInt(e,10)===e,v=(e,t)=>!Object.is(e,t),b=(e,t,s)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:s})};let y;class x{constructor(e=!1){this.active=!0,this.effects=[],this.cleanups=[],!e&&y&&(this.parent=y,this.index=(y.scopes||(y.scopes=[])).push(this)-1)}run(e){if(this.active){const t=y;try{return y=this,e()}finally{y=t}}}on(){y=this}off(){y=this.parent}stop(e){if(this.active){let t,s;for(t=0,s=this.effects.length;t<s;t++)this.effects[t].stop();for(t=0,s=this.cleanups.length;t<s;t++)this.cleanups[t]();if(this.scopes)for(t=0,s=this.scopes.length;t<s;t++)this.scopes[t].stop(!0);if(this.parent&&!e){const e=this.parent.scopes.pop();e&&e!==this&&(this.parent.scopes[this.index]=e,e.index=this.index)}this.active=!1}}}function w(e,t=y){t&&t.active&&t.effects.push(e)}const k=e=>{const t=new Set(e);return t.w=0,t.n=0,t},S=e=>(e.w&B)>0,M=e=>(e.n&B)>0,A=({deps:e})=>{if(e.length)for(let t=0;t<e.length;t++)e[t].w|=B},R=e=>{const{deps:t}=e;if(t.length){let s=0;for(let a=0;a<t.length;a++){const o=t[a];S(o)&&!M(o)?o.delete(e):t[s++]=o,o.w&=~B,o.n&=~B}t.length=s}},T=new WeakMap;let E=0,B=1;const O=30;let C;const j=Symbol(""),I=Symbol("");class L{constructor(e,t=null,s){this.fn=e,this.scheduler=t,this.active=!0,this.deps=[],this.parent=void 0,w(this,s)}run(){if(!this.active)return this.fn();let e=C,t=N;while(e){if(e===this)return;e=e.parent}try{return this.parent=C,C=this,N=!0,B=1<<++E,E<=O?A(this):P(this),this.fn()}finally{E<=O&&R(this),B=1<<--E,C=this.parent,N=t,this.parent=void 0,this.deferStop&&this.stop()}}stop(){C===this?this.deferStop=!0:this.active&&(P(this),this.onStop&&this.onStop(),this.active=!1)}}function P(e){const{deps:t}=e;if(t.length){for(let s=0;s<t.length;s++)t[s].delete(e);t.length=0}}let N=!0;const H=[];function F(){H.push(N),N=!1}function D(){const e=H.pop();N=void 0===e||e}function $(e,t,s){if(N&&C){let t=T.get(e);t||T.set(e,t=new Map);let a=t.get(s);a||t.set(s,a=k()),U(a)}}function U(e,t){let s=!1;E<=O?M(e)||(e.n|=B,s=!S(e)):s=!e.has(C),s&&(e.add(C),C.deps.push(e))}function q(e,t,s,a,o,n){const r=T.get(e);if(!r)return;let i=[];if("clear"===t)i=[...r.values()];else if("length"===s&&l(e))r.forEach((e,t)=>{("length"===t||t>=a)&&i.push(e)});else switch(void 0!==s&&i.push(r.get(s)),t){case"add":l(e)?_(s)&&i.push(r.get("length")):(i.push(r.get(j)),c(e)&&i.push(r.get(I)));break;case"delete":l(e)||(i.push(r.get(j)),c(e)&&i.push(r.get(I)));break;case"set":c(e)&&i.push(r.get(j));break}if(1===i.length)i[0]&&V(i[0]);else{const e=[];for(const t of i)t&&e.push(...t);V(k(e))}}function V(e,t){const s=l(e)?e:[...e];for(const a of s)a.computed&&z(a);for(const a of s)a.computed||z(a)}function z(e,t){(e!==C||e.allowRecurse)&&(e.scheduler?e.scheduler():e.run())}const X=a("__proto__,__v_isRef,__isVue"),Y=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>"arguments"!==e&&"caller"!==e).map(e=>Symbol[e]).filter(m)),K=J(),G=J(!1,!0),Z=J(!0),W=Q();function Q(){const e={};return["includes","indexOf","lastIndexOf"].forEach(t=>{e[t]=function(...e){const s=Ve(this);for(let t=0,o=this.length;t<o;t++)$(s,"get",t+"");const a=s[t](...e);return-1===a||!1===a?s[t](...e.map(Ve)):a}}),["push","pop","shift","unshift","splice"].forEach(t=>{e[t]=function(...e){F();const s=Ve(this)[t].apply(this,e);return D(),s}}),e}function J(e=!1,t=!1){return function(s,a,o){if("__v_isReactive"===a)return!e;if("__v_isReadonly"===a)return e;if("__v_isShallow"===a)return t;if("__v_raw"===a&&o===(e?t?je:Ce:t?Oe:Be).get(s))return s;const n=l(s);if(!e&&n&&i(W,a))return Reflect.get(W,a,o);const r=Reflect.get(s,a,o);return(m(a)?Y.has(a):X(a))?r:(e||$(s,"get",a),t?r:Ze(r)?n&&_(a)?r:r.value:p(r)?e?He(r):Pe(r):r)}}const ee=se(),te=se(!0);function se(e=!1){return function(t,s,a,o){let n=t[s];if($e(n)&&Ze(n)&&!Ze(a))return!1;if(!e&&!$e(a)&&(Ue(a)||(a=Ve(a),n=Ve(n)),!l(t)&&Ze(n)&&!Ze(a)))return n.value=a,!0;const r=l(t)&&_(s)?Number(s)<t.length:i(t,s),c=Reflect.set(t,s,a,o);return t===Ve(o)&&(r?v(a,n)&&q(t,"set",s,a):q(t,"add",s,a)),c}}function ae(e,t){const s=i(e,t);e[t];const a=Reflect.deleteProperty(e,t);return a&&s&&q(e,"delete",t,void 0),a}function oe(e,t){const s=Reflect.has(e,t);return m(t)&&Y.has(t)||$(e,"has",t),s}function ne(e){return $(e,"iterate",l(e)?"length":j),Reflect.ownKeys(e)}const re={get:K,set:ee,deleteProperty:ae,has:oe,ownKeys:ne},ie={get:Z,set(e,t){return!0},deleteProperty(e,t){return!0}},le=n({},re,{get:G,set:te}),ce=e=>e,de=e=>Reflect.getPrototypeOf(e);function ue(e,t,s=!1,a=!1){e=e["__v_raw"];const o=Ve(e),n=Ve(t);s||(t!==n&&$(o,"get",t),$(o,"get",n));const{has:r}=de(o),i=a?ce:s?Ye:Xe;return r.call(o,t)?i(e.get(t)):r.call(o,n)?i(e.get(n)):void(e!==o&&e.get(t))}function me(e,t=!1){const s=this["__v_raw"],a=Ve(s),o=Ve(e);return t||(e!==o&&$(a,"has",e),$(a,"has",o)),e===o?s.has(e):s.has(e)||s.has(o)}function pe(e,t=!1){return e=e["__v_raw"],!t&&$(Ve(e),"iterate",j),Reflect.get(e,"size",e)}function he(e){e=Ve(e);const t=Ve(this),s=de(t),a=s.has.call(t,e);return a||(t.add(e),q(t,"add",e,e)),this}function fe(e,t){t=Ve(t);const s=Ve(this),{has:a,get:o}=de(s);let n=a.call(s,e);n||(e=Ve(e),n=a.call(s,e));const r=o.call(s,e);return s.set(e,t),n?v(t,r)&&q(s,"set",e,t):q(s,"add",e,t),this}function ge(e){const t=Ve(this),{has:s,get:a}=de(t);let o=s.call(t,e);o||(e=Ve(e),o=s.call(t,e)),a&&a.call(t,e);const n=t.delete(e);return o&&q(t,"delete",e,void 0),n}function _e(){const e=Ve(this),t=0!==e.size,s=e.clear();return t&&q(e,"clear",void 0,void 0),s}function ve(e,t){return function(s,a){const o=this,n=o["__v_raw"],r=Ve(n),i=t?ce:e?Ye:Xe;return!e&&$(r,"iterate",j),n.forEach((e,t)=>s.call(a,i(e),i(t),o))}}function be(e,t,s){return function(...a){const o=this["__v_raw"],n=Ve(o),r=c(n),i="entries"===e||e===Symbol.iterator&&r,l="keys"===e&&r,d=o[e](...a),u=s?ce:t?Ye:Xe;return!t&&$(n,"iterate",l?I:j),{next(){const{value:e,done:t}=d.next();return t?{value:e,done:t}:{value:i?[u(e[0]),u(e[1])]:u(e),done:t}},[Symbol.iterator](){return this}}}}function ye(e){return function(...t){return"delete"!==e&&this}}function xe(){const e={get(e){return ue(this,e)},get size(){return pe(this)},has:me,add:he,set:fe,delete:ge,clear:_e,forEach:ve(!1,!1)},t={get(e){return ue(this,e,!1,!0)},get size(){return pe(this)},has:me,add:he,set:fe,delete:ge,clear:_e,forEach:ve(!1,!0)},s={get(e){return ue(this,e,!0)},get size(){return pe(this,!0)},has(e){return me.call(this,e,!0)},add:ye("add"),set:ye("set"),delete:ye("delete"),clear:ye("clear"),forEach:ve(!0,!1)},a={get(e){return ue(this,e,!0,!0)},get size(){return pe(this,!0)},has(e){return me.call(this,e,!0)},add:ye("add"),set:ye("set"),delete:ye("delete"),clear:ye("clear"),forEach:ve(!0,!0)},o=["keys","values","entries",Symbol.iterator];return o.forEach(o=>{e[o]=be(o,!1,!1),s[o]=be(o,!0,!1),t[o]=be(o,!1,!0),a[o]=be(o,!0,!0)}),[e,s,t,a]}const[we,ke,Se,Me]=xe();function Ae(e,t){const s=t?e?Me:Se:e?ke:we;return(t,a,o)=>"__v_isReactive"===a?!e:"__v_isReadonly"===a?e:"__v_raw"===a?t:Reflect.get(i(s,a)&&a in t?s:t,a,o)}const Re={get:Ae(!1,!1)},Te={get:Ae(!1,!0)},Ee={get:Ae(!0,!1)},Be=new WeakMap,Oe=new WeakMap,Ce=new WeakMap,je=new WeakMap;function Ie(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Le(e){return e["__v_skip"]||!Object.isExtensible(e)?0:Ie(g(e))}function Pe(e){return $e(e)?e:Fe(e,!1,re,Re,Be)}function Ne(e){return Fe(e,!1,le,Te,Oe)}function He(e){return Fe(e,!0,ie,Ee,Ce)}function Fe(e,t,s,a,o){if(!p(e))return e;if(e["__v_raw"]&&(!t||!e["__v_isReactive"]))return e;const n=o.get(e);if(n)return n;const r=Le(e);if(0===r)return e;const i=new Proxy(e,2===r?a:s);return o.set(e,i),i}function De(e){return $e(e)?De(e["__v_raw"]):!(!e||!e["__v_isReactive"])}function $e(e){return!(!e||!e["__v_isReadonly"])}function Ue(e){return!(!e||!e["__v_isShallow"])}function qe(e){return De(e)||$e(e)}function Ve(e){const t=e&&e["__v_raw"];return t?Ve(t):e}function ze(e){return b(e,"__v_skip",!0),e}const Xe=e=>p(e)?Pe(e):e,Ye=e=>p(e)?He(e):e;function Ke(e){N&&C&&(e=Ve(e),U(e.dep||(e.dep=k())))}function Ge(e,t){e=Ve(e),e.dep&&V(e.dep)}function Ze(e){return!(!e||!0!==e.__v_isRef)}function We(e){return Ze(e)?e.value:e}const Qe={get:(e,t,s)=>We(Reflect.get(e,t,s)),set:(e,t,s,a)=>{const o=e[t];return Ze(o)&&!Ze(s)?(o.value=s,!0):Reflect.set(e,t,s,a)}};function Je(e){return De(e)?e:new Proxy(e,Qe)}class et{constructor(e,t,s,a){this._setter=t,this.dep=void 0,this.__v_isRef=!0,this._dirty=!0,this.effect=new L(e,()=>{this._dirty||(this._dirty=!0,Ge(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!a,this["__v_isReadonly"]=s}get value(){const e=Ve(this);return Ke(e),!e._dirty&&e._cacheable||(e._dirty=!1,e._value=e.effect.run()),e._value}set value(e){this._setter(e)}}function tt(e,t,s=!1){let a,n;const r=d(e);r?(a=e,n=o):(a=e.get,n=e.set);const i=new et(a,n,r||!n,s);return i}function st(e,t){const s=Object.create(null),a=e.split(",");for(let o=0;o<a.length;o++)s[a[o]]=!0;return t?e=>!!s[e.toLowerCase()]:e=>!!s[e]}function at(e){if(wt(e)){const t={};for(let s=0;s<e.length;s++){const a=e[s],o=At(a)?rt(a):at(a);if(o)for(const e in o)t[e]=o[e]}return t}return At(e)||Rt(e)?e:void 0}const ot=/;(?![^(]*\))/g,nt=/:(.+)/;function rt(e){const t={};return e.split(ot).forEach(e=>{if(e){const s=e.split(nt);s.length>1&&(t[s[0].trim()]=s[1].trim())}}),t}function it(e){let t="";if(At(e))t=e;else if(wt(e))for(let s=0;s<e.length;s++){const a=it(e[s]);a&&(t+=a+" ")}else if(Rt(e))for(const s in e)e[s]&&(t+=s+" ");return t.trim()}function lt(e){if(!e)return null;let{class:t,style:s}=e;return t&&!At(t)&&(e.class=it(t)),s&&(e.style=at(s)),e}const ct=e=>At(e)?e:null==e?"":wt(e)||Rt(e)&&(e.toString===Et||!Mt(e.toString))?JSON.stringify(e,dt,2):String(e),dt=(e,t)=>t&&t.__v_isRef?dt(e,t.value):kt(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((e,[t,s])=>(e[t+" =>"]=s,e),{})}:St(t)?{[`Set(${t.size})`]:[...t.values()]}:!Rt(t)||wt(t)||Ot(t)?t:String(t),ut={},mt=[],pt=()=>{},ht=()=>!1,ft=/^on[^a-z]/,gt=e=>ft.test(e),_t=e=>e.startsWith("onUpdate:"),vt=Object.assign,bt=(e,t)=>{const s=e.indexOf(t);s>-1&&e.splice(s,1)},yt=Object.prototype.hasOwnProperty,xt=(e,t)=>yt.call(e,t),wt=Array.isArray,kt=e=>"[object Map]"===Bt(e),St=e=>"[object Set]"===Bt(e),Mt=e=>"function"===typeof e,At=e=>"string"===typeof e,Rt=e=>null!==e&&"object"===typeof e,Tt=e=>Rt(e)&&Mt(e.then)&&Mt(e.catch),Et=Object.prototype.toString,Bt=e=>Et.call(e),Ot=e=>"[object Object]"===Bt(e),Ct=st(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),jt=e=>{const t=Object.create(null);return s=>{const a=t[s];return a||(t[s]=e(s))}},It=/-(\w)/g,Lt=jt(e=>e.replace(It,(e,t)=>t?t.toUpperCase():"")),Pt=/\B([A-Z])/g,Nt=jt(e=>e.replace(Pt,"-$1").toLowerCase()),Ht=jt(e=>e.charAt(0).toUpperCase()+e.slice(1)),Ft=jt(e=>e?"on"+Ht(e):""),Dt=(e,t)=>!Object.is(e,t),$t=(e,t)=>{for(let s=0;s<e.length;s++)e[s](t)},Ut=(e,t,s)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:s})},qt=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let Vt;const zt=()=>Vt||(Vt="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof e?e:{});function Xt(e,t,s,a){let o;try{o=a?e(...a):e()}catch(n){Kt(n,t,s)}return o}function Yt(e,t,s,a){if(Mt(e)){const o=Xt(e,t,s,a);return o&&Tt(o)&&o.catch(e=>{Kt(e,t,s)}),o}const o=[];for(let n=0;n<e.length;n++)o.push(Yt(e[n],t,s,a));return o}function Kt(e,t,s,a=!0){const o=t?t.vnode:null;if(t){let a=t.parent;const o=t.proxy,n=s;while(a){const t=a.ec;if(t)for(let s=0;s<t.length;s++)if(!1===t[s](e,o,n))return;a=a.parent}const r=t.appContext.config.errorHandler;if(r)return void Xt(r,null,10,[e,o,n])}Gt(e,s,o,a)}function Gt(e,t,s,a=!0){console.error(e)}let Zt=!1,Wt=!1;const Qt=[];let Jt=0;const es=[];let ts=null,ss=0;const as=[];let os=null,ns=0;const rs=Promise.resolve();let is=null,ls=null;function cs(e){const t=is||rs;return e?t.then(this?e.bind(this):e):t}function ds(e){let t=Jt+1,s=Qt.length;while(t<s){const a=t+s>>>1,o=bs(Qt[a]);o<e?t=a+1:s=a}return t}function us(e){Qt.length&&Qt.includes(e,Zt&&e.allowRecurse?Jt+1:Jt)||e===ls||(null==e.id?Qt.push(e):Qt.splice(ds(e.id),0,e),ms())}function ms(){Zt||Wt||(Wt=!0,is=rs.then(ys))}function ps(e){const t=Qt.indexOf(e);t>Jt&&Qt.splice(t,1)}function hs(e,t,s,a){wt(e)?s.push(...e):t&&t.includes(e,e.allowRecurse?a+1:a)||s.push(e),ms()}function fs(e){hs(e,ts,es,ss)}function gs(e){hs(e,os,as,ns)}function _s(e,t=null){if(es.length){for(ls=t,ts=[...new Set(es)],es.length=0,ss=0;ss<ts.length;ss++)ts[ss]();ts=null,ss=0,ls=null,_s(e,t)}}function vs(e){if(_s(),as.length){const e=[...new Set(as)];if(as.length=0,os)return void os.push(...e);for(os=e,os.sort((e,t)=>bs(e)-bs(t)),ns=0;ns<os.length;ns++)os[ns]();os=null,ns=0}}const bs=e=>null==e.id?1/0:e.id;function ys(e){Wt=!1,Zt=!0,_s(e),Qt.sort((e,t)=>bs(e)-bs(t));try{for(Jt=0;Jt<Qt.length;Jt++){const e=Qt[Jt];e&&!1!==e.active&&Xt(e,null,14)}}finally{Jt=0,Qt.length=0,vs(),Zt=!1,is=null,(Qt.length||es.length||as.length)&&ys(e)}}function xs(e,t,...s){if(e.isUnmounted)return;const a=e.vnode.props||ut;let o=s;const n=t.startsWith("update:"),r=n&&t.slice(7);if(r&&r in a){const e=("modelValue"===r?"model":r)+"Modifiers",{number:t,trim:n}=a[e]||ut;n&&(o=s.map(e=>e.trim())),t&&(o=s.map(qt))}let i,l=a[i=Ft(t)]||a[i=Ft(Lt(t))];!l&&n&&(l=a[i=Ft(Nt(t))]),l&&Yt(l,e,6,o);const c=a[i+"Once"];if(c){if(e.emitted){if(e.emitted[i])return}else e.emitted={};e.emitted[i]=!0,Yt(c,e,6,o)}}function ws(e,t,s=!1){const a=t.emitsCache,o=a.get(e);if(void 0!==o)return o;const n=e.emits;let r={},i=!1;if(!Mt(e)){const a=e=>{const s=ws(e,t,!0);s&&(i=!0,vt(r,s))};!s&&t.mixins.length&&t.mixins.forEach(a),e.extends&&a(e.extends),e.mixins&&e.mixins.forEach(a)}return n||i?(wt(n)?n.forEach(e=>r[e]=null):vt(r,n),a.set(e,r),r):(a.set(e,null),null)}function ks(e,t){return!(!e||!gt(t))&&(t=t.slice(2).replace(/Once$/,""),xt(e,t[0].toLowerCase()+t.slice(1))||xt(e,Nt(t))||xt(e,t))}let Ss=null,Ms=null;function As(e){const t=Ss;return Ss=e,Ms=e&&e.type.__scopeId||null,t}function Rs(e,t=Ss,s){if(!t)return e;if(e._n)return e;const a=(...s)=>{a._d&&jo(-1);const o=As(t),n=e(...s);return As(o),a._d&&jo(1),n};return a._n=!0,a._c=!0,a._d=!0,a}function Ts(e){const{type:t,vnode:s,proxy:a,withProxy:o,props:n,propsOptions:[r],slots:i,attrs:l,emit:c,render:d,renderCache:u,data:m,setupState:p,ctx:h,inheritAttrs:f}=e;let g,_;const v=As(e);try{if(4&s.shapeFlag){const e=o||a;g=Go(d.call(e,e,u,n,p,m,h)),_=l}else{const e=t;0,g=Go(e.length>1?e(n,{attrs:l,slots:i,emit:c}):e(n,null)),_=t.props?l:Es(l)}}catch(y){To.length=0,Kt(y,e,1),g=qo(Ao)}let b=g;if(_&&!1!==f){const e=Object.keys(_),{shapeFlag:t}=b;e.length&&7&t&&(r&&e.some(_t)&&(_=Bs(_,r)),b=Xo(b,_))}return s.dirs&&(b=Xo(b),b.dirs=b.dirs?b.dirs.concat(s.dirs):s.dirs),s.transition&&(b.transition=s.transition),g=b,As(v),g}const Es=e=>{let t;for(const s in e)("class"===s||"style"===s||gt(s))&&((t||(t={}))[s]=e[s]);return t},Bs=(e,t)=>{const s={};for(const a in e)_t(a)&&a.slice(9)in t||(s[a]=e[a]);return s};function Os(e,t,s){const{props:a,children:o,component:n}=e,{props:r,children:i,patchFlag:l}=t,c=n.emitsOptions;if(t.dirs||t.transition)return!0;if(!(s&&l>=0))return!(!o&&!i||i&&i.$stable)||a!==r&&(a?!r||Cs(a,r,c):!!r);if(1024&l)return!0;if(16&l)return a?Cs(a,r,c):!!r;if(8&l){const e=t.dynamicProps;for(let t=0;t<e.length;t++){const s=e[t];if(r[s]!==a[s]&&!ks(c,s))return!0}}return!1}function Cs(e,t,s){const a=Object.keys(t);if(a.length!==Object.keys(e).length)return!0;for(let o=0;o<a.length;o++){const n=a[o];if(t[n]!==e[n]&&!ks(s,n))return!0}return!1}function js({vnode:e,parent:t},s){while(t&&t.subTree===e)(e=t.vnode).el=s,t=t.parent}const Is=e=>e.__isSuspense;function Ls(e,t){t&&t.pendingBranch?wt(e)?t.effects.push(...e):t.effects.push(e):gs(e)}function Ps(e,t){if(an){let s=an.provides;const a=an.parent&&an.parent.provides;a===s&&(s=an.provides=Object.create(a)),s[e]=t}else;}function Ns(e,t,s=!1){const a=an||Ss;if(a){const o=null==a.parent?a.vnode.appContext&&a.vnode.appContext.provides:a.parent.provides;if(o&&e in o)return o[e];if(arguments.length>1)return s&&Mt(t)?t.call(a.proxy):t}}const Hs={};function Fs(e,t,s){return Ds(e,t,s)}function Ds(e,t,{immediate:s,deep:a,flush:o,onTrack:n,onTrigger:r}=ut){const i=an;let l,c,d=!1,u=!1;if(Ze(e)?(l=()=>e.value,d=Ue(e)):De(e)?(l=()=>e,a=!0):wt(e)?(u=!0,d=e.some(e=>De(e)||Ue(e)),l=()=>e.map(e=>Ze(e)?e.value:De(e)?qs(e):Mt(e)?Xt(e,i,2):void 0)):l=Mt(e)?t?()=>Xt(e,i,2):()=>{if(!i||!i.isUnmounted)return c&&c(),Yt(e,i,3,[m])}:pt,t&&a){const e=l;l=()=>qs(e())}let m=e=>{c=g.onStop=()=>{Xt(e,i,4)}};if(dn)return m=pt,t?s&&Yt(t,i,3,[l(),u?[]:void 0,m]):l(),pt;let p=u?[]:Hs;const h=()=>{if(g.active)if(t){const e=g.run();(a||d||(u?e.some((e,t)=>Dt(e,p[t])):Dt(e,p)))&&(c&&c(),Yt(t,i,3,[e,p===Hs?void 0:p,m]),p=e)}else g.run()};let f;h.allowRecurse=!!t,f="sync"===o?h:"post"===o?()=>_o(h,i&&i.suspense):()=>fs(h);const g=new L(l,f);return t?s?h():p=g.run():"post"===o?_o(g.run.bind(g),i&&i.suspense):g.run(),()=>{g.stop(),i&&i.scope&&bt(i.scope.effects,g)}}function $s(e,t,s){const a=this.proxy,o=At(e)?e.includes(".")?Us(a,e):()=>a[e]:e.bind(a,a);let n;Mt(t)?n=t:(n=t.handler,s=t);const r=an;nn(this);const i=Ds(o,n.bind(a),s);return r?nn(r):rn(),i}function Us(e,t){const s=t.split(".");return()=>{let t=e;for(let e=0;e<s.length&&t;e++)t=t[s[e]];return t}}function qs(e,t){if(!Rt(e)||e["__v_skip"])return e;if(t=t||new Set,t.has(e))return e;if(t.add(e),Ze(e))qs(e.value,t);else if(wt(e))for(let s=0;s<e.length;s++)qs(e[s],t);else if(St(e)||kt(e))e.forEach(e=>{qs(e,t)});else if(Ot(e))for(const s in e)qs(e[s],t);return e}function Vs(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return da(()=>{e.isMounted=!0}),pa(()=>{e.isUnmounting=!0}),e}const zs=[Function,Array],Xs={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:zs,onEnter:zs,onAfterEnter:zs,onEnterCancelled:zs,onBeforeLeave:zs,onLeave:zs,onAfterLeave:zs,onLeaveCancelled:zs,onBeforeAppear:zs,onAppear:zs,onAfterAppear:zs,onAppearCancelled:zs},setup(e,{slots:t}){const s=on(),a=Vs();let o;return()=>{const n=t.default&&Js(t.default(),!0);if(!n||!n.length)return;let r=n[0];if(n.length>1)for(const e of n)if(e.type!==Ao){r=e;break}const i=Ve(e),{mode:l}=i;if(a.isLeaving)return Zs(r);const c=Ws(r);if(!c)return Zs(r);const d=Gs(c,i,a,s);Qs(c,d);const u=s.subTree,m=u&&Ws(u);let p=!1;const{getTransitionKey:h}=c.type;if(h){const e=h();void 0===o?o=e:e!==o&&(o=e,p=!0)}if(m&&m.type!==Ao&&(!Ho(c,m)||p)){const e=Gs(m,i,a,s);if(Qs(m,e),"out-in"===l)return a.isLeaving=!0,e.afterLeave=()=>{a.isLeaving=!1,s.update()},Zs(r);"in-out"===l&&c.type!==Ao&&(e.delayLeave=(e,t,s)=>{const o=Ks(a,m);o[String(m.key)]=m,e._leaveCb=()=>{t(),e._leaveCb=void 0,delete d.delayedLeave},d.delayedLeave=s})}return r}}},Ys=Xs;function Ks(e,t){const{leavingVNodes:s}=e;let a=s.get(t.type);return a||(a=Object.create(null),s.set(t.type,a)),a}function Gs(e,t,s,a){const{appear:o,mode:n,persisted:r=!1,onBeforeEnter:i,onEnter:l,onAfterEnter:c,onEnterCancelled:d,onBeforeLeave:u,onLeave:m,onAfterLeave:p,onLeaveCancelled:h,onBeforeAppear:f,onAppear:g,onAfterAppear:_,onAppearCancelled:v}=t,b=String(e.key),y=Ks(s,e),x=(e,t)=>{e&&Yt(e,a,9,t)},w=(e,t)=>{const s=t[1];x(e,t),wt(e)?e.every(e=>e.length<=1)&&s():e.length<=1&&s()},k={mode:n,persisted:r,beforeEnter(t){let a=i;if(!s.isMounted){if(!o)return;a=f||i}t._leaveCb&&t._leaveCb(!0);const n=y[b];n&&Ho(e,n)&&n.el._leaveCb&&n.el._leaveCb(),x(a,[t])},enter(e){let t=l,a=c,n=d;if(!s.isMounted){if(!o)return;t=g||l,a=_||c,n=v||d}let r=!1;const i=e._enterCb=t=>{r||(r=!0,x(t?n:a,[e]),k.delayedLeave&&k.delayedLeave(),e._enterCb=void 0)};t?w(t,[e,i]):i()},leave(t,a){const o=String(e.key);if(t._enterCb&&t._enterCb(!0),s.isUnmounting)return a();x(u,[t]);let n=!1;const r=t._leaveCb=s=>{n||(n=!0,a(),x(s?h:p,[t]),t._leaveCb=void 0,y[o]===e&&delete y[o])};y[o]=e,m?w(m,[t,r]):r()},clone(e){return Gs(e,t,s,a)}};return k}function Zs(e){if(sa(e))return e=Xo(e),e.children=null,e}function Ws(e){return sa(e)?e.children?e.children[0]:void 0:e}function Qs(e,t){6&e.shapeFlag&&e.component?Qs(e.component.subTree,t):128&e.shapeFlag?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function Js(e,t=!1,s){let a=[],o=0;for(let n=0;n<e.length;n++){let r=e[n];const i=null==s?r.key:String(s)+String(null!=r.key?r.key:n);r.type===So?(128&r.patchFlag&&o++,a=a.concat(Js(r.children,t,i))):(t||r.type!==Ao)&&a.push(null!=i?Xo(r,{key:i}):r)}if(o>1)for(let n=0;n<a.length;n++)a[n].patchFlag=-2;return a}function ea(e){return Mt(e)?{setup:e,name:e.name}:e}const ta=e=>!!e.type.__asyncLoader,sa=e=>e.type.__isKeepAlive;function aa(e,t){na(e,"a",t)}function oa(e,t){na(e,"da",t)}function na(e,t,s=an){const a=e.__wdc||(e.__wdc=()=>{let t=s;while(t){if(t.isDeactivated)return;t=t.parent}return e()});if(ia(t,a,s),s){let e=s.parent;while(e&&e.parent)sa(e.parent.vnode)&&ra(a,t,s,e),e=e.parent}}function ra(e,t,s,a){const o=ia(t,e,a,!0);ha(()=>{bt(a[t],o)},s)}function ia(e,t,s=an,a=!1){if(s){const o=s[e]||(s[e]=[]),n=t.__weh||(t.__weh=(...a)=>{if(s.isUnmounted)return;F(),nn(s);const o=Yt(t,s,e,a);return rn(),D(),o});return a?o.unshift(n):o.push(n),n}}const la=e=>(t,s=an)=>(!dn||"sp"===e)&&ia(e,t,s),ca=la("bm"),da=la("m"),ua=la("bu"),ma=la("u"),pa=la("bum"),ha=la("um"),fa=la("sp"),ga=la("rtg"),_a=la("rtc");function va(e,t=an){ia("ec",e,t)}function ba(e,t){const s=Ss;if(null===s)return e;const a=_n(s)||s.proxy,o=e.dirs||(e.dirs=[]);for(let n=0;n<t.length;n++){let[e,s,r,i=ut]=t[n];Mt(e)&&(e={mounted:e,updated:e}),e.deep&&qs(s),o.push({dir:e,instance:a,value:s,oldValue:void 0,arg:r,modifiers:i})}return e}function ya(e,t,s,a){const o=e.dirs,n=t&&t.dirs;for(let r=0;r<o.length;r++){const i=o[r];n&&(i.oldValue=n[r].value);let l=i.dir[a];l&&(F(),Yt(l,s,8,[e.el,i,e,t]),D())}}const xa="components",wa="directives";function ka(e,t){return Ra(xa,e,!0,t)||e}const Sa=Symbol();function Ma(e){return At(e)?Ra(xa,e,!1)||e:e||Sa}function Aa(e){return Ra(wa,e)}function Ra(e,t,s=!0,a=!1){const o=Ss||an;if(o){const s=o.type;if(e===xa){const e=vn(s,!1);if(e&&(e===t||e===Lt(t)||e===Ht(Lt(t))))return s}const n=Ta(o[e]||s[e],t)||Ta(o.appContext[e],t);return!n&&a?s:n}}function Ta(e,t){return e&&(e[t]||e[Lt(t)]||e[Ht(Lt(t))])}function Ea(e,t,s,a){let o;const n=s&&s[a];if(wt(e)||At(e)){o=new Array(e.length);for(let s=0,a=e.length;s<a;s++)o[s]=t(e[s],s,void 0,n&&n[s])}else if("number"===typeof e){o=new Array(e);for(let s=0;s<e;s++)o[s]=t(s+1,s,void 0,n&&n[s])}else if(Rt(e))if(e[Symbol.iterator])o=Array.from(e,(e,s)=>t(e,s,void 0,n&&n[s]));else{const s=Object.keys(e);o=new Array(s.length);for(let a=0,r=s.length;a<r;a++){const r=s[a];o[a]=t(e[r],r,a,n&&n[a])}}else o=[];return s&&(s[a]=o),o}function Ba(e,t){for(let s=0;s<t.length;s++){const a=t[s];if(wt(a))for(let t=0;t<a.length;t++)e[a[t].name]=a[t].fn;else a&&(e[a.name]=a.fn)}return e}function Oa(e,t,s={},a,o){if(Ss.isCE||Ss.parent&&ta(Ss.parent)&&Ss.parent.isCE)return qo("slot","default"===t?null:{name:t},a&&a());let n=e[t];n&&n._c&&(n._d=!1),Bo();const r=n&&Ca(n(s)),i=Po(So,{key:s.key||"_"+t},r||(a?a():[]),r&&1===e._?64:-2);return!o&&i.scopeId&&(i.slotScopeIds=[i.scopeId+"-s"]),n&&n._c&&(n._d=!0),i}function Ca(e){return e.some(e=>!No(e)||e.type!==Ao&&!(e.type===So&&!Ca(e.children)))?e:null}const ja=e=>e?ln(e)?_n(e)||e.proxy:ja(e.parent):null,Ia=vt(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>ja(e.parent),$root:e=>ja(e.root),$emit:e=>e.emit,$options:e=>$a(e),$forceUpdate:e=>e.f||(e.f=()=>us(e.update)),$nextTick:e=>e.n||(e.n=cs.bind(e.proxy)),$watch:e=>$s.bind(e)}),La={get({_:e},t){const{ctx:s,setupState:a,data:o,props:n,accessCache:r,type:i,appContext:l}=e;let c;if("$"!==t[0]){const i=r[t];if(void 0!==i)switch(i){case 1:return a[t];case 2:return o[t];case 4:return s[t];case 3:return n[t]}else{if(a!==ut&&xt(a,t))return r[t]=1,a[t];if(o!==ut&&xt(o,t))return r[t]=2,o[t];if((c=e.propsOptions[0])&&xt(c,t))return r[t]=3,n[t];if(s!==ut&&xt(s,t))return r[t]=4,s[t];Pa&&(r[t]=0)}}const d=Ia[t];let u,m;return d?("$attrs"===t&&$(e,"get",t),d(e)):(u=i.__cssModules)&&(u=u[t])?u:s!==ut&&xt(s,t)?(r[t]=4,s[t]):(m=l.config.globalProperties,xt(m,t)?m[t]:void 0)},set({_:e},t,s){const{data:a,setupState:o,ctx:n}=e;return o!==ut&&xt(o,t)?(o[t]=s,!0):a!==ut&&xt(a,t)?(a[t]=s,!0):!xt(e.props,t)&&(("$"!==t[0]||!(t.slice(1)in e))&&(n[t]=s,!0))},has({_:{data:e,setupState:t,accessCache:s,ctx:a,appContext:o,propsOptions:n}},r){let i;return!!s[r]||e!==ut&&xt(e,r)||t!==ut&&xt(t,r)||(i=n[0])&&xt(i,r)||xt(a,r)||xt(Ia,r)||xt(o.config.globalProperties,r)},defineProperty(e,t,s){return null!=s.get?e._.accessCache[t]=0:xt(s,"value")&&this.set(e,t,s.value,null),Reflect.defineProperty(e,t,s)}};let Pa=!0;function Na(e){const t=$a(e),s=e.proxy,a=e.ctx;Pa=!1,t.beforeCreate&&Fa(t.beforeCreate,e,"bc");const{data:o,computed:n,methods:r,watch:i,provide:l,inject:c,created:d,beforeMount:u,mounted:m,beforeUpdate:p,updated:h,activated:f,deactivated:g,beforeDestroy:_,beforeUnmount:v,destroyed:b,unmounted:y,render:x,renderTracked:w,renderTriggered:k,errorCaptured:S,serverPrefetch:M,expose:A,inheritAttrs:R,components:T,directives:E,filters:B}=t,O=null;if(c&&Ha(c,a,O,e.appContext.config.unwrapInjectedRef),r)for(const j in r){const e=r[j];Mt(e)&&(a[j]=e.bind(s))}if(o){const t=o.call(s,s);Rt(t)&&(e.data=Pe(t))}if(Pa=!0,n)for(const j in n){const e=n[j],t=Mt(e)?e.bind(s,s):Mt(e.get)?e.get.bind(s,s):pt,o=!Mt(e)&&Mt(e.set)?e.set.bind(s):pt,r=yn({get:t,set:o});Object.defineProperty(a,j,{enumerable:!0,configurable:!0,get:()=>r.value,set:e=>r.value=e})}if(i)for(const j in i)Da(i[j],a,s,j);if(l){const e=Mt(l)?l.call(s):l;Reflect.ownKeys(e).forEach(t=>{Ps(t,e[t])})}function C(e,t){wt(t)?t.forEach(t=>e(t.bind(s))):t&&e(t.bind(s))}if(d&&Fa(d,e,"c"),C(ca,u),C(da,m),C(ua,p),C(ma,h),C(aa,f),C(oa,g),C(va,S),C(_a,w),C(ga,k),C(pa,v),C(ha,y),C(fa,M),wt(A))if(A.length){const t=e.exposed||(e.exposed={});A.forEach(e=>{Object.defineProperty(t,e,{get:()=>s[e],set:t=>s[e]=t})})}else e.exposed||(e.exposed={});x&&e.render===pt&&(e.render=x),null!=R&&(e.inheritAttrs=R),T&&(e.components=T),E&&(e.directives=E)}function Ha(e,t,s=pt,a=!1){wt(e)&&(e=Xa(e));for(const o in e){const s=e[o];let n;n=Rt(s)?"default"in s?Ns(s.from||o,s.default,!0):Ns(s.from||o):Ns(s),Ze(n)&&a?Object.defineProperty(t,o,{enumerable:!0,configurable:!0,get:()=>n.value,set:e=>n.value=e}):t[o]=n}}function Fa(e,t,s){Yt(wt(e)?e.map(e=>e.bind(t.proxy)):e.bind(t.proxy),t,s)}function Da(e,t,s,a){const o=a.includes(".")?Us(s,a):()=>s[a];if(At(e)){const s=t[e];Mt(s)&&Fs(o,s)}else if(Mt(e))Fs(o,e.bind(s));else if(Rt(e))if(wt(e))e.forEach(e=>Da(e,t,s,a));else{const a=Mt(e.handler)?e.handler.bind(s):t[e.handler];Mt(a)&&Fs(o,a,e)}}function $a(e){const t=e.type,{mixins:s,extends:a}=t,{mixins:o,optionsCache:n,config:{optionMergeStrategies:r}}=e.appContext,i=n.get(t);let l;return i?l=i:o.length||s||a?(l={},o.length&&o.forEach(e=>Ua(l,e,r,!0)),Ua(l,t,r)):l=t,n.set(t,l),l}function Ua(e,t,s,a=!1){const{mixins:o,extends:n}=t;n&&Ua(e,n,s,!0),o&&o.forEach(t=>Ua(e,t,s,!0));for(const r in t)if(a&&"expose"===r);else{const a=qa[r]||s&&s[r];e[r]=a?a(e[r],t[r]):t[r]}return e}const qa={data:Va,props:Ka,emits:Ka,methods:Ka,computed:Ka,beforeCreate:Ya,created:Ya,beforeMount:Ya,mounted:Ya,beforeUpdate:Ya,updated:Ya,beforeDestroy:Ya,beforeUnmount:Ya,destroyed:Ya,unmounted:Ya,activated:Ya,deactivated:Ya,errorCaptured:Ya,serverPrefetch:Ya,components:Ka,directives:Ka,watch:Ga,provide:Va,inject:za};function Va(e,t){return t?e?function(){return vt(Mt(e)?e.call(this,this):e,Mt(t)?t.call(this,this):t)}:t:e}function za(e,t){return Ka(Xa(e),Xa(t))}function Xa(e){if(wt(e)){const t={};for(let s=0;s<e.length;s++)t[e[s]]=e[s];return t}return e}function Ya(e,t){return e?[...new Set([].concat(e,t))]:t}function Ka(e,t){return e?vt(vt(Object.create(null),e),t):t}function Ga(e,t){if(!e)return t;if(!t)return e;const s=vt(Object.create(null),e);for(const a in t)s[a]=Ya(e[a],t[a]);return s}function Za(e,t,s,a=!1){const o={},n={};Ut(n,Fo,1),e.propsDefaults=Object.create(null),Qa(e,t,o,n);for(const r in e.propsOptions[0])r in o||(o[r]=void 0);s?e.props=a?o:Ne(o):e.type.props?e.props=o:e.props=n,e.attrs=n}function Wa(e,t,s,a){const{props:o,attrs:n,vnode:{patchFlag:r}}=e,i=Ve(o),[l]=e.propsOptions;let c=!1;if(!(a||r>0)||16&r){let a;Qa(e,t,o,n)&&(c=!0);for(const n in i)t&&(xt(t,n)||(a=Nt(n))!==n&&xt(t,a))||(l?!s||void 0===s[n]&&void 0===s[a]||(o[n]=Ja(l,i,n,void 0,e,!0)):delete o[n]);if(n!==i)for(const e in n)t&&xt(t,e)||(delete n[e],c=!0)}else if(8&r){const s=e.vnode.dynamicProps;for(let a=0;a<s.length;a++){let r=s[a];if(ks(e.emitsOptions,r))continue;const d=t[r];if(l)if(xt(n,r))d!==n[r]&&(n[r]=d,c=!0);else{const t=Lt(r);o[t]=Ja(l,i,t,d,e,!1)}else d!==n[r]&&(n[r]=d,c=!0)}}c&&q(e,"set","$attrs")}function Qa(e,t,s,a){const[o,n]=e.propsOptions;let r,i=!1;if(t)for(let l in t){if(Ct(l))continue;const c=t[l];let d;o&&xt(o,d=Lt(l))?n&&n.includes(d)?(r||(r={}))[d]=c:s[d]=c:ks(e.emitsOptions,l)||l in a&&c===a[l]||(a[l]=c,i=!0)}if(n){const t=Ve(s),a=r||ut;for(let r=0;r<n.length;r++){const i=n[r];s[i]=Ja(o,t,i,a[i],e,!xt(a,i))}}return i}function Ja(e,t,s,a,o,n){const r=e[s];if(null!=r){const e=xt(r,"default");if(e&&void 0===a){const e=r.default;if(r.type!==Function&&Mt(e)){const{propsDefaults:n}=o;s in n?a=n[s]:(nn(o),a=n[s]=e.call(null,t),rn())}else a=e}r[0]&&(n&&!e?a=!1:!r[1]||""!==a&&a!==Nt(s)||(a=!0))}return a}function eo(e,t,s=!1){const a=t.propsCache,o=a.get(e);if(o)return o;const n=e.props,r={},i=[];let l=!1;if(!Mt(e)){const a=e=>{l=!0;const[s,a]=eo(e,t,!0);vt(r,s),a&&i.push(...a)};!s&&t.mixins.length&&t.mixins.forEach(a),e.extends&&a(e.extends),e.mixins&&e.mixins.forEach(a)}if(!n&&!l)return a.set(e,mt),mt;if(wt(n))for(let d=0;d<n.length;d++){const e=Lt(n[d]);to(e)&&(r[e]=ut)}else if(n)for(const d in n){const e=Lt(d);if(to(e)){const t=n[d],s=r[e]=wt(t)||Mt(t)?{type:t}:t;if(s){const t=oo(Boolean,s.type),a=oo(String,s.type);s[0]=t>-1,s[1]=a<0||t<a,(t>-1||xt(s,"default"))&&i.push(e)}}}const c=[r,i];return a.set(e,c),c}function to(e){return"$"!==e[0]}function so(e){const t=e&&e.toString().match(/^\s*function (\w+)/);return t?t[1]:null===e?"null":""}function ao(e,t){return so(e)===so(t)}function oo(e,t){return wt(t)?t.findIndex(t=>ao(t,e)):Mt(t)&&ao(t,e)?0:-1}const no=e=>"_"===e[0]||"$stable"===e,ro=e=>wt(e)?e.map(Go):[Go(e)],io=(e,t,s)=>{if(t._n)return t;const a=Rs((...e)=>ro(t(...e)),s);return a._c=!1,a},lo=(e,t,s)=>{const a=e._ctx;for(const o in e){if(no(o))continue;const s=e[o];if(Mt(s))t[o]=io(o,s,a);else if(null!=s){const e=ro(s);t[o]=()=>e}}},co=(e,t)=>{const s=ro(t);e.slots.default=()=>s},uo=(e,t)=>{if(32&e.vnode.shapeFlag){const s=t._;s?(e.slots=Ve(t),Ut(t,"_",s)):lo(t,e.slots={})}else e.slots={},t&&co(e,t);Ut(e.slots,Fo,1)},mo=(e,t,s)=>{const{vnode:a,slots:o}=e;let n=!0,r=ut;if(32&a.shapeFlag){const e=t._;e?s&&1===e?n=!1:(vt(o,t),s||1!==e||delete o._):(n=!t.$stable,lo(t,o)),r=t}else t&&(co(e,t),r={default:1});if(n)for(const i in o)no(i)||i in r||delete o[i]};function po(){return{app:null,config:{isNativeTag:ht,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let ho=0;function fo(e,t){return function(s,a=null){Mt(s)||(s=Object.assign({},s)),null==a||Rt(a)||(a=null);const o=po(),n=new Set;let r=!1;const i=o.app={_uid:ho++,_component:s,_props:a,_container:null,_context:o,_instance:null,version:wn,get config(){return o.config},set config(e){},use(e,...t){return n.has(e)||(e&&Mt(e.install)?(n.add(e),e.install(i,...t)):Mt(e)&&(n.add(e),e(i,...t))),i},mixin(e){return o.mixins.includes(e)||o.mixins.push(e),i},component(e,t){return t?(o.components[e]=t,i):o.components[e]},directive(e,t){return t?(o.directives[e]=t,i):o.directives[e]},mount(n,l,c){if(!r){const d=qo(s,a);return d.appContext=o,l&&t?t(d,n):e(d,n,c),r=!0,i._container=n,n.__vue_app__=i,_n(d.component)||d.component.proxy}},unmount(){r&&(e(null,i._container),delete i._container.__vue_app__)},provide(e,t){return o.provides[e]=t,i}};return i}}function go(e,t,s,a,o=!1){if(wt(e))return void e.forEach((e,n)=>go(e,t&&(wt(t)?t[n]:t),s,a,o));if(ta(a)&&!o)return;const n=4&a.shapeFlag?_n(a.component)||a.component.proxy:a.el,r=o?null:n,{i:i,r:l}=e,c=t&&t.r,d=i.refs===ut?i.refs={}:i.refs,u=i.setupState;if(null!=c&&c!==l&&(At(c)?(d[c]=null,xt(u,c)&&(u[c]=null)):Ze(c)&&(c.value=null)),Mt(l))Xt(l,i,12,[r,d]);else{const t=At(l),a=Ze(l);if(t||a){const i=()=>{if(e.f){const s=t?d[l]:l.value;o?wt(s)&&bt(s,n):wt(s)?s.includes(n)||s.push(n):t?(d[l]=[n],xt(u,l)&&(u[l]=d[l])):(l.value=[n],e.k&&(d[e.k]=l.value))}else t?(d[l]=r,xt(u,l)&&(u[l]=r)):a&&(l.value=r,e.k&&(d[e.k]=r))};r?(i.id=-1,_o(i,s)):i()}}}const _o=Ls;function vo(e){return bo(e)}function bo(e,t){const s=zt();s.__VUE__=!0;const{insert:a,remove:o,patchProp:n,createElement:r,createText:i,createComment:l,setText:c,setElementText:d,parentNode:u,nextSibling:m,setScopeId:p=pt,cloneNode:h,insertStaticContent:f}=e,g=(e,t,s,a=null,o=null,n=null,r=!1,i=null,l=!!t.dynamicChildren)=>{if(e===t)return;e&&!Ho(e,t)&&(a=Y(e),U(e,o,n,!0),e=null),-2===t.patchFlag&&(l=!1,t.dynamicChildren=null);const{type:c,ref:d,shapeFlag:u}=t;switch(c){case Mo:_(e,t,s,a);break;case Ao:v(e,t,s,a);break;case Ro:null==e&&b(t,s,a,r);break;case So:E(e,t,s,a,o,n,r,i,l);break;default:1&u?w(e,t,s,a,o,n,r,i,l):6&u?B(e,t,s,a,o,n,r,i,l):(64&u||128&u)&&c.process(e,t,s,a,o,n,r,i,l,G)}null!=d&&o&&go(d,e&&e.ref,n,t||e,!t)},_=(e,t,s,o)=>{if(null==e)a(t.el=i(t.children),s,o);else{const s=t.el=e.el;t.children!==e.children&&c(s,t.children)}},v=(e,t,s,o)=>{null==e?a(t.el=l(t.children||""),s,o):t.el=e.el},b=(e,t,s,a)=>{[e.el,e.anchor]=f(e.children,t,s,a,e.el,e.anchor)},y=({el:e,anchor:t},s,o)=>{let n;while(e&&e!==t)n=m(e),a(e,s,o),e=n;a(t,s,o)},x=({el:e,anchor:t})=>{let s;while(e&&e!==t)s=m(e),o(e),e=s;o(t)},w=(e,t,s,a,o,n,r,i,l)=>{r=r||"svg"===t.type,null==e?k(t,s,a,o,n,r,i,l):A(e,t,o,n,r,i,l)},k=(e,t,s,o,i,l,c,u)=>{let m,p;const{type:f,props:g,shapeFlag:_,transition:v,patchFlag:b,dirs:y}=e;if(e.el&&void 0!==h&&-1===b)m=e.el=h(e.el);else{if(m=e.el=r(e.type,l,g&&g.is,g),8&_?d(m,e.children):16&_&&M(e.children,m,null,o,i,l&&"foreignObject"!==f,c,u),y&&ya(e,null,o,"created"),g){for(const t in g)"value"===t||Ct(t)||n(m,t,null,g[t],l,e.children,o,i,X);"value"in g&&n(m,"value",null,g.value),(p=g.onVnodeBeforeMount)&&Jo(p,o,e)}S(m,e,e.scopeId,c,o)}y&&ya(e,null,o,"beforeMount");const x=(!i||i&&!i.pendingBranch)&&v&&!v.persisted;x&&v.beforeEnter(m),a(m,t,s),((p=g&&g.onVnodeMounted)||x||y)&&_o(()=>{p&&Jo(p,o,e),x&&v.enter(m),y&&ya(e,null,o,"mounted")},i)},S=(e,t,s,a,o)=>{if(s&&p(e,s),a)for(let n=0;n<a.length;n++)p(e,a[n]);if(o){let s=o.subTree;if(t===s){const t=o.vnode;S(e,t,t.scopeId,t.slotScopeIds,o.parent)}}},M=(e,t,s,a,o,n,r,i,l=0)=>{for(let c=l;c<e.length;c++){const l=e[c]=i?Zo(e[c]):Go(e[c]);g(null,l,t,s,a,o,n,r,i)}},A=(e,t,s,a,o,r,i)=>{const l=t.el=e.el;let{patchFlag:c,dynamicChildren:u,dirs:m}=t;c|=16&e.patchFlag;const p=e.props||ut,h=t.props||ut;let f;s&&yo(s,!1),(f=h.onVnodeBeforeUpdate)&&Jo(f,s,t,e),m&&ya(t,e,s,"beforeUpdate"),s&&yo(s,!0);const g=o&&"foreignObject"!==t.type;if(u?R(e.dynamicChildren,u,l,s,a,g,r):i||P(e,t,l,null,s,a,g,r,!1),c>0){if(16&c)T(l,t,p,h,s,a,o);else if(2&c&&p.class!==h.class&&n(l,"class",null,h.class,o),4&c&&n(l,"style",p.style,h.style,o),8&c){const r=t.dynamicProps;for(let t=0;t<r.length;t++){const i=r[t],c=p[i],d=h[i];d===c&&"value"!==i||n(l,i,c,d,o,e.children,s,a,X)}}1&c&&e.children!==t.children&&d(l,t.children)}else i||null!=u||T(l,t,p,h,s,a,o);((f=h.onVnodeUpdated)||m)&&_o(()=>{f&&Jo(f,s,t,e),m&&ya(t,e,s,"updated")},a)},R=(e,t,s,a,o,n,r)=>{for(let i=0;i<t.length;i++){const l=e[i],c=t[i],d=l.el&&(l.type===So||!Ho(l,c)||70&l.shapeFlag)?u(l.el):s;g(l,c,d,null,a,o,n,r,!0)}},T=(e,t,s,a,o,r,i)=>{if(s!==a){for(const l in a){if(Ct(l))continue;const c=a[l],d=s[l];c!==d&&"value"!==l&&n(e,l,d,c,i,t.children,o,r,X)}if(s!==ut)for(const l in s)Ct(l)||l in a||n(e,l,s[l],null,i,t.children,o,r,X);"value"in a&&n(e,"value",s.value,a.value)}},E=(e,t,s,o,n,r,l,c,d)=>{const u=t.el=e?e.el:i(""),m=t.anchor=e?e.anchor:i("");let{patchFlag:p,dynamicChildren:h,slotScopeIds:f}=t;f&&(c=c?c.concat(f):f),null==e?(a(u,s,o),a(m,s,o),M(t.children,s,m,n,r,l,c,d)):p>0&&64&p&&h&&e.dynamicChildren?(R(e.dynamicChildren,h,s,n,r,l,c),(null!=t.key||n&&t===n.subTree)&&xo(e,t,!0)):P(e,t,s,m,n,r,l,c,d)},B=(e,t,s,a,o,n,r,i,l)=>{t.slotScopeIds=i,null==e?512&t.shapeFlag?o.ctx.activate(t,s,a,r,l):O(t,s,a,o,n,r,l):C(e,t,l)},O=(e,t,s,a,o,n,r)=>{const i=e.component=sn(e,a,o);if(sa(e)&&(i.ctx.renderer=G),un(i),i.asyncDep){if(o&&o.registerDep(i,j),!e.el){const e=i.subTree=qo(Ao);v(null,e,t,s)}}else j(i,e,t,s,o,n,r)},C=(e,t,s)=>{const a=t.component=e.component;if(Os(e,t,s)){if(a.asyncDep&&!a.asyncResolved)return void I(a,t,s);a.next=t,ps(a.update),a.update()}else t.el=e.el,a.vnode=t},j=(e,t,s,a,o,n,r)=>{const i=()=>{if(e.isMounted){let t,{next:s,bu:a,u:i,parent:l,vnode:c}=e,d=s;yo(e,!1),s?(s.el=c.el,I(e,s,r)):s=c,a&&$t(a),(t=s.props&&s.props.onVnodeBeforeUpdate)&&Jo(t,l,s,c),yo(e,!0);const m=Ts(e),p=e.subTree;e.subTree=m,g(p,m,u(p.el),Y(p),e,o,n),s.el=m.el,null===d&&js(e,m.el),i&&_o(i,o),(t=s.props&&s.props.onVnodeUpdated)&&_o(()=>Jo(t,l,s,c),o)}else{let r;const{el:i,props:l}=t,{bm:c,m:d,parent:u}=e,m=ta(t);if(yo(e,!1),c&&$t(c),!m&&(r=l&&l.onVnodeBeforeMount)&&Jo(r,u,t),yo(e,!0),i&&W){const s=()=>{e.subTree=Ts(e),W(i,e.subTree,e,o,null)};m?t.type.__asyncLoader().then(()=>!e.isUnmounted&&s()):s()}else{const r=e.subTree=Ts(e);g(null,r,s,a,e,o,n),t.el=r.el}if(d&&_o(d,o),!m&&(r=l&&l.onVnodeMounted)){const e=t;_o(()=>Jo(r,u,e),o)}(256&t.shapeFlag||u&&ta(u.vnode)&&256&u.vnode.shapeFlag)&&e.a&&_o(e.a,o),e.isMounted=!0,t=s=a=null}},l=e.effect=new L(i,()=>us(c),e.scope),c=e.update=()=>l.run();c.id=e.uid,yo(e,!0),c()},I=(e,t,s)=>{t.component=e;const a=e.vnode.props;e.vnode=t,e.next=null,Wa(e,t.props,a,s),mo(e,t.children,s),F(),_s(void 0,e.update),D()},P=(e,t,s,a,o,n,r,i,l=!1)=>{const c=e&&e.children,u=e?e.shapeFlag:0,m=t.children,{patchFlag:p,shapeFlag:h}=t;if(p>0){if(128&p)return void H(c,m,s,a,o,n,r,i,l);if(256&p)return void N(c,m,s,a,o,n,r,i,l)}8&h?(16&u&&X(c,o,n),m!==c&&d(s,m)):16&u?16&h?H(c,m,s,a,o,n,r,i,l):X(c,o,n,!0):(8&u&&d(s,""),16&h&&M(m,s,a,o,n,r,i,l))},N=(e,t,s,a,o,n,r,i,l)=>{e=e||mt,t=t||mt;const c=e.length,d=t.length,u=Math.min(c,d);let m;for(m=0;m<u;m++){const a=t[m]=l?Zo(t[m]):Go(t[m]);g(e[m],a,s,null,o,n,r,i,l)}c>d?X(e,o,n,!0,!1,u):M(t,s,a,o,n,r,i,l,u)},H=(e,t,s,a,o,n,r,i,l)=>{let c=0;const d=t.length;let u=e.length-1,m=d-1;while(c<=u&&c<=m){const a=e[c],d=t[c]=l?Zo(t[c]):Go(t[c]);if(!Ho(a,d))break;g(a,d,s,null,o,n,r,i,l),c++}while(c<=u&&c<=m){const a=e[u],c=t[m]=l?Zo(t[m]):Go(t[m]);if(!Ho(a,c))break;g(a,c,s,null,o,n,r,i,l),u--,m--}if(c>u){if(c<=m){const e=m+1,u=e<d?t[e].el:a;while(c<=m)g(null,t[c]=l?Zo(t[c]):Go(t[c]),s,u,o,n,r,i,l),c++}}else if(c>m)while(c<=u)U(e[c],o,n,!0),c++;else{const p=c,h=c,f=new Map;for(c=h;c<=m;c++){const e=t[c]=l?Zo(t[c]):Go(t[c]);null!=e.key&&f.set(e.key,c)}let _,v=0;const b=m-h+1;let y=!1,x=0;const w=new Array(b);for(c=0;c<b;c++)w[c]=0;for(c=p;c<=u;c++){const a=e[c];if(v>=b){U(a,o,n,!0);continue}let d;if(null!=a.key)d=f.get(a.key);else for(_=h;_<=m;_++)if(0===w[_-h]&&Ho(a,t[_])){d=_;break}void 0===d?U(a,o,n,!0):(w[d-h]=c+1,d>=x?x=d:y=!0,g(a,t[d],s,null,o,n,r,i,l),v++)}const k=y?wo(w):mt;for(_=k.length-1,c=b-1;c>=0;c--){const e=h+c,u=t[e],m=e+1<d?t[e+1].el:a;0===w[c]?g(null,u,s,m,o,n,r,i,l):y&&(_<0||c!==k[_]?$(u,s,m,2):_--)}}},$=(e,t,s,o,n=null)=>{const{el:r,type:i,transition:l,children:c,shapeFlag:d}=e;if(6&d)return void $(e.component.subTree,t,s,o);if(128&d)return void e.suspense.move(t,s,o);if(64&d)return void i.move(e,t,s,G);if(i===So){a(r,t,s);for(let e=0;e<c.length;e++)$(c[e],t,s,o);return void a(e.anchor,t,s)}if(i===Ro)return void y(e,t,s);const u=2!==o&&1&d&&l;if(u)if(0===o)l.beforeEnter(r),a(r,t,s),_o(()=>l.enter(r),n);else{const{leave:e,delayLeave:o,afterLeave:n}=l,i=()=>a(r,t,s),c=()=>{e(r,()=>{i(),n&&n()})};o?o(r,i,c):c()}else a(r,t,s)},U=(e,t,s,a=!1,o=!1)=>{const{type:n,props:r,ref:i,children:l,dynamicChildren:c,shapeFlag:d,patchFlag:u,dirs:m}=e;if(null!=i&&go(i,null,s,e,!0),256&d)return void t.ctx.deactivate(e);const p=1&d&&m,h=!ta(e);let f;if(h&&(f=r&&r.onVnodeBeforeUnmount)&&Jo(f,t,e),6&d)z(e.component,s,a);else{if(128&d)return void e.suspense.unmount(s,a);p&&ya(e,null,t,"beforeUnmount"),64&d?e.type.remove(e,t,s,o,G,a):c&&(n!==So||u>0&&64&u)?X(c,t,s,!1,!0):(n===So&&384&u||!o&&16&d)&&X(l,t,s),a&&q(e)}(h&&(f=r&&r.onVnodeUnmounted)||p)&&_o(()=>{f&&Jo(f,t,e),p&&ya(e,null,t,"unmounted")},s)},q=e=>{const{type:t,el:s,anchor:a,transition:n}=e;if(t===So)return void V(s,a);if(t===Ro)return void x(e);const r=()=>{o(s),n&&!n.persisted&&n.afterLeave&&n.afterLeave()};if(1&e.shapeFlag&&n&&!n.persisted){const{leave:t,delayLeave:a}=n,o=()=>t(s,r);a?a(e.el,r,o):o()}else r()},V=(e,t)=>{let s;while(e!==t)s=m(e),o(e),e=s;o(t)},z=(e,t,s)=>{const{bum:a,scope:o,update:n,subTree:r,um:i}=e;a&&$t(a),o.stop(),n&&(n.active=!1,U(r,e,t,s)),i&&_o(i,t),_o(()=>{e.isUnmounted=!0},t),t&&t.pendingBranch&&!t.isUnmounted&&e.asyncDep&&!e.asyncResolved&&e.suspenseId===t.pendingId&&(t.deps--,0===t.deps&&t.resolve())},X=(e,t,s,a=!1,o=!1,n=0)=>{for(let r=n;r<e.length;r++)U(e[r],t,s,a,o)},Y=e=>6&e.shapeFlag?Y(e.component.subTree):128&e.shapeFlag?e.suspense.next():m(e.anchor||e.el),K=(e,t,s)=>{null==e?t._vnode&&U(t._vnode,null,null,!0):g(t._vnode||null,e,t,null,null,null,s),vs(),t._vnode=e},G={p:g,um:U,m:$,r:q,mt:O,mc:M,pc:P,pbc:R,n:Y,o:e};let Z,W;return t&&([Z,W]=t(G)),{render:K,hydrate:Z,createApp:fo(K,Z)}}function yo({effect:e,update:t},s){e.allowRecurse=t.allowRecurse=s}function xo(e,t,s=!1){const a=e.children,o=t.children;if(wt(a)&&wt(o))for(let n=0;n<a.length;n++){const e=a[n];let t=o[n];1&t.shapeFlag&&!t.dynamicChildren&&((t.patchFlag<=0||32===t.patchFlag)&&(t=o[n]=Zo(o[n]),t.el=e.el),s||xo(e,t))}}function wo(e){const t=e.slice(),s=[0];let a,o,n,r,i;const l=e.length;for(a=0;a<l;a++){const l=e[a];if(0!==l){if(o=s[s.length-1],e[o]<l){t[a]=o,s.push(a);continue}n=0,r=s.length-1;while(n<r)i=n+r>>1,e[s[i]]<l?n=i+1:r=i;l<e[s[n]]&&(n>0&&(t[a]=s[n-1]),s[n]=a)}}n=s.length,r=s[n-1];while(n-- >0)s[n]=r,r=t[r];return s}const ko=e=>e.__isTeleport,So=Symbol(void 0),Mo=Symbol(void 0),Ao=Symbol(void 0),Ro=Symbol(void 0),To=[];let Eo=null;function Bo(e=!1){To.push(Eo=e?null:[])}function Oo(){To.pop(),Eo=To[To.length-1]||null}let Co=1;function jo(e){Co+=e}function Io(e){return e.dynamicChildren=Co>0?Eo||mt:null,Oo(),Co>0&&Eo&&Eo.push(e),e}function Lo(e,t,s,a,o,n){return Io(Uo(e,t,s,a,o,n,!0))}function Po(e,t,s,a,o){return Io(qo(e,t,s,a,o,!0))}function No(e){return!!e&&!0===e.__v_isVNode}function Ho(e,t){return e.type===t.type&&e.key===t.key}const Fo="__vInternal",Do=({key:e})=>null!=e?e:null,$o=({ref:e,ref_key:t,ref_for:s})=>null!=e?At(e)||Ze(e)||Mt(e)?{i:Ss,r:e,k:t,f:!!s}:e:null;function Uo(e,t=null,s=null,a=0,o=null,n=(e===So?0:1),r=!1,i=!1){const l={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&Do(t),ref:t&&$o(t),scopeId:Ms,slotScopeIds:null,children:s,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:n,patchFlag:a,dynamicProps:o,dynamicChildren:null,appContext:null};return i?(Wo(l,s),128&n&&e.normalize(l)):s&&(l.shapeFlag|=At(s)?8:16),Co>0&&!r&&Eo&&(l.patchFlag>0||6&n)&&32!==l.patchFlag&&Eo.push(l),l}const qo=Vo;function Vo(e,t=null,s=null,a=0,o=null,n=!1){if(e&&e!==Sa||(e=Ao),No(e)){const a=Xo(e,t,!0);return s&&Wo(a,s),Co>0&&!n&&Eo&&(6&a.shapeFlag?Eo[Eo.indexOf(e)]=a:Eo.push(a)),a.patchFlag|=-2,a}if(bn(e)&&(e=e.__vccOpts),t){t=zo(t);let{class:e,style:s}=t;e&&!At(e)&&(t.class=it(e)),Rt(s)&&(qe(s)&&!wt(s)&&(s=vt({},s)),t.style=at(s))}const r=At(e)?1:Is(e)?128:ko(e)?64:Rt(e)?4:Mt(e)?2:0;return Uo(e,t,s,a,o,r,n,!0)}function zo(e){return e?qe(e)||Fo in e?vt({},e):e:null}function Xo(e,t,s=!1){const{props:a,ref:o,patchFlag:n,children:r}=e,i=t?Qo(a||{},t):a,l={__v_isVNode:!0,__v_skip:!0,type:e.type,props:i,key:i&&Do(i),ref:t&&t.ref?s&&o?wt(o)?o.concat($o(t)):[o,$o(t)]:$o(t):o,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:r,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==So?-1===n?16:16|n:n,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Xo(e.ssContent),ssFallback:e.ssFallback&&Xo(e.ssFallback),el:e.el,anchor:e.anchor};return l}function Yo(e=" ",t=0){return qo(Mo,null,e,t)}function Ko(e="",t=!1){return t?(Bo(),Po(Ao,null,e)):qo(Ao,null,e)}function Go(e){return null==e||"boolean"===typeof e?qo(Ao):wt(e)?qo(So,null,e.slice()):"object"===typeof e?Zo(e):qo(Mo,null,String(e))}function Zo(e){return null===e.el||e.memo?e:Xo(e)}function Wo(e,t){let s=0;const{shapeFlag:a}=e;if(null==t)t=null;else if(wt(t))s=16;else if("object"===typeof t){if(65&a){const s=t.default;return void(s&&(s._c&&(s._d=!1),Wo(e,s()),s._c&&(s._d=!0)))}{s=32;const a=t._;a||Fo in t?3===a&&Ss&&(1===Ss.slots._?t._=1:(t._=2,e.patchFlag|=1024)):t._ctx=Ss}}else Mt(t)?(t={default:t,_ctx:Ss},s=32):(t=String(t),64&a?(s=16,t=[Yo(t)]):s=8);e.children=t,e.shapeFlag|=s}function Qo(...e){const t={};for(let s=0;s<e.length;s++){const a=e[s];for(const e in a)if("class"===e)t.class!==a.class&&(t.class=it([t.class,a.class]));else if("style"===e)t.style=at([t.style,a.style]);else if(gt(e)){const s=t[e],o=a[e];!o||s===o||wt(s)&&s.includes(o)||(t[e]=s?[].concat(s,o):o)}else""!==e&&(t[e]=a[e])}return t}function Jo(e,t,s,a=null){Yt(e,t,7,[s,a])}const en=po();let tn=0;function sn(e,t,s){const a=e.type,o=(t?t.appContext:e.appContext)||en,n={uid:tn++,vnode:e,type:a,parent:t,appContext:o,root:null,next:null,subTree:null,effect:null,update:null,scope:new x(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(o.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:eo(a,o),emitsOptions:ws(a,o),emit:null,emitted:null,propsDefaults:ut,inheritAttrs:a.inheritAttrs,ctx:ut,data:ut,props:ut,attrs:ut,slots:ut,refs:ut,setupState:ut,setupContext:null,suspense:s,suspenseId:s?s.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return n.ctx={_:n},n.root=t?t.root:n,n.emit=xs.bind(null,n),e.ce&&e.ce(n),n}let an=null;const on=()=>an||Ss,nn=e=>{an=e,e.scope.on()},rn=()=>{an&&an.scope.off(),an=null};function ln(e){return 4&e.vnode.shapeFlag}let cn,dn=!1;function un(e,t=!1){dn=t;const{props:s,children:a}=e.vnode,o=ln(e);Za(e,s,o,t),uo(e,a);const n=o?mn(e,t):void 0;return dn=!1,n}function mn(e,t){const s=e.type;e.accessCache=Object.create(null),e.proxy=ze(new Proxy(e.ctx,La));const{setup:a}=s;if(a){const s=e.setupContext=a.length>1?gn(e):null;nn(e),F();const o=Xt(a,e,0,[e.props,s]);if(D(),rn(),Tt(o)){if(o.then(rn,rn),t)return o.then(s=>{pn(e,s,t)}).catch(t=>{Kt(t,e,0)});e.asyncDep=o}else pn(e,o,t)}else hn(e,t)}function pn(e,t,s){Mt(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:Rt(t)&&(e.setupState=Je(t)),hn(e,s)}function hn(e,t,s){const a=e.type;if(!e.render){if(!t&&cn&&!a.render){const t=a.template;if(t){const{isCustomElement:s,compilerOptions:o}=e.appContext.config,{delimiters:n,compilerOptions:r}=a,i=vt(vt({isCustomElement:s,delimiters:n},o),r);a.render=cn(t,i)}}e.render=a.render||pt}nn(e),F(),Na(e),D(),rn()}function fn(e){return new Proxy(e.attrs,{get(t,s){return $(e,"get","$attrs"),t[s]}})}function gn(e){const t=t=>{e.exposed=t||{}};let s;return{get attrs(){return s||(s=fn(e))},slots:e.slots,emit:e.emit,expose:t}}function _n(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(Je(ze(e.exposed)),{get(t,s){return s in t?t[s]:s in Ia?Ia[s](e):void 0}}))}function vn(e,t=!0){return Mt(e)?e.displayName||e.name:e.name||t&&e.__name}function bn(e){return Mt(e)&&"__vccOpts"in e}const yn=(e,t)=>tt(e,t,dn);function xn(e,t,s){const a=arguments.length;return 2===a?Rt(t)&&!wt(t)?No(t)?qo(e,null,[t]):qo(e,t):qo(e,null,t):(a>3?s=Array.prototype.slice.call(arguments,2):3===a&&No(s)&&(s=[s]),qo(e,t,s))}const wn="3.2.37";function kn(e,t){const s=Object.create(null),a=e.split(",");for(let o=0;o<a.length;o++)s[a[o]]=!0;return t?e=>!!s[e.toLowerCase()]:e=>!!s[e]}const Sn="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Mn=kn(Sn);function An(e){return!!e||""===e}const Rn=/^on[^a-z]/,Tn=e=>Rn.test(e),En=e=>e.startsWith("onUpdate:"),Bn=Object.assign,On=Array.isArray,Cn=e=>"function"===typeof e,jn=e=>"string"===typeof e,In=e=>null!==e&&"object"===typeof e,Ln=e=>{const t=Object.create(null);return s=>{const a=t[s];return a||(t[s]=e(s))}},Pn=/-(\w)/g,Nn=Ln(e=>e.replace(Pn,(e,t)=>t?t.toUpperCase():"")),Hn=/\B([A-Z])/g,Fn=Ln(e=>e.replace(Hn,"-$1").toLowerCase()),Dn=Ln(e=>e.charAt(0).toUpperCase()+e.slice(1)),$n=e=>{const t=parseFloat(e);return isNaN(t)?e:t},Un="http://www.w3.org/2000/svg",qn="undefined"!==typeof document?document:null,Vn=qn&&qn.createElement("template"),zn={insert:(e,t,s)=>{t.insertBefore(e,s||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,s,a)=>{const o=t?qn.createElementNS(Un,e):qn.createElement(e,s?{is:s}:void 0);return"select"===e&&a&&null!=a.multiple&&o.setAttribute("multiple",a.multiple),o},createText:e=>qn.createTextNode(e),createComment:e=>qn.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>qn.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},cloneNode(e){const t=e.cloneNode(!0);return"_value"in e&&(t._value=e._value),t},insertStaticContent(e,t,s,a,o,n){const r=s?s.previousSibling:t.lastChild;if(o&&(o===n||o.nextSibling)){while(1)if(t.insertBefore(o.cloneNode(!0),s),o===n||!(o=o.nextSibling))break}else{Vn.innerHTML=a?`<svg>${e}</svg>`:e;const o=Vn.content;if(a){const e=o.firstChild;while(e.firstChild)o.appendChild(e.firstChild);o.removeChild(e)}t.insertBefore(o,s)}return[r?r.nextSibling:t.firstChild,s?s.previousSibling:t.lastChild]}};function Xn(e,t,s){const a=e._vtc;a&&(t=(t?[t,...a]:[...a]).join(" ")),null==t?e.removeAttribute("class"):s?e.setAttribute("class",t):e.className=t}function Yn(e,t,s){const a=e.style,o=jn(s);if(s&&!o){for(const e in s)Gn(a,e,s[e]);if(t&&!jn(t))for(const e in t)null==s[e]&&Gn(a,e,"")}else{const n=a.display;o?t!==s&&(a.cssText=s):t&&e.removeAttribute("style"),"_vod"in e&&(a.display=n)}}const Kn=/\s*!important$/;function Gn(e,t,s){if(On(s))s.forEach(s=>Gn(e,t,s));else if(null==s&&(s=""),t.startsWith("--"))e.setProperty(t,s);else{const a=Qn(e,t);Kn.test(s)?e.setProperty(Fn(a),s.replace(Kn,""),"important"):e[a]=s}}const Zn=["Webkit","Moz","ms"],Wn={};function Qn(e,t){const s=Wn[t];if(s)return s;let a=Lt(t);if("filter"!==a&&a in e)return Wn[t]=a;a=Dn(a);for(let o=0;o<Zn.length;o++){const s=Zn[o]+a;if(s in e)return Wn[t]=s}return t}const Jn="http://www.w3.org/1999/xlink";function er(e,t,s,a,o){if(a&&t.startsWith("xlink:"))null==s?e.removeAttributeNS(Jn,t.slice(6,t.length)):e.setAttributeNS(Jn,t,s);else{const a=Mn(t);null==s||a&&!An(s)?e.removeAttribute(t):e.setAttribute(t,a?"":s)}}function tr(e,t,s,a,o,n,r){if("innerHTML"===t||"textContent"===t)return a&&r(a,o,n),void(e[t]=null==s?"":s);if("value"===t&&"PROGRESS"!==e.tagName&&!e.tagName.includes("-")){e._value=s;const a=null==s?"":s;return e.value===a&&"OPTION"!==e.tagName||(e.value=a),void(null==s&&e.removeAttribute(t))}let i=!1;if(""===s||null==s){const a=typeof e[t];"boolean"===a?s=An(s):null==s&&"string"===a?(s="",i=!0):"number"===a&&(s=0,i=!0)}try{e[t]=s}catch(l){}i&&e.removeAttribute(t)}const[sr,ar]=(()=>{let e=Date.now,t=!1;if("undefined"!==typeof window){Date.now()>document.createEvent("Event").timeStamp&&(e=performance.now.bind(performance));const s=navigator.userAgent.match(/firefox\/(\d+)/i);t=!!(s&&Number(s[1])<=53)}return[e,t]})();let or=0;const nr=Promise.resolve(),rr=()=>{or=0},ir=()=>or||(nr.then(rr),or=sr());function lr(e,t,s,a){e.addEventListener(t,s,a)}function cr(e,t,s,a){e.removeEventListener(t,s,a)}function dr(e,t,s,a,o=null){const n=e._vei||(e._vei={}),r=n[t];if(a&&r)r.value=a;else{const[s,i]=mr(t);if(a){const r=n[t]=pr(a,o);lr(e,s,r,i)}else r&&(cr(e,s,r,i),n[t]=void 0)}}const ur=/(?:Once|Passive|Capture)$/;function mr(e){let t;if(ur.test(e)){let s;t={};while(s=e.match(ur))e=e.slice(0,e.length-s[0].length),t[s[0].toLowerCase()]=!0}return[Fn(e.slice(2)),t]}function pr(e,t){const s=e=>{const a=e.timeStamp||sr();(ar||a>=s.attached-1)&&Yt(hr(e,s.value),t,5,[e])};return s.value=e,s.attached=ir(),s}function hr(e,t){if(On(t)){const s=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{s.call(e),e._stopped=!0},t.map(e=>t=>!t._stopped&&e&&e(t))}return t}const fr=/^on[a-z]/,gr=(e,t,s,a,o=!1,n,r,i,l)=>{"class"===t?Xn(e,a,o):"style"===t?Yn(e,s,a):Tn(t)?En(t)||dr(e,t,s,a,r):("."===t[0]?(t=t.slice(1),1):"^"===t[0]?(t=t.slice(1),0):_r(e,t,a,o))?tr(e,t,a,n,r,i,l):("true-value"===t?e._trueValue=a:"false-value"===t&&(e._falseValue=a),er(e,t,a,o))};function _r(e,t,s,a){return a?"innerHTML"===t||"textContent"===t||!!(t in e&&fr.test(t)&&Cn(s)):"spellcheck"!==t&&"draggable"!==t&&"translate"!==t&&("form"!==t&&(("list"!==t||"INPUT"!==e.tagName)&&(("type"!==t||"TEXTAREA"!==e.tagName)&&((!fr.test(t)||!jn(s))&&t in e))))}function vr(e,t){const s=ea(e);class a extends yr{constructor(e){super(s,e,t)}}return a.def=s,a}const br="undefined"!==typeof HTMLElement?HTMLElement:class{};class yr extends br{constructor(e,t={},s){super(),this._def=e,this._props=t,this._instance=null,this._connected=!1,this._resolved=!1,this._numberProps=null,this.shadowRoot&&s?s(this._createVNode(),this.shadowRoot):this.attachShadow({mode:"open"})}connectedCallback(){this._connected=!0,this._instance||this._resolveDef()}disconnectedCallback(){this._connected=!1,cs(()=>{this._connected||(oi(null,this.shadowRoot),this._instance=null)})}_resolveDef(){if(this._resolved)return;this._resolved=!0;for(let s=0;s<this.attributes.length;s++)this._setAttr(this.attributes[s].name);new MutationObserver(e=>{for(const t of e)this._setAttr(t.attributeName)}).observe(this,{attributes:!0});const e=e=>{const{props:t,styles:s}=e,a=!On(t),o=t?a?Object.keys(t):t:[];let n;if(a)for(const r in this._props){const e=t[r];(e===Number||e&&e.type===Number)&&(this._props[r]=$n(this._props[r]),(n||(n=Object.create(null)))[r]=!0)}this._numberProps=n;for(const r of Object.keys(this))"_"!==r[0]&&this._setProp(r,this[r],!0,!1);for(const r of o.map(Nn))Object.defineProperty(this,r,{get(){return this._getProp(r)},set(e){this._setProp(r,e)}});this._applyStyles(s),this._update()},t=this._def.__asyncLoader;t?t().then(e):e(this._def)}_setAttr(e){let t=this.getAttribute(e);this._numberProps&&this._numberProps[e]&&(t=$n(t)),this._setProp(Nn(e),t,!1)}_getProp(e){return this._props[e]}_setProp(e,t,s=!0,a=!0){t!==this._props[e]&&(this._props[e]=t,a&&this._instance&&this._update(),s&&(!0===t?this.setAttribute(Fn(e),""):"string"===typeof t||"number"===typeof t?this.setAttribute(Fn(e),t+""):t||this.removeAttribute(Fn(e))))}_update(){oi(this._createVNode(),this.shadowRoot)}_createVNode(){const e=qo(this._def,Bn({},this._props));return this._instance||(e.ce=e=>{this._instance=e,e.isCE=!0,e.emit=(e,...t)=>{this.dispatchEvent(new CustomEvent(e,{detail:t}))};let t=this;while(t=t&&(t.parentNode||t.host))if(t instanceof yr){e.parent=t._instance;break}}),e}_applyStyles(e){e&&e.forEach(e=>{const t=document.createElement("style");t.textContent=e,this.shadowRoot.appendChild(t)})}}const xr="transition",wr="animation",kr=(e,{slots:t})=>xn(Ys,Tr(e),t);kr.displayName="Transition";const Sr={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},Mr=kr.props=Bn({},Ys.props,Sr),Ar=(e,t=[])=>{On(e)?e.forEach(e=>e(...t)):e&&e(...t)},Rr=e=>!!e&&(On(e)?e.some(e=>e.length>1):e.length>1);function Tr(e){const t={};for(const T in e)T in Sr||(t[T]=e[T]);if(!1===e.css)return t;const{name:s="v",type:a,duration:o,enterFromClass:n=s+"-enter-from",enterActiveClass:r=s+"-enter-active",enterToClass:i=s+"-enter-to",appearFromClass:l=n,appearActiveClass:c=r,appearToClass:d=i,leaveFromClass:u=s+"-leave-from",leaveActiveClass:m=s+"-leave-active",leaveToClass:p=s+"-leave-to"}=e,h=Er(o),f=h&&h[0],g=h&&h[1],{onBeforeEnter:_,onEnter:v,onEnterCancelled:b,onLeave:y,onLeaveCancelled:x,onBeforeAppear:w=_,onAppear:k=v,onAppearCancelled:S=b}=t,M=(e,t,s)=>{Cr(e,t?d:i),Cr(e,t?c:r),s&&s()},A=(e,t)=>{e._isLeaving=!1,Cr(e,u),Cr(e,p),Cr(e,m),t&&t()},R=e=>(t,s)=>{const o=e?k:v,r=()=>M(t,e,s);Ar(o,[t,r]),jr(()=>{Cr(t,e?l:n),Or(t,e?d:i),Rr(o)||Lr(t,a,f,r)})};return Bn(t,{onBeforeEnter(e){Ar(_,[e]),Or(e,n),Or(e,r)},onBeforeAppear(e){Ar(w,[e]),Or(e,l),Or(e,c)},onEnter:R(!1),onAppear:R(!0),onLeave(e,t){e._isLeaving=!0;const s=()=>A(e,t);Or(e,u),Fr(),Or(e,m),jr(()=>{e._isLeaving&&(Cr(e,u),Or(e,p),Rr(y)||Lr(e,a,g,s))}),Ar(y,[e,s])},onEnterCancelled(e){M(e,!1),Ar(b,[e])},onAppearCancelled(e){M(e,!0),Ar(S,[e])},onLeaveCancelled(e){A(e),Ar(x,[e])}})}function Er(e){if(null==e)return null;if(In(e))return[Br(e.enter),Br(e.leave)];{const t=Br(e);return[t,t]}}function Br(e){const t=$n(e);return t}function Or(e,t){t.split(/\s+/).forEach(t=>t&&e.classList.add(t)),(e._vtc||(e._vtc=new Set)).add(t)}function Cr(e,t){t.split(/\s+/).forEach(t=>t&&e.classList.remove(t));const{_vtc:s}=e;s&&(s.delete(t),s.size||(e._vtc=void 0))}function jr(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let Ir=0;function Lr(e,t,s,a){const o=e._endId=++Ir,n=()=>{o===e._endId&&a()};if(s)return setTimeout(n,s);const{type:r,timeout:i,propCount:l}=Pr(e,t);if(!r)return a();const c=r+"end";let d=0;const u=()=>{e.removeEventListener(c,m),n()},m=t=>{t.target===e&&++d>=l&&u()};setTimeout(()=>{d<l&&u()},i+1),e.addEventListener(c,m)}function Pr(e,t){const s=window.getComputedStyle(e),a=e=>(s[e]||"").split(", "),o=a(xr+"Delay"),n=a(xr+"Duration"),r=Nr(o,n),i=a(wr+"Delay"),l=a(wr+"Duration"),c=Nr(i,l);let d=null,u=0,m=0;t===xr?r>0&&(d=xr,u=r,m=n.length):t===wr?c>0&&(d=wr,u=c,m=l.length):(u=Math.max(r,c),d=u>0?r>c?xr:wr:null,m=d?d===xr?n.length:l.length:0);const p=d===xr&&/\b(transform|all)(,|$)/.test(s[xr+"Property"]);return{type:d,timeout:u,propCount:m,hasTransform:p}}function Nr(e,t){while(e.length<t.length)e=e.concat(e);return Math.max(...t.map((t,s)=>Hr(t)+Hr(e[s])))}function Hr(e){return 1e3*Number(e.slice(0,-1).replace(",","."))}function Fr(){return document.body.offsetHeight}const Dr=new WeakMap,$r=new WeakMap,Ur={name:"TransitionGroup",props:Bn({},Mr,{tag:String,moveClass:String}),setup(e,{slots:t}){const s=on(),a=Vs();let o,n;return ma(()=>{if(!o.length)return;const t=e.moveClass||(e.name||"v")+"-move";if(!Yr(o[0].el,s.vnode.el,t))return;o.forEach(Vr),o.forEach(zr);const a=o.filter(Xr);Fr(),a.forEach(e=>{const s=e.el,a=s.style;Or(s,t),a.transform=a.webkitTransform=a.transitionDuration="";const o=s._moveCb=e=>{e&&e.target!==s||e&&!/transform$/.test(e.propertyName)||(s.removeEventListener("transitionend",o),s._moveCb=null,Cr(s,t))};s.addEventListener("transitionend",o)})}),()=>{const r=Ve(e),i=Tr(r);let l=r.tag||So;o=n,n=t.default?Js(t.default()):[];for(let e=0;e<n.length;e++){const t=n[e];null!=t.key&&Qs(t,Gs(t,i,a,s))}if(o)for(let e=0;e<o.length;e++){const t=o[e];Qs(t,Gs(t,i,a,s)),Dr.set(t,t.el.getBoundingClientRect())}return qo(l,null,n)}}},qr=Ur;function Vr(e){const t=e.el;t._moveCb&&t._moveCb(),t._enterCb&&t._enterCb()}function zr(e){$r.set(e,e.el.getBoundingClientRect())}function Xr(e){const t=Dr.get(e),s=$r.get(e),a=t.left-s.left,o=t.top-s.top;if(a||o){const t=e.el.style;return t.transform=t.webkitTransform=`translate(${a}px,${o}px)`,t.transitionDuration="0s",e}}function Yr(e,t,s){const a=e.cloneNode();e._vtc&&e._vtc.forEach(e=>{e.split(/\s+/).forEach(e=>e&&a.classList.remove(e))}),s.split(/\s+/).forEach(e=>e&&a.classList.add(e)),a.style.display="none";const o=1===t.nodeType?t:t.parentNode;o.appendChild(a);const{hasTransform:n}=Pr(a);return o.removeChild(a),n}const Kr=["ctrl","shift","alt","meta"],Gr={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&0!==e.button,middle:e=>"button"in e&&1!==e.button,right:e=>"button"in e&&2!==e.button,exact:(e,t)=>Kr.some(s=>e[s+"Key"]&&!t.includes(s))},Zr=(e,t)=>(s,...a)=>{for(let e=0;e<t.length;e++){const a=Gr[t[e]];if(a&&a(s,t))return}return e(s,...a)},Wr={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},Qr=(e,t)=>s=>{if(!("key"in s))return;const a=Fn(s.key);return t.some(e=>e===a||Wr[e]===a)?e(s):void 0},Jr={beforeMount(e,{value:t},{transition:s}){e._vod="none"===e.style.display?"":e.style.display,s&&t?s.beforeEnter(e):ei(e,t)},mounted(e,{value:t},{transition:s}){s&&t&&s.enter(e)},updated(e,{value:t,oldValue:s},{transition:a}){!t!==!s&&(a?t?(a.beforeEnter(e),ei(e,!0),a.enter(e)):a.leave(e,()=>{ei(e,!1)}):ei(e,t))},beforeUnmount(e,{value:t}){ei(e,t)}};function ei(e,t){e.style.display=t?e._vod:"none"}const ti=Bn({patchProp:gr},zn);let si;function ai(){return si||(si=vo(ti))}const oi=(...e)=>{ai().render(...e)};var ni=(e,t)=>{const s=e.__vccOpts||e;for(const[a,o]of t)s[a]=o;return s};const ri={name:"AppLoader",props:{show:{type:Boolean,default:!1},infinite:{type:Boolean,default:!1},type:{type:String,required:!0},messageId:{type:String,default:""}}},ii=Uo("div",{id:"vac-circle"},null,-1),li=Uo("div",{id:"vac-circle"},null,-1),ci=Uo("div",{id:"vac-circle"},null,-1),di=Uo("div",{id:"vac-circle"},null,-1),ui=Uo("div",{id:"vac-circle"},null,-1),mi=Uo("div",{id:"vac-circle"},null,-1);function pi(e,t,s,a,o,n){return Bo(),Po(kr,{name:"vac-fade-spinner",appear:""},{default:Rs(()=>[s.show?(Bo(),Lo("div",{key:0,class:it(["vac-loader-wrapper",{"vac-container-center":!s.infinite,"vac-container-top":s.infinite}])},["rooms"===s.type?Oa(e.$slots,"spinner-icon-rooms",{key:0},()=>[ii]):Ko("",!0),"infinite-rooms"===s.type?Oa(e.$slots,"spinner-icon-infinite-rooms",{key:1},()=>[li]):Ko("",!0),"message-file"===s.type?Oa(e.$slots,"spinner-icon-message-file_"+s.messageId,{key:2},()=>[ci]):Ko("",!0),"room-file"===s.type?Oa(e.$slots,"spinner-icon-room-file",{key:3},()=>[di]):Ko("",!0),"messages"===s.type?Oa(e.$slots,"spinner-icon-messages",{key:4},()=>[ui]):Ko("",!0),"infinite-messages"===s.type?Oa(e.$slots,"spinner-icon-infinite-messages",{key:5},()=>[mi]):Ko("",!0)],2)):Ko("",!0)]),_:3})}var hi=ni(ri,[["render",pi]]);const fi={name:"SvgIcon",props:{name:{type:String,default:null},param:{type:String,default:null}},data(){return{svgItem:{search:{path:"M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"},add:{path:"M17,13H13V17H11V13H7V11H11V7H13V11H17M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"},toggle:{path:"M5,13L9,17L7.6,18.42L1.18,12L7.6,5.58L9,7L5,11H21V13H5M21,6V8H11V6H21M21,16V18H11V16H21Z"},menu:{path:"M12,16A2,2 0 0,1 14,18A2,2 0 0,1 12,20A2,2 0 0,1 10,18A2,2 0 0,1 12,16M12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12A2,2 0 0,1 12,10M12,4A2,2 0 0,1 14,6A2,2 0 0,1 12,8A2,2 0 0,1 10,6A2,2 0 0,1 12,4Z"},close:{path:"M12,2C17.53,2 22,6.47 22,12C22,17.53 17.53,22 12,22C6.47,22 2,17.53 2,12C2,6.47 6.47,2 12,2M15.59,7L12,10.59L8.41,7L7,8.41L10.59,12L7,15.59L8.41,17L12,13.41L15.59,17L17,15.59L13.41,12L17,8.41L15.59,7Z"},file:{path:"M14,17H7V15H14M17,13H7V11H17M17,9H7V7H17M19,3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3Z"},paperclip:{path:"M16.5,6V17.5A4,4 0 0,1 12.5,21.5A4,4 0 0,1 8.5,17.5V5A2.5,2.5 0 0,1 11,2.5A2.5,2.5 0 0,1 13.5,5V15.5A1,1 0 0,1 12.5,16.5A1,1 0 0,1 11.5,15.5V6H10V15.5A2.5,2.5 0 0,0 12.5,18A2.5,2.5 0 0,0 15,15.5V5A4,4 0 0,0 11,1A4,4 0 0,0 7,5V17.5A5.5,5.5 0 0,0 12.5,23A5.5,5.5 0 0,0 18,17.5V6H16.5Z"},"close-outline":{path:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"},send:{path:"M2,21L23,12L2,3V10L17,12L2,14V21Z"},emoji:{path:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm3.5-9c.83 0 1.5-.67 1.5-1.5S16.33 8 15.5 8 14 8.67 14 9.5s.67 1.5 1.5 1.5zm-7 0c.83 0 1.5-.67 1.5-1.5S9.33 8 8.5 8 7 8.67 7 9.5 7.67 11 8.5 11zm3.5 6.5c2.33 0 4.31-1.46 5.11-3.5H6.89c.8 2.04 2.78 3.5 5.11 3.5z"},document:{path:"M5,20H19V18H5M19,9H15V3H9V9H5L12,16L19,9Z"},pencil:{path:"M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z"},checkmark:{path:"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"},"double-checkmark":{path:"M18 7l-1.41-1.41-6.34 6.34 1.41 1.41L18 7zm4.24-1.41L11.66 16.17 7.48 12l-1.41 1.41L11.66 19l12-12-1.42-1.41zM.41 13.41L6 19l1.41-1.41L1.83 12 .41 13.41z"},eye:{path:"M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17M12,4.5C7,4.5 2.73,7.61 1,12C2.73,16.39 7,19.5 12,19.5C17,19.5 21.27,16.39 23,12C21.27,7.61 17,4.5 12,4.5Z"},dropdown:{path:"M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z"},deleted:{path:"M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2M12,4A8,8 0 0,0 4,12C4,13.85 4.63,15.55 5.68,16.91L16.91,5.68C15.55,4.63 13.85,4 12,4M12,20A8,8 0 0,0 20,12C20,10.15 19.37,8.45 18.32,7.09L7.09,18.32C8.45,19.37 10.15,20 12,20Z"},microphone:{size:"large",path:"M432.8,216.4v39.2c0,45.2-15.3,84.3-45.2,118.4c-29.8,33.2-67.3,52.8-111.6,57.9v40.9h78.4c5.1,0,10.2,1.7,13.6,6c4.3,4.3,6,8.5,6,13.6c0,5.1-1.7,10.2-6,13.6c-4.3,4.3-8.5,6-13.6,6H157.6c-5.1,0-10.2-1.7-13.6-6c-4.3-4.3-6-8.5-6-13.6c0-5.1,1.7-10.2,6-13.6c4.3-4.3,8.5-6,13.6-6H236v-40.9c-44.3-5.1-81.8-23.9-111.6-57.9s-45.2-73.3-45.2-118.4v-39.2c0-5.1,1.7-10.2,6-13.6c4.3-4.3,8.5-6,13.6-6s10.2,1.7,13.6,6c4.3,4.3,6,8.5,6,13.6v39.2c0,37.5,13.6,70.7,40,97.1s59.6,40,97.1,40s70.7-13.6,97.1-40c26.4-26.4,40-59.6,40-97.1v-39.2c0-5.1,1.7-10.2,6-13.6c4.3-4.3,8.5-6,13.6-6c5.1,0,10.2,1.7,13.6,6C430.2,206.2,432.8,211.3,432.8,216.4z M353.5,98v157.6c0,27.3-9.4,50.3-29,69c-19.6,19.6-42.6,29-69,29s-50.3-9.4-69-29c-19.6-19.6-29-42.6-29-69V98c0-27.3,9.4-50.3,29-69c19.6-19.6,42.6-29,69-29s50.3,9.4,69,29C344.2,47.7,353.5,71.6,353.5,98z"},"audio-play":{size:"medium",path:"M43.331,21.237L7.233,0.397c-0.917-0.529-2.044-0.529-2.96,0c-0.916,0.528-1.48,1.505-1.48,2.563v41.684   c0,1.058,0.564,2.035,1.48,2.563c0.458,0.268,0.969,0.397,1.48,0.397c0.511,0,1.022-0.133,1.48-0.397l36.098-20.84   c0.918-0.529,1.479-1.506,1.479-2.564S44.247,21.767,43.331,21.237z"},"audio-pause":{size:"medium",path:"M17.991,40.976c0,3.662-2.969,6.631-6.631,6.631l0,0c-3.662,0-6.631-2.969-6.631-6.631V6.631C4.729,2.969,7.698,0,11.36,0l0,0c3.662,0,6.631,2.969,6.631,6.631V40.976z",path2:"M42.877,40.976c0,3.662-2.969,6.631-6.631,6.631l0,0c-3.662,0-6.631-2.969-6.631-6.631V6.631C29.616,2.969,32.585,0,36.246,0l0,0c3.662,0,6.631,2.969,6.631,6.631V40.976z"}}}},computed:{svgId(){const e=this.param?"-"+this.param:"";return`vac-icon-${this.name}${e}`},size(){const e=this.svgItem[this.name];return"large"===e.size?512:"medium"===e.size?48:24}}},gi=["viewBox"],_i=["id","d"],vi=["id","d"];function bi(e,t,s,a,o,n){return Bo(),Lo("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1",width:"24",height:"24",viewBox:`0 0 ${n.size} ${n.size}`},[Uo("path",{id:n.svgId,d:o.svgItem[s.name].path},null,8,_i),o.svgItem[s.name].path2?(Bo(),Lo("path",{key:0,id:n.svgId,d:o.svgItem[s.name].path2},null,8,vi)):Ko("",!0)],8,gi)}var yi=ni(fi,[["render",bi]]);const xi={name:"RoomsSearch",components:{SvgIcon:yi},props:{textMessages:{type:Object,required:!0},showSearch:{type:Boolean,required:!0},showAddRoom:{type:Boolean,required:!0},rooms:{type:Array,required:!0},loadingRooms:{type:Boolean,required:!0}},emits:["search-room","add-room"],computed:{showSearchBar(){return this.showSearch||this.showAddRoom}}},wi={key:0,class:"vac-icon-search"},ki=["placeholder"];function Si(e,t,s,a,o,n){const r=ka("svg-icon");return Bo(),Lo("div",{class:it({"vac-box-search":n.showSearchBar,"vac-box-empty":!n.showSearchBar})},[s.showSearch?(Bo(),Lo(So,{key:0},[!s.loadingRooms&&s.rooms.length?(Bo(),Lo("div",wi,[Oa(e.$slots,"search-icon",{},()=>[qo(r,{name:"search"})])])):Ko("",!0),!s.loadingRooms&&s.rooms.length?(Bo(),Lo("input",{key:1,type:"search",placeholder:s.textMessages.SEARCH,autocomplete:"off",class:"vac-input",onInput:t[0]||(t[0]=t=>e.$emit("search-room",t))},null,40,ki)):Ko("",!0)],64)):Ko("",!0),s.showAddRoom?(Bo(),Lo("div",{key:1,class:"vac-svg-button vac-add-icon",onClick:t[1]||(t[1]=t=>e.$emit("add-room"))},[Oa(e.$slots,"add-icon",{},()=>[qo(r,{name:"add"})])])):Ko("",!0)],2)}var Mi=ni(xi,[["render",Si]]),Ai={},Ri={};function Ti(e,t){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=Object.create(e.prototype);for(var o in s)a[o]=s[o];return a.constructor=t,t.prototype=a,t}Ri.__esModule=!0,Ri.inherits=Ti;var Ei={__esModule:!0},Bi="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Oi={defaultProtocol:"http",events:null,format:Ii,formatHref:Ii,nl2br:!1,tagName:"a",target:Li,validate:!0,ignoreTags:[],attributes:null,className:"linkified"};function Ci(e){e=e||{},this.defaultProtocol=e.hasOwnProperty("defaultProtocol")?e.defaultProtocol:Oi.defaultProtocol,this.events=e.hasOwnProperty("events")?e.events:Oi.events,this.format=e.hasOwnProperty("format")?e.format:Oi.format,this.formatHref=e.hasOwnProperty("formatHref")?e.formatHref:Oi.formatHref,this.nl2br=e.hasOwnProperty("nl2br")?e.nl2br:Oi.nl2br,this.tagName=e.hasOwnProperty("tagName")?e.tagName:Oi.tagName,this.target=e.hasOwnProperty("target")?e.target:Oi.target,this.validate=e.hasOwnProperty("validate")?e.validate:Oi.validate,this.ignoreTags=[],this.attributes=e.attributes||e.linkAttributes||Oi.attributes,this.className=e.hasOwnProperty("className")?e.className:e.linkClass||Oi.className;for(var t=e.hasOwnProperty("ignoreTags")?e.ignoreTags:Oi.ignoreTags,s=0;s<t.length;s++)this.ignoreTags.push(t[s].toUpperCase())}function ji(e,t){for(var s=0;s<e.length;s++)if(e[s]===t)return!0;return!1}function Ii(e){return e}function Li(e,t){return"url"===t?"_blank":null}Ei.defaults=Oi,Ei.Options=Ci,Ei.contains=ji,Ci.prototype={resolve:function(e){var t=e.toHref(this.defaultProtocol);return{formatted:this.get("format",e.toString(),e),formattedHref:this.get("formatHref",t,e),tagName:this.get("tagName",t,e),className:this.get("className",t,e),target:this.get("target",t,e),events:this.getObject("events",t,e),attributes:this.getObject("attributes",t,e)}},check:function(e){return this.get("validate",e.toString(),e)},get:function(e,t,s){var a=void 0,o=this[e];if(!o)return o;switch("undefined"===typeof o?"undefined":Bi(o)){case"function":return o(t,s.type);case"object":return a=o.hasOwnProperty(s.type)?o[s.type]:Oi[e],"function"===typeof a?a(t,s.type):a}return o},getObject:function(e,t,s){var a=this[e];return"function"===typeof a?a(t,s.type):a}};var Pi={},Ni={__esModule:!0};Ni.stateify=Ni.TokenState=Ni.CharacterState=void 0;var Hi=Ri;function Fi(){return function(e){this.j=[],this.T=e||null}}var Di=Fi();Di.prototype={defaultTransition:!1,on:function(e,t){if(e instanceof Array){for(var s=0;s<e.length;s++)this.j.push([e[s],t]);return this}return this.j.push([e,t]),this},next:function(e){for(var t=0;t<this.j.length;t++){var s=this.j[t],a=s[0],o=s[1];if(this.test(e,a))return o}return this.defaultTransition},accepts:function(){return!!this.T},test:function(e,t){return e===t},emit:function(){return this.T}};var $i=(0,Hi.inherits)(Di,Fi(),{test:function(e,t){return e===t||t instanceof RegExp&&t.test(e)}}),Ui=(0,Hi.inherits)(Di,Fi(),{jump:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=this.next(new e(""));return s===this.defaultTransition?(s=new this.constructor(t),this.on(e,s)):t&&(s.T=t),s},test:function(e,t){return e instanceof t}});function qi(e,t,s,a){var o=0,n=e.length,r=t,i=[],l=void 0;while(o<n&&(l=r.next(e[o])))r=l,o++;if(o>=n)return[];while(o<n-1)l=new $i(a),i.push(l),r.on(e[o],l),r=l,o++;return l=new $i(s),i.push(l),r.on(e[n-1],l),i}Ni.CharacterState=$i,Ni.TokenState=Ui,Ni.stateify=qi;var Vi={},zi={};function Xi(){return function(e){e&&(this.v=e)}}zi.__esModule=!0,zi.createTokenClass=Xi,Vi.__esModule=!0,Vi.AMPERSAND=Vi.CLOSEPAREN=Vi.CLOSEANGLEBRACKET=Vi.CLOSEBRACKET=Vi.CLOSEBRACE=Vi.OPENPAREN=Vi.OPENANGLEBRACKET=Vi.OPENBRACKET=Vi.OPENBRACE=Vi.WS=Vi.TLD=Vi.SYM=Vi.UNDERSCORE=Vi.SLASH=Vi.MAILTO=Vi.PROTOCOL=Vi.QUERY=Vi.POUND=Vi.PLUS=Vi.NUM=Vi.NL=Vi.LOCALHOST=Vi.PUNCTUATION=Vi.DOT=Vi.COLON=Vi.AT=Vi.DOMAIN=Vi.Base=void 0;var Yi=zi,Ki=Ri,Gi=(0,Yi.createTokenClass)();function Zi(e){var t=e?{v:e}:{};return(0,Ki.inherits)(Gi,(0,Yi.createTokenClass)(),t)}Gi.prototype={toString:function(){return this.v+""}};var Wi=Zi(),Qi=Zi("@"),Ji=Zi(":"),el=Zi("."),tl=Zi(),sl=Zi(),al=Zi("\n"),ol=Zi(),nl=Zi("+"),rl=Zi("#"),il=Zi(),ll=Zi("mailto:"),cl=Zi("?"),dl=Zi("/"),ul=Zi("_"),ml=Zi(),pl=Zi(),hl=Zi(),fl=Zi("{"),gl=Zi("["),_l=Zi("<"),vl=Zi("("),bl=Zi("}"),yl=Zi("]"),xl=Zi(">"),wl=Zi(")"),kl=Zi("&");Vi.Base=Gi,Vi.DOMAIN=Wi,Vi.AT=Qi,Vi.COLON=Ji,Vi.DOT=el,Vi.PUNCTUATION=tl,Vi.LOCALHOST=sl,Vi.NL=al,Vi.NUM=ol,Vi.PLUS=nl,Vi.POUND=rl,Vi.QUERY=cl,Vi.PROTOCOL=il,Vi.MAILTO=ll,Vi.SLASH=dl,Vi.UNDERSCORE=ul,Vi.SYM=ml,Vi.TLD=pl,Vi.WS=hl,Vi.OPENBRACE=fl,Vi.OPENBRACKET=gl,Vi.OPENANGLEBRACKET=_l,Vi.OPENPAREN=vl,Vi.CLOSEBRACE=bl,Vi.CLOSEBRACKET=yl,Vi.CLOSEANGLEBRACKET=xl,Vi.CLOSEPAREN=wl,Vi.AMPERSAND=kl,Pi.__esModule=!0,Pi.start=Pi.run=Pi.TOKENS=Pi.State=void 0;var Sl=Ni,Ml=Vi,Al=Rl(Ml);function Rl(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t.default=e,t}var Tl="aaa|aarp|abarth|abb|abbott|abbvie|abc|able|abogado|abudhabi|ac|academy|accenture|accountant|accountants|aco|active|actor|ad|adac|ads|adult|ae|aeg|aero|aetna|af|afamilycompany|afl|africa|ag|agakhan|agency|ai|aig|aigo|airbus|airforce|airtel|akdn|al|alfaromeo|alibaba|alipay|allfinanz|allstate|ally|alsace|alstom|am|americanexpress|americanfamily|amex|amfam|amica|amsterdam|analytics|android|anquan|anz|ao|aol|apartments|app|apple|aq|aquarelle|ar|arab|aramco|archi|army|arpa|art|arte|as|asda|asia|associates|at|athleta|attorney|au|auction|audi|audible|audio|auspost|author|auto|autos|avianca|aw|aws|ax|axa|az|azure|ba|baby|baidu|banamex|bananarepublic|band|bank|bar|barcelona|barclaycard|barclays|barefoot|bargains|baseball|basketball|bauhaus|bayern|bb|bbc|bbt|bbva|bcg|bcn|bd|be|beats|beauty|beer|bentley|berlin|best|bestbuy|bet|bf|bg|bh|bharti|bi|bible|bid|bike|bing|bingo|bio|biz|bj|black|blackfriday|blanco|blockbuster|blog|bloomberg|blue|bm|bms|bmw|bn|bnl|bnpparibas|bo|boats|boehringer|bofa|bom|bond|boo|book|booking|boots|bosch|bostik|boston|bot|boutique|box|br|bradesco|bridgestone|broadway|broker|brother|brussels|bs|bt|budapest|bugatti|build|builders|business|buy|buzz|bv|bw|by|bz|bzh|ca|cab|cafe|cal|call|calvinklein|cam|camera|camp|cancerresearch|canon|capetown|capital|capitalone|car|caravan|cards|care|career|careers|cars|cartier|casa|case|caseih|cash|casino|cat|catering|catholic|cba|cbn|cbre|cbs|cc|cd|ceb|center|ceo|cern|cf|cfa|cfd|cg|ch|chanel|channel|chase|chat|cheap|chintai|chloe|christmas|chrome|chrysler|church|ci|cipriani|circle|cisco|citadel|citi|citic|city|cityeats|ck|cl|claims|cleaning|click|clinic|clinique|clothing|cloud|club|clubmed|cm|cn|co|coach|codes|coffee|college|cologne|com|comcast|commbank|community|company|compare|computer|comsec|condos|construction|consulting|contact|contractors|cooking|cookingchannel|cool|coop|corsica|country|coupon|coupons|courses|cr|credit|creditcard|creditunion|cricket|crown|crs|cruise|cruises|csc|cu|cuisinella|cv|cw|cx|cy|cymru|cyou|cz|dabur|dad|dance|data|date|dating|datsun|day|dclk|dds|de|deal|dealer|deals|degree|delivery|dell|deloitte|delta|democrat|dental|dentist|desi|design|dev|dhl|diamonds|diet|digital|direct|directory|discount|discover|dish|diy|dj|dk|dm|dnp|do|docs|doctor|dodge|dog|doha|domains|dot|download|drive|dtv|dubai|duck|dunlop|duns|dupont|durban|dvag|dvr|dz|earth|eat|ec|eco|edeka|edu|education|ee|eg|email|emerck|energy|engineer|engineering|enterprises|epost|epson|equipment|er|ericsson|erni|es|esq|estate|esurance|et|etisalat|eu|eurovision|eus|events|everbank|exchange|expert|exposed|express|extraspace|fage|fail|fairwinds|faith|family|fan|fans|farm|farmers|fashion|fast|fedex|feedback|ferrari|ferrero|fi|fiat|fidelity|fido|film|final|finance|financial|fire|firestone|firmdale|fish|fishing|fit|fitness|fj|fk|flickr|flights|flir|florist|flowers|fly|fm|fo|foo|food|foodnetwork|football|ford|forex|forsale|forum|foundation|fox|fr|free|fresenius|frl|frogans|frontdoor|frontier|ftr|fujitsu|fujixerox|fun|fund|furniture|futbol|fyi|ga|gal|gallery|gallo|gallup|game|games|gap|garden|gb|gbiz|gd|gdn|ge|gea|gent|genting|george|gf|gg|ggee|gh|gi|gift|gifts|gives|giving|gl|glade|glass|gle|global|globo|gm|gmail|gmbh|gmo|gmx|gn|godaddy|gold|goldpoint|golf|goo|goodhands|goodyear|goog|google|gop|got|gov|gp|gq|gr|grainger|graphics|gratis|green|gripe|grocery|group|gs|gt|gu|guardian|gucci|guge|guide|guitars|guru|gw|gy|hair|hamburg|hangout|haus|hbo|hdfc|hdfcbank|health|healthcare|help|helsinki|here|hermes|hgtv|hiphop|hisamitsu|hitachi|hiv|hk|hkt|hm|hn|hockey|holdings|holiday|homedepot|homegoods|homes|homesense|honda|honeywell|horse|hospital|host|hosting|hot|hoteles|hotels|hotmail|house|how|hr|hsbc|ht|htc|hu|hughes|hyatt|hyundai|ibm|icbc|ice|icu|id|ie|ieee|ifm|ikano|il|im|imamat|imdb|immo|immobilien|in|industries|infiniti|info|ing|ink|institute|insurance|insure|int|intel|international|intuit|investments|io|ipiranga|iq|ir|irish|is|iselect|ismaili|ist|istanbul|it|itau|itv|iveco|iwc|jaguar|java|jcb|jcp|je|jeep|jetzt|jewelry|jio|jlc|jll|jm|jmp|jnj|jo|jobs|joburg|jot|joy|jp|jpmorgan|jprs|juegos|juniper|kaufen|kddi|ke|kerryhotels|kerrylogistics|kerryproperties|kfh|kg|kh|ki|kia|kim|kinder|kindle|kitchen|kiwi|km|kn|koeln|komatsu|kosher|kp|kpmg|kpn|kr|krd|kred|kuokgroup|kw|ky|kyoto|kz|la|lacaixa|ladbrokes|lamborghini|lamer|lancaster|lancia|lancome|land|landrover|lanxess|lasalle|lat|latino|latrobe|law|lawyer|lb|lc|lds|lease|leclerc|lefrak|legal|lego|lexus|lgbt|li|liaison|lidl|life|lifeinsurance|lifestyle|lighting|like|lilly|limited|limo|lincoln|linde|link|lipsy|live|living|lixil|lk|loan|loans|locker|locus|loft|lol|london|lotte|lotto|love|lpl|lplfinancial|lr|ls|lt|ltd|ltda|lu|lundbeck|lupin|luxe|luxury|lv|ly|ma|macys|madrid|maif|maison|makeup|man|management|mango|map|market|marketing|markets|marriott|marshalls|maserati|mattel|mba|mc|mckinsey|md|me|med|media|meet|melbourne|meme|memorial|men|menu|meo|merckmsd|metlife|mg|mh|miami|microsoft|mil|mini|mint|mit|mitsubishi|mk|ml|mlb|mls|mm|mma|mn|mo|mobi|mobile|mobily|moda|moe|moi|mom|monash|money|monster|mopar|mormon|mortgage|moscow|moto|motorcycles|mov|movie|movistar|mp|mq|mr|ms|msd|mt|mtn|mtr|mu|museum|mutual|mv|mw|mx|my|mz|na|nab|nadex|nagoya|name|nationwide|natura|navy|nba|nc|ne|nec|net|netbank|netflix|network|neustar|new|newholland|news|next|nextdirect|nexus|nf|nfl|ng|ngo|nhk|ni|nico|nike|nikon|ninja|nissan|nissay|nl|no|nokia|northwesternmutual|norton|now|nowruz|nowtv|np|nr|nra|nrw|ntt|nu|nyc|nz|obi|observer|off|office|okinawa|olayan|olayangroup|oldnavy|ollo|om|omega|one|ong|onl|online|onyourside|ooo|open|oracle|orange|org|organic|origins|osaka|otsuka|ott|ovh|pa|page|panasonic|panerai|paris|pars|partners|parts|party|passagens|pay|pccw|pe|pet|pf|pfizer|pg|ph|pharmacy|phd|philips|phone|photo|photography|photos|physio|piaget|pics|pictet|pictures|pid|pin|ping|pink|pioneer|pizza|pk|pl|place|play|playstation|plumbing|plus|pm|pn|pnc|pohl|poker|politie|porn|post|pr|pramerica|praxi|press|prime|pro|prod|productions|prof|progressive|promo|properties|property|protection|pru|prudential|ps|pt|pub|pw|pwc|py|qa|qpon|quebec|quest|qvc|racing|radio|raid|re|read|realestate|realtor|realty|recipes|red|redstone|redumbrella|rehab|reise|reisen|reit|reliance|ren|rent|rentals|repair|report|republican|rest|restaurant|review|reviews|rexroth|rich|richardli|ricoh|rightathome|ril|rio|rip|rmit|ro|rocher|rocks|rodeo|rogers|room|rs|rsvp|ru|rugby|ruhr|run|rw|rwe|ryukyu|sa|saarland|safe|safety|sakura|sale|salon|samsclub|samsung|sandvik|sandvikcoromant|sanofi|sap|sapo|sarl|sas|save|saxo|sb|sbi|sbs|sc|sca|scb|schaeffler|schmidt|scholarships|school|schule|schwarz|science|scjohnson|scor|scot|sd|se|search|seat|secure|security|seek|select|sener|services|ses|seven|sew|sex|sexy|sfr|sg|sh|shangrila|sharp|shaw|shell|shia|shiksha|shoes|shop|shopping|shouji|show|showtime|shriram|si|silk|sina|singles|site|sj|sk|ski|skin|sky|skype|sl|sling|sm|smart|smile|sn|sncf|so|soccer|social|softbank|software|sohu|solar|solutions|song|sony|soy|space|spiegel|spot|spreadbetting|sr|srl|srt|st|stada|staples|star|starhub|statebank|statefarm|statoil|stc|stcgroup|stockholm|storage|store|stream|studio|study|style|su|sucks|supplies|supply|support|surf|surgery|suzuki|sv|swatch|swiftcover|swiss|sx|sy|sydney|symantec|systems|sz|tab|taipei|talk|taobao|target|tatamotors|tatar|tattoo|tax|taxi|tc|tci|td|tdk|team|tech|technology|tel|telecity|telefonica|temasek|tennis|teva|tf|tg|th|thd|theater|theatre|tiaa|tickets|tienda|tiffany|tips|tires|tirol|tj|tjmaxx|tjx|tk|tkmaxx|tl|tm|tmall|tn|to|today|tokyo|tools|top|toray|toshiba|total|tours|town|toyota|toys|tr|trade|trading|training|travel|travelchannel|travelers|travelersinsurance|trust|trv|tt|tube|tui|tunes|tushu|tv|tvs|tw|tz|ua|ubank|ubs|uconnect|ug|uk|unicom|university|uno|uol|ups|us|uy|uz|va|vacations|vana|vanguard|vc|ve|vegas|ventures|verisign|versicherung|vet|vg|vi|viajes|video|vig|viking|villas|vin|vip|virgin|visa|vision|vista|vistaprint|viva|vivo|vlaanderen|vn|vodka|volkswagen|volvo|vote|voting|voto|voyage|vu|vuelos|wales|walmart|walter|wang|wanggou|warman|watch|watches|weather|weatherchannel|webcam|weber|website|wed|wedding|weibo|weir|wf|whoswho|wien|wiki|williamhill|win|windows|wine|winners|wme|wolterskluwer|woodside|work|works|world|wow|ws|wtc|wtf|xbox|xerox|xfinity|xihuan|xin|xn--11b4c3d|xn--1ck2e1b|xn--1qqw23a|xn--2scrj9c|xn--30rr7y|xn--3bst00m|xn--3ds443g|xn--3e0b707e|xn--3hcrj9c|xn--3oq18vl8pn36a|xn--3pxu8k|xn--42c2d9a|xn--45br5cyl|xn--45brj9c|xn--45q11c|xn--4gbrim|xn--54b7fta0cc|xn--55qw42g|xn--55qx5d|xn--5su34j936bgsg|xn--5tzm5g|xn--6frz82g|xn--6qq986b3xl|xn--80adxhks|xn--80ao21a|xn--80aqecdr1a|xn--80asehdb|xn--80aswg|xn--8y0a063a|xn--90a3ac|xn--90ae|xn--90ais|xn--9dbq2a|xn--9et52u|xn--9krt00a|xn--b4w605ferd|xn--bck1b9a5dre4c|xn--c1avg|xn--c2br7g|xn--cck2b3b|xn--cg4bki|xn--clchc0ea0b2g2a9gcd|xn--czr694b|xn--czrs0t|xn--czru2d|xn--d1acj3b|xn--d1alf|xn--e1a4c|xn--eckvdtc9d|xn--efvy88h|xn--estv75g|xn--fct429k|xn--fhbei|xn--fiq228c5hs|xn--fiq64b|xn--fiqs8s|xn--fiqz9s|xn--fjq720a|xn--flw351e|xn--fpcrj9c3d|xn--fzc2c9e2c|xn--fzys8d69uvgm|xn--g2xx48c|xn--gckr3f0f|xn--gecrj9c|xn--gk3at1e|xn--h2breg3eve|xn--h2brj9c|xn--h2brj9c8c|xn--hxt814e|xn--i1b6b1a6a2e|xn--imr513n|xn--io0a7i|xn--j1aef|xn--j1amh|xn--j6w193g|xn--jlq61u9w7b|xn--jvr189m|xn--kcrx77d1x4a|xn--kprw13d|xn--kpry57d|xn--kpu716f|xn--kput3i|xn--l1acc|xn--lgbbat1ad8j|xn--mgb9awbf|xn--mgba3a3ejt|xn--mgba3a4f16a|xn--mgba7c0bbn0a|xn--mgbaakc7dvf|xn--mgbaam7a8h|xn--mgbab2bd|xn--mgbai9azgqp6j|xn--mgbayh7gpa|xn--mgbb9fbpob|xn--mgbbh1a|xn--mgbbh1a71e|xn--mgbc0a9azcg|xn--mgbca7dzdo|xn--mgberp4a5d4ar|xn--mgbgu82a|xn--mgbi4ecexp|xn--mgbpl2fh|xn--mgbt3dhd|xn--mgbtx2b|xn--mgbx4cd0ab|xn--mix891f|xn--mk1bu44c|xn--mxtq1m|xn--ngbc5azd|xn--ngbe9e0a|xn--ngbrx|xn--node|xn--nqv7f|xn--nqv7fs00ema|xn--nyqy26a|xn--o3cw4h|xn--ogbpf8fl|xn--p1acf|xn--p1ai|xn--pbt977c|xn--pgbs0dh|xn--pssy2u|xn--q9jyb4c|xn--qcka1pmc|xn--qxam|xn--rhqv96g|xn--rovu88b|xn--rvc1e0am3e|xn--s9brj9c|xn--ses554g|xn--t60b56a|xn--tckwe|xn--tiq49xqyj|xn--unup4y|xn--vermgensberater-ctb|xn--vermgensberatung-pwb|xn--vhquv|xn--vuq861b|xn--w4r85el8fhu5dnra|xn--w4rs40l|xn--wgbh1c|xn--wgbl6a|xn--xhq521b|xn--xkc2al3hye2a|xn--xkc2dl3a5ee0h|xn--y9a3aq|xn--yfro4i67o|xn--ygbi2ammx|xn--zfr164b|xperia|xxx|xyz|yachts|yahoo|yamaxun|yandex|ye|yodobashi|yoga|yokohama|you|youtube|yt|yun|za|zappos|zara|zero|zip|zippo|zm|zone|zuerich|zw".split("|"),El="0123456789".split(""),Bl="0123456789abcdefghijklmnopqrstuvwxyz".split(""),Ol=[" ","\f","\r","\t","\v"," "," ","᠎"],Cl=[],jl=function(e){return new Sl.CharacterState(e)},Il=jl(),Ll=jl(Ml.NUM),Pl=jl(Ml.DOMAIN),Nl=jl(),Hl=jl(Ml.WS);Il.on("@",jl(Ml.AT)).on(".",jl(Ml.DOT)).on("+",jl(Ml.PLUS)).on("#",jl(Ml.POUND)).on("?",jl(Ml.QUERY)).on("/",jl(Ml.SLASH)).on("_",jl(Ml.UNDERSCORE)).on(":",jl(Ml.COLON)).on("{",jl(Ml.OPENBRACE)).on("[",jl(Ml.OPENBRACKET)).on("<",jl(Ml.OPENANGLEBRACKET)).on("(",jl(Ml.OPENPAREN)).on("}",jl(Ml.CLOSEBRACE)).on("]",jl(Ml.CLOSEBRACKET)).on(">",jl(Ml.CLOSEANGLEBRACKET)).on(")",jl(Ml.CLOSEPAREN)).on("&",jl(Ml.AMPERSAND)).on([",",";","!",'"',"'"],jl(Ml.PUNCTUATION)),Il.on("\n",jl(Ml.NL)).on(Ol,Hl),Hl.on(Ol,Hl);for(var Fl=0;Fl<Tl.length;Fl++){var Dl=(0,Sl.stateify)(Tl[Fl],Il,Ml.TLD,Ml.DOMAIN);Cl.push.apply(Cl,Dl)}var $l=(0,Sl.stateify)("file",Il,Ml.DOMAIN,Ml.DOMAIN),Ul=(0,Sl.stateify)("ftp",Il,Ml.DOMAIN,Ml.DOMAIN),ql=(0,Sl.stateify)("http",Il,Ml.DOMAIN,Ml.DOMAIN),Vl=(0,Sl.stateify)("mailto",Il,Ml.DOMAIN,Ml.DOMAIN);Cl.push.apply(Cl,$l),Cl.push.apply(Cl,Ul),Cl.push.apply(Cl,ql),Cl.push.apply(Cl,Vl);var zl=$l.pop(),Xl=Ul.pop(),Yl=ql.pop(),Kl=Vl.pop(),Gl=jl(Ml.DOMAIN),Zl=jl(Ml.PROTOCOL),Wl=jl(Ml.MAILTO);Xl.on("s",Gl).on(":",Zl),Yl.on("s",Gl).on(":",Zl),Cl.push(Gl),zl.on(":",Zl),Gl.on(":",Zl),Kl.on(":",Wl);var Ql=(0,Sl.stateify)("localhost",Il,Ml.LOCALHOST,Ml.DOMAIN);Cl.push.apply(Cl,Ql),Il.on(El,Ll),Ll.on("-",Nl).on(El,Ll).on(Bl,Pl),Pl.on("-",Nl).on(Bl,Pl);for(var Jl=0;Jl<Cl.length;Jl++)Cl[Jl].on("-",Nl).on(Bl,Pl);Nl.on("-",Nl).on(El,Pl).on(Bl,Pl),Il.defaultTransition=jl(Ml.SYM);var ec=function(e){var t=e.replace(/[A-Z]/g,(function(e){return e.toLowerCase()})),s=e.length,a=[],o=0;while(o<s){var n=Il,r=null,i=0,l=null,c=-1;while(o<s&&(r=n.next(t[o])))n=r,n.accepts()?(c=0,l=n):c>=0&&c++,i++,o++;if(!(c<0)){o-=c,i-=c;var d=l.emit();a.push(new d(e.substr(o-i,i)))}}return a},tc=Il;Pi.State=Sl.CharacterState,Pi.TOKENS=Al,Pi.run=ec,Pi.start=tc;var sc={},ac={__esModule:!0};ac.URL=ac.TEXT=ac.NL=ac.EMAIL=ac.MAILTOEMAIL=ac.Base=void 0;var oc=zi,nc=Ri,rc=Vi;function ic(e){return e instanceof rc.DOMAIN||e instanceof rc.TLD}var lc=(0,oc.createTokenClass)();lc.prototype={type:"token",isLink:!1,toString:function(){for(var e=[],t=0;t<this.v.length;t++)e.push(this.v[t].toString());return e.join("")},toHref:function(){return this.toString()},toObject:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"http";return{type:this.type,value:this.toString(),href:this.toHref(e)}}};var cc=(0,nc.inherits)(lc,(0,oc.createTokenClass)(),{type:"email",isLink:!0}),dc=(0,nc.inherits)(lc,(0,oc.createTokenClass)(),{type:"email",isLink:!0,toHref:function(){return"mailto:"+this.toString()}}),uc=(0,nc.inherits)(lc,(0,oc.createTokenClass)(),{type:"text"}),mc=(0,nc.inherits)(lc,(0,oc.createTokenClass)(),{type:"nl"}),pc=(0,nc.inherits)(lc,(0,oc.createTokenClass)(),{type:"url",isLink:!0,toHref:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"http",t=!1,s=!1,a=this.v,o=[],n=0;while(a[n]instanceof rc.PROTOCOL)t=!0,o.push(a[n].toString().toLowerCase()),n++;while(a[n]instanceof rc.SLASH)s=!0,o.push(a[n].toString()),n++;while(ic(a[n]))o.push(a[n].toString().toLowerCase()),n++;for(;n<a.length;n++)o.push(a[n].toString());return o=o.join(""),t||s||(o=e+"://"+o),o},hasProtocol:function(){return this.v[0]instanceof rc.PROTOCOL}});ac.Base=lc,ac.MAILTOEMAIL=cc,ac.EMAIL=dc,ac.NL=mc,ac.TEXT=uc,ac.URL=pc,sc.__esModule=!0,sc.start=sc.run=sc.TOKENS=sc.State=void 0;var hc=Ni,fc=ac,gc=vc(fc),_c=Vi;function vc(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t.default=e,t}var bc=function(e){return new hc.TokenState(e)},yc=bc(),xc=bc(),wc=bc(),kc=bc(),Sc=bc(),Mc=bc(),Ac=bc(),Rc=bc(fc.URL),Tc=bc(),Ec=bc(fc.URL),Bc=bc(fc.URL),Oc=bc(),Cc=bc(),jc=bc(),Ic=bc(),Lc=bc(),Pc=bc(fc.URL),Nc=bc(fc.URL),Hc=bc(fc.URL),Fc=bc(fc.URL),Dc=bc(),$c=bc(),Uc=bc(),qc=bc(),Vc=bc(),zc=bc(),Xc=bc(fc.EMAIL),Yc=bc(),Kc=bc(fc.EMAIL),Gc=bc(fc.MAILTOEMAIL),Zc=bc(),Wc=bc(),Qc=bc(),Jc=bc(),ed=bc(fc.NL);yc.on(_c.NL,ed).on(_c.PROTOCOL,xc).on(_c.MAILTO,wc).on(_c.SLASH,kc),xc.on(_c.SLASH,kc),kc.on(_c.SLASH,Sc),yc.on(_c.TLD,Mc).on(_c.DOMAIN,Mc).on(_c.LOCALHOST,Rc).on(_c.NUM,Mc),Sc.on(_c.TLD,Bc).on(_c.DOMAIN,Bc).on(_c.NUM,Bc).on(_c.LOCALHOST,Bc),Mc.on(_c.DOT,Ac),Vc.on(_c.DOT,zc),Ac.on(_c.TLD,Rc).on(_c.DOMAIN,Mc).on(_c.NUM,Mc).on(_c.LOCALHOST,Mc),zc.on(_c.TLD,Xc).on(_c.DOMAIN,Vc).on(_c.NUM,Vc).on(_c.LOCALHOST,Vc),Rc.on(_c.DOT,Ac),Xc.on(_c.DOT,zc),Rc.on(_c.COLON,Tc).on(_c.SLASH,Bc),Tc.on(_c.NUM,Ec),Ec.on(_c.SLASH,Bc),Xc.on(_c.COLON,Yc),Yc.on(_c.NUM,Kc);var td=[_c.DOMAIN,_c.AT,_c.LOCALHOST,_c.NUM,_c.PLUS,_c.POUND,_c.PROTOCOL,_c.SLASH,_c.TLD,_c.UNDERSCORE,_c.SYM,_c.AMPERSAND],sd=[_c.COLON,_c.DOT,_c.QUERY,_c.PUNCTUATION,_c.CLOSEBRACE,_c.CLOSEBRACKET,_c.CLOSEANGLEBRACKET,_c.CLOSEPAREN,_c.OPENBRACE,_c.OPENBRACKET,_c.OPENANGLEBRACKET,_c.OPENPAREN];Bc.on(_c.OPENBRACE,Cc).on(_c.OPENBRACKET,jc).on(_c.OPENANGLEBRACKET,Ic).on(_c.OPENPAREN,Lc),Oc.on(_c.OPENBRACE,Cc).on(_c.OPENBRACKET,jc).on(_c.OPENANGLEBRACKET,Ic).on(_c.OPENPAREN,Lc),Cc.on(_c.CLOSEBRACE,Bc),jc.on(_c.CLOSEBRACKET,Bc),Ic.on(_c.CLOSEANGLEBRACKET,Bc),Lc.on(_c.CLOSEPAREN,Bc),Pc.on(_c.CLOSEBRACE,Bc),Nc.on(_c.CLOSEBRACKET,Bc),Hc.on(_c.CLOSEANGLEBRACKET,Bc),Fc.on(_c.CLOSEPAREN,Bc),Dc.on(_c.CLOSEBRACE,Bc),$c.on(_c.CLOSEBRACKET,Bc),Uc.on(_c.CLOSEANGLEBRACKET,Bc),qc.on(_c.CLOSEPAREN,Bc),Cc.on(td,Pc),jc.on(td,Nc),Ic.on(td,Hc),Lc.on(td,Fc),Cc.on(sd,Dc),jc.on(sd,$c),Ic.on(sd,Uc),Lc.on(sd,qc),Pc.on(td,Pc),Nc.on(td,Nc),Hc.on(td,Hc),Fc.on(td,Fc),Pc.on(sd,Pc),Nc.on(sd,Nc),Hc.on(sd,Hc),Fc.on(sd,Fc),Dc.on(td,Pc),$c.on(td,Nc),Uc.on(td,Hc),qc.on(td,Fc),Dc.on(sd,Dc),$c.on(sd,$c),Uc.on(sd,Uc),qc.on(sd,qc),Bc.on(td,Bc),Oc.on(td,Bc),Bc.on(sd,Oc),Oc.on(sd,Oc),wc.on(_c.TLD,Gc).on(_c.DOMAIN,Gc).on(_c.NUM,Gc).on(_c.LOCALHOST,Gc),Gc.on(td,Gc).on(sd,Zc),Zc.on(td,Gc).on(sd,Zc);var ad=[_c.DOMAIN,_c.NUM,_c.PLUS,_c.POUND,_c.QUERY,_c.UNDERSCORE,_c.SYM,_c.AMPERSAND,_c.TLD];Mc.on(ad,Wc).on(_c.AT,Qc),Rc.on(ad,Wc).on(_c.AT,Qc),Ac.on(ad,Wc),Wc.on(ad,Wc).on(_c.AT,Qc).on(_c.DOT,Jc),Jc.on(ad,Wc),Qc.on(_c.TLD,Vc).on(_c.DOMAIN,Vc).on(_c.LOCALHOST,Xc);var od=function(e){var t=e.length,s=0,a=[],o=[];while(s<t){var n=yc,r=null,i=null,l=0,c=null,d=-1;while(s<t&&!(r=n.next(e[s])))o.push(e[s++]);while(s<t&&(i=r||n.next(e[s])))r=null,n=i,n.accepts()?(d=0,c=n):d>=0&&d++,s++,l++;if(d<0)for(var u=s-l;u<s;u++)o.push(e[u]);else{o.length>0&&(a.push(new fc.TEXT(o)),o=[]),s-=d,l-=d;var m=c.emit();a.push(new m(e.slice(s-l,s)))}}return o.length>0&&a.push(new fc.TEXT(o)),a};sc.State=hc.TokenState,sc.TOKENS=gc,sc.run=od,sc.start=yc,Ai.__esModule=!0,Ai.tokenize=Ai.test=Ai.scanner=Ai.parser=Ai.options=Ai.inherits=Ai.find=void 0;var nd=Ri,rd=Ei,id=md(rd),ld=Pi,cd=md(ld),dd=sc,ud=md(dd);function md(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t.default=e,t}Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)});var pd=function(e){return ud.run(cd.run(e))},hd=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=pd(e),a=[],o=0;o<s.length;o++){var n=s[o];!n.isLink||t&&n.type!==t||a.push(n.toObject())}return a},fd=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=pd(e);return 1===s.length&&s[0].isLink&&(!t||s[0].type===t)};Ai.find=hd,Ai.inherits=nd.inherits,Ai.options=id,Ai.parser=ud,Ai.scanner=cd,Ai.test=fd,Ai.tokenize=pd;var gd=Ai,_d=(e,t,s)=>{const a={bold:s.bold,italic:s.italic,strike:s.strike,underline:s.underline,multilineCode:s.multilineCode,inlineCode:s.inlineCode},o={[a.bold]:{end:"\\"+a.bold,allowed_chars:".",type:"bold"},[a.italic]:{end:a.italic,allowed_chars:".",type:"italic"},[a.strike]:{end:a.strike,allowed_chars:".",type:"strike"},[a.underline]:{end:a.underline,allowed_chars:".",type:"underline"},[a.multilineCode]:{end:a.multilineCode,allowed_chars:"(.|\n)",type:"multiline-code"},[a.inlineCode]:{end:a.inlineCode,allowed_chars:".",type:"inline-code"},"<usertag>":{allowed_chars:".",end:"</usertag>",type:"tag"}},n=vd(e,o),r=bd(n,o),i=[].concat.apply([],r);return t&&kd(i),i};function vd(e,t){let s=[],a=-1,o=null,n=gd.find(e),r=!1;if(n.length>0&&(a=e.indexOf(n[0].value),r=!0),Object.keys(t).forEach(t=>{const s=e.indexOf(t);s>=0&&(a<0||s<a)&&(a=s,o=t,r=!1)}),r&&-1!==o){let o=e.substr(0,a),r=e.substr(a,n[0].value.length),i=e.substr(a+n[0].value.length);return s.push(o),s.push(r),s=s.concat(vd(i,t)),s}if(o){let n=e.substr(0,a);const r=o;let i=e.substr(a+r.length);if(e.replace(/\s/g,"").length===2*r.length)return[e];const l=i.match(new RegExp("^("+(t[r].allowed_chars||".")+"*"+(t[r].end?"?":"")+")"+(t[r].end?"("+t[r].end+")":""),"m"));if(l&&l[1]){n&&s.push(n);const e={start:r,content:vd(l[1],t),end:l[2],type:t[r].type};s.push(e),i=i.substr(l[0].length)}else n+=r,s.push(n);return s=s.concat(vd(i,t)),s}return e?[e]:[]}function bd(e,t){const s=[];return e.forEach(e=>{"string"===typeof e?s.push({types:[],value:e}):t[e.start]&&s.push(yd(e))}),s}function yd(e){const t=[];return xd(e,t,[]),t}function xd(e,t,s){e.content.forEach(a=>{"string"===typeof a?t.push({types:wd(s.concat([e.type])),value:a}):xd(a,t,wd([a.type].concat([e.type]).concat(s)))})}function wd(e){return[...new Set(e)]}function kd(e){const t=[];return e.forEach(e=>{const s=gd.find(e.value);if(s.length){const a=e.value.replace(s[0].value,"");t.push({types:e.types,value:a}),e.types=["url"].concat(e.types),e.href=s[0].href,e.value=s[0].value}t.push(e)}),t}const Sd=["png","jpg","jpeg","webp","svg","gif"],Md=["mp4","video/ogg","webm","quicktime"],Ad=["mp3","audio/ogg","wav","mpeg"],Rd={name:"FormatMessage",components:{SvgIcon:yi},props:{messageId:{type:String,default:""},roomId:{type:String,default:""},roomList:{type:Boolean,default:!1},content:{type:[String,Number],required:!0},deleted:{type:Boolean,default:!1},users:{type:Array,default:()=>[]},linkify:{type:Boolean,default:!0},singleLine:{type:Boolean,default:!1},reply:{type:Boolean,default:!1},textFormatting:{type:Object,required:!0},textMessages:{type:Object,default:()=>{}},linkOptions:{type:Object,required:!0}},emits:["open-user-tag"],computed:{linkifiedMessage(){if(this.deleted)return[{value:this.textMessages.MESSAGE_DELETED}];const e=_d(this.formatTags(this.content),this.linkify&&!this.linkOptions.disabled,this.textFormatting);return e.forEach(e=>{e.url=this.checkType(e,"url"),e.bold=this.checkType(e,"bold"),e.italic=this.checkType(e,"italic"),e.strike=this.checkType(e,"strike"),e.underline=this.checkType(e,"underline"),e.inline=this.checkType(e,"inline-code"),e.multiline=this.checkType(e,"multiline-code"),e.tag=this.checkType(e,"tag"),e.image=this.checkImageType(e),e.value=this.replaceEmojiByElement(e.value)}),e},formattedContent(){return this.deleted?this.textMessages.MESSAGE_DELETED:this.formatTags(this.content)}},methods:{checkType(e,t){return e.types&&-1!==e.types.indexOf(t)},checkImageType(e){let t=e.value.lastIndexOf(".");const s=e.value.lastIndexOf("/");s>t&&(t=-1);const a=e.value.substring(t+1,e.value.length),o=t>0&&Sd.some(e=>a.toLowerCase().includes(e));return o&&this.setImageSize(e),o},setImageSize(e){const t=new Image;function s(a){const o=a.path[0].width/150;e.height=Math.round(a.path[0].height/o)+"px",t.removeEventListener("load",s)}t.src=e.value,t.addEventListener("load",s)},formatTags(e){const t="<usertag>",s="</usertag>",a=[...e.matchAll(new RegExp(t,"gi"))].map(e=>e.index),o=e;return a.forEach(a=>{const n=o.substring(a+t.length,o.indexOf(s,a)),r=this.users.find(e=>e._id===n);e=e.replaceAll(n,"@"+((null==r?void 0:r.username)||"unknown"))}),e},openTag(e){if(!this.singleLine&&this.checkType(e,"tag")){const t=this.users.find(t=>-1!==e.value.indexOf(t.username));this.$emit("open-user-tag",t)}},replaceEmojiByElement(e){let t;if(this.singleLine)t=16;else{const e=this.containsOnlyEmojis();t=e?28:20}return e.replaceAll(/[\p{Extended_Pictographic}\u{1F3FB}-\u{1F3FF}\u{1F9B0}-\u{1F9B3}]/gu,e=>`<span style="font-size: ${t}px">${e}</span>`)},containsOnlyEmojis(){const e=this.content.replace(new RegExp("[\0-ữf]","g"),""),t=this.content.replace(new RegExp("[\n\rs]+|( )+","g"),"");return e.length===t.length}}},Td={class:"vac-image-link-container"},Ed={class:"vac-image-link-message"},Bd=["innerHTML"],Od=["innerHTML"];function Cd(e,t,s,a,o,n){const r=ka("svg-icon");return Bo(),Lo("div",{class:it(["vac-format-message-wrapper",{"vac-text-ellipsis":s.singleLine}])},[s.textFormatting.disabled?(Bo(),Lo("div",{key:1,innerHTML:n.formattedContent},null,8,Od)):(Bo(),Lo("div",{key:0,class:it({"vac-text-ellipsis":s.singleLine})},[(Bo(!0),Lo(So,null,Ea(n.linkifiedMessage,(t,a)=>(Bo(),Lo("div",{key:a,class:"vac-format-container"},[(Bo(),Po(Ma(t.url?"a":"span"),{class:it({"vac-text-ellipsis":s.singleLine,"vac-text-bold":t.bold,"vac-text-italic":s.deleted||t.italic,"vac-text-strike":t.strike,"vac-text-underline":t.underline,"vac-text-inline-code":!s.singleLine&&t.inline,"vac-text-multiline-code":!s.singleLine&&t.multiline,"vac-text-tag":!s.singleLine&&!s.reply&&t.tag}),href:t.href,target:t.href?s.linkOptions.target:null,rel:t.href?s.linkOptions.rel:null,onClick:e=>n.openTag(t)},{default:Rs(()=>[s.deleted?(Bo(),Lo(So,{key:0},[Oa(e.$slots,s.roomList?"deleted-icon-room_"+s.roomId:"deleted-icon_"+s.messageId,{},()=>[qo(r,{name:"deleted",class:it(["vac-icon-deleted",{"vac-icon-deleted-room":s.roomList}])},null,8,["class"])]),Yo(" "+ct(s.textMessages.MESSAGE_DELETED),1)],64)):t.url&&t.image?(Bo(),Lo(So,{key:1},[Uo("div",Td,[Uo("div",{class:"vac-image-link",style:at({"background-image":`url('${t.value}')`,height:t.height})},null,4)]),Uo("div",Ed,[Uo("span",null,ct(t.value),1)])],64)):(Bo(),Lo("span",{key:2,innerHTML:t.value},null,8,Bd))]),_:2},1032,["class","href","target","rel","onClick"]))]))),128))],2))],2)}var jd=ni(Rd,[["render",Cd]]);const Id="__v-click-outside",Ld="undefined"!==typeof window,Pd="undefined"!==typeof navigator,Nd=Ld&&("ontouchstart"in window||Pd&&navigator.msMaxTouchPoints>0),Hd=Nd?["touchstart"]:["click"],Fd=e=>{const t="function"===typeof e;if(!t&&"object"!==typeof e)throw new Error("v-click-outside: Binding value must be a function or an object");return{handler:t?e:e.handler,middleware:e.middleware||(e=>e),events:e.events||Hd,isActive:!(!1===e.isActive),detectIframe:!(!1===e.detectIframe),capture:Boolean(e.capture)}},Dd=({event:e,handler:t,middleware:s})=>{s(e)&&t(e)},$d=({el:e,event:t,handler:s,middleware:a})=>{setTimeout(()=>{const{activeElement:o}=document;o&&"IFRAME"===o.tagName&&!e.contains(o)&&Dd({event:t,handler:s,middleware:a})},0)},Ud=({el:e,event:t,handler:s,middleware:a})=>{const o=t.path||t.composedPath&&t.composedPath(),n=o?o.indexOf(e)<0:!e.contains(t.target);n&&Dd({event:t,handler:s,middleware:a})},qd=(e,{value:t})=>{const{events:s,handler:a,middleware:o,isActive:n,detectIframe:r,capture:i}=Fd(t);if(n){if(e[Id]=s.map(t=>({event:t,srcTarget:document.documentElement,handler:t=>Ud({el:e,event:t,handler:a,middleware:o}),capture:i})),r){const t={event:"blur",srcTarget:window,handler:t=>$d({el:e,event:t,handler:a,middleware:o}),capture:i};e[Id]=[...e[Id],t]}e[Id].forEach(({event:t,srcTarget:s,handler:a})=>setTimeout(()=>{e[Id]&&s.addEventListener(t,a,i)},0))}},Vd=e=>{const t=e[Id]||[];t.forEach(({event:e,srcTarget:t,handler:s,capture:a})=>t.removeEventListener(e,s,a)),delete e[Id]},zd=(e,{value:t,oldValue:s})=>{JSON.stringify(t)!==JSON.stringify(s)&&(Vd(e),qd(e,{value:t}))},Xd={beforeMount:qd,updated:zd,unmounted:Vd};var Yd=Ld?Xd:{},Kd=(e,t,s)=>{if(e.typingUsers&&e.typingUsers.length){const a=e.users.filter(s=>{if(s._id!==t&&-1!==e.typingUsers.indexOf(s._id)&&(!s.status||"offline"!==s.status.state))return!0});if(!a.length)return;return 2===e.users.length?s.IS_TYPING:a.map(e=>e.username).join(", ")+" "+s.IS_TYPING}};function Gd(e,t){if(t&&t.type)return e.some(e=>t.type.toLowerCase().includes(e))}function Zd(e){return Gd(Sd,e)}function Wd(e){return Gd(Md,e)}function Qd(e){return Gd(Sd,e)||Gd(Md,e)}function Jd(e){return Gd(Ad,e)}const eu={name:"RoomsContent",components:{SvgIcon:yi,FormatMessage:jd},directives:{clickOutside:Yd},props:{currentUserId:{type:[String,Number],required:!0},room:{type:Object,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},textMessages:{type:Object,required:!0},roomActions:{type:Array,required:!0}},emits:["room-action-handler"],data(){return{roomMenuOpened:null}},computed:{getLastMessage(){const e=this.typingUsers;if(e)return e;const t=this.room.lastMessage.content;if(this.room.users.length<=2)return t;const s=this.room.users.find(e=>e._id===this.room.lastMessage.senderId);return this.room.lastMessage.username?`${this.room.lastMessage.username} - ${t}`:s&&s._id!==this.currentUserId?`${s.username} - ${t}`:t},userStatus(){if(!this.room.users||2!==this.room.users.length)return;const e=this.room.users.find(e=>e._id!==this.currentUserId);return e&&e.status?e.status.state:null},typingUsers(){return Kd(this.room,this.currentUserId,this.textMessages)},isMessageCheckmarkVisible(){return!this.typingUsers&&this.room.lastMessage&&!this.room.lastMessage.deleted&&this.room.lastMessage.senderId===this.currentUserId&&(this.room.lastMessage.saved||this.room.lastMessage.distributed||this.room.lastMessage.seen)},formattedDuration(){var e,t;const s=null==(t=null==(e=this.room.lastMessage)?void 0:e.files)?void 0:t[0];if(s){if(!s.duration)return`${s.name}.${s.extension}`;let e=Math.floor(s.duration);return(e-(e%=60))/60+(e>9?":":":0")+e}return""},isAudio(){return!!this.room.lastMessage.files&&Jd(this.room.lastMessage.files[0])}},methods:{roomActionHandler(e){this.closeRoomMenu(),this.$emit("room-action-handler",{action:e,roomId:this.room.roomId})},closeRoomMenu(){this.roomMenuOpened=null}}},tu={class:"vac-room-container"},su={class:"vac-name-container vac-text-ellipsis"},au={class:"vac-title-container"},ou={class:"vac-room-name vac-text-ellipsis"},nu={key:1,class:"vac-text-date"},ru={key:0},iu={key:1,class:"vac-text-ellipsis"},lu={key:3,class:"vac-text-ellipsis"},cu={class:"vac-room-options-container"},du={key:0,class:"vac-badge-counter vac-room-badge"},uu={key:0,class:"vac-menu-options"},mu={class:"vac-menu-list"},pu=["onClick"];function hu(e,t,s,a,o,n){const r=ka("svg-icon"),i=ka("format-message"),l=Aa("click-outside");return Bo(),Lo("div",tu,[Oa(e.$slots,"room-list-item_"+s.room.roomId,{},()=>[Oa(e.$slots,"room-list-avatar_"+s.room.roomId,{},()=>[s.room.avatar?(Bo(),Lo("div",{key:0,class:"vac-avatar",style:at({"background-image":`url('${s.room.avatar}')`})},null,4)):Ko("",!0)]),Uo("div",su,[Uo("div",au,[n.userStatus?(Bo(),Lo("div",{key:0,class:it(["vac-state-circle",{"vac-state-online":"online"===n.userStatus}])},null,2)):Ko("",!0),Uo("div",ou,ct(s.room.roomName),1),s.room.lastMessage?(Bo(),Lo("div",nu,ct(s.room.lastMessage.timestamp),1)):Ko("",!0)]),Uo("div",{class:it(["vac-text-last",{"vac-message-new":s.room.lastMessage&&s.room.lastMessage.new&&!n.typingUsers}])},[n.isMessageCheckmarkVisible?(Bo(),Lo("span",ru,[Oa(e.$slots,"checkmark-icon_"+s.room.roomId,{},()=>[qo(r,{name:s.room.lastMessage.distributed?"double-checkmark":"checkmark",param:s.room.lastMessage.seen?"seen":"",class:"vac-icon-check"},null,8,["name","param"])])])):Ko("",!0),s.room.lastMessage&&!s.room.lastMessage.deleted&&n.isAudio?(Bo(),Lo("div",iu,[Oa(e.$slots,"microphone-icon_"+s.room.roomId,{},()=>[qo(r,{name:"microphone",class:"vac-icon-microphone"})]),Yo(" "+ct(n.formattedDuration),1)])):s.room.lastMessage?(Bo(),Po(i,{key:2,"message-id":s.room.lastMessage._id,"room-id":s.room.roomId,"room-list":!0,content:n.getLastMessage,deleted:!!s.room.lastMessage.deleted&&!n.typingUsers,users:s.room.users,"text-messages":s.textMessages,linkify:!1,"text-formatting":s.textFormatting,"link-options":s.linkOptions,"single-line":!0},Ba({_:2},[Ea(e.$slots,(t,s)=>({name:s,fn:Rs(t=>[Oa(e.$slots,s,lt(zo(t)))])}))]),1032,["message-id","room-id","content","deleted","users","text-messages","text-formatting","link-options"])):Ko("",!0),!s.room.lastMessage&&n.typingUsers?(Bo(),Lo("div",lu,ct(n.typingUsers),1)):Ko("",!0),Uo("div",cu,[s.room.unreadCount?(Bo(),Lo("div",du,ct(s.room.unreadCount),1)):Ko("",!0),Oa(e.$slots,"room-list-options_"+s.room.roomId,{},()=>[s.roomActions.length?(Bo(),Lo("div",{key:0,class:"vac-svg-button vac-list-room-options",onClick:t[0]||(t[0]=Zr(e=>o.roomMenuOpened=s.room.roomId,["stop"]))},[Oa(e.$slots,"room-list-options-icon_"+s.room.roomId,{},()=>[qo(r,{name:"dropdown",param:"room"})])])):Ko("",!0),s.roomActions.length?(Bo(),Po(kr,{key:1,name:"vac-slide-left"},{default:Rs(()=>[o.roomMenuOpened===s.room.roomId?ba((Bo(),Lo("div",uu,[Uo("div",mu,[(Bo(!0),Lo(So,null,Ea(s.roomActions,e=>(Bo(),Lo("div",{key:e.name},[Uo("div",{class:"vac-menu-item",onClick:Zr(t=>n.roomActionHandler(e),["stop"])},ct(e.title),9,pu)]))),128))])])),[[l,n.closeRoomMenu]]):Ko("",!0)]),_:1})):Ko("",!0)])])],2)])])])}var fu=ni(eu,[["render",hu]]),gu=(e,t,s,a=!1)=>s&&""!==s?e.filter(e=>a?_u(e[t]).startsWith(_u(s)):_u(e[t]).includes(_u(s))):e;function _u(e){return e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"")}const vu={name:"RoomsList",components:{Loader:hi,RoomsSearch:Mi,RoomContent:fu},props:{currentUserId:{type:[String,Number],required:!0},textMessages:{type:Object,required:!0},showRoomsList:{type:Boolean,required:!0},showSearch:{type:Boolean,required:!0},showAddRoom:{type:Boolean,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},isMobile:{type:Boolean,required:!0},rooms:{type:Array,required:!0},loadingRooms:{type:Boolean,required:!0},roomsLoaded:{type:Boolean,required:!0},room:{type:Object,required:!0},customSearchRoomEnabled:{type:[Boolean,String],default:!1},roomActions:{type:Array,required:!0},scrollDistance:{type:Number,required:!0}},emits:["add-room","search-room","room-action-handler","loading-more-rooms","fetch-room","fetch-more-rooms"],data(){return{filteredRooms:this.rooms||[],observer:null,showLoader:!0,loadingMoreRooms:!1,selectedRoomId:""}},watch:{rooms:{deep:!0,handler(e,t){this.filteredRooms=e,(e.length!==t.length||this.roomsLoaded)&&(this.loadingMoreRooms=!1)}},loadingRooms(e){e||setTimeout(()=>this.initIntersectionObserver())},loadingMoreRooms(e){this.$emit("loading-more-rooms",e)},roomsLoaded:{immediate:!0,handler(e){e&&(this.loadingMoreRooms=!1,this.loadingRooms||(this.showLoader=!1))}},room:{immediate:!0,handler(e){e&&!this.isMobile&&(this.selectedRoomId=e.roomId)}}},methods:{initIntersectionObserver(){this.observer&&(this.showLoader=!0,this.observer.disconnect());const e=this.$el.querySelector("#infinite-loader-rooms");if(e){const t={root:this.$el.querySelector("#rooms-list"),rootMargin:this.scrollDistance+"px",threshold:0};this.observer=new IntersectionObserver(e=>{e[0].isIntersecting&&this.loadMoreRooms()},t),this.observer.observe(e)}},searchRoom(e){this.customSearchRoomEnabled?this.$emit("search-room",e.target.value):this.filteredRooms=gu(this.rooms,"roomName",e.target.value)},openRoom(e){(e.roomId!==this.room.roomId||this.isMobile)&&(this.isMobile||(this.selectedRoomId=e.roomId),this.$emit("fetch-room",{room:e}))},loadMoreRooms(){if(!this.loadingMoreRooms){if(this.roomsLoaded)return this.loadingMoreRooms=!1,void(this.showLoader=!1);this.$emit("fetch-more-rooms"),this.loadingMoreRooms=!0}}}},bu={key:0,class:"vac-rooms-empty"},yu={key:1,id:"rooms-list",class:"vac-room-list"},xu=["id","onClick"],wu={key:0,id:"infinite-loader-rooms"};function ku(e,t,s,a,o,n){const r=ka("rooms-search"),i=ka("loader"),l=ka("room-content");return ba((Bo(),Lo("div",{class:it(["vac-rooms-container",{"vac-rooms-container-full":s.isMobile,"vac-app-border-r":!s.isMobile}])},[Oa(e.$slots,"rooms-header"),Oa(e.$slots,"rooms-list-search",{},()=>[qo(r,{rooms:s.rooms,"loading-rooms":s.loadingRooms,"text-messages":s.textMessages,"show-search":s.showSearch,"show-add-room":s.showAddRoom,onSearchRoom:n.searchRoom,onAddRoom:t[0]||(t[0]=t=>e.$emit("add-room"))},Ba({_:2},[Ea(e.$slots,(t,s)=>({name:s,fn:Rs(t=>[Oa(e.$slots,s,lt(zo(t)))])}))]),1032,["rooms","loading-rooms","text-messages","show-search","show-add-room","onSearchRoom"])]),qo(i,{show:s.loadingRooms,type:"rooms"},Ba({_:2},[Ea(e.$slots,(t,s)=>({name:s,fn:Rs(t=>[Oa(e.$slots,s,lt(zo(t)))])}))]),1032,["show"]),s.loadingRooms||s.rooms.length?Ko("",!0):(Bo(),Lo("div",bu,[Oa(e.$slots,"rooms-empty",{},()=>[Yo(ct(s.textMessages.ROOMS_EMPTY),1)])])),s.loadingRooms?Ko("",!0):(Bo(),Lo("div",yu,[(Bo(!0),Lo(So,null,Ea(o.filteredRooms,a=>(Bo(),Lo("div",{id:a.roomId,key:a.roomId,class:it(["vac-room-item",{"vac-room-selected":o.selectedRoomId===a.roomId}]),onClick:e=>n.openRoom(a)},[qo(l,{"current-user-id":s.currentUserId,room:a,"text-formatting":s.textFormatting,"link-options":s.linkOptions,"text-messages":s.textMessages,"room-actions":s.roomActions,onRoomActionHandler:t[1]||(t[1]=t=>e.$emit("room-action-handler",t))},Ba({_:2},[Ea(e.$slots,(t,s)=>({name:s,fn:Rs(t=>[Oa(e.$slots,s,lt(zo(t)))])}))]),1032,["current-user-id","room","text-formatting","link-options","text-messages","room-actions"])],10,xu))),128)),qo(kr,{name:"vac-fade-message"},{default:Rs(()=>[s.rooms.length&&!s.loadingRooms?(Bo(),Lo("div",wu,[qo(i,{show:o.showLoader,infinite:!0,type:"infinite-rooms"},Ba({_:2},[Ea(e.$slots,(t,s)=>({name:s,fn:Rs(t=>[Oa(e.$slots,s,lt(zo(t)))])}))]),1032,["show"])])):Ko("",!0)]),_:3})]))],2)),[[Jr,s.showRoomsList]])}var Su=ni(vu,[["render",ku]]);const Mu={name:"RoomHeader",components:{SvgIcon:yi},directives:{clickOutside:Yd},props:{currentUserId:{type:[String,Number],required:!0},textMessages:{type:Object,required:!0},singleRoom:{type:Boolean,required:!0},showRoomsList:{type:Boolean,required:!0},isMobile:{type:Boolean,required:!0},roomInfoEnabled:{type:Boolean,required:!0},menuActions:{type:Array,required:!0},room:{type:Object,required:!0},messageSelectionEnabled:{type:Boolean,required:!0},messageSelectionActions:{type:Array,required:!0},selectedMessagesTotal:{type:Number,required:!0}},emits:["toggle-rooms-list","room-info","menu-action-handler","cancel-message-selection","message-selection-action-handler"],data(){return{menuOpened:!1,messageSelectionAnimationEnded:!0}},computed:{typingUsers(){return Kd(this.room,this.currentUserId,this.textMessages)},userStatus(){if(!this.room.users||2!==this.room.users.length)return;const e=this.room.users.find(e=>e._id!==this.currentUserId);if(!(null==e?void 0:e.status))return;let t="";return"online"===e.status.state?t=this.textMessages.IS_ONLINE:e.status.lastChanged&&(t=this.textMessages.LAST_SEEN+e.status.lastChanged),t}},watch:{messageSelectionEnabled(e){e?this.messageSelectionAnimationEnded=!1:setTimeout(()=>{this.messageSelectionAnimationEnded=!0},300)}},methods:{menuActionHandler(e){this.closeMenu(),this.$emit("menu-action-handler",e)},closeMenu(){this.menuOpened=!1},messageSelectionActionHandler(e){this.$emit("message-selection-action-handler",e)}}},Au={class:"vac-room-header vac-app-border-b"},Ru={class:"vac-room-wrapper"},Tu={key:0,class:"vac-room-selection"},Eu=["id"],Bu=["onClick"],Ou={class:"vac-selection-button-count"},Cu={class:"vac-text-ellipsis"},ju={class:"vac-room-name vac-text-ellipsis"},Iu={key:0,class:"vac-room-info vac-text-ellipsis"},Lu={key:1,class:"vac-room-info vac-text-ellipsis"},Pu={key:0,class:"vac-menu-options"},Nu={class:"vac-menu-list"},Hu=["onClick"];function Fu(e,t,s,a,o,n){const r=ka("svg-icon"),i=Aa("click-outside");return Bo(),Lo("div",Au,[Oa(e.$slots,"room-header",{},()=>[Uo("div",Ru,[qo(kr,{name:"vac-slide-up"},{default:Rs(()=>[s.messageSelectionEnabled?(Bo(),Lo("div",Tu,[(Bo(!0),Lo(So,null,Ea(s.messageSelectionActions,e=>(Bo(),Lo("div",{id:e.name,key:e.name},[Uo("div",{class:"vac-selection-button",onClick:t=>n.messageSelectionActionHandler(e)},[Yo(ct(e.title)+" ",1),Uo("span",Ou,ct(s.selectedMessagesTotal),1)],8,Bu)],8,Eu))),128)),Uo("div",{class:"vac-selection-cancel vac-item-clickable",onClick:t[0]||(t[0]=t=>e.$emit("cancel-message-selection"))},ct(s.textMessages.CANCEL_SELECT_MESSAGE),1)])):Ko("",!0)]),_:1}),!s.messageSelectionEnabled&&o.messageSelectionAnimationEnded?(Bo(),Lo(So,{key:0},[s.singleRoom?Ko("",!0):(Bo(),Lo("div",{key:0,class:it(["vac-svg-button vac-toggle-button",{"vac-rotate-icon-init":!s.isMobile,"vac-rotate-icon":!s.showRoomsList&&!s.isMobile}]),onClick:t[1]||(t[1]=t=>e.$emit("toggle-rooms-list"))},[Oa(e.$slots,"toggle-icon",{},()=>[qo(r,{name:"toggle"})])],2)),Uo("div",{class:it(["vac-info-wrapper",{"vac-item-clickable":s.roomInfoEnabled}]),onClick:t[2]||(t[2]=t=>e.$emit("room-info"))},[Oa(e.$slots,"room-header-avatar",{},()=>[s.room.avatar?(Bo(),Lo("div",{key:0,class:"vac-avatar",style:at({"background-image":`url('${s.room.avatar}')`})},null,4)):Ko("",!0)]),Oa(e.$slots,"room-header-info",{},()=>[Uo("div",Cu,[Uo("div",ju,ct(s.room.roomName),1),n.typingUsers?(Bo(),Lo("div",Iu,ct(n.typingUsers),1)):(Bo(),Lo("div",Lu,ct(n.userStatus),1))])])],2),s.room.roomId?Oa(e.$slots,"room-options",{key:1},()=>[s.menuActions.length?(Bo(),Lo("div",{key:0,class:"vac-svg-button vac-room-options",onClick:t[3]||(t[3]=e=>o.menuOpened=!o.menuOpened)},[Oa(e.$slots,"menu-icon",{},()=>[qo(r,{name:"menu"})])])):Ko("",!0),s.menuActions.length?(Bo(),Po(kr,{key:1,name:"vac-slide-left"},{default:Rs(()=>[o.menuOpened?ba((Bo(),Lo("div",Pu,[Uo("div",Nu,[(Bo(!0),Lo(So,null,Ea(s.menuActions,e=>(Bo(),Lo("div",{key:e.name},[Uo("div",{class:"vac-menu-item",onClick:t=>n.menuActionHandler(e)},ct(e.title),9,Hu)]))),128))])])),[[i,n.closeMenu]]):Ko("",!0)]),_:1})):Ko("",!0)]):Ko("",!0)],64)):Ko("",!0)])])])}var Du=ni(Mu,[["render",Fu]]);function $u(e){if("string"!==typeof e||!e)throw new Error("expected a non-empty string, got: "+e)}function Uu(e){if("number"!==typeof e)throw new Error("expected a number, got: "+e)}const qu=1,Vu=1,zu="emoji",Xu="keyvalue",Yu="favorites",Ku="tokens",Gu="tokens",Zu="unicode",Wu="count",Qu="group",Ju="order",em="group-order",tm="eTag",sm="url",am="skinTone",om="readonly",nm="readwrite",rm="skinUnicodes",im="skinUnicodes",lm="https://cdn.jsdelivr.net/npm/emoji-picker-element-data@^1/en/emojibase/data.json",cm="en";function dm(e,t){const s=new Set,a=[];for(const o of e){const e=t(o);s.has(e)||(s.add(e),a.push(o))}return a}function um(e){return dm(e,e=>e.unicode)}function mm(e){function t(t,s,a){const o=s?e.createObjectStore(t,{keyPath:s}):e.createObjectStore(t);if(a)for(const[e,[n,r]]of Object.entries(a))o.createIndex(e,n,{multiEntry:r});return o}t(Xu),t(zu,Zu,{[Gu]:[Ku,!0],[em]:[[Qu,Ju]],[rm]:[im,!0]}),t(Yu,void 0,{[Wu]:[""]})}const pm={},hm={},fm={};function gm(e,t,s){s.onerror=()=>t(s.error),s.onblocked=()=>t(new Error("IDB blocked")),s.onsuccess=()=>e(s.result)}async function _m(e){const t=await new Promise((t,s)=>{const a=indexedDB.open(e,qu);pm[e]=a,a.onupgradeneeded=e=>{e.oldVersion<Vu&&mm(a.result)},gm(t,s,a)});return t.onclose=()=>ym(e),t}function vm(e){return hm[e]||(hm[e]=_m(e)),hm[e]}function bm(e,t,s,a){return new Promise((o,n)=>{const r=e.transaction(t,s,{durability:"relaxed"}),i="string"===typeof t?r.objectStore(t):t.map(e=>r.objectStore(e));let l;a(i,r,e=>{l=e}),r.oncomplete=()=>o(l),r.onerror=()=>n(r.error)})}function ym(e){const t=pm[e],s=t&&t.result;if(s){s.close();const t=fm[e];if(t)for(const e of t)e()}delete pm[e],delete hm[e],delete fm[e]}function xm(e){return new Promise((t,s)=>{ym(e);const a=indexedDB.deleteDatabase(e);gm(t,s,a)})}function wm(e,t){let s=fm[e];s||(s=fm[e]=[]),s.push(t)}const km=new Set([":D","XD",":'D","O:)",":X",":P",";P","XP",":L",":Z",":j","8D","XO","8)",":B",":O",":S",":'o","Dx","X(","D:",":C",">0)",":3","</3","<3","\\M/",":E","8#"]);function Sm(e){return e.split(/[\s_]+/).map(e=>!e.match(/\w/)||km.has(e)?e.toLowerCase():e.replace(/[)(:,]/g,"").replace(/’/g,"'").toLowerCase()).filter(Boolean)}const Mm=2;function Am(e){return e.filter(Boolean).map(e=>e.toLowerCase()).filter(e=>e.length>=Mm)}function Rm(e){const t=e.map(({annotation:e,emoticon:t,group:s,order:a,shortcodes:o,skins:n,tags:r,emoji:i,version:l})=>{const c=[...new Set(Am([...(o||[]).map(Sm).flat(),...r.map(Sm).flat(),...Sm(e),t]))].sort(),d={annotation:e,group:s,order:a,tags:r,tokens:c,unicode:i,version:l};if(t&&(d.emoticon=t),o&&(d.shortcodes=o),n){d.skinTones=[],d.skinUnicodes=[],d.skinVersions=[];for(const{tone:e,emoji:t,version:s}of n)d.skinTones.push(e),d.skinUnicodes.push(t),d.skinVersions.push(s)}return d});return t}function Tm(e,t,s,a){e[t](s).onsuccess=e=>a&&a(e.target.result)}function Em(e,t,s){Tm(e,"get",t,s)}function Bm(e,t,s){Tm(e,"getAll",t,s)}function Om(e){e.commit&&e.commit()}function Cm(e,t){let s=e[0];for(let a=1;a<e.length;a++){const o=e[a];t(s)>t(o)&&(s=o)}return s}function jm(e,t){const s=Cm(e,e=>e.length),a=[];for(const o of s)e.some(e=>-1===e.findIndex(e=>t(e)===t(o)))||a.push(o);return a}async function Im(e){return!await Um(e,Xu,sm)}async function Lm(e,t,s){const[a,o]=await Promise.all([tm,sm].map(t=>Um(e,Xu,t)));return a===s&&o===t}async function Pm(e,t){const s=50;return bm(e,zu,om,(e,a,o)=>{let n;const r=()=>{e.getAll(n&&IDBKeyRange.lowerBound(n,!0),s).onsuccess=e=>{const a=e.target.result;for(const s of a)if(n=s.unicode,t(s))return o(s);if(a.length<s)return o();r()}};r()})}async function Nm(e,t,s,a){try{const o=Rm(t);await bm(e,[zu,Xu],nm,([e,t],n)=>{let r,i,l=0;function c(){2===++l&&d()}function d(){if(r!==a||i!==s){e.clear();for(const t of o)e.put(t);t.put(a,tm),t.put(s,sm),Om(n)}}Em(t,tm,e=>{r=e,c()}),Em(t,sm,e=>{i=e,c()})})}finally{}}async function Hm(e,t){return bm(e,zu,om,(e,s,a)=>{const o=IDBKeyRange.bound([t,0],[t+1,0],!1,!0);Bm(e.index(em),o,a)})}async function Fm(e,t){const s=Am(Sm(t));return s.length?bm(e,zu,om,(e,t,a)=>{const o=[],n=()=>{o.length===s.length&&r()},r=()=>{const e=jm(o,e=>e.unicode);a(e.sort((e,t)=>e.order<t.order?-1:1))};for(let i=0;i<s.length;i++){const t=s[i],a=i===s.length-1?IDBKeyRange.bound(t,t+"￿",!1,!0):IDBKeyRange.only(t);Bm(e.index(Gu),a,e=>{o.push(e),n()})}}):[]}async function Dm(e,t){const s=await Fm(e,t);if(!s.length){const s=e=>(e.shortcodes||[]).includes(t.toLowerCase());return await Pm(e,s)||null}return s.filter(e=>{const s=(e.shortcodes||[]).map(e=>e.toLowerCase());return s.includes(t.toLowerCase())})[0]||null}async function $m(e,t){return bm(e,zu,om,(e,s,a)=>Em(e,t,s=>{if(s)return a(s);Em(e.index(rm),t,e=>a(e||null))}))}function Um(e,t,s){return bm(e,t,om,(e,t,a)=>Em(e,s,a))}function qm(e,t,s,a){return bm(e,t,nm,(e,t)=>{e.put(a,s),Om(t)})}function Vm(e,t){return bm(e,Yu,nm,(e,s)=>Em(e,t,a=>{e.put((a||0)+1,t),Om(s)}))}function zm(e,t,s){return 0===s?[]:bm(e,[Yu,zu],om,([e,a],o,n)=>{const r=[];e.index(Wu).openCursor(void 0,"prev").onsuccess=e=>{const o=e.target.result;if(!o)return n(r);function i(e){if(r.push(e),r.length===s)return n(r);o.continue()}const l=o.primaryKey,c=t.byName(l);if(c)return i(c);Em(a,l,e=>{if(e)return i(e);o.continue()})}})}const Xm="";function Ym(e,t){const s=new Map;for(const o of e){const e=t(o);for(const t of e){let e=s;for(let s=0;s<t.length;s++){const a=t.charAt(s);let o=e.get(a);o||(o=new Map,e.set(a,o)),e=o}let a=e.get(Xm);a||(a=[],e.set(Xm,a)),a.push(o)}}const a=(e,t)=>{let a=s;for(let s=0;s<e.length;s++){const t=e.charAt(s),o=a.get(t);if(!o)return[];a=o}if(t){const e=a.get(Xm);return e||[]}const o=[],n=[a];while(n.length){const e=n.shift(),t=[...e.entries()].sort((e,t)=>e[0]<t[0]?-1:1);for(const[s,a]of t)s===Xm?o.push(...a):n.push(a)}return o};return a}const Km=["name","url"];function Gm(e){const t=e&&Array.isArray(e),s=t&&e.length&&(!e[0]||Km.some(t=>!(t in e[0])));if(!t||s)throw new Error("Custom emojis are in the wrong format")}function Zm(e){Gm(e);const t=(e,t)=>e.name.toLowerCase()<t.name.toLowerCase()?-1:1,s=e.sort(t),a=e=>[...new Set((e.shortcodes||[]).map(e=>Sm(e)).flat())],o=Ym(e,a),n=e=>o(e,!0),r=e=>o(e,!1),i=e=>{const s=Sm(e),a=s.map((e,t)=>(t<s.length-1?n:r)(e));return jm(a,e=>e.name).sort(t)},l=new Map,c=new Map;for(const m of e){c.set(m.name.toLowerCase(),m);for(const e of m.shortcodes||[])l.set(e.toLowerCase(),m)}const d=e=>l.get(e.toLowerCase()),u=e=>c.get(e.toLowerCase());return{all:s,search:i,byShortcode:d,byName:u}}function Wm(e){if(!e)return e;if(delete e.tokens,e.skinTones){const t=e.skinTones.length;e.skins=Array(t);for(let s=0;s<t;s++)e.skins[s]={tone:e.skinTones[s],unicode:e.skinUnicodes[s],version:e.skinVersions[s]};delete e.skinTones,delete e.skinUnicodes,delete e.skinVersions}return e}function Qm(e){e||console.warn("emoji-picker-element is more efficient if the dataSource server exposes an ETag header.")}const Jm=["annotation","emoji","group","order","tags","version"];function ep(e){if(!e||!Array.isArray(e)||!e[0]||"object"!==typeof e[0]||Jm.some(t=>!(t in e[0])))throw new Error("Emoji data is in the wrong format")}function tp(e,t){if(2!==Math.floor(e.status/100))throw new Error("Failed to fetch: "+t+":  "+e.status)}async function sp(e){const t=await fetch(e,{method:"HEAD"});tp(t,e);const s=t.headers.get("etag");return Qm(s),s}async function ap(e){const t=await fetch(e);tp(t,e);const s=t.headers.get("etag");Qm(s);const a=await t.json();return ep(a),[s,a]}function op(e){var t="",s=new Uint8Array(e),a=s.byteLength,o=-1;while(++o<a)t+=String.fromCharCode(s[o]);return t}function np(e){var t=e.length,s=new ArrayBuffer(t),a=new Uint8Array(s),o=-1;while(++o<t)a[o]=e.charCodeAt(o);return s}async function rp(e){const t=JSON.stringify(e),s=np(t),a=await crypto.subtle.digest("SHA-1",s),o=op(a),n=btoa(o);return n}async function ip(e,t){let s,a=await sp(t);if(!a){const e=await ap(t);a=e[0],s=e[1],a||(a=await rp(s))}if(await Lm(e,t,a));else{if(!s){const e=await ap(t);s=e[1]}await Nm(e,s,t,a)}}async function lp(e,t){let[s,a]=await ap(t);s||(s=await rp(a)),await Nm(e,a,t,s)}class cp{constructor({dataSource:e=lm,locale:t=cm,customEmoji:s=[]}={}){this.dataSource=e,this.locale=t,this._dbName="emoji-picker-element-"+this.locale,this._db=void 0,this._lazyUpdate=void 0,this._custom=Zm(s),this._clear=this._clear.bind(this),this._ready=this._init()}async _init(){const e=this._db=await vm(this._dbName);wm(this._dbName,this._clear);const t=this.dataSource,s=await Im(e);s?await lp(e,t):this._lazyUpdate=ip(e,t)}async ready(){const e=async()=>(this._ready||(this._ready=this._init()),this._ready);await e(),this._db||await e()}async getEmojiByGroup(e){return Uu(e),await this.ready(),um(await Hm(this._db,e)).map(Wm)}async getEmojiBySearchQuery(e){$u(e),await this.ready();const t=this._custom.search(e),s=um(await Fm(this._db,e)).map(Wm);return[...t,...s]}async getEmojiByShortcode(e){$u(e),await this.ready();const t=this._custom.byShortcode(e);return t||Wm(await Dm(this._db,e))}async getEmojiByUnicodeOrName(e){$u(e),await this.ready();const t=this._custom.byName(e);return t||Wm(await $m(this._db,e))}async getPreferredSkinTone(){return await this.ready(),await Um(this._db,Xu,am)||0}async setPreferredSkinTone(e){return Uu(e),await this.ready(),qm(this._db,Xu,am,e)}async incrementFavoriteEmojiCount(e){return $u(e),await this.ready(),Vm(this._db,e)}async getTopFavoriteEmoji(e){return Uu(e),await this.ready(),(await zm(this._db,this._custom,e)).map(Wm)}set customEmoji(e){this._custom=Zm(e)}get customEmoji(){return this._custom.all}async _shutdown(){await this.ready();try{await this._lazyUpdate}catch(e){}}_clear(){this._db=this._ready=this._lazyUpdate=void 0}async close(){await this._shutdown(),await ym(this._dbName)}async delete(){await this._shutdown(),await xm(this._dbName)}}function dp(){}function up(e){return e()}function mp(){return Object.create(null)}function pp(e){e.forEach(up)}function hp(e){return"function"===typeof e}function fp(e,t){return e!=e?t==t:e!==t||e&&"object"===typeof e||"function"===typeof e}let gp,_p;function vp(e,t){return gp||(gp=document.createElement("a")),gp.href=t,e===gp.href}function bp(e){return 0===Object.keys(e).length}function yp(e){return e&&hp(e.destroy)?e.destroy:dp}function xp(e,t){e.appendChild(t)}function wp(e,t,s){e.insertBefore(t,s||null)}function kp(e){e.parentNode.removeChild(e)}function Sp(e){return document.createElement(e)}function Mp(e){return document.createTextNode(e)}function Ap(e,t,s,a){return e.addEventListener(t,s,a),()=>e.removeEventListener(t,s,a)}function Rp(e,t,s){null==s?e.removeAttribute(t):e.getAttribute(t)!==s&&e.setAttribute(t,s)}function Tp(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function Ep(e,t){e.value=null==t?"":t}function Bp(e,t,s,a){null===s?e.style.removeProperty(t):e.style.setProperty(t,s,a?"important":"")}function Op(e){_p=e}const Cp=[],jp=[],Ip=[],Lp=[],Pp=Promise.resolve();let Np=!1;function Hp(){Np||(Np=!0,Pp.then(qp))}function Fp(){return Hp(),Pp}function Dp(e){Ip.push(e)}const $p=new Set;let Up=0;function qp(){const e=_p;do{while(Up<Cp.length){const e=Cp[Up];Up++,Op(e),Vp(e.$$)}Op(null),Cp.length=0,Up=0;while(jp.length)jp.pop()();for(let e=0;e<Ip.length;e+=1){const t=Ip[e];$p.has(t)||($p.add(t),t())}Ip.length=0}while(Cp.length);while(Lp.length)Lp.pop()();Np=!1,$p.clear(),Op(e)}function Vp(e){if(null!==e.fragment){e.update(),pp(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(Dp)}}const zp=new Set;function Xp(e,t){e&&e.i&&(zp.delete(e),e.i(t))}const Yp="undefined"!==typeof window?window:"undefined"!==typeof globalThis?globalThis:e;function Kp(e,t){e.d(1),t.delete(e.key)}function Gp(e,t,s,a,o,n,r,i,l,c,d,u){let m=e.length,p=n.length,h=m;const f={};while(h--)f[e[h].key]=h;const g=[],_=new Map,v=new Map;h=p;while(h--){const e=u(o,n,h),i=s(e);let l=r.get(i);l?a&&l.p(e,t):(l=c(i,e),l.c()),_.set(i,g[h]=l),i in f&&v.set(i,Math.abs(h-f[i]))}const b=new Set,y=new Set;function x(e){Xp(e,1),e.m(i,d),r.set(e.key,e),d=e.first,p--}while(m&&p){const t=g[p-1],s=e[m-1],a=t.key,o=s.key;t===s?(d=t.first,m--,p--):_.has(o)?!r.has(a)||b.has(a)?x(t):y.has(o)?m--:v.get(a)>v.get(o)?(y.add(a),x(t)):(b.add(o),m--):(l(s,r),m--)}while(m--){const t=e[m];_.has(t.key)||l(t,r)}while(p)x(g[p-1]);return g}function Zp(e,t,s,a){const{fragment:o,on_mount:n,on_destroy:r,after_update:i}=e.$$;o&&o.m(t,s),a||Dp(()=>{const t=n.map(up).filter(hp);r?r.push(...t):pp(t),e.$$.on_mount=[]}),i.forEach(Dp)}function Wp(e,t){const s=e.$$;null!==s.fragment&&(pp(s.on_destroy),s.fragment&&s.fragment.d(t),s.on_destroy=s.fragment=null,s.ctx=[])}function Qp(e,t){-1===e.$$.dirty[0]&&(Cp.push(e),Hp(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function Jp(e,t,s,a,o,n,r,i=[-1]){const l=_p;Op(e);const c=e.$$={fragment:null,ctx:null,props:n,update:dp,not_equal:o,bound:mp(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(l?l.$$.context:[]),callbacks:mp(),dirty:i,skip_bound:!1,root:t.target||l.$$.root};r&&r(c.root);let d=!1;c.ctx=s?s(e,t.props||{},(t,s,...a)=>{const n=a.length?a[0]:s;return c.ctx&&o(c.ctx[t],c.ctx[t]=n)&&(!c.skip_bound&&c.bound[t]&&c.bound[t](n),d&&Qp(e,t)),s}):[],c.update(),d=!0,pp(c.before_update),c.fragment=!!a&&a(c.ctx),t.target&&(c.fragment&&c.fragment.c(),Zp(e,t.target,void 0,void 0),qp()),Op(l)}class eh{$destroy(){Wp(this,1),this.$destroy=dp}$on(e,t){const s=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return s.push(t),()=>{const e=s.indexOf(t);-1!==e&&s.splice(e,1)}}$set(e){this.$$set&&!bp(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const th=[[-1,"✨","custom"],[0,"😀","smileys-emotion"],[1,"👋","people-body"],[3,"🐱","animals-nature"],[4,"🍎","food-drink"],[5,"🏠️","travel-places"],[6,"⚽","activities"],[7,"📝","objects"],[8,"⛔️","symbols"],[9,"🏁","flags"]].map(([e,t,s])=>({id:e,emoji:t,name:s})),sh=th.slice(1),ah=th[0],oh=2,nh=6,rh="function"===typeof requestIdleCallback?requestIdleCallback:setTimeout;function ih(e){return e.unicode.includes("‍")}const lh={"🫠":14,"🥲":13.1,"🥻":12.1,"🥰":11,"🤩":5,"👱‍♀️":4,"🤣":3,"👁️‍🗨️":2,"😀":1,"😐️":.7,"😃":.6},ch=1e3,dh="🖐️",uh=8,mh=["😊","😒","♥️","👍️","😍","😂","😭","☺️","😔","😩","😏","💕","🙌","😘"],ph='"Twemoji Mozilla","Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji","EmojiOne Color","Android Emoji",sans-serif',hh=(e,t)=>e<t?-1:e>t?1:0,fh=(e,t)=>{const s=document.createElement("canvas");s.width=s.height=1;const a=s.getContext("2d");return a.textBaseline="top",a.font="100px "+ph,a.fillStyle=t,a.scale(.01,.01),a.fillText(e,0,0),a.getImageData(0,0,1,1).data},gh=(e,t)=>{const s=[...e].join(","),a=[...t].join(",");return s===a&&!s.startsWith("0,0,0,")};function _h(e){const t=fh(e,"#000"),s=fh(e,"#fff");return t&&s&&gh(t,s)}function vh(){const e=Object.entries(lh);try{for(const[t,s]of e)if(_h(t))return s}catch(t){}return e[0][1]}const bh=new Promise(e=>rh(()=>e(vh()))),yh=new Map,xh="️",wh="\ud83c",kh="‍",Sh=127995,Mh=57339;function Ah(e,t){if(0===t)return e;const s=e.indexOf(kh);return-1!==s?e.substring(0,s)+String.fromCodePoint(Sh+t-1)+e.substring(s):(e.endsWith(xh)&&(e=e.substring(0,e.length-1)),e+wh+String.fromCodePoint(Mh+t-1))}function Rh(e){e.preventDefault(),e.stopPropagation()}function Th(e,t,s){return t+=e?-1:1,t<0?t=s.length-1:t>=s.length&&(t=0),t}function Eh(e,t){const s=new Set,a=[];for(const o of e){const e=t(o);s.has(e)||(s.add(e),a.push(o))}return a}function Bh(e,t){const s=e=>{const s={};for(const a of e)"number"===typeof a.tone&&a.version<=t&&(s[a.tone]=a.unicode);return s};return e.map(({unicode:e,skins:t,shortcodes:a,url:o,name:n,category:r})=>({unicode:e,name:n,shortcodes:a,url:o,category:r,id:e||n,skins:t&&s(t),title:(a||[]).join(", ")}))}const Oh=requestAnimationFrame;let Ch,jh="function"===typeof ResizeObserver;function Ih(e,t){let s;return jh?(s=new ResizeObserver(e=>t(e[0].contentRect.width)),s.observe(e)):Oh(()=>t(e.getBoundingClientRect().width)),{destroy(){s&&s.disconnect()}}}function Lh(e){{const t=document.createRange();return t.selectNode(e.firstChild),t.getBoundingClientRect().width}}function Ph(e,t,s){for(const a of e){const e=s(a),o=Lh(e);"undefined"===typeof Ch&&(Ch=Lh(t));const n=o/1.8<Ch;yh.set(a.unicode,n)}}function Nh(e){return Eh(e,e=>e)}const{Map:Hh}=Yp;function Fh(e,t,s){const a=e.slice();return a[63]=t[s],a[65]=s,a}function Dh(e,t,s){const a=e.slice();return a[66]=t[s],a[65]=s,a}function $h(e,t,s){const a=e.slice();return a[63]=t[s],a[65]=s,a}function Uh(e,t,s){const a=e.slice();return a[69]=t[s],a}function qh(e,t,s){const a=e.slice();return a[72]=t[s],a[65]=s,a}function Vh(e,t){let s,a,o,n,r,i,l,c=t[72]+"";return{key:e,first:null,c(){s=Sp("div"),a=Mp(c),Rp(s,"id",o="skintone-"+t[65]),Rp(s,"class",n="emoji hide-focus "+(t[65]===t[20]?"active":"")),Rp(s,"aria-selected",r=t[65]===t[20]),Rp(s,"role","option"),Rp(s,"title",i=t[0].skinTones[t[65]]),Rp(s,"tabindex","-1"),Rp(s,"aria-label",l=t[0].skinTones[t[65]]),this.first=s},m(e,t){wp(e,s,t),xp(s,a)},p(e,d){t=e,512&d[0]&&c!==(c=t[72]+"")&&Tp(a,c),512&d[0]&&o!==(o="skintone-"+t[65])&&Rp(s,"id",o),1049088&d[0]&&n!==(n="emoji hide-focus "+(t[65]===t[20]?"active":""))&&Rp(s,"class",n),1049088&d[0]&&r!==(r=t[65]===t[20])&&Rp(s,"aria-selected",r),513&d[0]&&i!==(i=t[0].skinTones[t[65]])&&Rp(s,"title",i),513&d[0]&&l!==(l=t[0].skinTones[t[65]])&&Rp(s,"aria-label",l)},d(e){e&&kp(s)}}}function zh(e,t){let s,a,o,n,r,i,l,c,d,u=t[69].emoji+"";function m(){return t[49](t[69])}return{key:e,first:null,c(){s=Sp("button"),a=Sp("div"),o=Mp(u),Rp(a,"class","nav-emoji emoji"),Rp(s,"role","tab"),Rp(s,"class","nav-button"),Rp(s,"aria-controls",n="tab-"+t[69].id),Rp(s,"aria-label",r=t[0].categories[t[69].name]),Rp(s,"aria-selected",i=!t[4]&&t[13].id===t[69].id),Rp(s,"title",l=t[0].categories[t[69].name]),this.first=s},m(e,t){wp(e,s,t),xp(s,a),xp(a,o),c||(d=Ap(s,"click",m),c=!0)},p(e,a){t=e,4096&a[0]&&u!==(u=t[69].emoji+"")&&Tp(o,u),4096&a[0]&&n!==(n="tab-"+t[69].id)&&Rp(s,"aria-controls",n),4097&a[0]&&r!==(r=t[0].categories[t[69].name])&&Rp(s,"aria-label",r),12304&a[0]&&i!==(i=!t[4]&&t[13].id===t[69].id)&&Rp(s,"aria-selected",i),4097&a[0]&&l!==(l=t[0].categories[t[69].name])&&Rp(s,"title",l)},d(e){e&&kp(s),c=!1,d()}}}function Xh(e){let t,s;return{c(){t=Sp("img"),Rp(t,"class","custom-emoji"),vp(t.src,s=e[63].url)||Rp(t,"src",s),Rp(t,"alt",""),Rp(t,"loading","lazy")},m(e,s){wp(e,t,s)},p(e,a){32768&a[0]&&!vp(t.src,s=e[63].url)&&Rp(t,"src",s)},d(e){e&&kp(t)}}}function Yh(e){let t,s=e[27](e[63],e[8])+"";return{c(){t=Mp(s)},m(e,s){wp(e,t,s)},p(e,a){33024&a[0]&&s!==(s=e[27](e[63],e[8])+"")&&Tp(t,s)},d(e){e&&kp(t)}}}function Kh(e,t){let s,a,o,n,r,i,l;function c(e,t){return e[63].unicode?Yh:Xh}let d=c(t),u=d(t);return{key:e,first:null,c(){s=Sp("button"),u.c(),Rp(s,"role",a=t[4]?"option":"menuitem"),Rp(s,"aria-selected",o=t[4]?t[65]==t[5]:""),Rp(s,"aria-label",n=t[28](t[63],t[8])),Rp(s,"title",r=t[63].title),Rp(s,"class",i="emoji "+(t[4]&&t[65]===t[5]?"active":"")),Rp(s,"id",l="emo-"+t[63].id),this.first=s},m(e,t){wp(e,s,t),u.m(s,null)},p(e,m){t=e,d===(d=c(t))&&u?u.p(t,m):(u.d(1),u=d(t),u&&(u.c(),u.m(s,null))),16&m[0]&&a!==(a=t[4]?"option":"menuitem")&&Rp(s,"role",a),32816&m[0]&&o!==(o=t[4]?t[65]==t[5]:"")&&Rp(s,"aria-selected",o),33024&m[0]&&n!==(n=t[28](t[63],t[8]))&&Rp(s,"aria-label",n),32768&m[0]&&r!==(r=t[63].title)&&Rp(s,"title",r),32816&m[0]&&i!==(i="emoji "+(t[4]&&t[65]===t[5]?"active":""))&&Rp(s,"class",i),32768&m[0]&&l!==(l="emo-"+t[63].id)&&Rp(s,"id",l)},d(e){e&&kp(s),u.d()}}}function Gh(e,t){let s,a,o,n,r,i,l,c,d=(t[4]?t[0].searchResultsLabel:t[66].category?t[66].category:t[15].length>1?t[0].categories.custom:t[0].categories[t[13].name])+"",u=[],m=new Hh,p=t[66].emojis;const h=e=>e[63].id;for(let f=0;f<p.length;f+=1){let e=$h(t,p,f),s=h(e);m.set(s,u[f]=Kh(s,e))}return{key:e,first:null,c(){s=Sp("div"),a=Mp(d),r=Sp("div");for(let e=0;e<u.length;e+=1)u[e].c();Rp(s,"id",o="menu-label-"+t[65]),Rp(s,"class",n="category "+(1===t[15].length&&""===t[15][0].category?"gone":"")),Rp(s,"aria-hidden","true"),Rp(r,"class","emoji-menu"),Rp(r,"role",i=t[4]?"listbox":"menu"),Rp(r,"aria-labelledby",l="menu-label-"+t[65]),Rp(r,"id",c=t[4]?"search-results":""),this.first=s},m(e,t){wp(e,s,t),xp(s,a),wp(e,r,t);for(let s=0;s<u.length;s+=1)u[s].m(r,null)},p(e,f){t=e,40977&f[0]&&d!==(d=(t[4]?t[0].searchResultsLabel:t[66].category?t[66].category:t[15].length>1?t[0].categories.custom:t[0].categories[t[13].name])+"")&&Tp(a,d),32768&f[0]&&o!==(o="menu-label-"+t[65])&&Rp(s,"id",o),32768&f[0]&&n!==(n="category "+(1===t[15].length&&""===t[15][0].category?"gone":""))&&Rp(s,"class",n),402686256&f[0]&&(p=t[66].emojis,u=Gp(u,f,h,1,t,p,m,r,Kp,Kh,null,$h)),16&f[0]&&i!==(i=t[4]?"listbox":"menu")&&Rp(r,"role",i),32768&f[0]&&l!==(l="menu-label-"+t[65])&&Rp(r,"aria-labelledby",l),16&f[0]&&c!==(c=t[4]?"search-results":"")&&Rp(r,"id",c)},d(e){e&&kp(s),e&&kp(r);for(let t=0;t<u.length;t+=1)u[t].d()}}}function Zh(e){let t,s;return{c(){t=Sp("img"),Rp(t,"class","custom-emoji"),vp(t.src,s=e[63].url)||Rp(t,"src",s),Rp(t,"alt",""),Rp(t,"loading","lazy")},m(e,s){wp(e,t,s)},p(e,a){1024&a[0]&&!vp(t.src,s=e[63].url)&&Rp(t,"src",s)},d(e){e&&kp(t)}}}function Wh(e){let t,s=e[27](e[63],e[8])+"";return{c(){t=Mp(s)},m(e,s){wp(e,t,s)},p(e,a){1280&a[0]&&s!==(s=e[27](e[63],e[8])+"")&&Tp(t,s)},d(e){e&&kp(t)}}}function Qh(e,t){let s,a,o,n;function r(e,t){return e[63].unicode?Wh:Zh}let i=r(t),l=i(t);return{key:e,first:null,c(){s=Sp("button"),l.c(),Rp(s,"role","menuitem"),Rp(s,"aria-label",a=t[28](t[63],t[8])),Rp(s,"title",o=t[63].title),Rp(s,"class","emoji"),Rp(s,"id",n="fav-"+t[63].id),this.first=s},m(e,t){wp(e,s,t),l.m(s,null)},p(e,c){t=e,i===(i=r(t))&&l?l.p(t,c):(l.d(1),l=i(t),l&&(l.c(),l.m(s,null))),1280&c[0]&&a!==(a=t[28](t[63],t[8]))&&Rp(s,"aria-label",a),1024&c[0]&&o!==(o=t[63].title)&&Rp(s,"title",o),1024&c[0]&&n!==(n="fav-"+t[63].id)&&Rp(s,"id",n)},d(e){e&&kp(s),l.d()}}}function Jh(e){let t,s,a,o,n,r,i,l,c,d,u,m,p,h,f,g,_,v,b,y,x,w,k,S,M,A,R,T,E,B,O,C,j,I,L,P,N,H,F,D,$,U,q,V,z=e[0].searchLabel+"",X=e[0].searchDescription+"",Y=e[0].skinToneDescription+"",K=[],G=new Hh,Z=[],W=new Hh,Q=[],J=new Hh,ee=[],te=new Hh,se=e[9];const ae=e=>e[72];for(let de=0;de<se.length;de+=1){let t=qh(e,se,de),s=ae(t);G.set(s,K[de]=Vh(s,t))}let oe=e[12];const ne=e=>e[69].id;for(let de=0;de<oe.length;de+=1){let t=Uh(e,oe,de),s=ne(t);W.set(s,Z[de]=zh(s,t))}let re=e[15];const ie=e=>e[66].category;for(let de=0;de<re.length;de+=1){let t=Dh(e,re,de),s=ie(t);J.set(s,Q[de]=Gh(s,t))}let le=e[10];const ce=e=>e[63].id;for(let de=0;de<le.length;de+=1){let t=Fh(e,le,de),s=ce(t);te.set(s,ee[de]=Qh(s,t))}return{c(){t=Sp("section"),s=Sp("div"),a=Sp("div"),o=Sp("div"),n=Sp("input"),c=Sp("label"),d=Mp(z),u=Sp("span"),m=Mp(X),p=Sp("div"),h=Sp("button"),f=Mp(e[21]),v=Sp("span"),b=Mp(Y),y=Sp("div");for(let e=0;e<K.length;e+=1)K[e].c();M=Sp("div");for(let e=0;e<Z.length;e+=1)Z[e].c();R=Sp("div"),T=Sp("div"),E=Sp("div"),B=Mp(e[18]),C=Sp("div"),j=Sp("div");for(let e=0;e<Q.length;e+=1)Q[e].c();H=Sp("div");for(let e=0;e<ee.length;e+=1)ee[e].c();$=Sp("button"),$.textContent="😀",Rp(s,"class","pad-top"),Rp(n,"id","search"),Rp(n,"class","search"),Rp(n,"type","search"),Rp(n,"role","combobox"),Rp(n,"enterkeyhint","search"),Rp(n,"placeholder",r=e[0].searchLabel),Rp(n,"autocapitalize","none"),Rp(n,"autocomplete","off"),Rp(n,"spellcheck","true"),Rp(n,"aria-expanded",i=!(!e[4]||!e[1].length)),Rp(n,"aria-controls","search-results"),Rp(n,"aria-describedby","search-description"),Rp(n,"aria-autocomplete","list"),Rp(n,"aria-activedescendant",l=e[26]?"emo-"+e[26]:""),Rp(c,"class","sr-only"),Rp(c,"for","search"),Rp(u,"id","search-description"),Rp(u,"class","sr-only"),Rp(o,"class","search-wrapper"),Rp(h,"id","skintone-button"),Rp(h,"class",g="emoji "+(e[6]?"hide-focus":"")),Rp(h,"aria-label",e[23]),Rp(h,"title",e[23]),Rp(h,"aria-describedby","skintone-description"),Rp(h,"aria-haspopup","listbox"),Rp(h,"aria-expanded",e[6]),Rp(h,"aria-controls","skintone-list"),Rp(p,"class",_="skintone-button-wrapper "+(e[19]?"expanded":"")),Rp(v,"id","skintone-description"),Rp(v,"class","sr-only"),Rp(y,"id","skintone-list"),Rp(y,"class",x="skintone-list "+(e[6]?"":"hidden no-animate")),Bp(y,"transform","translateY("+(e[6]?0:"calc(-1 * var(--num-skintones) * var(--total-emoji-size))")+")"),Rp(y,"role","listbox"),Rp(y,"aria-label",w=e[0].skinTonesLabel),Rp(y,"aria-activedescendant",k="skintone-"+e[20]),Rp(y,"aria-hidden",S=!e[6]),Rp(a,"class","search-row"),Rp(M,"class","nav"),Rp(M,"role","tablist"),Bp(M,"grid-template-columns","repeat("+e[12].length+", 1fr)"),Rp(M,"aria-label",A=e[0].categoriesLabel),Rp(T,"class","indicator"),Bp(T,"transform","translateX("+(e[24]?-1:1)*e[11]*100+"%)"),Rp(R,"class","indicator-wrapper"),Rp(E,"class",O="message "+(e[18]?"":"gone")),Rp(E,"role","alert"),Rp(E,"aria-live","polite"),Rp(C,"class",I="tabpanel "+(!e[14]||e[18]?"gone":"")),Rp(C,"role",L=e[4]?"region":"tabpanel"),Rp(C,"aria-label",P=e[4]?e[0].searchResultsLabel:e[0].categories[e[13].name]),Rp(C,"id",N=e[4]?"":"tab-"+e[13].id),Rp(C,"tabindex","0"),Rp(H,"class",F="favorites emoji-menu "+(e[18]?"gone":"")),Rp(H,"role","menu"),Rp(H,"aria-label",D=e[0].favoritesLabel),Bp(H,"padding-inline-end",e[25]+"px"),Rp($,"aria-hidden","true"),Rp($,"tabindex","-1"),Rp($,"class","abs-pos hidden emoji"),Rp(t,"class","picker"),Rp(t,"aria-label",U=e[0].regionLabel),Rp(t,"style",e[22])},m(r,i){wp(r,t,i),xp(t,s),xp(t,a),xp(a,o),xp(o,n),Ep(n,e[2]),xp(o,c),xp(c,d),xp(o,u),xp(u,m),xp(a,p),xp(p,h),xp(h,f),xp(a,v),xp(v,b),xp(a,y);for(let e=0;e<K.length;e+=1)K[e].m(y,null);e[48](y),xp(t,M);for(let e=0;e<Z.length;e+=1)Z[e].m(M,null);xp(t,R),xp(R,T),xp(t,E),xp(E,B),xp(t,C),xp(C,j);for(let e=0;e<Q.length;e+=1)Q[e].m(j,null);e[50](C),xp(t,H);for(let e=0;e<ee.length;e+=1)ee[e].m(H,null);xp(t,$),e[51]($),e[52](t),q||(V=[Ap(n,"input",e[47]),Ap(n,"keydown",e[30]),Ap(h,"click",e[35]),Ap(y,"focusout",e[38]),Ap(y,"click",e[34]),Ap(y,"keydown",e[36]),Ap(y,"keyup",e[37]),Ap(M,"keydown",e[32]),yp(e[29].call(null,j)),Ap(C,"click",e[33]),Ap(H,"click",e[33])],q=!0)},p(e,s){1&s[0]&&r!==(r=e[0].searchLabel)&&Rp(n,"placeholder",r),18&s[0]&&i!==(i=!(!e[4]||!e[1].length))&&Rp(n,"aria-expanded",i),67108864&s[0]&&l!==(l=e[26]?"emo-"+e[26]:"")&&Rp(n,"aria-activedescendant",l),4&s[0]&&Ep(n,e[2]),1&s[0]&&z!==(z=e[0].searchLabel+"")&&Tp(d,z),1&s[0]&&X!==(X=e[0].searchDescription+"")&&Tp(m,X),2097152&s[0]&&Tp(f,e[21]),64&s[0]&&g!==(g="emoji "+(e[6]?"hide-focus":""))&&Rp(h,"class",g),8388608&s[0]&&Rp(h,"aria-label",e[23]),8388608&s[0]&&Rp(h,"title",e[23]),64&s[0]&&Rp(h,"aria-expanded",e[6]),524288&s[0]&&_!==(_="skintone-button-wrapper "+(e[19]?"expanded":""))&&Rp(p,"class",_),1&s[0]&&Y!==(Y=e[0].skinToneDescription+"")&&Tp(b,Y),1049089&s[0]&&(se=e[9],K=Gp(K,s,ae,1,e,se,G,y,Kp,Vh,null,qh)),64&s[0]&&x!==(x="skintone-list "+(e[6]?"":"hidden no-animate"))&&Rp(y,"class",x),64&s[0]&&Bp(y,"transform","translateY("+(e[6]?0:"calc(-1 * var(--num-skintones) * var(--total-emoji-size))")+")"),1&s[0]&&w!==(w=e[0].skinTonesLabel)&&Rp(y,"aria-label",w),1048576&s[0]&&k!==(k="skintone-"+e[20])&&Rp(y,"aria-activedescendant",k),64&s[0]&&S!==(S=!e[6])&&Rp(y,"aria-hidden",S),12305&s[0]|1&s[1]&&(oe=e[12],Z=Gp(Z,s,ne,1,e,oe,W,M,Kp,zh,null,Uh)),4096&s[0]&&Bp(M,"grid-template-columns","repeat("+e[12].length+", 1fr)"),1&s[0]&&A!==(A=e[0].categoriesLabel)&&Rp(M,"aria-label",A),16779264&s[0]&&Bp(T,"transform","translateX("+(e[24]?-1:1)*e[11]*100+"%)"),262144&s[0]&&Tp(B,e[18]),262144&s[0]&&O!==(O="message "+(e[18]?"":"gone"))&&Rp(E,"class",O),402694449&s[0]&&(re=e[15],Q=Gp(Q,s,ie,1,e,re,J,j,Kp,Gh,null,Dh)),278528&s[0]&&I!==(I="tabpanel "+(!e[14]||e[18]?"gone":""))&&Rp(C,"class",I),16&s[0]&&L!==(L=e[4]?"region":"tabpanel")&&Rp(C,"role",L),8209&s[0]&&P!==(P=e[4]?e[0].searchResultsLabel:e[0].categories[e[13].name])&&Rp(C,"aria-label",P),8208&s[0]&&N!==(N=e[4]?"":"tab-"+e[13].id)&&Rp(C,"id",N),402654464&s[0]&&(le=e[10],ee=Gp(ee,s,ce,1,e,le,te,H,Kp,Qh,null,Fh)),262144&s[0]&&F!==(F="favorites emoji-menu "+(e[18]?"gone":""))&&Rp(H,"class",F),1&s[0]&&D!==(D=e[0].favoritesLabel)&&Rp(H,"aria-label",D),33554432&s[0]&&Bp(H,"padding-inline-end",e[25]+"px"),1&s[0]&&U!==(U=e[0].regionLabel)&&Rp(t,"aria-label",U),4194304&s[0]&&Rp(t,"style",e[22])},i:dp,o:dp,d(s){s&&kp(t);for(let e=0;e<K.length;e+=1)K[e].d();e[48](null);for(let e=0;e<Z.length;e+=1)Z[e].d();for(let e=0;e<Q.length;e+=1)Q[e].d();e[50](null);for(let e=0;e<ee.length;e+=1)ee[e].d();e[51](null),e[52](null),q=!1,pp(V)}}}function ef(e,t,s){let a,o,n,r,i,l,c,d,u,m,{skinToneEmoji:p}=t,{i18n:h}=t,{database:f}=t,{customEmoji:g}=t,{customCategorySorting:_}=t,v=!0,b=[],y=[],x="",w="",k=!1,S=-1,M=!1,A=!1,R=0,T=0,E="",B=[],O=[],C=uh,j=!1,I=0,L=0,P=sh,N=!1;const H=e=>{a.getRootNode().getElementById(e).focus()},F=(e,t)=>{a.dispatchEvent(new CustomEvent(e,{detail:t,bubbles:!0,composed:!0}))},D=(e,t)=>t&&e.skins&&e.skins[t]||e.unicode,$=(e,t)=>Nh([e.name||D(e,t),...e.shortcodes||[]]).join(", "),U=e=>/^skintone-/.test(e.id);function q(e){return Ih(e,t=>{{const o=getComputedStyle(a),n=parseInt(o.getPropertyValue("--num-columns"),10),r="rtl"===o.getPropertyValue("direction"),i=e.parentElement.getBoundingClientRect().width,l=i-t;s(46,C=n),s(25,I=l),s(24,j=r)}})}function V(e){const t=a.getRootNode(),n=e=>t.getElementById("emo-"+e.id);Ph(e,o,n),s(1,b=b)}function z(e){return!e.unicode||!ih(e)||yh.get(e.unicode)}async function X(e){const t=await bh;return e.filter(({version:e})=>!e||e<=t)}async function Y(e){return Bh(e,await bh)}async function K(e){if("undefined"===typeof e)return[];const t=-1===e?g:await f.getEmojiByGroup(e);return Y(await X(t))}async function G(e){return Y(await X(await f.getEmojiBySearchQuery(e)))}function Z(e){if(!k||!b.length)return;const t=t=>{Rh(e),s(5,S=Th(t,S,b))};switch(e.key){case"ArrowDown":return t(!1);case"ArrowUp":return t(!0);case"Enter":if(-1!==S)return Rh(e),J(b[S].id);b.length&&s(5,S=0)}}function W(e){s(2,x=""),s(44,w=""),s(5,S=-1),s(11,L=P.findIndex(t=>t.id===e.id))}function Q(e){const{target:t,key:s}=e,a=t=>{t&&(Rh(e),t.focus())};switch(s){case"ArrowLeft":return a(t.previousSibling);case"ArrowRight":return a(t.nextSibling);case"Home":return a(t.parentElement.firstChild);case"End":return a(t.parentElement.lastChild)}}async function J(e){const t=await f.getEmojiByUnicodeOrName(e),s=[...b,...O].find(t=>t.id===e),a=s.unicode&&D(s,R);await f.incrementFavoriteEmojiCount(e),F("emoji-click",{emoji:t,skinTone:R,...a&&{unicode:a},...s.name&&{name:s.name}})}async function ee(e){const{target:t}=e;if(!t.classList.contains("emoji"))return;Rh(e);const s=t.id.substring(4);J(s)}async function te(e){const{target:t}=e;if(!U(t))return;Rh(e);const a=parseInt(t.id.slice(9),10);s(8,R=a),s(6,M=!1),H("skintone-button"),F("skin-tone-change",{skinTone:a}),f.setPreferredSkinTone(a)}async function se(e){s(6,M=!M),s(20,T=R),M&&(Rh(e),Oh(()=>H("skintone-"+T)))}function ae(e){if(!M)return;const t=async t=>{Rh(e),s(20,T=t),await Fp(),H("skintone-"+T)};switch(e.key){case"ArrowUp":return t(Th(!0,T,B));case"ArrowDown":return t(Th(!1,T,B));case"Home":return t(0);case"End":return t(B.length-1);case"Enter":return te(e);case"Escape":return Rh(e),s(6,M=!1),H("skintone-button")}}function oe(e){if(M)switch(e.key){case" ":return te(e)}}async function ne(e){const{relatedTarget:t}=e;t&&U(t)||s(6,M=!1)}function re(){x=this.value,s(2,x)}function ie(e){jp[e?"unshift":"push"](()=>{i=e,s(7,i)})}bh.then(e=>{e||s(18,r=h.emojiUnsupportedMessage)});const le=e=>W(e);function ce(e){jp[e?"unshift":"push"](()=>{n=e,s(3,n)})}function de(e){jp[e?"unshift":"push"](()=>{o=e,s(17,o)})}function ue(e){jp[e?"unshift":"push"](()=>{a=e,s(16,a)})}return e.$$set=e=>{"skinToneEmoji"in e&&s(40,p=e.skinToneEmoji),"i18n"in e&&s(0,h=e.i18n),"database"in e&&s(39,f=e.database),"customEmoji"in e&&s(41,g=e.customEmoji),"customCategorySorting"in e&&s(42,_=e.customCategorySorting)},e.$$.update=()=>{if(1280&e.$$.dirty[1]&&g&&f&&s(39,f.customEmoji=g,f),1&e.$$.dirty[0]|256&e.$$.dirty[1]){async function t(){let e=!1;const t=setTimeout(()=>{e=!0,s(18,r=h.loadingMessage)},ch);try{await f.ready(),s(14,N=!0)}catch(a){console.error(a),s(18,r=h.networkErrorMessage)}finally{clearTimeout(t),e&&(e=!1,s(18,r=""))}}f&&t()}if(6144&e.$$.dirty[0]|1024&e.$$.dirty[1]&&(g&&g.length?s(12,P=[ah,...sh]):P!==sh&&(L&&s(11,L--,L),s(12,P=sh))),4&e.$$.dirty[0]&&rh(()=>{s(44,w=(x||"").trim()),s(5,S=-1)}),6144&e.$$.dirty[0]&&s(13,u=P[L]),24576&e.$$.dirty[0]|8192&e.$$.dirty[1]){async function a(){if(N){if(w.length>=oh){const e=w,t=await G(e);e===w&&(s(1,b=t),s(4,k=!0))}else if(u){const e=u.id,t=await K(e);e===u.id&&(s(1,b=t),s(4,k=!1))}}else s(1,b=[]),s(4,k=!1)}a()}if(4112&e.$$.dirty[0]&&s(22,c=`\n  --font-family: ${ph};\n  --num-groups: ${P.length}; \n  --indicator-opacity: ${k?0:1}; \n  --num-skintones: ${nh};`),16384&e.$$.dirty[0]|256&e.$$.dirty[1]){async function o(){N&&s(8,R=await f.getPreferredSkinTone())}o()}if(512&e.$$.dirty[1]&&s(9,B=Array(nh).fill().map((e,t)=>Ah(p,t))),768&e.$$.dirty[0]&&s(21,l=B[R]),257&e.$$.dirty[0]&&s(23,E=h.skinToneLabel.replace("{skinTone}",h.skinTones[R])),16384&e.$$.dirty[0]|256&e.$$.dirty[1]){async function v(){s(45,d=(await Promise.all(mh.map(e=>f.getEmojiByUnicodeOrName(e)))).filter(Boolean))}N&&v()}if(16384&e.$$.dirty[0]|49408&e.$$.dirty[1]){async function T(){const e=await f.getTopFavoriteEmoji(C),t=await Y(Eh([...e,...d],e=>e.unicode||e.name).slice(0,C));s(10,O=t)}N&&d&&T()}if(10&e.$$.dirty[0]){const e=b.filter(e=>e.unicode).filter(e=>ih(e)&&!yh.has(e.unicode));e.length?Oh(()=>V(e)):(s(1,b=b.filter(z)),Oh(()=>{(n||{}).scrollTop=0}))}if(e.$$.dirty[0],e.$$.dirty[1],18&e.$$.dirty[0]|2048&e.$$.dirty[1]){let e=function(){if(k)return[{category:"",emojis:b}];const e=new Map;for(const t of b){const s=t.category||"";let a=e.get(s);a||(a=[],e.set(s,a)),a.push(t)}return[...e.entries()].map(([e,t])=>({category:e,emojis:t})).sort((e,t)=>_(e.category,t.category))};s(15,y=e())}34&e.$$.dirty[0]&&s(26,m=-1!==S&&b[S].id),192&e.$$.dirty[0]&&(M?i.addEventListener("transitionend",()=>{s(19,A=!0)},{once:!0}):s(19,A=!1))},[h,b,x,n,k,S,M,i,R,B,O,L,P,u,N,y,a,o,r,A,T,l,c,E,j,I,m,D,$,q,Z,W,Q,ee,te,se,ae,oe,ne,f,p,g,_,v,w,d,C,re,ie,le,ce,de,ue]}class tf extends eh{constructor(e){super(),Jp(this,e,ef,Jh,fp,{skinToneEmoji:40,i18n:0,database:39,customEmoji:41,customCategorySorting:42},null,[-1,-1,-1])}}const sf="https://cdn.jsdelivr.net/npm/emoji-picker-element-data@^1/en/emojibase/data.json",af="en";var of={categoriesLabel:"Categories",emojiUnsupportedMessage:"Your browser does not support color emoji.",favoritesLabel:"Favorites",loadingMessage:"Loading…",networkErrorMessage:"Could not load emoji.",regionLabel:"Emoji picker",searchDescription:"When search results are available, press up or down to select and enter to choose.",searchLabel:"Search",searchResultsLabel:"Search results",skinToneDescription:"When expanded, press up or down to select and enter to choose.",skinToneLabel:"Choose a skin tone (currently {skinTone})",skinTonesLabel:"Skin tones",skinTones:["Default","Light","Medium-Light","Medium","Medium-Dark","Dark"],categories:{custom:"Custom","smileys-emotion":"Smileys and emoticons","people-body":"People and body","animals-nature":"Animals and nature","food-drink":"Food and drink","travel-places":"Travel and places",activities:"Activities",objects:"Objects",symbols:"Symbols",flags:"Flags"}};const nf=["customEmoji","customCategorySorting","database","dataSource","i18n","locale","skinToneEmoji"];class rf extends HTMLElement{constructor(e){super(),this.attachShadow({mode:"open"});const t=document.createElement("style");t.textContent=":host{--emoji-size:1.375rem;--emoji-padding:0.5rem;--category-emoji-size:var(--emoji-size);--category-emoji-padding:var(--emoji-padding);--indicator-height:3px;--input-border-radius:0.5rem;--input-border-size:1px;--input-font-size:1rem;--input-line-height:1.5;--input-padding:0.25rem;--num-columns:8;--outline-size:2px;--border-size:1px;--skintone-border-radius:1rem;--category-font-size:1rem;display:flex;width:min-content;height:400px}:host,:host(.light){--background:#fff;--border-color:#e0e0e0;--indicator-color:#385ac1;--input-border-color:#999;--input-font-color:#111;--input-placeholder-color:#999;--outline-color:#999;--category-font-color:#111;--button-active-background:#e6e6e6;--button-hover-background:#d9d9d9}:host(.dark){--background:#222;--border-color:#444;--indicator-color:#5373ec;--input-border-color:#ccc;--input-font-color:#efefef;--input-placeholder-color:#ccc;--outline-color:#fff;--category-font-color:#efefef;--button-active-background:#555555;--button-hover-background:#484848}@media (prefers-color-scheme:dark){:host{--background:#222;--border-color:#444;--indicator-color:#5373ec;--input-border-color:#ccc;--input-font-color:#efefef;--input-placeholder-color:#ccc;--outline-color:#fff;--category-font-color:#efefef;--button-active-background:#555555;--button-hover-background:#484848}}:host([hidden]){display:none}button{margin:0;padding:0;border:0;background:0 0;box-shadow:none;-webkit-tap-highlight-color:transparent}button::-moz-focus-inner{border:0}input{padding:0;margin:0;line-height:1.15;font-family:inherit}input[type=search]{-webkit-appearance:none}:focus{outline:var(--outline-color) solid var(--outline-size);outline-offset:calc(-1*var(--outline-size))}:host([data-js-focus-visible]) :focus:not([data-focus-visible-added]){outline:0}:focus:not(:focus-visible){outline:0}.hide-focus{outline:0}*{box-sizing:border-box}.picker{contain:content;display:flex;flex-direction:column;background:var(--background);border:var(--border-size) solid var(--border-color);width:100%;height:100%;overflow:hidden;--total-emoji-size:calc(var(--emoji-size) + (2 * var(--emoji-padding)));--total-category-emoji-size:calc(var(--category-emoji-size) + (2 * var(--category-emoji-padding)))}.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.hidden{opacity:0;pointer-events:none}.abs-pos{position:absolute;left:0;top:0}.gone{display:none!important}.skintone-button-wrapper,.skintone-list{background:var(--background);z-index:3}.skintone-button-wrapper.expanded{z-index:1}.skintone-list{position:absolute;inset-inline-end:0;top:0;z-index:2;overflow:visible;border-bottom:var(--border-size) solid var(--border-color);border-radius:0 0 var(--skintone-border-radius) var(--skintone-border-radius);will-change:transform;transition:transform .2s ease-in-out;transform-origin:center 0}@media (prefers-reduced-motion:reduce){.skintone-list{transition-duration:.001s}}@supports not (inset-inline-end:0){.skintone-list{right:0}}.skintone-list.no-animate{transition:none}.tabpanel{overflow-y:auto;-webkit-overflow-scrolling:touch;will-change:transform;min-height:0;flex:1;contain:content}.emoji-menu{display:grid;grid-template-columns:repeat(var(--num-columns),var(--total-emoji-size));justify-content:space-around;align-items:flex-start;width:100%}.category{padding:var(--emoji-padding);font-size:var(--category-font-size);color:var(--category-font-color)}.custom-emoji,.emoji,button.emoji{height:var(--total-emoji-size);width:var(--total-emoji-size)}.emoji,button.emoji{font-size:var(--emoji-size);display:flex;align-items:center;justify-content:center;border-radius:100%;line-height:1;overflow:hidden;font-family:var(--font-family);cursor:pointer}@media (hover:hover) and (pointer:fine){.emoji:hover,button.emoji:hover{background:var(--button-hover-background)}}.emoji.active,.emoji:active,button.emoji.active,button.emoji:active{background:var(--button-active-background)}.custom-emoji{padding:var(--emoji-padding);object-fit:contain;pointer-events:none;background-repeat:no-repeat;background-position:center center;background-size:var(--emoji-size) var(--emoji-size)}.nav,.nav-button{align-items:center}.nav{display:grid;justify-content:space-between;contain:content}.nav-button{display:flex;justify-content:center}.nav-emoji{font-size:var(--category-emoji-size);width:var(--total-category-emoji-size);height:var(--total-category-emoji-size)}.indicator-wrapper{display:flex;border-bottom:1px solid var(--border-color)}.indicator{width:calc(100%/var(--num-groups));height:var(--indicator-height);opacity:var(--indicator-opacity);background-color:var(--indicator-color);will-change:transform,opacity;transition:opacity .1s linear,transform .25s ease-in-out}@media (prefers-reduced-motion:reduce){.indicator{will-change:opacity;transition:opacity .1s linear}}.pad-top,input.search{background:var(--background);width:100%}.pad-top{height:var(--emoji-padding);z-index:3}.search-row{display:flex;align-items:center;position:relative;padding-inline-start:var(--emoji-padding);padding-bottom:var(--emoji-padding)}.search-wrapper{flex:1;min-width:0}input.search{padding:var(--input-padding);border-radius:var(--input-border-radius);border:var(--input-border-size) solid var(--input-border-color);color:var(--input-font-color);font-size:var(--input-font-size);line-height:var(--input-line-height)}input.search::placeholder{color:var(--input-placeholder-color)}.favorites{display:flex;flex-direction:row;border-top:var(--border-size) solid var(--border-color);contain:content}.message{padding:var(--emoji-padding)}",this.shadowRoot.appendChild(t),this._ctx={locale:af,dataSource:sf,skinToneEmoji:dh,customCategorySorting:hh,customEmoji:null,i18n:of,...e};for(const s of nf)"database"!==s&&Object.prototype.hasOwnProperty.call(this,s)&&(this._ctx[s]=this[s],delete this[s]);this._dbFlush()}connectedCallback(){this._cmp=new tf({target:this.shadowRoot,props:this._ctx})}disconnectedCallback(){this._cmp.$destroy(),this._cmp=void 0;const{database:e}=this._ctx;e&&e.close().catch(e=>console.error(e))}static get observedAttributes(){return["locale","data-source","skin-tone-emoji"]}attributeChangedCallback(e,t,s){this._set(e.replace(/-([a-z])/g,(e,t)=>t.toUpperCase()),s)}_set(e,t){this._ctx[e]=t,this._cmp&&this._cmp.$set({[e]:t}),["locale","dataSource"].includes(e)&&this._dbFlush()}_dbCreate(){const{locale:e,dataSource:t,database:s}=this._ctx;s&&s.locale===e&&s.dataSource===t||this._set("database",new cp({locale:e,dataSource:t}))}_dbFlush(){Promise.resolve().then(()=>this._dbCreate())}}const lf={};for(const t of nf)lf[t]={get(){return"database"===t&&this._dbCreate(),this._ctx[t]},set(e){if("database"===t)throw new Error("database is read-only");this._set(t,e)}};function cf(e,t){while(e&&!e.querySelector(t)){e=e.parentNode;const s=e.querySelector(t);if(s)return s}return null}Object.defineProperties(rf.prototype,lf),customElements.get("emoji-picker")||customElements.define("emoji-picker",rf);const df={name:"EmojiPickerContainer",components:{SvgIcon:yi},props:{emojiOpened:{type:Boolean,default:!1},emojiReaction:{type:Boolean,default:!1},positionTop:{type:Boolean,default:!1},positionRight:{type:Boolean,default:!1},messageId:{type:String,default:""},emojiDataSource:{type:String,default:void 0}},emits:["add-emoji","open-emoji"],data(){return{emojiPickerHeight:320,emojiPickerTop:0,emojiPickerRight:""}},watch:{emojiOpened(e){e&&setTimeout(()=>{this.addCustomStyling(),this.$refs.emojiPicker.shadowRoot.addEventListener("emoji-click",({detail:e})=>{this.$emit("add-emoji",{unicode:e.unicode})})},0)}},methods:{addCustomStyling(){const e=".picker {\n\t\t\t\tborder: none;\n\t\t\t}",t=".nav {\n\t\t\t\toverflow-x: auto;\n\t\t\t}",s=".search-wrapper {\n\t\t\t\tpadding-right: 2px;\n\t\t\t\tpadding-left: 2px;\n\t\t\t}",a="input.search {\n\t\t\t\theight: 32px;\n\t\t\t\tfont-size: 14px;\n\t\t\t\tborder-radius: 10rem;\n\t\t\t\tborder: var(--chat-border-style);\n\t\t\t\tpadding: 5px 10px;\n\t\t\t\toutline: none;\n\t\t\t\tbackground: var(--chat-bg-color-input);\n\t\t\t\tcolor: var(--chat-color);\n\t\t\t}",o=document.createElement("style");o.textContent=e+t+s+a,this.$refs.emojiPicker.shadowRoot.appendChild(o)},openEmoji(e){this.$emit("open-emoji",!this.emojiOpened),this.setEmojiPickerPosition(e.clientY,e.view.innerWidth,e.view.innerHeight)},setEmojiPickerPosition(e,t,s){const a=t<500||s<700,o=cf(this.$el,"#room-footer");if(o)if(a)this.emojiPickerRight=t/2-(this.positionTop?200:150)+"px",this.emojiPickerTop=100,this.emojiPickerHeight=s-200;else{const t=o.getBoundingClientRect().top,s=t-e>this.emojiPickerHeight-50;this.emojiPickerTop=s?e+10:e-this.emojiPickerHeight-10,this.emojiPickerRight=this.positionTop?"0px":this.positionRight?"60px":""}else a&&(this.emojiPickerRight="-50px")}}},uf={class:"vac-emoji-wrapper"};function mf(e,t,s,a,o,n){const r=ka("svg-icon"),i=ka("emoji-picker");return Bo(),Lo("div",uf,[Uo("div",{class:it(["vac-svg-button",{"vac-emoji-reaction":s.emojiReaction}]),onClick:t[0]||(t[0]=(...e)=>n.openEmoji&&n.openEmoji(...e))},[Oa(e.$slots,s.messageId?"emoji-picker-reaction-icon_"+s.messageId:"emoji-picker-icon",{},()=>[qo(r,{name:"emoji",param:s.emojiReaction?"reaction":""},null,8,["param"])])],2),s.emojiOpened?(Bo(),Po(kr,{key:0,name:"vac-slide-up",appear:""},{default:Rs(()=>[Uo("div",{class:it(["vac-emoji-picker",{"vac-picker-reaction":s.emojiReaction}]),style:at({height:o.emojiPickerHeight+"px",top:s.positionTop?o.emojiPickerHeight:o.emojiPickerTop+"px",right:o.emojiPickerRight,display:o.emojiPickerTop||!s.emojiReaction?"initial":"none"})},[s.emojiOpened?(Bo(),Po(i,{key:0,ref:"emojiPicker","data-source":s.emojiDataSource},null,8,["data-source"])):Ko("",!0)],6)]),_:1})):Ko("",!0)])}var pf=ni(df,[["render",mf]]);const hf={name:"RoomFiles",components:{Loader:hi,SvgIcon:yi},props:{file:{type:Object,required:!0},index:{type:Number,required:!0}},emits:["remove-file"],computed:{isImage(){return Zd(this.file)},isVideo(){return Wd(this.file)}}},ff={class:"vac-room-file-container"},gf=["src"],_f={class:"vac-text-ellipsis"},vf={key:0,class:"vac-text-ellipsis vac-text-extension"};function bf(e,t,s,a,o,n){const r=ka("loader"),i=ka("svg-icon");return Bo(),Lo("div",ff,[qo(r,{show:s.file.loading,type:"room-file"},Ba({_:2},[Ea(e.$slots,(t,s)=>({name:s,fn:Rs(t=>[Oa(e.$slots,s,lt(zo(t)))])}))]),1032,["show"]),Uo("div",{class:"vac-svg-button vac-icon-remove",onClick:t[0]||(t[0]=t=>e.$emit("remove-file",s.index))},[Oa(e.$slots,"image-close-icon",{},()=>[qo(i,{name:"close",param:"image"})])]),n.isImage?(Bo(),Lo("div",{key:0,class:it(["vac-message-image",{"vac-blur-loading":s.file.loading}]),style:at({"background-image":`url('${s.file.localUrl||s.file.url}')`})},null,6)):n.isVideo?(Bo(),Lo("video",{key:1,controls:"",class:it({"vac-blur-loading":s.file.loading})},[Uo("source",{src:s.file.localUrl||s.file.url},null,8,gf)],2)):(Bo(),Lo("div",{key:2,class:it(["vac-file-container",{"vac-blur-loading":s.file.loading}])},[Uo("div",null,[Oa(e.$slots,"file-icon",{},()=>[qo(i,{name:"file"})])]),Uo("div",_f,ct(s.file.name),1),s.file.extension?(Bo(),Lo("div",vf,ct(s.file.extension),1)):Ko("",!0)],2))])}var yf=ni(hf,[["render",bf]]);const xf={name:"RoomFiles",components:{SvgIcon:yi,RoomFile:yf},props:{files:{type:Array,required:!0}},emits:["remove-file","reset-message"],computed:{}},wf={key:0,class:"vac-room-files-container"},kf={class:"vac-files-box"},Sf={class:"vac-icon-close"};function Mf(e,t,s,a,o,n){const r=ka("room-file"),i=ka("svg-icon");return Bo(),Po(kr,{name:"vac-slide-up"},{default:Rs(()=>[s.files.length?(Bo(),Lo("div",wf,[Uo("div",kf,[(Bo(!0),Lo(So,null,Ea(s.files,(s,a)=>(Bo(),Lo("div",{key:a},[qo(r,{file:s,index:a,onRemoveFile:t[0]||(t[0]=t=>e.$emit("remove-file",t))},Ba({_:2},[Ea(e.$slots,(t,s)=>({name:s,fn:Rs(t=>[Oa(e.$slots,s,lt(zo(t)))])}))]),1032,["file","index"])]))),128))]),Uo("div",Sf,[Uo("div",{class:"vac-svg-button",onClick:t[1]||(t[1]=t=>e.$emit("reset-message"))},[Oa(e.$slots,"files-close-icon",{},()=>[qo(i,{name:"close-outline"})])])])])):Ko("",!0)]),_:3})}var Af=ni(xf,[["render",Mf]]);const Rf={props:{percentage:{type:Number,default:0},messageSelectionEnabled:{type:Boolean,required:!0}},emits:["hover-audio-progress","change-linehead"],data(){return{isMouseDown:!1}},methods:{onMouseDown(e){if(this.messageSelectionEnabled)return;this.isMouseDown=!0;const t=this.calculateLineHeadPosition(e,this.$refs.progress);this.$emit("change-linehead",t),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)},onMouseUp(e){if(this.messageSelectionEnabled)return;this.isMouseDown=!1,document.removeEventListener("mouseup",this.onMouseUp),document.removeEventListener("mousemove",this.onMouseMove);const t=this.calculateLineHeadPosition(e,this.$refs.progress);this.$emit("change-linehead",t)},onMouseMove(e){if(this.messageSelectionEnabled)return;const t=this.calculateLineHeadPosition(e,this.$refs.progress);this.$emit("change-linehead",t)},calculateLineHeadPosition(e,t){const s=t.getBoundingClientRect().width,a=t.getBoundingClientRect().left;let o=(e.clientX-a)/s;return o=o<0?0:o,o=o>1?1:o,o}}},Tf={class:"vac-player-progress"},Ef={class:"vac-line-container"};function Bf(e,t,s,a,o,n){return Bo(),Lo("div",{ref:"progress",class:"vac-player-bar",onMousedown:t[0]||(t[0]=(...e)=>n.onMouseDown&&n.onMouseDown(...e)),onMouseover:t[1]||(t[1]=t=>e.$emit("hover-audio-progress",!0)),onMouseout:t[2]||(t[2]=t=>e.$emit("hover-audio-progress",!1))},[Uo("div",Tf,[Uo("div",Ef,[Uo("div",{class:"vac-line-progress",style:at({width:s.percentage+"%"})},null,4),Uo("div",{class:it(["vac-line-dot",{"vac-line-dot__active":o.isMouseDown}]),style:at({left:s.percentage+"%"})},null,6)])])],544)}var Of=ni(Rf,[["render",Bf]]);const Cf={name:"AudioPlayer",components:{SvgIcon:yi,AudioControl:Of},props:{messageId:{type:[String,Number],default:null},src:{type:String,default:null},messageSelectionEnabled:{type:Boolean,required:!0}},emits:["hover-audio-progress","update-progress-time"],data(){return{isPlaying:!1,duration:this.convertTimeMMSS(0),playedTime:this.convertTimeMMSS(0),progress:0}},computed:{playerUniqId(){return"audio-player"+this.messageId},audioSource(){return this.src?this.src:(this.resetProgress(),null)}},mounted(){this.player=this.$el.querySelector("#"+this.playerUniqId),this.player.addEventListener("ended",()=>{this.isPlaying=!1}),this.player.addEventListener("loadeddata",()=>{this.resetProgress(),this.duration=this.convertTimeMMSS(this.player.duration),this.updateProgressTime()}),this.player.addEventListener("timeupdate",this.onTimeUpdate)},methods:{convertTimeMMSS(e){return new Date(1e3*e).toISOString().substr(14,5)},playback(){!this.messageSelectionEnabled&&this.audioSource&&(this.isPlaying?this.player.pause():setTimeout(()=>this.player.play()),this.isPlaying=!this.isPlaying)},resetProgress(){this.isPlaying&&this.player.pause(),this.duration=this.convertTimeMMSS(0),this.playedTime=this.convertTimeMMSS(0),this.progress=0,this.isPlaying=!1,this.updateProgressTime()},onTimeUpdate(){this.playedTime=this.convertTimeMMSS(this.player.currentTime),this.progress=this.player.currentTime/this.player.duration*100,this.updateProgressTime()},onUpdateProgress(e){e&&(this.player.currentTime=e*this.player.duration)},updateProgressTime(){this.$emit("update-progress-time",this.progress>1?this.playedTime:this.duration)}}},jf={class:"vac-audio-player"},If=["id","src"];function Lf(e,t,s,a,o,n){const r=ka("svg-icon"),i=ka("audio-control");return Bo(),Lo("div",null,[Uo("div",jf,[Uo("div",{class:"vac-svg-button",onClick:t[0]||(t[0]=(...e)=>n.playback&&n.playback(...e))},[o.isPlaying?Oa(e.$slots,"audio-pause-icon_"+s.messageId,{key:0},()=>[qo(r,{name:"audio-pause"})]):Oa(e.$slots,"audio-play-icon_"+s.messageId,{key:1},()=>[qo(r,{name:"audio-play"})])]),qo(i,{percentage:o.progress,"message-selection-enabled":s.messageSelectionEnabled,onChangeLinehead:n.onUpdateProgress,onHoverAudioProgress:t[1]||(t[1]=t=>e.$emit("hover-audio-progress",t))},null,8,["percentage","message-selection-enabled","onChangeLinehead"]),Uo("audio",{id:n.playerUniqId,src:n.audioSource},null,8,If)])])}var Pf=ni(Cf,[["render",Lf]]);const Nf={name:"RoomMessageReply",components:{SvgIcon:yi,FormatMessage:jd,AudioPlayer:Pf},props:{room:{type:Object,required:!0},messageReply:{type:Object,default:null},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0}},emits:["reset-message"],computed:{firstFile(){var e,t;return(null==(t=null==(e=this.messageReply)?void 0:e.files)?void 0:t.length)?this.messageReply.files[0]:{}},isImage(){return Zd(this.firstFile)},isVideo(){return Wd(this.firstFile)},isAudio(){return Jd(this.firstFile)},isOtherFile(){var e,t;return(null==(t=null==(e=this.messageReply)?void 0:e.files)?void 0:t.length)&&!this.isAudio&&!this.isVideo&&!this.isImage}}},Hf={key:0,class:"vac-reply-container"},Ff={class:"vac-reply-box"},Df={class:"vac-reply-info"},$f={class:"vac-reply-username"},Uf={class:"vac-reply-content"},qf=["src"],Vf={key:1,controls:"",class:"vac-image-reply"},zf=["src"],Xf={key:3,class:"vac-image-reply vac-file-container"},Yf={class:"vac-text-ellipsis"},Kf={key:0,class:"vac-text-ellipsis vac-text-extension"},Gf={class:"vac-icon-reply"};function Zf(e,t,s,a,o,n){const r=ka("format-message"),i=ka("audio-player"),l=ka("svg-icon");return Bo(),Po(kr,{name:"vac-slide-up"},{default:Rs(()=>[s.messageReply?(Bo(),Lo("div",Hf,[Uo("div",Ff,[Uo("div",Df,[Uo("div",$f,ct(s.messageReply.username),1),Uo("div",Uf,[qo(r,{"message-id":s.messageReply._id,content:s.messageReply.content,users:s.room.users,"text-formatting":s.textFormatting,"link-options":s.linkOptions,reply:!0},null,8,["message-id","content","users","text-formatting","link-options"])])]),n.isImage?(Bo(),Lo("img",{key:0,src:n.firstFile.url,class:"vac-image-reply"},null,8,qf)):n.isVideo?(Bo(),Lo("video",Vf,[Uo("source",{src:n.firstFile.url},null,8,zf)])):n.isAudio?(Bo(),Po(i,{key:2,src:n.firstFile.url,"message-selection-enabled":!1,class:"vac-audio-reply"},Ba({_:2},[Ea(e.$slots,(t,s)=>({name:s,fn:Rs(t=>[Oa(e.$slots,s,lt(zo(t)))])}))]),1032,["src"])):n.isOtherFile?(Bo(),Lo("div",Xf,[Uo("div",null,[Oa(e.$slots,"file-icon",{},()=>[qo(l,{name:"file"})])]),Uo("div",Yf,ct(n.firstFile.name),1),n.firstFile.extension?(Bo(),Lo("div",Kf,ct(n.firstFile.extension),1)):Ko("",!0)])):Ko("",!0)]),Uo("div",Gf,[Uo("div",{class:"vac-svg-button",onClick:t[0]||(t[0]=t=>e.$emit("reset-message"))},[Oa(e.$slots,"reply-close-icon",{},()=>[qo(l,{name:"close-outline"})])])])])):Ko("",!0)]),_:3})}var Wf=ni(Nf,[["render",Zf]]);const Qf={name:"RoomUsersTag",props:{filteredUsersTag:{type:Array,required:!0},selectItem:{type:Boolean,default:null},activeUpOrDown:{type:Number,default:null}},emits:["select-user-tag","activate-item"],data(){return{activeItem:null}},watch:{filteredUsersTag(e,t){t.length&&e.length===t.length||(this.activeItem=0)},selectItem(e){e&&this.$emit("select-user-tag",this.filteredUsersTag[this.activeItem])},activeUpOrDown(){this.activeUpOrDown>0&&this.activeItem<this.filteredUsersTag.length-1?this.activeItem++:this.activeUpOrDown<0&&this.activeItem>0&&this.activeItem--,this.$emit("activate-item")}}},Jf={key:0,class:"vac-tags-container"},eg=["onMouseover","onClick"],tg={class:"vac-tags-info"},sg={class:"vac-tags-username"};function ag(e,t,s,a,o,n){return Bo(),Po(kr,{name:"vac-slide-up"},{default:Rs(()=>[s.filteredUsersTag.length?(Bo(),Lo("div",Jf,[(Bo(!0),Lo(So,null,Ea(s.filteredUsersTag,(t,s)=>(Bo(),Lo("div",{key:t._id,class:it(["vac-tags-box",{"vac-tags-box-active":s===o.activeItem}]),onMouseover:e=>o.activeItem=s,onClick:s=>e.$emit("select-user-tag",t)},[Uo("div",tg,[t.avatar?(Bo(),Lo("div",{key:0,class:"vac-avatar vac-tags-avatar",style:at({"background-image":`url('${t.avatar}')`})},null,4)):Ko("",!0),Uo("div",sg,ct(t.username),1)])],42,eg))),128))])):Ko("",!0)]),_:1})}var og=ni(Qf,[["render",ag]]);const ng={name:"RoomEmojis",props:{filteredEmojis:{type:Array,required:!0},selectItem:{type:Boolean,default:null},activeUpOrDown:{type:Number,default:null}},emits:["select-emoji","activate-item"],data(){return{activeItem:null}},watch:{filteredEmojis(e,t){t.length&&e.length===t.length||(this.activeItem=0)},selectItem(e){e&&this.$emit("select-emoji",this.filteredEmojis[this.activeItem])},activeUpOrDown(){this.activeUpOrDown>0&&this.activeItem<this.filteredEmojis.length-1?this.activeItem++:this.activeUpOrDown<0&&this.activeItem>0&&this.activeItem--,this.$emit("activate-item")}}},rg={key:0,class:"vac-emojis-container"},ig=["onMouseover","onClick"];function lg(e,t,s,a,o,n){return Bo(),Po(kr,{name:"vac-slide-up"},{default:Rs(()=>[s.filteredEmojis.length?(Bo(),Lo("div",rg,[(Bo(!0),Lo(So,null,Ea(s.filteredEmojis,(t,s)=>(Bo(),Lo("div",{key:t,class:it(["vac-emoji-element",{"vac-emoji-element-active":s===o.activeItem}]),onMouseover:e=>o.activeItem=s,onClick:s=>e.$emit("select-emoji",t)},ct(t),43,ig))),128))])):Ko("",!0)]),_:1})}var cg=ni(ng,[["render",lg]]);const dg={name:"RoomTemplatesText",props:{filteredTemplatesText:{type:Array,required:!0},selectItem:{type:Boolean,default:null},activeUpOrDown:{type:Number,default:null}},emits:["select-template-text","activate-item"],data(){return{activeItem:null}},watch:{filteredTemplatesText(e,t){t.length&&e.length===t.length||(this.activeItem=0)},selectItem(e){e&&this.$emit("select-template-text",this.filteredTemplatesText[this.activeItem])},activeUpOrDown(){this.activeUpOrDown>0&&this.activeItem<this.filteredTemplatesText.length-1?this.activeItem++:this.activeUpOrDown<0&&this.activeItem>0&&this.activeItem--,this.$emit("activate-item")}}},ug={key:0,class:"vac-template-container vac-app-box-shadow"},mg=["onMouseover","onClick"],pg={class:"vac-template-info"},hg={class:"vac-template-tag"},fg={class:"vac-template-text"};function gg(e,t,s,a,o,n){return Bo(),Po(kr,{name:"vac-slide-up"},{default:Rs(()=>[s.filteredTemplatesText.length?(Bo(),Lo("div",ug,[(Bo(!0),Lo(So,null,Ea(s.filteredTemplatesText,(t,s)=>(Bo(),Lo("div",{key:s,class:it(["vac-template-box",{"vac-template-active":s===o.activeItem}]),onMouseover:e=>o.activeItem=s,onClick:s=>e.$emit("select-template-text",t)},[Uo("div",pg,[Uo("div",hg," /"+ct(t.tag),1),Uo("div",fg,ct(t.text),1)])],42,mg))),128))])):Ko("",!0)]),_:1})}var _g=ni(dg,[["render",gg]]);function vg(e){return new Int8Array(e)}function bg(e){return new Int16Array(e)}function yg(e){return new Int32Array(e)}function xg(e){return new Float32Array(e)}function wg(e){return new Float64Array(e)}function kg(e){if(1==e.length)return xg(e[0]);var t=e[0];e=e.slice(1);for(var s=[],a=0;a<t;a++)s.push(kg(e));return s}function Sg(e){if(1==e.length)return yg(e[0]);var t=e[0];e=e.slice(1);for(var s=[],a=0;a<t;a++)s.push(Sg(e));return s}function Mg(e){if(1==e.length)return bg(e[0]);var t=e[0];e=e.slice(1);for(var s=[],a=0;a<t;a++)s.push(Mg(e));return s}function Ag(e){if(1==e.length)return new Array(e[0]);var t=e[0];e=e.slice(1);for(var s=[],a=0;a<t;a++)s.push(Ag(e));return s}var Rg={fill:function(e,t,s,a){if(2==arguments.length)for(var o=0;o<e.length;o++)e[o]=arguments[1];else for(o=t;o<s;o++)e[o]=a}},Tg={arraycopy:function(e,t,s,a,o){var n=t+o;while(t<n)s[a++]=e[t++]},out:{}};Tg.out.println=function(e){console.log(e)},Tg.out.printf=function(){console.log.apply(console,arguments)};var Eg={};function Bg(e){this.ordinal=e}Eg.SQRT2=1.4142135623730951,Eg.FAST_LOG10=function(e){return Math.log10(e)},Eg.FAST_LOG10_X=function(e,t){return Math.log10(e)*t},Bg.short_block_allowed=new Bg(0),Bg.short_block_coupled=new Bg(1),Bg.short_block_dispensed=new Bg(2),Bg.short_block_forced=new Bg(3);var Og={};function Cg(e){this.ordinal=e}Og.MAX_VALUE=34028235e31,Cg.vbr_off=new Cg(0),Cg.vbr_mt=new Cg(1),Cg.vbr_rh=new Cg(2),Cg.vbr_abr=new Cg(3),Cg.vbr_mtrh=new Cg(4),Cg.vbr_default=Cg.vbr_mtrh;var jg=function(e){},Ig={System:Tg,VbrMode:Cg,Float:Og,ShortBlock:Bg,Util:Eg,Arrays:Rg,new_array_n:Ag,new_byte:vg,new_double:wg,new_float:xg,new_float_n:kg,new_int:yg,new_int_n:Sg,new_short:bg,new_short_n:Mg,assert:jg},Lg=Ig.System,Pg=Ig.Util,Ng=Ig.Arrays,Hg=Ig.new_float;function Fg(){var e=[-.1482523854003001,32.308141959636465,296.40344946382766,883.1344870032432,11113.947376231741,1057.2713659324597,305.7402417275812,30.825928907280012,3.8533188138216365,59.42900443849514,709.5899960123345,5281.91112291017,-5829.66483675846,-817.6293103748613,-76.91656988279972,-4.594269939176596,.9063471690191471,.1960342806591213,-.15466694054279598,34.324387823855965,301.8067566458425,817.599602898885,11573.795901679885,1181.2520595540152,321.59731579894424,31.232021761053772,3.7107095756221318,53.650946155329365,684.167428119626,5224.56624370173,-6366.391851890084,-908.9766368219582,-89.83068876699639,-5.411397422890401,.8206787908286602,.3901806440322567,-.16070888947830023,36.147034243915876,304.11815768187864,732.7429163887613,11989.60988270091,1300.012278487897,335.28490093152146,31.48816102859945,3.373875931311736,47.232241542899175,652.7371796173471,5132.414255594984,-6909.087078780055,-1001.9990371107289,-103.62185754286375,-6.104916304710272,.7416505462720353,.5805693545089249,-.16636367662261495,37.751650073343995,303.01103387567713,627.9747488785183,12358.763425278165,1412.2779918482834,346.7496836825721,31.598286663170416,3.1598635433980946,40.57878626349686,616.1671130880391,5007.833007176154,-7454.040671756168,-1095.7960341867115,-118.24411666465777,-6.818469345853504,.6681786379192989,.7653668647301797,-.1716176790982088,39.11551877123304,298.3413246578966,503.5259106886539,12679.589408408976,1516.5821921214542,355.9850766329023,31.395241710249053,2.9164211881972335,33.79716964664243,574.8943997801362,4853.234992253242,-7997.57021486075,-1189.7624067269965,-133.6444792601766,-7.7202770609839915,.5993769336819237,.9427934736519954,-.17645823955292173,40.21879108166477,289.9982036694474,359.3226160751053,12950.259102786438,1612.1013903507662,362.85067106591504,31.045922092242872,2.822222032597987,26.988862316190684,529.8996541764288,4671.371946949588,-8535.899136645805,-1282.5898586244496,-149.58553632943463,-8.643494270763135,.5345111359507916,1.111140466039205,-.36174739330527045,41.04429910497807,277.5463268268618,195.6386023135583,13169.43812144731,1697.6433561479398,367.40983966190305,30.557037410382826,2.531473372857427,20.070154905927314,481.50208566532336,4464.970341588308,-9065.36882077239,-1373.62841526722,-166.1660487028118,-9.58289321133207,.4729647758913199,1.268786568327291,-.36970682634889585,41.393213350082036,261.2935935556502,12.935476055240873,13336.131683328815,1772.508612059496,369.76534388639965,29.751323653701338,2.4023193045459172,13.304795348228817,430.5615775526625,4237.0568611071185,-9581.931701634761,-1461.6913552409758,-183.12733958476446,-10.718010163869403,.41421356237309503,1.414213562373095,-.37677560326535325,41.619486213528496,241.05423794991074,-187.94665032361226,13450.063605744153,1836.153896465782,369.4908799925761,29.001847876923147,2.0714759319987186,6.779591200894186,377.7767837205709,3990.386575512536,-10081.709459700915,-1545.947424837898,-200.3762958015653,-11.864482073055006,.3578057213145241,1.546020906725474,-.3829366947518991,41.1516456456653,216.47684307105183,-406.1569483347166,13511.136535077321,1887.8076599260432,367.3025214564151,28.136213436723654,1.913880671464418,.3829366947518991,323.85365704338597,3728.1472257487526,-10561.233882199509,-1625.2025997821418,-217.62525175416,-13.015432208941645,.3033466836073424,1.66293922460509,-.5822628872992417,40.35639251440489,188.20071124269245,-640.2706748618148,13519.21490106562,1927.6022433578062,362.8197642637487,26.968821921868447,1.7463817695935329,-5.62650678237171,269.3016715297017,3453.386536448852,-11016.145278780888,-1698.6569643425091,-234.7658734267683,-14.16351421663124,.2504869601913055,1.76384252869671,-.5887180101749253,39.23429103868072,155.76096234403798,-889.2492977967378,13475.470561874661,1955.0535223723712,356.4450994756727,25.894952980042156,1.5695032905781554,-11.181939564328772,214.80884394039484,3169.1640829158237,-11443.321309975563,-1765.1588461316153,-251.68908574481912,-15.49755935939164,.198912367379658,1.847759065022573,-.7912582233652842,37.39369355329111,119.699486012458,-1151.0956593239027,13380.446257078214,1970.3952110853447,348.01959814116185,24.731487364283044,1.3850130831637748,-16.421408865300393,161.05030052864092,2878.3322807850063,-11838.991423510031,-1823.985884688674,-268.2854986386903,-16.81724543849939,.1483359875383474,1.913880671464418,-.7960642926861912,35.2322109610459,80.01928065061526,-1424.0212633405113,13235.794061869668,1973.804052543835,337.9908651258184,23.289159354463873,1.3934255946442087,-21.099669467133474,108.48348407242611,2583.700758091299,-12199.726194855148,-1874.2780658979746,-284.2467154529415,-18.11369784385905,.09849140335716425,1.961570560806461,-.998795456205172,32.56307803611191,36.958364584370486,-1706.075448829146,13043.287458812016,1965.3831106103316,326.43182772364605,22.175018750622293,1.198638339011324,-25.371248002043963,57.53505923036915,2288.41886619975,-12522.674544337233,-1914.8400385312243,-299.26241273417224,-19.37805630698734,.04912684976946725,1.990369453344394,.035780907*Pg.SQRT2*.5/2384e-9,.017876148*Pg.SQRT2*.5/2384e-9,.003134727*Pg.SQRT2*.5/2384e-9,.002457142*Pg.SQRT2*.5/2384e-9,971317e-9*Pg.SQRT2*.5/2384e-9,218868e-9*Pg.SQRT2*.5/2384e-9,101566e-9*Pg.SQRT2*.5/2384e-9,13828e-9*Pg.SQRT2*.5/2384e-9,12804.797818791945,1945.5515939597317,313.4244966442953,20.801593959731544,1995.1556208053692,9.000838926174497,-29.20218120805369],t=12,s=36,a=[[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,940084909404969e-27,6423305872147839e-28,2382191739347918e-28,5456116108943412e-27,4878985199565852e-27,4240448995017367e-27,3559909094758252e-27,2858043359288075e-27,2156177623817898e-27,1475637723558783e-27,8371015190102974e-28,2599706096327376e-28,-5456116108943412e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758252e-27,-2858043359288076e-27,-2156177623817898e-27,-1475637723558783e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347923e-28,-6423305872147843e-28,-9400849094049696e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049694e-28,-642330587214784e-27,-2382191739347918e-28],[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,9400849094049688e-28,6423305872147841e-28,2382191739347918e-28,5456116108943413e-27,4878985199565852e-27,4240448995017367e-27,3559909094758253e-27,2858043359288075e-27,2156177623817898e-27,1475637723558782e-27,8371015190102975e-28,2599706096327376e-28,-5461314069809755e-27,-4921085770524055e-27,-4343405037091838e-27,-3732668368707687e-27,-3093523840190885e-27,-2430835727329465e-27,-1734679010007751e-27,-974825365660928e-27,-2797435120168326e-28,0,0,0,0,0,0,-2283748241799531e-28,-4037858874020686e-28,-2146547464825323e-28],[.1316524975873958,.414213562373095,.7673269879789602,1.091308501069271,1.303225372841206,1.56968557711749,1.920982126971166,2.414213562373094,3.171594802363212,4.510708503662055,7.595754112725146,22.90376554843115,.984807753012208,.6427876096865394,.3420201433256688,.9396926207859084,-.1736481776669303,-.7660444431189779,.8660254037844387,.5,-.5144957554275265,-.4717319685649723,-.3133774542039019,-.1819131996109812,-.09457419252642064,-.04096558288530405,-.01419856857247115,-.003699974673760037,.8574929257125442,.8817419973177052,.9496286491027329,.9833145924917901,.9955178160675857,.9991605581781475,.999899195244447,.9999931550702802],[0,0,0,0,0,0,2283748241799531e-28,4037858874020686e-28,2146547464825323e-28,5461314069809755e-27,4921085770524055e-27,4343405037091838e-27,3732668368707687e-27,3093523840190885e-27,2430835727329466e-27,1734679010007751e-27,974825365660928e-27,2797435120168326e-28,-5456116108943413e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758253e-27,-2858043359288075e-27,-2156177623817898e-27,-1475637723558782e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347913e-28,-6423305872147834e-28,-9400849094049688e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049688e-28,-6423305872147841e-28,-2382191739347918e-28]],o=a[Jg.SHORT_TYPE],n=a[Jg.SHORT_TYPE],r=a[Jg.SHORT_TYPE],i=a[Jg.SHORT_TYPE],l=[0,1,16,17,8,9,24,25,4,5,20,21,12,13,28,29,2,3,18,19,10,11,26,27,6,7,22,23,14,15,30,31];function c(t,s,a){for(var o,n,r,i=10,l=s+238-14-286,c=-15;c<0;c++){var d,u,m;d=e[i+-10],u=t[l+-224]*d,m=t[s+224]*d,d=e[i+-9],u+=t[l+-160]*d,m+=t[s+160]*d,d=e[i+-8],u+=t[l+-96]*d,m+=t[s+96]*d,d=e[i+-7],u+=t[l+-32]*d,m+=t[s+32]*d,d=e[i+-6],u+=t[l+32]*d,m+=t[s+-32]*d,d=e[i+-5],u+=t[l+96]*d,m+=t[s+-96]*d,d=e[i+-4],u+=t[l+160]*d,m+=t[s+-160]*d,d=e[i+-3],u+=t[l+224]*d,m+=t[s+-224]*d,d=e[i+-2],u+=t[s+-256]*d,m-=t[l+256]*d,d=e[i+-1],u+=t[s+-192]*d,m-=t[l+192]*d,d=e[i+0],u+=t[s+-128]*d,m-=t[l+128]*d,d=e[i+1],u+=t[s+-64]*d,m-=t[l+64]*d,d=e[i+2],u+=t[s+0]*d,m-=t[l+0]*d,d=e[i+3],u+=t[s+64]*d,m-=t[l+-64]*d,d=e[i+4],u+=t[s+128]*d,m-=t[l+-128]*d,d=e[i+5],u+=t[s+192]*d,m-=t[l+-192]*d,u*=e[i+6],d=m-u,a[30+2*c]=m+u,a[31+2*c]=e[i+7]*d,i+=18,s--,l++}m=t[s+-16]*e[i+-10],u=t[s+-32]*e[i+-2],m+=(t[s+-48]-t[s+16])*e[i+-9],u+=t[s+-96]*e[i+-1],m+=(t[s+-80]+t[s+48])*e[i+-8],u+=t[s+-160]*e[i+0],m+=(t[s+-112]-t[s+80])*e[i+-7],u+=t[s+-224]*e[i+1],m+=(t[s+-144]+t[s+112])*e[i+-6],u-=t[s+32]*e[i+2],m+=(t[s+-176]-t[s+144])*e[i+-5],u-=t[s+96]*e[i+3],m+=(t[s+-208]+t[s+176])*e[i+-4],u-=t[s+160]*e[i+4],m+=(t[s+-240]-t[s+208])*e[i+-3],u-=t[s+224],o=u-m,n=u+m,m=a[14],u=a[15]-m,a[31]=n+m,a[30]=o+u,a[15]=o-u,a[14]=n-m,r=a[28]-a[0],a[0]+=a[28],a[28]=r*e[i+-36+7],r=a[29]-a[1],a[1]+=a[29],a[29]=r*e[i+-36+7],r=a[26]-a[2],a[2]+=a[26],a[26]=r*e[i+-72+7],r=a[27]-a[3],a[3]+=a[27],a[27]=r*e[i+-72+7],r=a[24]-a[4],a[4]+=a[24],a[24]=r*e[i+-108+7],r=a[25]-a[5],a[5]+=a[25],a[25]=r*e[i+-108+7],r=a[22]-a[6],a[6]+=a[22],a[22]=r*Pg.SQRT2,r=a[23]-a[7],a[7]+=a[23],a[23]=r*Pg.SQRT2-a[7],a[7]-=a[6],a[22]-=a[7],a[23]-=a[22],r=a[6],a[6]=a[31]-r,a[31]=a[31]+r,r=a[7],a[7]=a[30]-r,a[30]=a[30]+r,r=a[22],a[22]=a[15]-r,a[15]=a[15]+r,r=a[23],a[23]=a[14]-r,a[14]=a[14]+r,r=a[20]-a[8],a[8]+=a[20],a[20]=r*e[i+-180+7],r=a[21]-a[9],a[9]+=a[21],a[21]=r*e[i+-180+7],r=a[18]-a[10],a[10]+=a[18],a[18]=r*e[i+-216+7],r=a[19]-a[11],a[11]+=a[19],a[19]=r*e[i+-216+7],r=a[16]-a[12],a[12]+=a[16],a[16]=r*e[i+-252+7],r=a[17]-a[13],a[13]+=a[17],a[17]=r*e[i+-252+7],r=-a[20]+a[24],a[20]+=a[24],a[24]=r*e[i+-216+7],r=-a[21]+a[25],a[21]+=a[25],a[25]=r*e[i+-216+7],r=a[4]-a[8],a[4]+=a[8],a[8]=r*e[i+-216+7],r=a[5]-a[9],a[5]+=a[9],a[9]=r*e[i+-216+7],r=a[0]-a[12],a[0]+=a[12],a[12]=r*e[i+-72+7],r=a[1]-a[13],a[1]+=a[13],a[13]=r*e[i+-72+7],r=a[16]-a[28],a[16]+=a[28],a[28]=r*e[i+-72+7],r=-a[17]+a[29],a[17]+=a[29],a[29]=r*e[i+-72+7],r=Pg.SQRT2*(a[2]-a[10]),a[2]+=a[10],a[10]=r,r=Pg.SQRT2*(a[3]-a[11]),a[3]+=a[11],a[11]=r,r=Pg.SQRT2*(-a[18]+a[26]),a[18]+=a[26],a[26]=r-a[18],r=Pg.SQRT2*(-a[19]+a[27]),a[19]+=a[27],a[27]=r-a[19],r=a[2],a[19]-=a[3],a[3]-=r,a[2]=a[31]-r,a[31]+=r,r=a[3],a[11]-=a[19],a[18]-=r,a[3]=a[30]-r,a[30]+=r,r=a[18],a[27]-=a[11],a[19]-=r,a[18]=a[15]-r,a[15]+=r,r=a[19],a[10]-=r,a[19]=a[14]-r,a[14]+=r,r=a[10],a[11]-=r,a[10]=a[23]-r,a[23]+=r,r=a[11],a[26]-=r,a[11]=a[22]-r,a[22]+=r,r=a[26],a[27]-=r,a[26]=a[7]-r,a[7]+=r,r=a[27],a[27]=a[6]-r,a[6]+=r,r=Pg.SQRT2*(a[0]-a[4]),a[0]+=a[4],a[4]=r,r=Pg.SQRT2*(a[1]-a[5]),a[1]+=a[5],a[5]=r,r=Pg.SQRT2*(a[16]-a[20]),a[16]+=a[20],a[20]=r,r=Pg.SQRT2*(a[17]-a[21]),a[17]+=a[21],a[21]=r,r=-Pg.SQRT2*(a[8]-a[12]),a[8]+=a[12],a[12]=r-a[8],r=-Pg.SQRT2*(a[9]-a[13]),a[9]+=a[13],a[13]=r-a[9],r=-Pg.SQRT2*(a[25]-a[29]),a[25]+=a[29],a[29]=r-a[25],r=-Pg.SQRT2*(a[24]+a[28]),a[24]-=a[28],a[28]=r-a[24],r=a[24]-a[16],a[24]=r,r=a[20]-r,a[20]=r,r=a[28]-r,a[28]=r,r=a[25]-a[17],a[25]=r,r=a[21]-r,a[21]=r,r=a[29]-r,a[29]=r,r=a[17]-a[1],a[17]=r,r=a[9]-r,a[9]=r,r=a[25]-r,a[25]=r,r=a[5]-r,a[5]=r,r=a[21]-r,a[21]=r,r=a[13]-r,a[13]=r,r=a[29]-r,a[29]=r,r=a[1]-a[0],a[1]=r,r=a[16]-r,a[16]=r,r=a[17]-r,a[17]=r,r=a[8]-r,a[8]=r,r=a[9]-r,a[9]=r,r=a[24]-r,a[24]=r,r=a[25]-r,a[25]=r,r=a[4]-r,a[4]=r,r=a[5]-r,a[5]=r,r=a[20]-r,a[20]=r,r=a[21]-r,a[21]=r,r=a[12]-r,a[12]=r,r=a[13]-r,a[13]=r,r=a[28]-r,a[28]=r,r=a[29]-r,a[29]=r,r=a[0],a[0]+=a[31],a[31]-=r,r=a[1],a[1]+=a[30],a[30]-=r,r=a[16],a[16]+=a[15],a[15]-=r,r=a[17],a[17]+=a[14],a[14]-=r,r=a[8],a[8]+=a[23],a[23]-=r,r=a[9],a[9]+=a[22],a[22]-=r,r=a[24],a[24]+=a[7],a[7]-=r,r=a[25],a[25]+=a[6],a[6]-=r,r=a[4],a[4]+=a[27],a[27]-=r,r=a[5],a[5]+=a[26],a[26]-=r,r=a[20],a[20]+=a[11],a[11]-=r,r=a[21],a[21]+=a[10],a[10]-=r,r=a[12],a[12]+=a[19],a[19]-=r,r=a[13],a[13]+=a[18],a[18]-=r,r=a[28],a[28]+=a[3],a[3]-=r,r=a[29],a[29]+=a[2],a[2]-=r}function d(e,t){for(var s=0;s<3;s++){var o,n,r,i,l,c;i=e[t+6]*a[Jg.SHORT_TYPE][0]-e[t+15],o=e[t+0]*a[Jg.SHORT_TYPE][2]-e[t+9],n=i+o,r=i-o,i=e[t+15]*a[Jg.SHORT_TYPE][0]+e[t+6],o=e[t+9]*a[Jg.SHORT_TYPE][2]+e[t+0],l=i+o,c=-i+o,o=2069978111953089e-26*(e[t+3]*a[Jg.SHORT_TYPE][1]-e[t+12]),i=2069978111953089e-26*(e[t+12]*a[Jg.SHORT_TYPE][1]+e[t+3]),e[t+0]=190752519173728e-25*n+o,e[t+15]=190752519173728e-25*-l+i,r=.8660254037844387*r*1907525191737281e-26,l=.5*l*1907525191737281e-26+i,e[t+3]=r-l,e[t+6]=r+l,n=.5*n*1907525191737281e-26-o,c=.8660254037844387*c*1907525191737281e-26,e[t+9]=n+c,e[t+12]=n-c,t++}}function u(e,t,s){var a,o,r,i,l,c,d,u,m,p,h,f,g,_,v,b,y,x;r=s[17]-s[9],l=s[15]-s[11],c=s[14]-s[12],d=s[0]+s[8],u=s[1]+s[7],m=s[2]+s[6],p=s[3]+s[5],e[t+17]=d+m-p-(u-s[4]),o=(d+m-p)*n[19]+(u-s[4]),a=(r-l-c)*n[18],e[t+5]=a+o,e[t+6]=a-o,i=(s[16]-s[10])*n[18],u=u*n[19]+s[4],a=r*n[12]+i+l*n[13]+c*n[14],o=-d*n[16]+u-m*n[17]+p*n[15],e[t+1]=a+o,e[t+2]=a-o,a=r*n[13]-i-l*n[14]+c*n[12],o=-d*n[17]+u-m*n[15]+p*n[16],e[t+9]=a+o,e[t+10]=a-o,a=r*n[14]-i+l*n[12]-c*n[13],o=d*n[15]-u+m*n[16]-p*n[17],e[t+13]=a+o,e[t+14]=a-o,h=s[8]-s[0],g=s[6]-s[2],_=s[5]-s[3],v=s[17]+s[9],b=s[16]+s[10],y=s[15]+s[11],x=s[14]+s[12],e[t+0]=v+y+x+(b+s[13]),a=(v+y+x)*n[19]-(b+s[13]),o=(h-g+_)*n[18],e[t+11]=a+o,e[t+12]=a-o,f=(s[7]-s[1])*n[18],b=s[13]-b*n[19],a=v*n[15]-b+y*n[16]+x*n[17],o=h*n[14]+f+g*n[12]+_*n[13],e[t+3]=a+o,e[t+4]=a-o,a=-v*n[17]+b-y*n[15]-x*n[16],o=h*n[13]+f-g*n[14]-_*n[12],e[t+7]=a+o,e[t+8]=a-o,a=-v*n[16]+b-y*n[17]-x*n[15],o=h*n[12]-f+g*n[13]-_*n[14],e[t+15]=a+o,e[t+16]=a-o}this.mdct_sub48=function(e,n,m){for(var p=n,h=286,f=0;f<e.channels_out;f++){for(var g=0;g<e.mode_gr;g++){for(var _,v=e.l3_side.tt[g][f],b=v.xr,y=0,x=e.sb_sample[f][1-g],w=0,k=0;k<9;k++)for(c(p,h,x[w]),c(p,h+32,x[w+1]),w+=2,h+=64,_=1;_<32;_+=2)x[w-1][_]*=-1;for(_=0;_<32;_++,y+=18){var S=v.block_type,M=e.sb_sample[f][g],A=e.sb_sample[f][1-g];if(0!=v.mixed_block_flag&&_<2&&(S=0),e.amp_filter[_]<1e-12)Ng.fill(b,y+0,y+18,0);else{if(e.amp_filter[_]<1)for(k=0;k<18;k++)A[k][l[_]]*=e.amp_filter[_];if(S==Jg.SHORT_TYPE){for(k=-t/4;k<0;k++){var R=a[Jg.SHORT_TYPE][k+3];b[y+3*k+9]=M[9+k][l[_]]*R-M[8-k][l[_]],b[y+3*k+18]=M[14-k][l[_]]*R+M[15+k][l[_]],b[y+3*k+10]=M[15+k][l[_]]*R-M[14-k][l[_]],b[y+3*k+19]=A[2-k][l[_]]*R+A[3+k][l[_]],b[y+3*k+11]=A[3+k][l[_]]*R-A[2-k][l[_]],b[y+3*k+20]=A[8-k][l[_]]*R+A[9+k][l[_]]}d(b,y)}else{var T=Hg(18);for(k=-s/4;k<0;k++){var E,B;E=a[S][k+27]*A[k+9][l[_]]+a[S][k+36]*A[8-k][l[_]],B=a[S][k+9]*M[k+9][l[_]]-a[S][k+18]*M[8-k][l[_]],T[k+9]=E-B*o[3+k+9],T[k+18]=E*o[3+k+9]+B}u(b,y,T)}}if(S!=Jg.SHORT_TYPE&&0!=_)for(k=7;k>=0;--k){var O,C;O=b[y+k]*r[20+k]+b[y+-1-k]*i[28+k],C=b[y+k]*i[28+k]-b[y+-1-k]*r[20+k],b[y+-1-k]=O,b[y+k]=C}}}if(p=m,h=286,1==e.mode_gr)for(var j=0;j<18;j++)Lg.arraycopy(e.sb_sample[f][1][j],0,e.sb_sample[f][0][j],0,32)}}}var Dg=Ig.System,$g=Ig.new_float,Ug=Ig.new_float_n;function qg(){this.l=$g(Jg.SBMAX_l),this.s=Ug([Jg.SBMAX_s,3]);var e=this;this.assign=function(t){Dg.arraycopy(t.l,0,e.l,0,Jg.SBMAX_l);for(var s=0;s<Jg.SBMAX_s;s++)for(var a=0;a<3;a++)e.s[s][a]=t.s[s][a]}}function Vg(){this.thm=new qg,this.en=new qg}function zg(e){var t=e;this.ordinal=function(){return t}}zg.STEREO=new zg(0),zg.JOINT_STEREO=new zg(1),zg.DUAL_CHANNEL=new zg(2),zg.MONO=new zg(3),zg.NOT_SET=new zg(4);var Xg=Ig.System,Yg=Ig.VbrMode,Kg=Ig.new_array_n,Gg=Ig.new_float,Zg=Ig.new_float_n,Wg=Ig.new_int,Qg=Ig.assert;function Jg(){var e=Jg.FFTOFFSET,t=Jg.MPG_MD_MS_LR,s=null;this.psy=null;var a=null,o=null,n=null;this.setModules=function(e,t,r,i){s=e,this.psy=t,a=t,o=i,n=r};var r=new Fg;function i(e){var t,s;if(0!=e.ATH.useAdjust)if(s=e.loudness_sq[0][0],t=e.loudness_sq[1][0],2==e.channels_out?(s+=e.loudness_sq[0][1],t+=e.loudness_sq[1][1]):(s+=s,t+=t),2==e.mode_gr&&(s=Math.max(s,t)),s*=.5,s*=e.ATH.aaSensitivityP,s>.03125)e.ATH.adjust>=1?e.ATH.adjust=1:e.ATH.adjust<e.ATH.adjustLimit&&(e.ATH.adjust=e.ATH.adjustLimit),e.ATH.adjustLimit=1;else{var a=31.98*s+625e-6;e.ATH.adjust>=a?(e.ATH.adjust*=.075*a+.925,e.ATH.adjust<a&&(e.ATH.adjust=a)):e.ATH.adjustLimit>=a?e.ATH.adjust=a:e.ATH.adjust<e.ATH.adjustLimit&&(e.ATH.adjust=e.ATH.adjustLimit),e.ATH.adjustLimit=a}else e.ATH.adjust=1}function l(e){var t,s;for(Qg(e.bitrate_index>=0&&e.bitrate_index<16),Qg(e.mode_ext>=0&&e.mode_ext<4),e.bitrate_stereoMode_Hist[e.bitrate_index][4]++,e.bitrate_stereoMode_Hist[15][4]++,2==e.channels_out&&(e.bitrate_stereoMode_Hist[e.bitrate_index][e.mode_ext]++,e.bitrate_stereoMode_Hist[15][e.mode_ext]++),t=0;t<e.mode_gr;++t)for(s=0;s<e.channels_out;++s){var a=0|e.l3_side.tt[t][s].block_type;0!=e.l3_side.tt[t][s].mixed_block_flag&&(a=4),e.bitrate_blockType_Hist[e.bitrate_index][a]++,e.bitrate_blockType_Hist[e.bitrate_index][5]++,e.bitrate_blockType_Hist[15][a]++,e.bitrate_blockType_Hist[15][5]++}}function c(e,t){var s,a,o=e.internal_flags;if(0==o.lame_encode_frame_init){var n,i,l=Gg(2014),c=Gg(2014);for(o.lame_encode_frame_init=1,n=0,i=0;n<286+576*(1+o.mode_gr);++n)n<576*o.mode_gr?(l[n]=0,2==o.channels_out&&(c[n]=0)):(l[n]=t[0][i],2==o.channels_out&&(c[n]=t[1][i]),++i);for(a=0;a<o.mode_gr;a++)for(s=0;s<o.channels_out;s++)o.l3_side.tt[a][s].block_type=Jg.SHORT_TYPE;r.mdct_sub48(o,l,c),Qg(o.mf_size>=Jg.BLKSIZE+e.framesize-Jg.FFTOFFSET),Qg(o.mf_size>=512+e.framesize-32)}}this.lame_encode_mp3_frame=function(d,u,m,p,h,f){var g,_=Kg([2,2]);_[0][0]=new Vg,_[0][1]=new Vg,_[1][0]=new Vg,_[1][1]=new Vg;var v,b=Kg([2,2]);b[0][0]=new Vg,b[0][1]=new Vg,b[1][0]=new Vg,b[1][1]=new Vg;var y,x,w,k=[null,null],S=d.internal_flags,M=Zg([2,4]),A=[.5,.5],R=[[0,0],[0,0]],T=[[0,0],[0,0]];if(k[0]=u,k[1]=m,0==S.lame_encode_frame_init&&c(d,k),S.padding=0,(S.slot_lag-=S.frac_SpF)<0&&(S.slot_lag+=d.out_samplerate,S.padding=1),0!=S.psymodel){var E,B=[null,null],O=0,C=Wg(2);for(w=0;w<S.mode_gr;w++){for(x=0;x<S.channels_out;x++)B[x]=k[x],O=576+576*w-Jg.FFTOFFSET;if(E=d.VBR==Yg.vbr_mtrh||d.VBR==Yg.vbr_mt?a.L3psycho_anal_vbr(d,B,O,w,_,b,R[w],T[w],M[w],C):a.L3psycho_anal_ns(d,B,O,w,_,b,R[w],T[w],M[w],C),0!=E)return-4;for(d.mode==zg.JOINT_STEREO&&(A[w]=M[w][2]+M[w][3],A[w]>0&&(A[w]=M[w][3]/A[w])),x=0;x<S.channels_out;x++){var j=S.l3_side.tt[w][x];j.block_type=C[x],j.mixed_block_flag=0}}}else for(w=0;w<S.mode_gr;w++)for(x=0;x<S.channels_out;x++)S.l3_side.tt[w][x].block_type=Jg.NORM_TYPE,S.l3_side.tt[w][x].mixed_block_flag=0,T[w][x]=R[w][x]=700;if(i(S),r.mdct_sub48(S,k[0],k[1]),S.mode_ext=Jg.MPG_MD_LR_LR,d.force_ms)S.mode_ext=Jg.MPG_MD_MS_LR;else if(d.mode==zg.JOINT_STEREO){var I=0,L=0;for(w=0;w<S.mode_gr;w++)for(x=0;x<S.channels_out;x++)I+=T[w][x],L+=R[w][x];if(I<=1*L){var P=S.l3_side.tt[0],N=S.l3_side.tt[S.mode_gr-1];P[0].block_type==P[1].block_type&&N[0].block_type==N[1].block_type&&(S.mode_ext=Jg.MPG_MD_MS_LR)}}if(S.mode_ext==t?(v=b,y=T):(v=_,y=R),d.analysis&&null!=S.pinfo)for(w=0;w<S.mode_gr;w++)for(x=0;x<S.channels_out;x++)S.pinfo.ms_ratio[w]=S.ms_ratio[w],S.pinfo.ms_ener_ratio[w]=A[w],S.pinfo.blocktype[w][x]=S.l3_side.tt[w][x].block_type,S.pinfo.pe[w][x]=y[w][x],Xg.arraycopy(S.l3_side.tt[w][x].xr,0,S.pinfo.xr[w][x],0,576),S.mode_ext==t&&(S.pinfo.ers[w][x]=S.pinfo.ers[w][x+2],Xg.arraycopy(S.pinfo.energy[w][x+2],0,S.pinfo.energy[w][x],0,S.pinfo.energy[w][x].length));if(d.VBR==Yg.vbr_off||d.VBR==Yg.vbr_abr){var H,F;for(H=0;H<18;H++)S.nsPsy.pefirbuf[H]=S.nsPsy.pefirbuf[H+1];for(F=0,w=0;w<S.mode_gr;w++)for(x=0;x<S.channels_out;x++)F+=y[w][x];for(S.nsPsy.pefirbuf[18]=F,F=S.nsPsy.pefirbuf[9],H=0;H<9;H++)F+=(S.nsPsy.pefirbuf[H]+S.nsPsy.pefirbuf[18-H])*Jg.fircoef[H];for(F=3350*S.mode_gr*S.channels_out/F,w=0;w<S.mode_gr;w++)for(x=0;x<S.channels_out;x++)y[w][x]*=F}if(S.iteration_loop.iteration_loop(d,y,A,v),s.format_bitstream(d),g=s.copy_buffer(S,p,h,f,1),d.bWriteVbrTag&&o.addVbrFrame(d),d.analysis&&null!=S.pinfo){for(x=0;x<S.channels_out;x++){var D;for(D=0;D<e;D++)S.pinfo.pcmdata[x][D]=S.pinfo.pcmdata[x][D+d.framesize];for(D=e;D<1600;D++)S.pinfo.pcmdata[x][D]=k[x][D-e]}n.set_frame_pinfo(d,v)}return l(S),g}}Jg.ENCDELAY=576,Jg.POSTDELAY=1152,Jg.MDCTDELAY=48,Jg.FFTOFFSET=224+Jg.MDCTDELAY,Jg.DECDELAY=528,Jg.SBLIMIT=32,Jg.CBANDS=64,Jg.SBPSY_l=21,Jg.SBPSY_s=12,Jg.SBMAX_l=22,Jg.SBMAX_s=13,Jg.PSFB21=6,Jg.PSFB12=6,Jg.BLKSIZE=1024,Jg.HBLKSIZE=Jg.BLKSIZE/2+1,Jg.BLKSIZE_s=256,Jg.HBLKSIZE_s=Jg.BLKSIZE_s/2+1,Jg.NORM_TYPE=0,Jg.START_TYPE=1,Jg.SHORT_TYPE=2,Jg.STOP_TYPE=3,Jg.MPG_MD_LR_LR=0,Jg.MPG_MD_LR_I=1,Jg.MPG_MD_MS_LR=2,Jg.MPG_MD_MS_I=3,Jg.fircoef=[-.1039435,-.1892065,5*-.0432472,-.155915,3898045e-23,.0467745*5,.50455,.756825,.187098*5];var e_=Ig.Util,t_=Ig.new_float;function s_(){var e=t_(Jg.BLKSIZE),t=t_(Jg.BLKSIZE_s/2),s=[.9238795325112867,.3826834323650898,.9951847266721969,.0980171403295606,.9996988186962042,.02454122852291229,.9999811752826011,.006135884649154475];function a(e,t,a){var o,n,r,i=0;a<<=1;var l=t+a;o=4;do{var c,d,u,m,p,h,f;f=o>>1,m=o,p=o<<1,h=p+m,o=p<<1,n=t,r=n+f;do{w=e[n+0]-e[n+m],x=e[n+0]+e[n+m],A=e[n+p]-e[n+h],S=e[n+p]+e[n+h],e[n+p]=x-S,e[n+0]=x+S,e[n+h]=w-A,e[n+m]=w+A,w=e[r+0]-e[r+m],x=e[r+0]+e[r+m],A=e_.SQRT2*e[r+h],S=e_.SQRT2*e[r+p],e[r+p]=x-S,e[r+0]=x+S,e[r+h]=w-A,e[r+m]=w+A,r+=o,n+=o}while(n<l);for(d=s[i+0],c=s[i+1],u=1;u<f;u++){var g,_;g=1-2*c*c,_=2*c*d,n=t+u,r=t+m-u;do{var v,b,y,x,w,k,S,M,A,R;b=_*e[n+m]-g*e[r+m],v=g*e[n+m]+_*e[r+m],w=e[n+0]-v,x=e[n+0]+v,k=e[r+0]-b,y=e[r+0]+b,b=_*e[n+h]-g*e[r+h],v=g*e[n+h]+_*e[r+h],A=e[n+p]-v,S=e[n+p]+v,R=e[r+p]-b,M=e[r+p]+b,b=c*S-d*R,v=d*S+c*R,e[n+p]=x-v,e[n+0]=x+v,e[r+h]=k-b,e[r+m]=k+b,b=d*M-c*A,v=c*M+d*A,e[r+p]=y-v,e[r+0]=y+v,e[n+h]=w-b,e[n+m]=w+b,r+=o,n+=o}while(n<l);g=d,d=g*s[i+0]-c*s[i+1],c=g*s[i+1]+c*s[i+0]}i+=2}while(o<a)}var o=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254];this.fft_short=function(e,s,n,r,i){for(var l=0;l<3;l++){var c=Jg.BLKSIZE_s/2,d=65535&192*(l+1),u=Jg.BLKSIZE_s/8-1;do{var m,p,h,f,g,_=255&o[u<<2];m=t[_]*r[n][i+_+d],g=t[127-_]*r[n][i+_+d+128],p=m-g,m+=g,h=t[_+64]*r[n][i+_+d+64],g=t[63-_]*r[n][i+_+d+192],f=h-g,h+=g,c-=4,s[l][c+0]=m+h,s[l][c+2]=m-h,s[l][c+1]=p+f,s[l][c+3]=p-f,m=t[_+1]*r[n][i+_+d+1],g=t[126-_]*r[n][i+_+d+129],p=m-g,m+=g,h=t[_+65]*r[n][i+_+d+65],g=t[62-_]*r[n][i+_+d+193],f=h-g,h+=g,s[l][c+Jg.BLKSIZE_s/2+0]=m+h,s[l][c+Jg.BLKSIZE_s/2+2]=m-h,s[l][c+Jg.BLKSIZE_s/2+1]=p+f,s[l][c+Jg.BLKSIZE_s/2+3]=p-f}while(--u>=0);a(s[l],c,Jg.BLKSIZE_s/2)}},this.fft_long=function(t,s,n,r,i){var l=Jg.BLKSIZE/8-1,c=Jg.BLKSIZE/2;do{var d,u,m,p,h,f=255&o[l];d=e[f]*r[n][i+f],h=e[f+512]*r[n][i+f+512],u=d-h,d+=h,m=e[f+256]*r[n][i+f+256],h=e[f+768]*r[n][i+f+768],p=m-h,m+=h,c-=4,s[c+0]=d+m,s[c+2]=d-m,s[c+1]=u+p,s[c+3]=u-p,d=e[f+1]*r[n][i+f+1],h=e[f+513]*r[n][i+f+513],u=d-h,d+=h,m=e[f+257]*r[n][i+f+257],h=e[f+769]*r[n][i+f+769],p=m-h,m+=h,s[c+Jg.BLKSIZE/2+0]=d+m,s[c+Jg.BLKSIZE/2+2]=d-m,s[c+Jg.BLKSIZE/2+1]=u+p,s[c+Jg.BLKSIZE/2+3]=u-p}while(--l>=0);a(s,c,Jg.BLKSIZE/2)},this.init_fft=function(s){for(var a=0;a<Jg.BLKSIZE;a++)e[a]=.42-.5*Math.cos(2*Math.PI*(a+.5)/Jg.BLKSIZE)+.08*Math.cos(4*Math.PI*(a+.5)/Jg.BLKSIZE);for(a=0;a<Jg.BLKSIZE_s/2;a++)t[a]=.5*(1-Math.cos(2*Math.PI*(a+.5)/Jg.BLKSIZE_s))}}var a_=Ig.VbrMode,o_=Ig.Float,n_=Ig.ShortBlock,r_=Ig.Util,i_=Ig.Arrays,l_=Ig.new_float,c_=Ig.new_float_n,d_=Ig.new_int,u_=Ig.assert;function m_(){var e=new s_,t=2.302585092994046,s=2,a=16,o=2,n=16,r=.34,i=1/217621504/(Jg.BLKSIZE/2),l=.01,c=.8,d=.6,u=.3,m=3.5,p=21,h=.2302585093;function f(e){return e}function g(e,t){for(var s=0,a=0;a<Jg.BLKSIZE/2;++a)s+=e[a]*t.ATH.eql_w[a];return s*=i,s}function _(t,s,a,o,n,r,i,l,c,d,u){var m=t.internal_flags;if(c<2)e.fft_long(m,o[n],c,d,u),e.fft_short(m,r[i],c,d,u);else if(2==c){for(var p=Jg.BLKSIZE-1;p>=0;--p){var h=o[n+0][p],_=o[n+1][p];o[n+0][p]=(h+_)*r_.SQRT2*.5,o[n+1][p]=(h-_)*r_.SQRT2*.5}for(var v=2;v>=0;--v)for(p=Jg.BLKSIZE_s-1;p>=0;--p){h=r[i+0][v][p],_=r[i+1][v][p];r[i+0][v][p]=(h+_)*r_.SQRT2*.5,r[i+1][v][p]=(h-_)*r_.SQRT2*.5}}s[0]=f(o[n+0][0]),s[0]*=s[0];for(p=Jg.BLKSIZE/2-1;p>=0;--p){var b=o[n+0][Jg.BLKSIZE/2-p],y=o[n+0][Jg.BLKSIZE/2+p];s[Jg.BLKSIZE/2-p]=f(.5*(b*b+y*y))}for(v=2;v>=0;--v){a[v][0]=r[i+0][v][0],a[v][0]*=a[v][0];for(p=Jg.BLKSIZE_s/2-1;p>=0;--p){b=r[i+0][v][Jg.BLKSIZE_s/2-p],y=r[i+0][v][Jg.BLKSIZE_s/2+p];a[v][Jg.BLKSIZE_s/2-p]=f(.5*(b*b+y*y))}}var x=0;for(p=11;p<Jg.HBLKSIZE;p++)x+=s[p];if(m.tot_ener[c]=x,t.analysis){for(p=0;p<Jg.HBLKSIZE;p++)m.pinfo.energy[l][c][p]=m.pinfo.energy_save[c][p],m.pinfo.energy_save[c][p]=s[p];m.pinfo.pe[l][c]=m.pe[c]}2==t.athaa_loudapprox&&c<2&&(m.loudness_sq[l][c]=m.loudness_sq_save[c],m.loudness_sq_save[c]=g(s,m))}var v,b,y,x=8,w=23,k=15,S=[1,.79433,.63096,.63096,.63096,.63096,.63096,.25119,.11749];function M(){v=Math.pow(10,(x+1)/16),b=Math.pow(10,(w+1)/16),y=Math.pow(10,k/10)}var A=[3.3246*3.3246,3.23837*3.23837,9.9500500969,9.0247369744,8.1854926609,7.0440875649,2.46209*2.46209,2.284*2.284,4.4892710641,1.96552*1.96552,1.82335*1.82335,1.69146*1.69146,2.4621061921,2.1508568964,1.37074*1.37074,1.31036*1.31036,1.5691069696,1.4555939904,1.16203*1.16203,1.2715945225,1.09428*1.09428,1.0659*1.0659,1.0779838276,1.0382591025,1],R=[1.7782755904,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.6999465924,1.22321*1.22321,1.3169398564,1],T=[5.5396212496,2.29259*2.29259,4.9868695969,2.12675*2.12675,2.02545*2.02545,1.87894*1.87894,1.74303*1.74303,1.61695*1.61695,2.2499700001,1.39148*1.39148,1.29083*1.29083,1.19746*1.19746,1.2339655056,1.0779838276];function E(e,t,s,a,o,n){var r;if(t>e){if(!(t<e*b))return e+t;r=t/e}else{if(e>=t*b)return e+t;r=e/t}if(e+=t,a+3<=6){if(r>=v)return e;var i=0|r_.FAST_LOG10_X(r,16);return e*R[i]}var l,c;i=0|r_.FAST_LOG10_X(r,16);return t=0!=n?o.ATH.cb_s[s]*o.ATH.adjust:o.ATH.cb_l[s]*o.ATH.adjust,e<y*t?e>t?(l=1,i<=13&&(l=T[i]),c=r_.FAST_LOG10_X(e/t,10/15),e*((A[i]-l)*c+l)):i>13?e:e*T[i]:e*A[i]}var B=[1.7782755904,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.6999465924,1.22321*1.22321,1.3169398564,1];function O(e,t,s){var a;if(e<0&&(e=0),t<0&&(t=0),e<=0)return t;if(t<=0)return e;if(a=t>e?t/e:e/t,s>=-2&&s<=2){if(a>=v)return e+t;var o=0|r_.FAST_LOG10_X(a,16);return(e+t)*B[o]}return a<b?e+t:(e<t&&(e=t),e)}function C(e,t){var s=e.internal_flags;if(s.channels_out>1){for(var a=0;a<Jg.SBMAX_l;a++){var o=s.thm[0].l[a],n=s.thm[1].l[a];s.thm[0].l[a]+=n*t,s.thm[1].l[a]+=o*t}for(a=0;a<Jg.SBMAX_s;a++)for(var r=0;r<3;r++){o=s.thm[0].s[a][r],n=s.thm[1].s[a][r];s.thm[0].s[a][r]+=n*t,s.thm[1].s[a][r]+=o*t}}}function j(e){for(var t=0;t<Jg.SBMAX_l;t++)if(!(e.thm[0].l[t]>1.58*e.thm[1].l[t]||e.thm[1].l[t]>1.58*e.thm[0].l[t])){var s=e.mld_l[t]*e.en[3].l[t],a=Math.max(e.thm[2].l[t],Math.min(e.thm[3].l[t],s));s=e.mld_l[t]*e.en[2].l[t];var o=Math.max(e.thm[3].l[t],Math.min(e.thm[2].l[t],s));e.thm[2].l[t]=a,e.thm[3].l[t]=o}for(t=0;t<Jg.SBMAX_s;t++)for(var n=0;n<3;n++)if(!(e.thm[0].s[t][n]>1.58*e.thm[1].s[t][n]||e.thm[1].s[t][n]>1.58*e.thm[0].s[t][n])){s=e.mld_s[t]*e.en[3].s[t][n],a=Math.max(e.thm[2].s[t][n],Math.min(e.thm[3].s[t][n],s));s=e.mld_s[t]*e.en[2].s[t][n];o=Math.max(e.thm[3].s[t][n],Math.min(e.thm[2].s[t][n],s));e.thm[2].s[t][n]=a,e.thm[3].s[t][n]=o}}function I(e,t,s){var a=t,o=Math.pow(10,s);t*=2,a*=2;for(var n=0;n<Jg.SBMAX_l;n++){if(u=e.ATH.cb_l[e.bm_l[n]]*o,l=Math.min(Math.max(e.thm[0].l[n],u),Math.max(e.thm[1].l[n],u)),c=Math.max(e.thm[2].l[n],u),d=Math.max(e.thm[3].l[n],u),l*t<c+d){var r=l*a/(c+d);c*=r,d*=r}e.thm[2].l[n]=Math.min(c,e.thm[2].l[n]),e.thm[3].l[n]=Math.min(d,e.thm[3].l[n])}o*=Jg.BLKSIZE_s/Jg.BLKSIZE;for(n=0;n<Jg.SBMAX_s;n++)for(var i=0;i<3;i++){var l,c,d,u;if(u=e.ATH.cb_s[e.bm_s[n]]*o,l=Math.min(Math.max(e.thm[0].s[n][i],u),Math.max(e.thm[1].s[n][i],u)),c=Math.max(e.thm[2].s[n][i],u),d=Math.max(e.thm[3].s[n][i],u),l*t<c+d){r=l*t/(c+d);c*=r,d*=r}e.thm[2].s[n][i]=Math.min(e.thm[2].s[n][i],c),e.thm[3].s[n][i]=Math.min(e.thm[3].s[n][i],d)}}function L(e,t,s,a,o){var n,r,i=0,l=0;for(n=r=0;n<Jg.SBMAX_s;++r,++n){var c=e.bo_s[n],d=e.npart_s,u=c<d?c:d;while(r<u)u_(t[r]>=0),u_(s[r]>=0),i+=t[r],l+=s[r],r++;if(e.en[a].s[n][o]=i,e.thm[a].s[n][o]=l,r>=d){++n;break}u_(t[r]>=0),u_(s[r]>=0);var m=e.PSY.bo_s_weight[n],p=1-m;i=m*t[r],l=m*s[r],e.en[a].s[n][o]+=i,e.thm[a].s[n][o]+=l,i=p*t[r],l=p*s[r]}for(;n<Jg.SBMAX_s;++n)e.en[a].s[n][o]=0,e.thm[a].s[n][o]=0}function P(e,t,s,a){var o,n,r=0,i=0;for(o=n=0;o<Jg.SBMAX_l;++n,++o){var l=e.bo_l[o],c=e.npart_l,d=l<c?l:c;while(n<d)u_(t[n]>=0),u_(s[n]>=0),r+=t[n],i+=s[n],n++;if(e.en[a].l[o]=r,e.thm[a].l[o]=i,n>=c){++o;break}u_(t[n]>=0),u_(s[n]>=0);var u=e.PSY.bo_l_weight[o],m=1-u;r=u*t[n],i=u*s[n],e.en[a].l[o]+=r,e.thm[a].l[o]+=i,r=m*t[n],i=m*s[n]}for(;o<Jg.SBMAX_l;++o)e.en[a].l[o]=0,e.thm[a].l[o]=0}function N(e,t,s,a,r,i){var l,c,d=e.internal_flags;for(c=l=0;c<d.npart_s;++c){for(var u=0,m=d.numlines_s[c],p=0;p<m;++p,++l){var h=t[i][l];u+=h}s[c]=u}for(u_(c==d.npart_s),l=c=0;c<d.npart_s;c++){var f=d.s3ind_s[c][0],g=d.s3_ss[l++]*s[f];++f;while(f<=d.s3ind_s[c][1])g+=d.s3_ss[l]*s[f],++l,++f;var _=o*d.nb_s1[r][c];if(a[c]=Math.min(g,_),d.blocktype_old[1&r]==Jg.SHORT_TYPE){_=n*d.nb_s2[r][c];var v=a[c];a[c]=Math.min(_,v)}d.nb_s2[r][c]=d.nb_s1[r][c],d.nb_s1[r][c]=g,u_(a[c]>=0)}for(;c<=Jg.CBANDS;++c)s[c]=0,a[c]=0}function H(e,t,s,a){var o=e.internal_flags;e.short_blocks!=n_.short_block_coupled||0!=t[0]&&0!=t[1]||(t[0]=t[1]=0);for(var n=0;n<o.channels_out;n++)a[n]=Jg.NORM_TYPE,e.short_blocks==n_.short_block_dispensed&&(t[n]=1),e.short_blocks==n_.short_block_forced&&(t[n]=0),0!=t[n]?(u_(o.blocktype_old[n]!=Jg.START_TYPE),o.blocktype_old[n]==Jg.SHORT_TYPE&&(a[n]=Jg.STOP_TYPE)):(a[n]=Jg.SHORT_TYPE,o.blocktype_old[n]==Jg.NORM_TYPE&&(o.blocktype_old[n]=Jg.START_TYPE),o.blocktype_old[n]==Jg.STOP_TYPE&&(o.blocktype_old[n]=Jg.SHORT_TYPE)),s[n]=o.blocktype_old[n],o.blocktype_old[n]=a[n]}function F(e,t,s){return s>=1?e:s<=0?t:t>0?Math.pow(e/t,s)*t:0}var D=[11.8,13.6,17.2,32,46.5,51.3,57.5,67.1,71.5,84.6,97.6,130];function $(e,s){for(var a=309.07,o=0;o<Jg.SBMAX_s-1;o++)for(var n=0;n<3;n++){var r=e.thm.s[o][n];if(r>0){var i=r*s,l=e.en.s[o][n];l>i&&(a+=l>1e10*i?D[o]*(10*t):D[o]*r_.FAST_LOG10(l/i))}}return a}var U=[6.8,5.8,5.8,6.4,6.5,9.9,12.1,14.4,15,18.9,21.6,26.9,34.2,40.2,46.8,56.5,60.7,73.9,85.7,93.4,126.1];function q(e,s){for(var a=281.0575,o=0;o<Jg.SBMAX_l-1;o++){var n=e.thm.l[o];if(n>0){var r=n*s,i=e.en.l[o];i>r&&(a+=i>1e10*r?U[o]*(10*t):U[o]*r_.FAST_LOG10(i/r))}}return a}function V(e,t,s,a,o){var n,r;for(n=r=0;n<e.npart_l;++n){var i,l=0,c=0;for(i=0;i<e.numlines_l[n];++i,++r){var d=t[r];l+=d,c<d&&(c=d)}s[n]=l,a[n]=c,o[n]=l*e.rnumlines_l[n],u_(e.rnumlines_l[n]>=0),u_(s[n]>=0),u_(a[n]>=0),u_(o[n]>=0)}}function z(e,t,s,a){var o=S.length-1,n=0,r=s[n]+s[n+1];if(r>0){var i=t[n];i<t[n+1]&&(i=t[n+1]),u_(e.numlines_l[n]+e.numlines_l[n+1]-1>0),r=20*(2*i-r)/(r*(e.numlines_l[n]+e.numlines_l[n+1]-1));var l=0|r;l>o&&(l=o),a[n]=l}else a[n]=0;for(n=1;n<e.npart_l-1;n++)if(r=s[n-1]+s[n]+s[n+1],r>0){i=t[n-1];i<t[n]&&(i=t[n]),i<t[n+1]&&(i=t[n+1]),u_(e.numlines_l[n-1]+e.numlines_l[n]+e.numlines_l[n+1]-1>0),r=20*(3*i-r)/(r*(e.numlines_l[n-1]+e.numlines_l[n]+e.numlines_l[n+1]-1));l=0|r;l>o&&(l=o),a[n]=l}else a[n]=0;if(u_(n==e.npart_l-1),r=s[n-1]+s[n],r>0){i=t[n-1];i<t[n]&&(i=t[n]),u_(e.numlines_l[n-1]+e.numlines_l[n]-1>0),r=20*(2*i-r)/(r*(e.numlines_l[n-1]+e.numlines_l[n]-1));l=0|r;l>o&&(l=o),a[n]=l}else a[n]=0;u_(n==e.npart_l-1)}var X=[-1730326e-23,-.01703172,-1349528e-23,.0418072,-673278e-22,-.0876324,-30835e-21,.1863476,-1104424e-22,-.627638];function Y(t,s,a,o,n,r,i,l){var c=t.internal_flags;if(o<2)e.fft_long(c,i[l],o,s,a);else if(2==o)for(var d=Jg.BLKSIZE-1;d>=0;--d){var u=i[l+0][d],m=i[l+1][d];i[l+0][d]=(u+m)*r_.SQRT2*.5,i[l+1][d]=(u-m)*r_.SQRT2*.5}r[0]=f(i[l+0][0]),r[0]*=r[0];for(d=Jg.BLKSIZE/2-1;d>=0;--d){var p=i[l+0][Jg.BLKSIZE/2-d],h=i[l+0][Jg.BLKSIZE/2+d];r[Jg.BLKSIZE/2-d]=f(.5*(p*p+h*h))}var g=0;for(d=11;d<Jg.HBLKSIZE;d++)g+=r[d];if(c.tot_ener[o]=g,t.analysis){for(d=0;d<Jg.HBLKSIZE;d++)c.pinfo.energy[n][o][d]=c.pinfo.energy_save[o][d],c.pinfo.energy_save[o][d]=r[d];c.pinfo.pe[n][o]=c.pe[o]}}function K(t,s,a,o,n,r,i,l){var c=t.internal_flags;if(0==n&&o<2&&e.fft_short(c,i[l],o,s,a),2==o)for(var d=Jg.BLKSIZE_s-1;d>=0;--d){var u=i[l+0][n][d],m=i[l+1][n][d];i[l+0][n][d]=(u+m)*r_.SQRT2*.5,i[l+1][n][d]=(u-m)*r_.SQRT2*.5}r[n][0]=i[l+0][n][0],r[n][0]*=r[n][0];for(d=Jg.BLKSIZE_s/2-1;d>=0;--d){var p=i[l+0][n][Jg.BLKSIZE_s/2-d],h=i[l+0][n][Jg.BLKSIZE_s/2+d];r[n][Jg.BLKSIZE_s/2-d]=f(.5*(p*p+h*h))}}function G(e,t,s,a){var o=e.internal_flags;2==e.athaa_loudapprox&&s<2&&(o.loudness_sq[t][s]=o.loudness_sq_save[s],o.loudness_sq_save[s]=g(a,o))}this.L3psycho_anal_ns=function(e,t,o,n,r,i,l,m,h,f){var g,v,b,y,x,w,k,M,A,R,T=e.internal_flags,B=c_([2,Jg.BLKSIZE]),O=c_([2,3,Jg.BLKSIZE_s]),D=l_(Jg.CBANDS+1),U=l_(Jg.CBANDS+1),Y=l_(Jg.CBANDS+2),K=d_(2),G=d_(2),Z=c_([2,576]),W=d_(Jg.CBANDS+2),Q=d_(Jg.CBANDS+2);for(i_.fill(Q,0),g=T.channels_out,e.mode==zg.JOINT_STEREO&&(g=4),A=e.VBR==a_.vbr_off?0==T.ResvMax?0:T.ResvSize/T.ResvMax*.5:e.VBR==a_.vbr_rh||e.VBR==a_.vbr_mtrh||e.VBR==a_.vbr_mt?.6:1,v=0;v<T.channels_out;v++){var J=t[v],ee=o+576-350-p+192;for(y=0;y<576;y++){var te,se;for(te=J[ee+y+10],se=0,x=0;x<(p-1)/2-1;x+=2)te+=X[x]*(J[ee+y+x]+J[ee+y+p-x]),se+=X[x+1]*(J[ee+y+x+1]+J[ee+y+p-x-1]);Z[v][y]=te+se}r[n][v].en.assign(T.en[v]),r[n][v].thm.assign(T.thm[v]),g>2&&(i[n][v].en.assign(T.en[v+2]),i[n][v].thm.assign(T.thm[v+2]))}for(v=0;v<g;v++){var ae,oe,ne,re=l_(12),ie=[0,0,0,0],le=l_(12),ce=1,de=l_(Jg.CBANDS),ue=l_(Jg.CBANDS),me=[0,0,0,0],pe=l_(Jg.HBLKSIZE),he=c_([3,Jg.HBLKSIZE_s]);for(u_(T.npart_s<=Jg.CBANDS),u_(T.npart_l<=Jg.CBANDS),y=0;y<3;y++)re[y]=T.nsPsy.last_en_subshort[v][y+6],u_(T.nsPsy.last_en_subshort[v][y+4]>0),le[y]=re[y]/T.nsPsy.last_en_subshort[v][y+4],ie[0]+=re[y];if(2==v)for(y=0;y<576;y++){var fe,ge;fe=Z[0][y],ge=Z[1][y],Z[0][y]=fe+ge,Z[1][y]=fe-ge}var _e=Z[1&v],ve=0;for(y=0;y<9;y++){for(var be=ve+64,ye=1;ve<be;ve++)ye<Math.abs(_e[ve])&&(ye=Math.abs(_e[ve]));T.nsPsy.last_en_subshort[v][y]=re[y+3]=ye,ie[1+y/3]+=ye,ye>re[y+3-2]?(u_(re[y+3-2]>0),ye/=re[y+3-2]):ye=re[y+3-2]>10*ye?re[y+3-2]/(10*ye):0,le[y+3]=ye}if(e.analysis){var xe=le[0];for(y=1;y<12;y++)xe<le[y]&&(xe=le[y]);T.pinfo.ers[n][v]=T.pinfo.ers_save[v],T.pinfo.ers_save[v]=xe}for(ne=3==v?T.nsPsy.attackthre_s:T.nsPsy.attackthre,y=0;y<12;y++)0==me[y/3]&&le[y]>ne&&(me[y/3]=y%3+1);for(y=1;y<4;y++){var we;ie[y-1]>ie[y]?(u_(ie[y]>0),we=ie[y-1]/ie[y]):(u_(ie[y-1]>0),we=ie[y]/ie[y-1]),we<1.7&&(me[y]=0,1==y&&(me[0]=0))}for(0!=me[0]&&0!=T.nsPsy.lastAttacks[v]&&(me[0]=0),3!=T.nsPsy.lastAttacks[v]&&me[0]+me[1]+me[2]+me[3]==0||(ce=0,0!=me[1]&&0!=me[0]&&(me[1]=0),0!=me[2]&&0!=me[1]&&(me[2]=0),0!=me[3]&&0!=me[2]&&(me[3]=0)),v<2?G[v]=ce:0==ce&&(G[0]=G[1]=0),h[v]=T.tot_ener[v],oe=O,ae=B,_(e,pe,he,ae,1&v,oe,1&v,n,v,t,o),V(T,pe,D,de,ue),z(T,de,ue,W),M=0;M<3;M++){var ke,Se;for(N(e,he,U,Y,v,M),L(T,U,Y,v,M),k=0;k<Jg.SBMAX_s;k++){if(Se=T.thm[v].s[k][M],Se*=c,me[M]>=2||1==me[M+1]){var Me=0!=M?M-1:2;ye=F(T.thm[v].s[k][Me],Se,d*A);Se=Math.min(Se,ye)}if(1==me[M]){Me=0!=M?M-1:2,ye=F(T.thm[v].s[k][Me],Se,u*A);Se=Math.min(Se,ye)}else if(0!=M&&3==me[M-1]||0==M&&3==T.nsPsy.lastAttacks[v]){Me=2!=M?M+1:0,ye=F(T.thm[v].s[k][Me],Se,u*A);Se=Math.min(Se,ye)}ke=re[3*M+3]+re[3*M+4]+re[3*M+5],6*re[3*M+5]<ke&&(Se*=.5,6*re[3*M+4]<ke&&(Se*=.5)),T.thm[v].s[k][M]=Se}}for(T.nsPsy.lastAttacks[v]=me[2],w=0,b=0;b<T.npart_l;b++){var Ae=T.s3ind[b][0],Re=D[Ae]*S[W[Ae]],Te=T.s3_ll[w++]*Re;while(++Ae<=T.s3ind[b][1])Re=D[Ae]*S[W[Ae]],Te=E(Te,T.s3_ll[w++]*Re,Ae,Ae-b,T,0);Te*=.158489319246111,T.blocktype_old[1&v]==Jg.SHORT_TYPE?Y[b]=Te:Y[b]=F(Math.min(Te,Math.min(s*T.nb_1[v][b],a*T.nb_2[v][b])),Te,A),T.nb_2[v][b]=T.nb_1[v][b],T.nb_1[v][b]=Te}for(;b<=Jg.CBANDS;++b)D[b]=0,Y[b]=0;P(T,D,Y,v)}(e.mode!=zg.STEREO&&e.mode!=zg.JOINT_STEREO||e.interChRatio>0&&C(e,e.interChRatio),e.mode==zg.JOINT_STEREO)&&(j(T),R=e.msfix,Math.abs(R)>0&&I(T,R,e.ATHlower*T.ATH.adjust));for(H(e,G,f,K),v=0;v<g;v++){var Ee,Be,Oe,Ce=0;v>1?(Ee=m,Ce=-2,Be=Jg.NORM_TYPE,f[0]!=Jg.SHORT_TYPE&&f[1]!=Jg.SHORT_TYPE||(Be=Jg.SHORT_TYPE),Oe=i[n][v-2]):(Ee=l,Ce=0,Be=f[v],Oe=r[n][v]),Be==Jg.SHORT_TYPE?Ee[Ce+v]=$(Oe,T.masking_lower):Ee[Ce+v]=q(Oe,T.masking_lower),e.analysis&&(T.pinfo.pe[n][v]=Ee[Ce+v])}return 0};var Z=[-1730326e-23,-.01703172,-1349528e-23,.0418072,-673278e-22,-.0876324,-30835e-21,.1863476,-1104424e-22,-.627638];function W(e,t,s,a,o,n,r,i,l,c){for(var d=c_([2,576]),u=e.internal_flags,m=u.channels_out,h=e.mode==zg.JOINT_STEREO?4:m,f=0;f<m;f++){firbuf=t[f];for(var g=s+576-350-p+192,_=0;_<576;_++){var v,b;v=firbuf[g+_+10],b=0;for(var y=0;y<(p-1)/2-1;y+=2)v+=Z[y]*(firbuf[g+_+y]+firbuf[g+_+p-y]),b+=Z[y+1]*(firbuf[g+_+y+1]+firbuf[g+_+p-y-1]);d[f][_]=v+b}o[a][f].en.assign(u.en[f]),o[a][f].thm.assign(u.thm[f]),h>2&&(n[a][f].en.assign(u.en[f+2]),n[a][f].thm.assign(u.thm[f+2]))}for(f=0;f<h;f++){var x=l_(12),w=l_(12),k=[0,0,0,0],S=d[1&f],M=0,A=3==f?u.nsPsy.attackthre_s:u.nsPsy.attackthre,R=1;if(2==f)for(_=0,y=576;y>0;++_,--y){var T=d[0][_],E=d[1][_];d[0][_]=T+E,d[1][_]=T-E}for(_=0;_<3;_++)w[_]=u.nsPsy.last_en_subshort[f][_+6],u_(u.nsPsy.last_en_subshort[f][_+4]>0),x[_]=w[_]/u.nsPsy.last_en_subshort[f][_+4],k[0]+=w[_];for(_=0;_<9;_++){for(var B=M+64,O=1;M<B;M++)O<Math.abs(S[M])&&(O=Math.abs(S[M]));u.nsPsy.last_en_subshort[f][_]=w[_+3]=O,k[1+_/3]+=O,O>w[_+3-2]?(u_(w[_+3-2]>0),O/=w[_+3-2]):O=w[_+3-2]>10*O?w[_+3-2]/(10*O):0,x[_+3]=O}for(_=0;_<3;++_){var C=w[3*_+3]+w[3*_+4]+w[3*_+5],j=1;6*w[3*_+5]<C&&(j*=.5,6*w[3*_+4]<C&&(j*=.5)),i[f][_]=j}if(e.analysis){var I=x[0];for(_=1;_<12;_++)I<x[_]&&(I=x[_]);u.pinfo.ers[a][f]=u.pinfo.ers_save[f],u.pinfo.ers_save[f]=I}for(_=0;_<12;_++)0==l[f][_/3]&&x[_]>A&&(l[f][_/3]=_%3+1);for(_=1;_<4;_++){var L=k[_-1],P=k[_],N=Math.max(L,P);N<4e4&&L<1.7*P&&P<1.7*L&&(1==_&&l[f][0]<=l[f][_]&&(l[f][0]=0),l[f][_]=0)}l[f][0]<=u.nsPsy.lastAttacks[f]&&(l[f][0]=0),3!=u.nsPsy.lastAttacks[f]&&l[f][0]+l[f][1]+l[f][2]+l[f][3]==0||(R=0,0!=l[f][1]&&0!=l[f][0]&&(l[f][1]=0),0!=l[f][2]&&0!=l[f][1]&&(l[f][2]=0),0!=l[f][3]&&0!=l[f][2]&&(l[f][3]=0)),f<2?c[f]=R:0==R&&(c[0]=c[1]=0),r[f]=u.tot_ener[f]}}function Q(e,t,s){if(0==s)for(var a=0;a<e.npart_s;a++)e.nb_s2[t][a]=e.nb_s1[t][a],e.nb_s1[t][a]=0}function J(e,t){for(var s=0;s<e.npart_l;s++)e.nb_2[t][s]=e.nb_1[t][s],e.nb_1[t][s]=0}function ee(e,t,s,a){var o=S.length-1,n=0,r=s[n]+s[n+1];if(r>0){var i=t[n];i<t[n+1]&&(i=t[n+1]),u_(e.numlines_s[n]+e.numlines_s[n+1]-1>0),r=20*(2*i-r)/(r*(e.numlines_s[n]+e.numlines_s[n+1]-1));var l=0|r;l>o&&(l=o),a[n]=l}else a[n]=0;for(n=1;n<e.npart_s-1;n++)if(r=s[n-1]+s[n]+s[n+1],u_(n+1<e.npart_s),r>0){i=t[n-1];i<t[n]&&(i=t[n]),i<t[n+1]&&(i=t[n+1]),u_(e.numlines_s[n-1]+e.numlines_s[n]+e.numlines_s[n+1]-1>0),r=20*(3*i-r)/(r*(e.numlines_s[n-1]+e.numlines_s[n]+e.numlines_s[n+1]-1));l=0|r;l>o&&(l=o),a[n]=l}else a[n]=0;if(u_(n==e.npart_s-1),r=s[n-1]+s[n],r>0){i=t[n-1];i<t[n]&&(i=t[n]),u_(e.numlines_s[n-1]+e.numlines_s[n]-1>0),r=20*(2*i-r)/(r*(e.numlines_s[n-1]+e.numlines_s[n]-1));l=0|r;l>o&&(l=o),a[n]=l}else a[n]=0;u_(n==e.npart_s-1)}function te(e,t,s,a,o,n){var r,i,l,c=e.internal_flags,d=new float[Jg.CBANDS],u=l_(Jg.CBANDS),m=new int[Jg.CBANDS];for(l=i=0;l<c.npart_s;++l){var p=0,h=0,f=c.numlines_s[l];for(r=0;r<f;++r,++i){var g=t[n][i];p+=g,h<g&&(h=g)}s[l]=p,d[l]=h,u[l]=p/f,u_(u[l]>=0)}for(u_(l==c.npart_s);l<Jg.CBANDS;++l)d[l]=0,u[l]=0;for(ee(c,d,u,m),i=l=0;l<c.npart_s;l++){var _,v,b,y,x,w=c.s3ind_s[l][0],k=c.s3ind_s[l][1];_=m[w],v=1,y=c.s3_ss[i]*s[w]*S[m[w]],++i,++w;while(w<=k)_+=m[w],v+=1,b=c.s3_ss[i]*s[w]*S[m[w]],y=O(y,b,w-l),++i,++w;_=(1+2*_)/(2*v),x=.5*S[_],y*=x,a[l]=y,c.nb_s2[o][l]=c.nb_s1[o][l],c.nb_s1[o][l]=y,b=d[l],b*=c.minval_s[l],b*=x,a[l]>b&&(a[l]=b),c.masking_lower>1&&(a[l]*=c.masking_lower),a[l]>s[l]&&(a[l]=s[l]),c.masking_lower<1&&(a[l]*=c.masking_lower),u_(a[l]>=0)}for(;l<Jg.CBANDS;++l)s[l]=0,a[l]=0}function se(e,t,o,n,r){var i,l=l_(Jg.CBANDS),c=l_(Jg.CBANDS),d=d_(Jg.CBANDS+2);V(e,t,o,l,c),z(e,l,c,d);var m=0;for(i=0;i<e.npart_l;i++){var p,h,f,g,_=e.s3ind[i][0],v=e.s3ind[i][1],b=0,y=0;b=d[_],y+=1,h=e.s3_ll[m]*o[_]*S[d[_]],++m,++_;while(_<=v)b+=d[_],y+=1,p=e.s3_ll[m]*o[_]*S[d[_]],g=O(h,p,_-i),h=g,++m,++_;if(b=(1+2*b)/(2*y),f=.5*S[b],h*=f,e.blocktype_old[1&r]==Jg.SHORT_TYPE){var x=s*e.nb_1[r][i];n[i]=x>0?Math.min(h,x):Math.min(h,o[i]*u)}else{var w=a*e.nb_2[r][i],k=s*e.nb_1[r][i];w<=0&&(w=h),k<=0&&(k=h),x=e.blocktype_old[1&r]==Jg.NORM_TYPE?Math.min(k,w):k,n[i]=Math.min(h,x)}e.nb_2[r][i]=e.nb_1[r][i],e.nb_1[r][i]=h,p=l[i],p*=e.minval_l[i],p*=f,n[i]>p&&(n[i]=p),e.masking_lower>1&&(n[i]*=e.masking_lower),n[i]>o[i]&&(n[i]=o[i]),e.masking_lower<1&&(n[i]*=e.masking_lower),u_(n[i]>=0)}for(;i<Jg.CBANDS;++i)o[i]=0,n[i]=0}function ae(e,t){var s=e.internal_flags;e.short_blocks!=n_.short_block_coupled||0!=t[0]&&0!=t[1]||(t[0]=t[1]=0);for(var a=0;a<s.channels_out;a++)e.short_blocks==n_.short_block_dispensed&&(t[a]=1),e.short_blocks==n_.short_block_forced&&(t[a]=0)}function oe(e,t,s){for(var a=e.internal_flags,o=0;o<a.channels_out;o++){var n=Jg.NORM_TYPE;0!=t[o]?(u_(a.blocktype_old[o]!=Jg.START_TYPE),a.blocktype_old[o]==Jg.SHORT_TYPE&&(n=Jg.STOP_TYPE)):(n=Jg.SHORT_TYPE,a.blocktype_old[o]==Jg.NORM_TYPE&&(a.blocktype_old[o]=Jg.START_TYPE),a.blocktype_old[o]==Jg.STOP_TYPE&&(a.blocktype_old[o]=Jg.SHORT_TYPE)),s[o]=a.blocktype_old[o],a.blocktype_old[o]=n}}function ne(e,t,s,a,o,n,r){for(var i,l,c=2*n,d=n>0?Math.pow(10,o):1,u=0;u<r;++u){var m=e[2][u],p=e[3][u],h=t[0][u],f=t[1][u],g=t[2][u],_=t[3][u];if(h<=1.58*f&&f<=1.58*h){var v=s[u]*p,b=s[u]*m;l=Math.max(g,Math.min(_,v)),i=Math.max(_,Math.min(g,b))}else l=g,i=_;if(n>0){var y,x,w=a[u]*d;if(y=Math.min(Math.max(h,w),Math.max(f,w)),g=Math.max(l,w),_=Math.max(i,w),x=g+_,x>0&&y*c<x){var k=y*c/x;g*=k,_*=k}l=Math.min(g,l),i=Math.min(_,i)}l>m&&(l=m),i>p&&(i=p),t[2][u]=l,t[3][u]=i}}function re(e,t){var s,a=e;return s=a>=0?27*-a:a*t,s<=-72?0:Math.exp(s*h)}function ie(e){var t=0,s=0,a=0;for(a=0;re(a,e)>1e-20;a-=1);o=a,n=0;while(Math.abs(n-o)>1e-12)a=(n+o)/2,re(a,e)>0?n=a:o=a;t=o;var o,n;a=0;for(a=0;re(a,e)>1e-20;a+=1);o=0,n=a;while(Math.abs(n-o)>1e-12)a=(n+o)/2,re(a,e)>0?o=a:n=a;s=n;var r,i=0,l=1e3;for(r=0;r<=l;++r){a=t+r*(s-t)/l;var c=re(a,e);i+=c}var d=(l+1)/(i*(s-t));return d}function le(e){var t,s,a,o;return t=e,t*=t>=0?3:1.5,t>=.5&&t<=2.5?(o=t-.5,s=8*(o*o-2*o)):s=0,t+=.474,a=15.811389+7.5*t-17.5*Math.sqrt(1+t*t),a<=-60?0:(t=Math.exp((s+a)*h),t/=.6609193,t)}function ce(e){return e<0&&(e=0),e*=.001,13*Math.atan(.76*e)+3.5*Math.atan(e*e/56.25)}function de(e,t,s,a,o,n,i,l,c,d,u,m){var p,h=l_(Jg.CBANDS+1),f=l/(m>15?1152:384),g=d_(Jg.HBLKSIZE);l/=c;var _=0,v=0;for(p=0;p<Jg.CBANDS;p++){var b;for(T=ce(l*_),h[p]=l*_,b=_;ce(l*b)-T<r&&b<=c/2;b++);e[p]=b-_,v=p+1;while(_<b)g[_++]=p;if(_>c/2){_=c/2,++p;break}}h[p]=l*_;for(var y=0;y<m;y++){var x,w,k,S,M;k=d[y],S=d[y+1],x=0|Math.floor(.5+u*(k-.5)),x<0&&(x=0),w=0|Math.floor(.5+u*(S-.5)),w>c/2&&(w=c/2),s[y]=(g[x]+g[w])/2,t[y]=g[w];var A=f*S;i[y]=(A-h[t[y]])/(h[t[y]+1]-h[t[y]]),i[y]<0?i[y]=0:i[y]>1&&(i[y]=1),M=ce(l*d[y]*u),M=Math.min(M,15.5)/15.5,n[y]=Math.pow(10,1.25*(1-Math.cos(Math.PI*M))-2.5)}_=0;for(var R=0;R<v;R++){var T,E,B=e[R];T=ce(l*_),E=ce(l*(_+B-1)),a[R]=.5*(T+E),T=ce(l*(_-.5)),E=ce(l*(_+B-.5)),o[R]=E-T,_+=B}return v}function ue(e,t,s,a,o,n){var r,i=c_([Jg.CBANDS,Jg.CBANDS]),l=0;if(n)for(var c=0;c<t;c++)for(r=0;r<t;r++){var d=le(s[c]-s[r])*a[r];i[c][r]=d*o[c]}else for(r=0;r<t;r++){var u=15+Math.min(21/s[r],12),m=ie(u);for(c=0;c<t;c++){d=m*re(s[c]-s[r],u)*a[r];i[c][r]=d*o[c]}}for(c=0;c<t;c++){for(r=0;r<t;r++)if(i[c][r]>0)break;for(e[c][0]=r,r=t-1;r>0;r--)if(i[c][r]>0)break;e[c][1]=r,l+=e[c][1]-e[c][0]+1}var p=l_(l),h=0;for(c=0;c<t;c++)for(r=e[c][0];r<=e[c][1];r++)p[h++]=i[c][r];return p}function me(e){var t=ce(e);return t=Math.min(t,15.5)/15.5,Math.pow(10,1.25*(1-Math.cos(Math.PI*t))-2.5)}function pe(e,t){e<-.3&&(e=3410),e/=1e3,e=Math.max(.1,e);var s=3.64*Math.pow(e,-.8)-6.8*Math.exp(-.6*Math.pow(e-3.4,2))+6*Math.exp(-.15*Math.pow(e-8.7,2))+.001*(.6+.04*t)*Math.pow(e,4);return s}this.L3psycho_anal_vbr=function(e,t,s,a,o,n,r,i,l,m){var p,h,f=e.internal_flags,g=l_(Jg.HBLKSIZE),_=c_([3,Jg.HBLKSIZE_s]),v=c_([2,Jg.BLKSIZE]),b=c_([2,3,Jg.BLKSIZE_s]),y=c_([4,Jg.CBANDS]),x=c_([4,Jg.CBANDS]),w=c_([4,3]),k=.6,S=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],M=d_(2),A=e.mode==zg.JOINT_STEREO?4:f.channels_out;W(e,t,s,a,o,n,l,w,S,M),ae(e,M);for(var R=0;R<A;R++){var T=1&R;p=v,Y(e,t,s,R,a,g,p,T),G(e,a,R,g),0!=M[T]?se(f,g,y[R],x[R],R):J(f,R)}M[0]+M[1]==2&&e.mode==zg.JOINT_STEREO&&ne(y,x,f.mld_cb_l,f.ATH.cb_l,e.ATHlower*f.ATH.adjust,e.msfix,f.npart_l);for(R=0;R<A;R++){T=1&R;0!=M[T]&&P(f,y[R],x[R],R)}for(var E=0;E<3;E++){for(R=0;R<A;++R){T=1&R;0!=M[T]?Q(f,R,E):(h=b,K(e,t,s,R,E,_,h,T),te(e,_,y[R],x[R],R,E))}M[0]+M[1]==0&&e.mode==zg.JOINT_STEREO&&ne(y,x,f.mld_cb_s,f.ATH.cb_s,e.ATHlower*f.ATH.adjust,e.msfix,f.npart_s);for(R=0;R<A;++R){T=1&R;0==M[T]&&L(f,y[R],x[R],R,E)}}for(R=0;R<A;R++){T=1&R;if(0==M[T])for(var B=0;B<Jg.SBMAX_s;B++){var O=l_(3);for(E=0;E<3;E++){var C=f.thm[R].s[B][E];if(C*=c,S[R][E]>=2||1==S[R][E+1]){var j=0!=E?E-1:2,I=F(f.thm[R].s[B][j],C,d*k);C=Math.min(C,I)}else if(1==S[R][E]){j=0!=E?E-1:2,I=F(f.thm[R].s[B][j],C,u*k);C=Math.min(C,I)}else if(0!=E&&3==S[R][E-1]||0==E&&3==f.nsPsy.lastAttacks[R]){j=2!=E?E+1:0,I=F(f.thm[R].s[B][j],C,u*k);C=Math.min(C,I)}C*=w[R][E],O[E]=C}for(E=0;E<3;E++)f.thm[R].s[B][E]=O[E]}}for(R=0;R<A;R++)f.nsPsy.lastAttacks[R]=S[R][2];oe(e,M,m);for(R=0;R<A;R++){var N,H,D,U;R>1?(N=i,H=-2,D=Jg.NORM_TYPE,m[0]!=Jg.SHORT_TYPE&&m[1]!=Jg.SHORT_TYPE||(D=Jg.SHORT_TYPE),U=n[a][R-2]):(N=r,H=0,D=m[R],U=o[a][R]),D==Jg.SHORT_TYPE?N[H+R]=$(U,f.masking_lower):N[H+R]=q(U,f.masking_lower),e.analysis&&(f.pinfo.pe[a][R]=N[H+R])}return 0},this.psymodel_init=function(s){var a,o=s.internal_flags,n=!0,r=13,i=24,c=0,d=0,u=-8.25,p=-4.5,h=l_(Jg.CBANDS),f=l_(Jg.CBANDS),g=l_(Jg.CBANDS),_=s.out_samplerate;switch(s.experimentalZ){default:case 0:n=!0;break;case 1:n=!(s.VBR==a_.vbr_mtrh||s.VBR==a_.vbr_mt);break;case 2:n=!1;break;case 3:r=8,c=-1.75,d=-.0125,u=-8.25,p=-2.25;break}for(o.ms_ener_ratio_old=.25,o.blocktype_old[0]=o.blocktype_old[1]=Jg.NORM_TYPE,a=0;a<4;++a){for(var v=0;v<Jg.CBANDS;++v)o.nb_1[a][v]=1e20,o.nb_2[a][v]=1e20,o.nb_s1[a][v]=o.nb_s2[a][v]=1;for(var b=0;b<Jg.SBMAX_l;b++)o.en[a].l[b]=1e20,o.thm[a].l[b]=1e20;for(v=0;v<3;++v){for(b=0;b<Jg.SBMAX_s;b++)o.en[a].s[b][v]=1e20,o.thm[a].s[b][v]=1e20;o.nsPsy.lastAttacks[a]=0}for(v=0;v<9;v++)o.nsPsy.last_en_subshort[a][v]=10}for(o.loudness_sq_save[0]=o.loudness_sq_save[1]=0,o.npart_l=de(o.numlines_l,o.bo_l,o.bm_l,h,f,o.mld_l,o.PSY.bo_l_weight,_,Jg.BLKSIZE,o.scalefac_band.l,Jg.BLKSIZE/1152,Jg.SBMAX_l),u_(o.npart_l<Jg.CBANDS),a=0;a<o.npart_l;a++){var y=c;h[a]>=r&&(y=d*(h[a]-r)/(i-r)+c*(i-h[a])/(i-r)),g[a]=Math.pow(10,y/10),o.numlines_l[a]>0?o.rnumlines_l[a]=1/o.numlines_l[a]:o.rnumlines_l[a]=0}o.s3_ll=ue(o.s3ind,o.npart_l,h,f,g,n);var x;v=0;for(a=0;a<o.npart_l;a++){S=o_.MAX_VALUE;for(var w=0;w<o.numlines_l[a];w++,v++){var k=_*v/(1e3*Jg.BLKSIZE);A=this.ATHformula(1e3*k,s)-20,A=Math.pow(10,.1*A),A*=o.numlines_l[a],S>A&&(S=A)}o.ATH.cb_l[a]=S,S=20*h[a]/10-20,S>6&&(S=100),S<-15&&(S=-15),S-=8,o.minval_l[a]=Math.pow(10,S/10)*o.numlines_l[a]}for(o.npart_s=de(o.numlines_s,o.bo_s,o.bm_s,h,f,o.mld_s,o.PSY.bo_s_weight,_,Jg.BLKSIZE_s,o.scalefac_band.s,Jg.BLKSIZE_s/384,Jg.SBMAX_s),u_(o.npart_s<Jg.CBANDS),v=0,a=0;a<o.npart_s;a++){var S;y=u;h[a]>=r&&(y=p*(h[a]-r)/(i-r)+u*(i-h[a])/(i-r)),g[a]=Math.pow(10,y/10),S=o_.MAX_VALUE;for(w=0;w<o.numlines_s[a];w++,v++){var A;k=_*v/(1e3*Jg.BLKSIZE_s);A=this.ATHformula(1e3*k,s)-20,A=Math.pow(10,.1*A),A*=o.numlines_s[a],S>A&&(S=A)}o.ATH.cb_s[a]=S,S=7*h[a]/12-7,h[a]>12&&(S*=1+3.1*Math.log(1+S)),h[a]<12&&(S*=1+2.3*Math.log(1-S)),S<-15&&(S=-15),S-=8,o.minval_s[a]=Math.pow(10,S/10)*o.numlines_s[a]}o.s3_ss=ue(o.s3ind_s,o.npart_s,h,f,g,n),M(),e.init_fft(o),o.decay=Math.exp(-1*t/(l*_/192)),x=m,0!=(2&s.exp_nspsytune)&&(x=1),Math.abs(s.msfix)>0&&(x=s.msfix),s.msfix=x;for(var R=0;R<o.npart_l;R++)o.s3ind[R][1]>o.npart_l-1&&(o.s3ind[R][1]=o.npart_l-1);var T=576*o.mode_gr/_;if(o.ATH.decay=Math.pow(10,-1.2*T),o.ATH.adjust=.01,o.ATH.adjustLimit=1,u_(o.bo_l[Jg.SBMAX_l-1]<=o.npart_l),u_(o.bo_s[Jg.SBMAX_s-1]<=o.npart_s),-1!=s.ATHtype){var E=s.out_samplerate/Jg.BLKSIZE,B=0;for(k=0,a=0;a<Jg.BLKSIZE/2;++a)k+=E,o.ATH.eql_w[a]=1/Math.pow(10,this.ATHformula(k,s)/10),B+=o.ATH.eql_w[a];for(B=1/B,a=Jg.BLKSIZE/2;--a>=0;)o.ATH.eql_w[a]*=B}for(R=v=0;R<o.npart_s;++R)for(a=0;a<o.numlines_s[R];++a)++v;for(R=v=0;R<o.npart_l;++R)for(a=0;a<o.numlines_l[R];++a)++v;for(v=0,a=0;a<o.npart_l;a++){k=_*(v+o.numlines_l[a]/2)/(1*Jg.BLKSIZE);o.mld_cb_l[a]=me(k),v+=o.numlines_l[a]}for(;a<Jg.CBANDS;++a)o.mld_cb_l[a]=1;for(v=0,a=0;a<o.npart_s;a++){k=_*(v+o.numlines_s[a]/2)/(1*Jg.BLKSIZE_s);o.mld_cb_s[a]=me(k),v+=o.numlines_s[a]}for(;a<Jg.CBANDS;++a)o.mld_cb_s[a]=1;return 0},this.ATHformula=function(e,t){var s;switch(t.ATHtype){case 0:s=pe(e,9);break;case 1:s=pe(e,-1);break;case 2:s=pe(e,0);break;case 3:s=pe(e,1)+6;break;case 4:s=pe(e,t.ATHcurve);break;default:s=pe(e,0);break}return s}}function p_(){this.class_id=0,this.num_samples=0,this.num_channels=0,this.in_samplerate=0,this.out_samplerate=0,this.scale=0,this.scale_left=0,this.scale_right=0,this.analysis=!1,this.bWriteVbrTag=!1,this.decode_only=!1,this.quality=0,this.mode=zg.STEREO,this.force_ms=!1,this.free_format=!1,this.findReplayGain=!1,this.decode_on_the_fly=!1,this.write_id3tag_automatic=!1,this.brate=0,this.compression_ratio=0,this.copyright=0,this.original=0,this.extension=0,this.emphasis=0,this.error_protection=0,this.strict_ISO=!1,this.disable_reservoir=!1,this.quant_comp=0,this.quant_comp_short=0,this.experimentalY=!1,this.experimentalZ=0,this.exp_nspsytune=0,this.preset=0,this.VBR=null,this.VBR_q_frac=0,this.VBR_q=0,this.VBR_mean_bitrate_kbps=0,this.VBR_min_bitrate_kbps=0,this.VBR_max_bitrate_kbps=0,this.VBR_hard_min=0,this.lowpassfreq=0,this.highpassfreq=0,this.lowpasswidth=0,this.highpasswidth=0,this.maskingadjust=0,this.maskingadjust_short=0,this.ATHonly=!1,this.ATHshort=!1,this.noATH=!1,this.ATHtype=0,this.ATHcurve=0,this.ATHlower=0,this.athaa_type=0,this.athaa_loudapprox=0,this.athaa_sensitivity=0,this.short_blocks=null,this.useTemporal=!1,this.interChRatio=0,this.msfix=0,this.tune=!1,this.tune_value_a=0,this.version=0,this.encoder_delay=0,this.encoder_padding=0,this.framesize=0,this.frameNum=0,this.lame_allocated_gfp=0,this.internal_flags=null}var h_={};h_.SFBMAX=3*Jg.SBMAX_s;var f_=Ig.new_float,g_=Ig.new_int;function __(){this.xr=f_(576),this.l3_enc=g_(576),this.scalefac=g_(h_.SFBMAX),this.xrpow_max=0,this.part2_3_length=0,this.big_values=0,this.count1=0,this.global_gain=0,this.scalefac_compress=0,this.block_type=0,this.mixed_block_flag=0,this.table_select=g_(3),this.subblock_gain=g_(4),this.region0_count=0,this.region1_count=0,this.preflag=0,this.scalefac_scale=0,this.count1table_select=0,this.part2_length=0,this.sfb_lmax=0,this.sfb_smin=0,this.psy_lmax=0,this.sfbmax=0,this.psymax=0,this.sfbdivide=0,this.width=g_(h_.SFBMAX),this.window=g_(h_.SFBMAX),this.count1bits=0,this.sfb_partition_table=null,this.slen=g_(4),this.max_nonzero_coeff=0;var e=this;function t(e){return new Int32Array(e)}function s(e){return new Float32Array(e)}this.assign=function(a){e.xr=s(a.xr),e.l3_enc=t(a.l3_enc),e.scalefac=t(a.scalefac),e.xrpow_max=a.xrpow_max,e.part2_3_length=a.part2_3_length,e.big_values=a.big_values,e.count1=a.count1,e.global_gain=a.global_gain,e.scalefac_compress=a.scalefac_compress,e.block_type=a.block_type,e.mixed_block_flag=a.mixed_block_flag,e.table_select=t(a.table_select),e.subblock_gain=t(a.subblock_gain),e.region0_count=a.region0_count,e.region1_count=a.region1_count,e.preflag=a.preflag,e.scalefac_scale=a.scalefac_scale,e.count1table_select=a.count1table_select,e.part2_length=a.part2_length,e.sfb_lmax=a.sfb_lmax,e.sfb_smin=a.sfb_smin,e.psy_lmax=a.psy_lmax,e.sfbmax=a.sfbmax,e.psymax=a.psymax,e.sfbdivide=a.sfbdivide,e.width=t(a.width),e.window=t(a.window),e.count1bits=a.count1bits,e.sfb_partition_table=a.sfb_partition_table.slice(0),e.slen=t(a.slen),e.max_nonzero_coeff=a.max_nonzero_coeff}}var v_=Ig.new_int;function b_(){this.tt=[[null,null],[null,null]],this.main_data_begin=0,this.private_bits=0,this.resvDrain_pre=0,this.resvDrain_post=0,this.scfsi=[v_(4),v_(4)];for(var e=0;e<2;e++)for(var t=0;t<2;t++)this.tt[e][t]=new __}var y_=Ig.System,x_=Ig.new_int;function w_(e,t,s,a){this.l=x_(1+Jg.SBMAX_l),this.s=x_(1+Jg.SBMAX_s),this.psfb21=x_(1+Jg.PSFB21),this.psfb12=x_(1+Jg.PSFB12);var o=this.l,n=this.s;4==arguments.length&&(this.arrL=arguments[0],this.arrS=arguments[1],this.arr21=arguments[2],this.arr12=arguments[3],y_.arraycopy(this.arrL,0,o,0,Math.min(this.arrL.length,this.l.length)),y_.arraycopy(this.arrS,0,n,0,Math.min(this.arrS.length,this.s.length)),y_.arraycopy(this.arr21,0,this.psfb21,0,Math.min(this.arr21.length,this.psfb21.length)),y_.arraycopy(this.arr12,0,this.psfb12,0,Math.min(this.arr12.length,this.psfb12.length)))}var k_=Ig.new_float,S_=Ig.new_float_n,M_=Ig.new_int;function A_(){this.last_en_subshort=S_([4,9]),this.lastAttacks=M_(4),this.pefirbuf=k_(19),this.longfact=k_(Jg.SBMAX_l),this.shortfact=k_(Jg.SBMAX_s),this.attackthre=0,this.attackthre_s=0}function R_(){this.sum=0,this.seen=0,this.want=0,this.pos=0,this.size=0,this.bag=null,this.nVbrNumFrames=0,this.nBytesWritten=0,this.TotalFrameSize=0}var T_=Ig.new_byte,E_=Ig.new_double,B_=Ig.new_float,O_=Ig.new_float_n,C_=Ig.new_int,j_=Ig.new_int_n;function I_(){var e=40;function t(){this.write_timing=0,this.ptr=0,this.buf=T_(e)}this.Class_ID=0,this.lame_encode_frame_init=0,this.iteration_init_init=0,this.fill_buffer_resample_init=0,this.mfbuf=O_([2,I_.MFSIZE]),this.mode_gr=0,this.channels_in=0,this.channels_out=0,this.resample_ratio=0,this.mf_samples_to_encode=0,this.mf_size=0,this.VBR_min_bitrate=0,this.VBR_max_bitrate=0,this.bitrate_index=0,this.samplerate_index=0,this.mode_ext=0,this.lowpass1=0,this.lowpass2=0,this.highpass1=0,this.highpass2=0,this.noise_shaping=0,this.noise_shaping_amp=0,this.substep_shaping=0,this.psymodel=0,this.noise_shaping_stop=0,this.subblock_gain=0,this.use_best_huffman=0,this.full_outer_loop=0,this.l3_side=new b_,this.ms_ratio=B_(2),this.padding=0,this.frac_SpF=0,this.slot_lag=0,this.tag_spec=null,this.nMusicCRC=0,this.OldValue=C_(2),this.CurrentStep=C_(2),this.masking_lower=0,this.bv_scf=C_(576),this.pseudohalf=C_(h_.SFBMAX),this.sfb21_extra=!1,this.inbuf_old=new Array(2),this.blackfilt=new Array(2*I_.BPC+1),this.itime=E_(2),this.sideinfo_len=0,this.sb_sample=O_([2,2,18,Jg.SBLIMIT]),this.amp_filter=B_(32),this.header=new Array(I_.MAX_HEADER_BUF),this.h_ptr=0,this.w_ptr=0,this.ancillary_flag=0,this.ResvSize=0,this.ResvMax=0,this.scalefac_band=new w_,this.minval_l=B_(Jg.CBANDS),this.minval_s=B_(Jg.CBANDS),this.nb_1=O_([4,Jg.CBANDS]),this.nb_2=O_([4,Jg.CBANDS]),this.nb_s1=O_([4,Jg.CBANDS]),this.nb_s2=O_([4,Jg.CBANDS]),this.s3_ss=null,this.s3_ll=null,this.decay=0,this.thm=new Array(4),this.en=new Array(4),this.tot_ener=B_(4),this.loudness_sq=O_([2,2]),this.loudness_sq_save=B_(2),this.mld_l=B_(Jg.SBMAX_l),this.mld_s=B_(Jg.SBMAX_s),this.bm_l=C_(Jg.SBMAX_l),this.bo_l=C_(Jg.SBMAX_l),this.bm_s=C_(Jg.SBMAX_s),this.bo_s=C_(Jg.SBMAX_s),this.npart_l=0,this.npart_s=0,this.s3ind=j_([Jg.CBANDS,2]),this.s3ind_s=j_([Jg.CBANDS,2]),this.numlines_s=C_(Jg.CBANDS),this.numlines_l=C_(Jg.CBANDS),this.rnumlines_l=B_(Jg.CBANDS),this.mld_cb_l=B_(Jg.CBANDS),this.mld_cb_s=B_(Jg.CBANDS),this.numlines_s_num1=0,this.numlines_l_num1=0,this.pe=B_(4),this.ms_ratio_s_old=0,this.ms_ratio_l_old=0,this.ms_ener_ratio_old=0,this.blocktype_old=C_(2),this.nsPsy=new A_,this.VBR_seek_table=new R_,this.ATH=null,this.PSY=null,this.nogap_total=0,this.nogap_current=0,this.decode_on_the_fly=!0,this.findReplayGain=!0,this.findPeakSample=!0,this.PeakSample=0,this.RadioGain=0,this.AudiophileGain=0,this.rgdata=null,this.noclipGainChange=0,this.noclipScale=0,this.bitrate_stereoMode_Hist=j_([16,5]),this.bitrate_blockType_Hist=j_([16,6]),this.pinfo=null,this.hip=null,this.in_buffer_nsamples=0,this.in_buffer_0=null,this.in_buffer_1=null,this.iteration_loop=null;for(var s=0;s<this.en.length;s++)this.en[s]=new qg;for(s=0;s<this.thm.length;s++)this.thm[s]=new qg;for(s=0;s<this.header.length;s++)this.header[s]=new t}I_.MFSIZE=3456+Jg.ENCDELAY-Jg.MDCTDELAY,I_.MAX_HEADER_BUF=256,I_.MAX_BITS_PER_CHANNEL=4095,I_.MAX_BITS_PER_GRANULE=7680,I_.BPC=320;var L_=Ig.new_float;function P_(){this.useAdjust=0,this.aaSensitivityP=0,this.adjust=0,this.adjustLimit=0,this.decay=0,this.floor=0,this.l=L_(Jg.SBMAX_l),this.s=L_(Jg.SBMAX_s),this.psfb21=L_(Jg.PSFB21),this.psfb12=L_(Jg.PSFB12),this.cb_l=L_(Jg.CBANDS),this.cb_s=L_(Jg.CBANDS),this.eql_w=L_(Jg.BLKSIZE/2)}var N_=Ig.System,H_=Ig.Arrays;function F_(){var e=64.82,t=.95,s=F_.RMS_WINDOW_TIME_NUMERATOR,a=F_.RMS_WINDOW_TIME_DENOMINATOR,o=[[.038575994352,-3.84664617118067,-.02160367184185,7.81501653005538,-.00123395316851,-11.34170355132042,-9291677959e-14,13.05504219327545,-.01655260341619,-12.28759895145294,.02161526843274,9.4829380631979,-.02074045215285,-5.87257861775999,.00594298065125,2.75465861874613,.00306428023191,-.86984376593551,.00012025322027,.13919314567432,.00288463683916],[.0541865640643,-3.47845948550071,-.02911007808948,6.36317777566148,-.00848709379851,-8.54751527471874,-.00851165645469,9.4769360780128,-.00834990904936,-8.81498681370155,.02245293253339,6.85401540936998,-.02596338512915,-4.39470996079559,.01624864962975,2.19611684890774,-.00240879051584,-.75104302451432,.00674613682247,.13149317958808,-.00187763777362],[.15457299681924,-2.37898834973084,-.09331049056315,2.84868151156327,-.06247880153653,-2.64577170229825,.02163541888798,2.23697657451713,-.05588393329856,-1.67148153367602,.04781476674921,1.00595954808547,.00222312597743,-.45953458054983,.03174092540049,.16378164858596,-.01390589421898,-.05032077717131,.00651420667831,.0234789740702,-.00881362733839],[.30296907319327,-1.61273165137247,-.22613988682123,1.0797749225997,-.08587323730772,-.2565625775407,.03282930172664,-.1627671912044,-.00915702933434,-.22638893773906,-.02364141202522,.39120800788284,-.00584456039913,-.22138138954925,.06276101321749,.04500235387352,-828086748e-14,.02005851806501,.00205861885564,.00302439095741,-.02950134983287],[.33642304856132,-1.49858979367799,-.2557224142557,.87350271418188,-.11828570177555,.12205022308084,.11921148675203,-.80774944671438,-.07834489609479,.47854794562326,-.0046997791438,-.12453458140019,-.0058950022444,-.04067510197014,.05724228140351,.08333755284107,.00832043980773,-.04237348025746,-.0163538138454,.02977207319925,-.0176017656815],[.4491525660845,-.62820619233671,-.14351757464547,.29661783706366,-.22784394429749,-.372563729424,-.01419140100551,.00213767857124,.04078262797139,-.42029820170918,-.12398163381748,.22199650564824,.04097565135648,.00613424350682,.10478503600251,.06747620744683,-.01863887810927,.05784820375801,-.03193428438915,.03222754072173,.00541907748707],[.56619470757641,-1.04800335126349,-.75464456939302,.29156311971249,.1624213774223,-.26806001042947,.16744243493672,.00819999645858,-.18901604199609,.45054734505008,.3093178284183,-.33032403314006,-.27562961986224,.0673936833311,.00647310677246,-.04784254229033,.08647503780351,.01639907836189,-.0378898455484,.01807364323573,-.00588215443421],[.58100494960553,-.51035327095184,-.53174909058578,-.31863563325245,-.14289799034253,-.20256413484477,.17520704835522,.1472815413433,.02377945217615,.38952639978999,.15558449135573,-.23313271880868,-.25344790059353,-.05246019024463,.01628462406333,-.02505961724053,.06920467763959,.02442357316099,-.03721611395801,.01818801111503,-.00749618797172],[.53648789255105,-.2504987195602,-.42163034350696,-.43193942311114,-.00275953611929,-.03424681017675,.04267842219415,-.04678328784242,-.10214864179676,.26408300200955,.14590772289388,.15113130533216,-.02459864859345,-.17556493366449,-.11202315195388,-.18823009262115,-.04060034127,.05477720428674,.0478866554818,.0470440968812,-.02217936801134]],n=[[.98621192462708,-1.97223372919527,-1.97242384925416,.97261396931306,.98621192462708],[.98500175787242,-1.96977855582618,-1.97000351574484,.9702284756635,.98500175787242],[.97938932735214,-1.95835380975398,-1.95877865470428,.95920349965459,.97938932735214],[.97531843204928,-1.95002759149878,-1.95063686409857,.95124613669835,.97531843204928],[.97316523498161,-1.94561023566527,-1.94633046996323,.94705070426118,.97316523498161],[.96454515552826,-1.92783286977036,-1.92909031105652,.93034775234268,.96454515552826],[.96009142950541,-1.91858953033784,-1.92018285901082,.92177618768381,.96009142950541],[.95856916599601,-1.9154210807478,-1.91713833199203,.91885558323625,.95856916599601],[.94597685600279,-1.88903307939452,-1.89195371200558,.89487434461664,.94597685600279]];function r(e,t,s,a,o,n){while(0!=o--)s[a]=1e-10+e[t+0]*n[0]-s[a-1]*n[1]+e[t-1]*n[2]-s[a-2]*n[3]+e[t-2]*n[4]-s[a-3]*n[5]+e[t-3]*n[6]-s[a-4]*n[7]+e[t-4]*n[8]-s[a-5]*n[9]+e[t-5]*n[10]-s[a-6]*n[11]+e[t-6]*n[12]-s[a-7]*n[13]+e[t-7]*n[14]-s[a-8]*n[15]+e[t-8]*n[16]-s[a-9]*n[17]+e[t-9]*n[18]-s[a-10]*n[19]+e[t-10]*n[20],++a,++t}function i(e,t,s,a,o,n){while(0!=o--)s[a]=e[t+0]*n[0]-s[a-1]*n[1]+e[t-1]*n[2]-s[a-2]*n[3]+e[t-2]*n[4],++a,++t}function l(e,t){for(var o=0;o<MAX_ORDER;o++)e.linprebuf[o]=e.lstepbuf[o]=e.loutbuf[o]=e.rinprebuf[o]=e.rstepbuf[o]=e.routbuf[o]=0;switch(0|t){case 48e3:e.reqindex=0;break;case 44100:e.reqindex=1;break;case 32e3:e.reqindex=2;break;case 24e3:e.reqindex=3;break;case 22050:e.reqindex=4;break;case 16e3:e.reqindex=5;break;case 12e3:e.reqindex=6;break;case 11025:e.reqindex=7;break;case 8e3:e.reqindex=8;break;default:return INIT_GAIN_ANALYSIS_ERROR}return e.sampleWindow=0|(t*s+a-1)/a,e.lsum=0,e.rsum=0,e.totsamp=0,H_.ill(e.A,0),INIT_GAIN_ANALYSIS_OK}function c(e){return e*e}function d(s,a){var o,n=0;for(o=0;o<a;o++)n+=s[o];if(0==n)return GAIN_NOT_ENOUGH_SAMPLES;var r=0|Math.ceil(n*(1-t));for(o=a;o-- >0;)if((r-=s[o])<=0)break;return e-o/F_.STEPS_per_dB}this.InitGainAnalysis=function(e,t){return l(e,t)!=INIT_GAIN_ANALYSIS_OK?INIT_GAIN_ANALYSIS_ERROR:(e.linpre=MAX_ORDER,e.rinpre=MAX_ORDER,e.lstep=MAX_ORDER,e.rstep=MAX_ORDER,e.lout=MAX_ORDER,e.rout=MAX_ORDER,H_.fill(e.B,0),INIT_GAIN_ANALYSIS_OK)},this.AnalyzeSamples=function(e,t,s,a,l,d,u){var m,p,h,f,g,_,v;if(0==d)return GAIN_ANALYSIS_OK;switch(v=0,g=d,u){case 1:a=t,l=s;break;case 2:break;default:return GAIN_ANALYSIS_ERROR}d<MAX_ORDER?(N_.arraycopy(t,s,e.linprebuf,MAX_ORDER,d),N_.arraycopy(a,l,e.rinprebuf,MAX_ORDER,d)):(N_.arraycopy(t,s,e.linprebuf,MAX_ORDER,MAX_ORDER),N_.arraycopy(a,l,e.rinprebuf,MAX_ORDER,MAX_ORDER));while(g>0){_=g>e.sampleWindow-e.totsamp?e.sampleWindow-e.totsamp:g,v<MAX_ORDER?(m=e.linpre+v,p=e.linprebuf,h=e.rinpre+v,f=e.rinprebuf,_>MAX_ORDER-v&&(_=MAX_ORDER-v)):(m=s+v,p=t,h=l+v,f=a),r(p,m,e.lstepbuf,e.lstep+e.totsamp,_,o[e.reqindex]),r(f,h,e.rstepbuf,e.rstep+e.totsamp,_,o[e.reqindex]),i(e.lstepbuf,e.lstep+e.totsamp,e.loutbuf,e.lout+e.totsamp,_,n[e.reqindex]),i(e.rstepbuf,e.rstep+e.totsamp,e.routbuf,e.rout+e.totsamp,_,n[e.reqindex]),m=e.lout+e.totsamp,p=e.loutbuf,h=e.rout+e.totsamp,f=e.routbuf;var b=_%8;while(0!=b--)e.lsum+=c(p[m++]),e.rsum+=c(f[h++]);b=_/8;while(0!=b--)e.lsum+=c(p[m+0])+c(p[m+1])+c(p[m+2])+c(p[m+3])+c(p[m+4])+c(p[m+5])+c(p[m+6])+c(p[m+7]),m+=8,e.rsum+=c(f[h+0])+c(f[h+1])+c(f[h+2])+c(f[h+3])+c(f[h+4])+c(f[h+5])+c(f[h+6])+c(f[h+7]),h+=8;if(g-=_,v+=_,e.totsamp+=_,e.totsamp==e.sampleWindow){var y=10*F_.STEPS_per_dB*Math.log10((e.lsum+e.rsum)/e.totsamp*.5+1e-37),x=y<=0?0:0|y;x>=e.A.length&&(x=e.A.length-1),e.A[x]++,e.lsum=e.rsum=0,N_.arraycopy(e.loutbuf,e.totsamp,e.loutbuf,0,MAX_ORDER),N_.arraycopy(e.routbuf,e.totsamp,e.routbuf,0,MAX_ORDER),N_.arraycopy(e.lstepbuf,e.totsamp,e.lstepbuf,0,MAX_ORDER),N_.arraycopy(e.rstepbuf,e.totsamp,e.rstepbuf,0,MAX_ORDER),e.totsamp=0}if(e.totsamp>e.sampleWindow)return GAIN_ANALYSIS_ERROR}return d<MAX_ORDER?(N_.arraycopy(e.linprebuf,d,e.linprebuf,0,MAX_ORDER-d),N_.arraycopy(e.rinprebuf,d,e.rinprebuf,0,MAX_ORDER-d),N_.arraycopy(t,s,e.linprebuf,MAX_ORDER-d,d),N_.arraycopy(a,l,e.rinprebuf,MAX_ORDER-d,d)):(N_.arraycopy(t,s+d-MAX_ORDER,e.linprebuf,0,MAX_ORDER),N_.arraycopy(a,l+d-MAX_ORDER,e.rinprebuf,0,MAX_ORDER)),GAIN_ANALYSIS_OK},this.GetTitleGain=function(e){for(var t=d(e.A,e.A.length),s=0;s<e.A.length;s++)e.B[s]+=e.A[s],e.A[s]=0;for(s=0;s<MAX_ORDER;s++)e.linprebuf[s]=e.lstepbuf[s]=e.loutbuf[s]=e.rinprebuf[s]=e.rstepbuf[s]=e.routbuf[s]=0;return e.totsamp=0,e.lsum=e.rsum=0,t}}F_.STEPS_per_dB=100,F_.MAX_dB=120,F_.GAIN_NOT_ENOUGH_SAMPLES=-24601,F_.GAIN_ANALYSIS_ERROR=0,F_.GAIN_ANALYSIS_OK=1,F_.INIT_GAIN_ANALYSIS_ERROR=0,F_.INIT_GAIN_ANALYSIS_OK=1,F_.YULE_ORDER=10,F_.MAX_ORDER=F_.YULE_ORDER,F_.MAX_SAMP_FREQ=48e3,F_.RMS_WINDOW_TIME_NUMERATOR=1,F_.RMS_WINDOW_TIME_DENOMINATOR=20,F_.MAX_SAMPLES_PER_WINDOW=F_.MAX_SAMP_FREQ*F_.RMS_WINDOW_TIME_NUMERATOR/F_.RMS_WINDOW_TIME_DENOMINATOR+1;var D_=Ig.new_float,$_=Ig.new_int;function U_(){this.linprebuf=D_(NaN),this.linpre=0,this.lstepbuf=D_(NaN),this.lstep=0,this.loutbuf=D_(NaN),this.lout=0,this.rinprebuf=D_(NaN),this.rinpre=0,this.rstepbuf=D_(NaN),this.rstep=0,this.routbuf=D_(NaN),this.rout=0,this.sampleWindow=0,this.totsamp=0,this.lsum=0,this.rsum=0,this.freqindex=0,this.first=0,this.A=$_(0),this.B=$_(0)}function q_(e){this.bits=e}var V_=Ig.new_float,z_=Ig.new_int,X_=Ig.assert;function Y_(e){var t=e;this.quantize=t,this.iteration_loop=function(e,t,s,a){var o,n=e.internal_flags,r=V_(h_.SFBMAX),i=V_(576),l=z_(2),c=0,d=n.l3_side,u=new q_(c);this.quantize.rv.ResvFrameBegin(e,u),c=u.bits;for(var m=0;m<n.mode_gr;m++){o=this.quantize.qupvt.on_pe(e,t,l,c,m,m),n.mode_ext==Jg.MPG_MD_MS_LR&&(this.quantize.ms_convert(n.l3_side,m),this.quantize.qupvt.reduce_side(l,s[m],c,o));for(var p=0;p<n.channels_out;p++){var h,f,g=d.tt[m][p];g.block_type!=Jg.SHORT_TYPE?(h=0,f=n.PSY.mask_adjust-h):(h=0,f=n.PSY.mask_adjust_short-h),n.masking_lower=Math.pow(10,.1*f),this.quantize.init_outer_loop(n,g),this.quantize.init_xrpow(n,g,i)&&(this.quantize.qupvt.calc_xmin(e,a[m][p],g,r),this.quantize.outer_loop(e,g,r,i,p,l[p])),this.quantize.iteration_finish_one(n,m,p),X_(g.part2_3_length<=I_.MAX_BITS_PER_CHANNEL),X_(g.part2_3_length<=l[p])}}this.quantize.rv.ResvFrameEnd(n,c)}}function K_(e,t,s,a){this.xlen=e,this.linmax=t,this.table=s,this.hlen=a}var G_={t1HB:[1,1,1,0],t2HB:[1,2,1,3,1,1,3,2,0],t3HB:[3,2,1,1,1,1,3,2,0],t5HB:[1,2,6,5,3,1,4,4,7,5,7,1,6,1,1,0],t6HB:[7,3,5,1,6,2,3,2,5,4,4,1,3,3,2,0],t7HB:[1,2,10,19,16,10,3,3,7,10,5,3,11,4,13,17,8,4,12,11,18,15,11,2,7,6,9,14,3,1,6,4,5,3,2,0],t8HB:[3,4,6,18,12,5,5,1,2,16,9,3,7,3,5,14,7,3,19,17,15,13,10,4,13,5,8,11,5,1,12,4,4,1,1,0],t9HB:[7,5,9,14,15,7,6,4,5,5,6,7,7,6,8,8,8,5,15,6,9,10,5,1,11,7,9,6,4,1,14,4,6,2,6,0],t10HB:[1,2,10,23,35,30,12,17,3,3,8,12,18,21,12,7,11,9,15,21,32,40,19,6,14,13,22,34,46,23,18,7,20,19,33,47,27,22,9,3,31,22,41,26,21,20,5,3,14,13,10,11,16,6,5,1,9,8,7,8,4,4,2,0],t11HB:[3,4,10,24,34,33,21,15,5,3,4,10,32,17,11,10,11,7,13,18,30,31,20,5,25,11,19,59,27,18,12,5,35,33,31,58,30,16,7,5,28,26,32,19,17,15,8,14,14,12,9,13,14,9,4,1,11,4,6,6,6,3,2,0],t12HB:[9,6,16,33,41,39,38,26,7,5,6,9,23,16,26,11,17,7,11,14,21,30,10,7,17,10,15,12,18,28,14,5,32,13,22,19,18,16,9,5,40,17,31,29,17,13,4,2,27,12,11,15,10,7,4,1,27,12,8,12,6,3,1,0],t13HB:[1,5,14,21,34,51,46,71,42,52,68,52,67,44,43,19,3,4,12,19,31,26,44,33,31,24,32,24,31,35,22,14,15,13,23,36,59,49,77,65,29,40,30,40,27,33,42,16,22,20,37,61,56,79,73,64,43,76,56,37,26,31,25,14,35,16,60,57,97,75,114,91,54,73,55,41,48,53,23,24,58,27,50,96,76,70,93,84,77,58,79,29,74,49,41,17,47,45,78,74,115,94,90,79,69,83,71,50,59,38,36,15,72,34,56,95,92,85,91,90,86,73,77,65,51,44,43,42,43,20,30,44,55,78,72,87,78,61,46,54,37,30,20,16,53,25,41,37,44,59,54,81,66,76,57,54,37,18,39,11,35,33,31,57,42,82,72,80,47,58,55,21,22,26,38,22,53,25,23,38,70,60,51,36,55,26,34,23,27,14,9,7,34,32,28,39,49,75,30,52,48,40,52,28,18,17,9,5,45,21,34,64,56,50,49,45,31,19,12,15,10,7,6,3,48,23,20,39,36,35,53,21,16,23,13,10,6,1,4,2,16,15,17,27,25,20,29,11,17,12,16,8,1,1,0,1],t15HB:[7,12,18,53,47,76,124,108,89,123,108,119,107,81,122,63,13,5,16,27,46,36,61,51,42,70,52,83,65,41,59,36,19,17,15,24,41,34,59,48,40,64,50,78,62,80,56,33,29,28,25,43,39,63,55,93,76,59,93,72,54,75,50,29,52,22,42,40,67,57,95,79,72,57,89,69,49,66,46,27,77,37,35,66,58,52,91,74,62,48,79,63,90,62,40,38,125,32,60,56,50,92,78,65,55,87,71,51,73,51,70,30,109,53,49,94,88,75,66,122,91,73,56,42,64,44,21,25,90,43,41,77,73,63,56,92,77,66,47,67,48,53,36,20,71,34,67,60,58,49,88,76,67,106,71,54,38,39,23,15,109,53,51,47,90,82,58,57,48,72,57,41,23,27,62,9,86,42,40,37,70,64,52,43,70,55,42,25,29,18,11,11,118,68,30,55,50,46,74,65,49,39,24,16,22,13,14,7,91,44,39,38,34,63,52,45,31,52,28,19,14,8,9,3,123,60,58,53,47,43,32,22,37,24,17,12,15,10,2,1,71,37,34,30,28,20,17,26,21,16,10,6,8,6,2,0],t16HB:[1,5,14,44,74,63,110,93,172,149,138,242,225,195,376,17,3,4,12,20,35,62,53,47,83,75,68,119,201,107,207,9,15,13,23,38,67,58,103,90,161,72,127,117,110,209,206,16,45,21,39,69,64,114,99,87,158,140,252,212,199,387,365,26,75,36,68,65,115,101,179,164,155,264,246,226,395,382,362,9,66,30,59,56,102,185,173,265,142,253,232,400,388,378,445,16,111,54,52,100,184,178,160,133,257,244,228,217,385,366,715,10,98,48,91,88,165,157,148,261,248,407,397,372,380,889,884,8,85,84,81,159,156,143,260,249,427,401,392,383,727,713,708,7,154,76,73,141,131,256,245,426,406,394,384,735,359,710,352,11,139,129,67,125,247,233,229,219,393,743,737,720,885,882,439,4,243,120,118,115,227,223,396,746,742,736,721,712,706,223,436,6,202,224,222,218,216,389,386,381,364,888,443,707,440,437,1728,4,747,211,210,208,370,379,734,723,714,1735,883,877,876,3459,865,2,377,369,102,187,726,722,358,711,709,866,1734,871,3458,870,434,0,12,10,7,11,10,17,11,9,13,12,10,7,5,3,1,3],t24HB:[15,13,46,80,146,262,248,434,426,669,653,649,621,517,1032,88,14,12,21,38,71,130,122,216,209,198,327,345,319,297,279,42,47,22,41,74,68,128,120,221,207,194,182,340,315,295,541,18,81,39,75,70,134,125,116,220,204,190,178,325,311,293,271,16,147,72,69,135,127,118,112,210,200,188,352,323,306,285,540,14,263,66,129,126,119,114,214,202,192,180,341,317,301,281,262,12,249,123,121,117,113,215,206,195,185,347,330,308,291,272,520,10,435,115,111,109,211,203,196,187,353,332,313,298,283,531,381,17,427,212,208,205,201,193,186,177,169,320,303,286,268,514,377,16,335,199,197,191,189,181,174,333,321,305,289,275,521,379,371,11,668,184,183,179,175,344,331,314,304,290,277,530,383,373,366,10,652,346,171,168,164,318,309,299,287,276,263,513,375,368,362,6,648,322,316,312,307,302,292,284,269,261,512,376,370,364,359,4,620,300,296,294,288,282,273,266,515,380,374,369,365,361,357,2,1033,280,278,274,267,264,259,382,378,372,367,363,360,358,356,0,43,20,19,17,15,13,11,9,7,6,4,7,5,3,1,3],t32HB:[1,10,8,20,12,20,16,32,14,12,24,0,28,16,24,16],t33HB:[15,28,26,48,22,40,36,64,14,24,20,32,12,16,8,0],t1l:[1,4,3,5],t2l:[1,4,7,4,5,7,6,7,8],t3l:[2,3,7,4,4,7,6,7,8],t5l:[1,4,7,8,4,5,8,9,7,8,9,10,8,8,9,10],t6l:[3,4,6,8,4,4,6,7,5,6,7,8,7,7,8,9],t7l:[1,4,7,9,9,10,4,6,8,9,9,10,7,7,9,10,10,11,8,9,10,11,11,11,8,9,10,11,11,12,9,10,11,12,12,12],t8l:[2,4,7,9,9,10,4,4,6,10,10,10,7,6,8,10,10,11,9,10,10,11,11,12,9,9,10,11,12,12,10,10,11,11,13,13],t9l:[3,4,6,7,9,10,4,5,6,7,8,10,5,6,7,8,9,10,7,7,8,9,9,10,8,8,9,9,10,11,9,9,10,10,11,11],t10l:[1,4,7,9,10,10,10,11,4,6,8,9,10,11,10,10,7,8,9,10,11,12,11,11,8,9,10,11,12,12,11,12,9,10,11,12,12,12,12,12,10,11,12,12,13,13,12,13,9,10,11,12,12,12,13,13,10,10,11,12,12,13,13,13],t11l:[2,4,6,8,9,10,9,10,4,5,6,8,10,10,9,10,6,7,8,9,10,11,10,10,8,8,9,11,10,12,10,11,9,10,10,11,11,12,11,12,9,10,11,12,12,13,12,13,9,9,9,10,11,12,12,12,9,9,10,11,12,12,12,12],t12l:[4,4,6,8,9,10,10,10,4,5,6,7,9,9,10,10,6,6,7,8,9,10,9,10,7,7,8,8,9,10,10,10,8,8,9,9,10,10,10,11,9,9,10,10,10,11,10,11,9,9,9,10,10,11,11,12,10,10,10,11,11,11,11,12],t13l:[1,5,7,8,9,10,10,11,10,11,12,12,13,13,14,14,4,6,8,9,10,10,11,11,11,11,12,12,13,14,14,14,7,8,9,10,11,11,12,12,11,12,12,13,13,14,15,15,8,9,10,11,11,12,12,12,12,13,13,13,13,14,15,15,9,9,11,11,12,12,13,13,12,13,13,14,14,15,15,16,10,10,11,12,12,12,13,13,13,13,14,13,15,15,16,16,10,11,12,12,13,13,13,13,13,14,14,14,15,15,16,16,11,11,12,13,13,13,14,14,14,14,15,15,15,16,18,18,10,10,11,12,12,13,13,14,14,14,14,15,15,16,17,17,11,11,12,12,13,13,13,15,14,15,15,16,16,16,18,17,11,12,12,13,13,14,14,15,14,15,16,15,16,17,18,19,12,12,12,13,14,14,14,14,15,15,15,16,17,17,17,18,12,13,13,14,14,15,14,15,16,16,17,17,17,18,18,18,13,13,14,15,15,15,16,16,16,16,16,17,18,17,18,18,14,14,14,15,15,15,17,16,16,19,17,17,17,19,18,18,13,14,15,16,16,16,17,16,17,17,18,18,21,20,21,18],t15l:[3,5,6,8,8,9,10,10,10,11,11,12,12,12,13,14,5,5,7,8,9,9,10,10,10,11,11,12,12,12,13,13,6,7,7,8,9,9,10,10,10,11,11,12,12,13,13,13,7,8,8,9,9,10,10,11,11,11,12,12,12,13,13,13,8,8,9,9,10,10,11,11,11,11,12,12,12,13,13,13,9,9,9,10,10,10,11,11,11,11,12,12,13,13,13,14,10,9,10,10,10,11,11,11,11,12,12,12,13,13,14,14,10,10,10,11,11,11,11,12,12,12,12,12,13,13,13,14,10,10,10,11,11,11,11,12,12,12,12,13,13,14,14,14,10,10,11,11,11,11,12,12,12,13,13,13,13,14,14,14,11,11,11,11,12,12,12,12,12,13,13,13,13,14,15,14,11,11,11,11,12,12,12,12,13,13,13,13,14,14,14,15,12,12,11,12,12,12,13,13,13,13,13,13,14,14,15,15,12,12,12,12,12,13,13,13,13,14,14,14,14,14,15,15,13,13,13,13,13,13,13,13,14,14,14,14,15,15,14,15,13,13,13,13,13,13,13,14,14,14,14,14,15,15,15,15],t16_5l:[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,11,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,11,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,12,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,13,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,12,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,13,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,13,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,13,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,13,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,14,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,13,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,14,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,14,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,14,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,14,11,11,11,12,12,13,13,13,14,14,14,14,14,14,14,12],t16l:[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,10,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,10,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,11,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,12,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,11,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,12,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,12,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,12,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,12,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,13,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,12,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,13,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,13,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,13,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,13,10,10,10,11,11,12,12,12,13,13,13,13,13,13,13,10],t24l:[4,5,7,8,9,10,10,11,11,12,12,12,12,12,13,10,5,6,7,8,9,10,10,11,11,11,12,12,12,12,12,10,7,7,8,9,9,10,10,11,11,11,11,12,12,12,13,9,8,8,9,9,10,10,10,11,11,11,11,12,12,12,12,9,9,9,9,10,10,10,10,11,11,11,12,12,12,12,13,9,10,9,10,10,10,10,11,11,11,11,12,12,12,12,12,9,10,10,10,10,10,11,11,11,11,12,12,12,12,12,13,9,11,10,10,10,11,11,11,11,12,12,12,12,12,13,13,10,11,11,11,11,11,11,11,11,11,12,12,12,12,13,13,10,11,11,11,11,11,11,11,12,12,12,12,12,13,13,13,10,12,11,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,10,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,10,13,12,12,12,12,12,12,13,13,13,13,13,13,13,13,10,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,6],t32l:[1,5,5,7,5,8,7,9,5,7,7,9,7,9,9,10],t33l:[4,5,5,6,5,6,6,7,5,6,6,7,6,7,7,8]};G_.ht=[new K_(0,0,null,null),new K_(2,0,G_.t1HB,G_.t1l),new K_(3,0,G_.t2HB,G_.t2l),new K_(3,0,G_.t3HB,G_.t3l),new K_(0,0,null,null),new K_(4,0,G_.t5HB,G_.t5l),new K_(4,0,G_.t6HB,G_.t6l),new K_(6,0,G_.t7HB,G_.t7l),new K_(6,0,G_.t8HB,G_.t8l),new K_(6,0,G_.t9HB,G_.t9l),new K_(8,0,G_.t10HB,G_.t10l),new K_(8,0,G_.t11HB,G_.t11l),new K_(8,0,G_.t12HB,G_.t12l),new K_(16,0,G_.t13HB,G_.t13l),new K_(0,0,null,G_.t16_5l),new K_(16,0,G_.t15HB,G_.t15l),new K_(1,1,G_.t16HB,G_.t16l),new K_(2,3,G_.t16HB,G_.t16l),new K_(3,7,G_.t16HB,G_.t16l),new K_(4,15,G_.t16HB,G_.t16l),new K_(6,63,G_.t16HB,G_.t16l),new K_(8,255,G_.t16HB,G_.t16l),new K_(10,1023,G_.t16HB,G_.t16l),new K_(13,8191,G_.t16HB,G_.t16l),new K_(4,15,G_.t24HB,G_.t24l),new K_(5,31,G_.t24HB,G_.t24l),new K_(6,63,G_.t24HB,G_.t24l),new K_(7,127,G_.t24HB,G_.t24l),new K_(8,255,G_.t24HB,G_.t24l),new K_(9,511,G_.t24HB,G_.t24l),new K_(11,2047,G_.t24HB,G_.t24l),new K_(13,8191,G_.t24HB,G_.t24l),new K_(0,0,G_.t32HB,G_.t32l),new K_(0,0,G_.t33HB,G_.t33l)],G_.largetbl=[65540,327685,458759,589832,655369,655370,720906,720907,786443,786444,786444,851980,851980,851980,917517,655370,262149,393222,524295,589832,655369,720906,720906,720907,786443,786443,786444,851980,917516,851980,917516,655370,458759,524295,589832,655369,720905,720906,786442,786443,851979,786443,851979,851980,851980,917516,917517,720905,589832,589832,655369,720905,720906,786442,786442,786443,851979,851979,917515,917516,917516,983052,983052,786441,655369,655369,720905,720906,786442,786442,851978,851979,851979,917515,917516,917516,983052,983052,983053,720905,655370,655369,720906,720906,786442,851978,851979,917515,851979,917515,917516,983052,983052,983052,1048588,786441,720906,720906,720906,786442,851978,851979,851979,851979,917515,917516,917516,917516,983052,983052,1048589,786441,720907,720906,786442,786442,851979,851979,851979,917515,917516,983052,983052,983052,983052,1114125,1114125,786442,720907,786443,786443,851979,851979,851979,917515,917515,983051,983052,983052,983052,1048588,1048589,1048589,786442,786443,786443,786443,851979,851979,917515,917515,983052,983052,983052,983052,1048588,983053,1048589,983053,851978,786444,851979,786443,851979,917515,917516,917516,917516,983052,1048588,1048588,1048589,1114125,1114125,1048589,786442,851980,851980,851979,851979,917515,917516,983052,1048588,1048588,1048588,1048588,1048589,1048589,983053,1048589,851978,851980,917516,917516,917516,917516,983052,983052,983052,983052,1114124,1048589,1048589,1048589,1048589,1179661,851978,983052,917516,917516,917516,983052,983052,1048588,1048588,1048589,1179661,1114125,1114125,1114125,1245197,1114125,851978,917517,983052,851980,917516,1048588,1048588,983052,1048589,1048589,1114125,1179661,1114125,1245197,1114125,1048589,851978,655369,655369,655369,720905,720905,786441,786441,786441,851977,851977,851977,851978,851978,851978,851978,655366],G_.table23=[65538,262147,458759,262148,327684,458759,393222,458759,524296],G_.table56=[65539,262148,458758,524296,262148,327684,524294,589831,458757,524294,589831,655368,524295,524295,589832,655369],G_.bitrate_table=[[0,8,16,24,32,40,48,56,64,80,96,112,128,144,160,-1],[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],[0,8,16,24,32,40,48,56,64,-1,-1,-1,-1,-1,-1,-1]],G_.samplerate_table=[[22050,24e3,16e3,-1],[44100,48e3,32e3,-1],[11025,12e3,8e3,-1]],G_.scfsi_band=[0,6,11,16,21];var Z_=Ig.VbrMode,W_=Ig.Float,Q_=Ig.Util,J_=Ig.new_float,ev=Ig.new_int,tv=Ig.assert;function sv(){var e=null,t=null,s=null;function a(e){return u[e+sv.Q_MAX2]}this.setModules=function(a,o,n){e=a,t=o,s=n},this.IPOW20=function(e){return m[e]};var o=2220446049250313e-31,n=sv.IXMAX_VAL,r=n+2,i=sv.Q_MAX,l=sv.Q_MAX2,c=100;this.nr_of_sfb_block=[[[6,5,5,5],[9,9,9,9],[6,9,9,9]],[[6,5,7,3],[9,9,12,6],[6,9,12,6]],[[11,10,0,0],[18,18,0,0],[15,18,0,0]],[[7,7,7,0],[12,12,12,0],[6,15,12,0]],[[6,6,6,3],[12,9,9,6],[6,12,9,6]],[[8,8,5,0],[15,12,9,0],[6,18,9,0]]];var d=[0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,2,2,3,3,3,2,0];this.pretab=d,this.sfBandIndex=[new w_([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,24,32,42,56,74,100,132,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new w_([0,6,12,18,24,30,36,44,54,66,80,96,114,136,162,194,232,278,332,394,464,540,576],[0,4,8,12,18,26,36,48,62,80,104,136,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new w_([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new w_([0,4,8,12,16,20,24,30,36,44,52,62,74,90,110,134,162,196,238,288,342,418,576],[0,4,8,12,16,22,30,40,52,66,84,106,136,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new w_([0,4,8,12,16,20,24,30,36,42,50,60,72,88,106,128,156,190,230,276,330,384,576],[0,4,8,12,16,22,28,38,50,64,80,100,126,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new w_([0,4,8,12,16,20,24,30,36,44,54,66,82,102,126,156,194,240,296,364,448,550,576],[0,4,8,12,16,22,30,42,58,78,104,138,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new w_([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new w_([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new w_([0,12,24,36,48,60,72,88,108,132,160,192,232,280,336,400,476,566,568,570,572,574,576],[0,8,16,24,36,52,72,96,124,160,162,164,166,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0])];var u=J_(i+l+1),m=J_(i),p=J_(r),h=J_(r);function f(e,t){var a=s.ATHformula(t,e);return a-=c,a=Math.pow(10,a/10+e.ATHlower),a}function g(e){for(var t=e.internal_flags.ATH.l,s=e.internal_flags.ATH.psfb21,a=e.internal_flags.ATH.s,o=e.internal_flags.ATH.psfb12,n=e.internal_flags,r=e.out_samplerate,i=0;i<Jg.SBMAX_l;i++){var l=n.scalefac_band.l[i],c=n.scalefac_band.l[i+1];t[i]=W_.MAX_VALUE;for(var d=l;d<c;d++){var u=d*r/1152,m=f(e,u);t[i]=Math.min(t[i],m)}}for(i=0;i<Jg.PSFB21;i++){l=n.scalefac_band.psfb21[i],c=n.scalefac_band.psfb21[i+1];s[i]=W_.MAX_VALUE;for(d=l;d<c;d++){u=d*r/1152,m=f(e,u);s[i]=Math.min(s[i],m)}}for(i=0;i<Jg.SBMAX_s;i++){l=n.scalefac_band.s[i],c=n.scalefac_band.s[i+1];a[i]=W_.MAX_VALUE;for(d=l;d<c;d++){u=d*r/384,m=f(e,u);a[i]=Math.min(a[i],m)}a[i]*=n.scalefac_band.s[i+1]-n.scalefac_band.s[i]}for(i=0;i<Jg.PSFB12;i++){l=n.scalefac_band.psfb12[i],c=n.scalefac_band.psfb12[i+1];o[i]=W_.MAX_VALUE;for(d=l;d<c;d++){u=d*r/384,m=f(e,u);o[i]=Math.min(o[i],m)}o[i]*=n.scalefac_band.s[13]-n.scalefac_band.s[12]}if(e.noATH){for(i=0;i<Jg.SBMAX_l;i++)t[i]=1e-20;for(i=0;i<Jg.PSFB21;i++)s[i]=1e-20;for(i=0;i<Jg.SBMAX_s;i++)a[i]=1e-20;for(i=0;i<Jg.PSFB12;i++)o[i]=1e-20}n.ATH.floor=10*Math.log10(f(e,-1))}function _(e){this.s=e}this.adj43=h,this.iteration_init=function(t){var s,a=t.internal_flags,o=a.l3_side;if(0==a.iteration_init_init){for(a.iteration_init_init=1,o.main_data_begin=0,g(t),p[0]=0,s=1;s<r;s++)p[s]=Math.pow(s,4/3);for(s=0;s<r-1;s++)h[s]=s+1-Math.pow(.5*(p[s]+p[s+1]),.75);for(h[s]=.5,s=0;s<i;s++)m[s]=Math.pow(2,-.1875*(s-210));for(s=0;s<=i+l;s++)u[s]=Math.pow(2,.25*(s-210-l));var n,c,d,f;for(e.huffman_init(a),s=t.exp_nspsytune>>2&63,s>=32&&(s-=64),n=Math.pow(10,s/4/10),s=t.exp_nspsytune>>8&63,s>=32&&(s-=64),c=Math.pow(10,s/4/10),s=t.exp_nspsytune>>14&63,s>=32&&(s-=64),d=Math.pow(10,s/4/10),s=t.exp_nspsytune>>20&63,s>=32&&(s-=64),f=d*Math.pow(10,s/4/10),s=0;s<Jg.SBMAX_l;s++){_=s<=6?n:s<=13?c:s<=20?d:f,a.nsPsy.longfact[s]=_}for(s=0;s<Jg.SBMAX_s;s++){var _;_=s<=5?n:s<=10?c:s<=11?d:f,a.nsPsy.shortfact[s]=_}}},this.on_pe=function(e,s,a,o,n,r){var i,l,c=e.internal_flags,d=0,u=ev(2),m=new q_(d),p=t.ResvMaxBits(e,o,m,r);d=m.bits;var h=d+p;for(h>I_.MAX_BITS_PER_GRANULE&&(h=I_.MAX_BITS_PER_GRANULE),i=0,l=0;l<c.channels_out;++l)a[l]=Math.min(I_.MAX_BITS_PER_CHANNEL,d/c.channels_out),u[l]=0|a[l]*s[n][l]/700-a[l],u[l]>3*o/4&&(u[l]=3*o/4),u[l]<0&&(u[l]=0),u[l]+a[l]>I_.MAX_BITS_PER_CHANNEL&&(u[l]=Math.max(0,I_.MAX_BITS_PER_CHANNEL-a[l])),i+=u[l];if(i>p)for(l=0;l<c.channels_out;++l)u[l]=p*u[l]/i;for(l=0;l<c.channels_out;++l)a[l]+=u[l],p-=u[l];for(i=0,l=0;l<c.channels_out;++l)i+=a[l];if(i>I_.MAX_BITS_PER_GRANULE){for(l=0;l<c.channels_out;++l)a[l]*=I_.MAX_BITS_PER_GRANULE,a[l]/=i,a[l]}return h},this.reduce_side=function(e,t,s,a){tv(e[0]+e[1]<=I_.MAX_BITS_PER_GRANULE);var o=.33*(.5-t)/.5;o<0&&(o=0),o>.5&&(o=.5);var n=0|.5*o*(e[0]+e[1]);n>I_.MAX_BITS_PER_CHANNEL-e[0]&&(n=I_.MAX_BITS_PER_CHANNEL-e[0]),n<0&&(n=0),e[1]>=125&&(e[1]-n>125?(e[0]<s&&(e[0]+=n),e[1]-=n):(e[0]+=e[1]-125,e[1]=125)),n=e[0]+e[1],n>a&&(e[0]=a*e[0]/n,e[1]=a*e[1]/n),tv(e[0]<=I_.MAX_BITS_PER_CHANNEL),tv(e[1]<=I_.MAX_BITS_PER_CHANNEL),tv(e[0]+e[1]<=I_.MAX_BITS_PER_GRANULE)},this.athAdjust=function(e,t,s){var a=90.30873362,o=94.82444863,n=Q_.FAST_LOG10_X(t,10),r=e*e,i=0;return n-=s,r>1e-20&&(i=1+Q_.FAST_LOG10_X(r,10/a)),i<0&&(i=0),n*=i,n+=s+a-o,Math.pow(10,.1*n)},this.calc_xmin=function(e,t,s,a){var n,r=0,i=e.internal_flags,l=0,c=0,d=i.ATH,u=s.xr,m=e.VBR==Z_.vbr_mtrh?1:0,p=i.masking_lower;for(e.VBR!=Z_.vbr_mtrh&&e.VBR!=Z_.vbr_mt||(p=1),n=0;n<s.psy_lmax;n++){w=e.VBR==Z_.vbr_rh||e.VBR==Z_.vbr_mtrh?athAdjust(d.adjust,d.l[n],d.floor):d.adjust*d.l[n],b=s.width[n],k=w/b,S=o,A=b>>1,M=0;do{R=u[l]*u[l],M+=R,S+=R<k?R:k,l++,T=u[l]*u[l],M+=T,S+=T<k?T:k,l++}while(--A>0);if(M>w&&c++,n==Jg.SBPSY_l){var h=w*i.nsPsy.longfact[n];S<h&&(S=h)}if(0!=m&&(w=S),!e.ATHonly){var f=t.en.l[n];if(f>0)h=M*t.thm.l[n]*p/f,0!=m&&(h*=i.nsPsy.longfact[n]),w<h&&(w=h)}a[r++]=0!=m?w:w*i.nsPsy.longfact[n]}var g=575;if(s.block_type!=Jg.SHORT_TYPE){var _=576;while(0!=_--&&hv.EQ(u[_],0))g=_}s.max_nonzero_coeff=g;for(var v=s.sfb_smin;n<s.psymax;v++,n+=3){var b,y,x;for(x=e.VBR==Z_.vbr_rh||e.VBR==Z_.vbr_mtrh?athAdjust(d.adjust,d.s[v],d.floor):d.adjust*d.s[v],b=s.width[n],y=0;y<3;y++){var w,k,S,M=0,A=b>>1;k=x/b,S=o;do{var R,T;R=u[l]*u[l],M+=R,S+=R<k?R:k,l++,T=u[l]*u[l],M+=T,S+=T<k?T:k,l++}while(--A>0);if(M>x&&c++,v==Jg.SBPSY_s){h=x*i.nsPsy.shortfact[v];S<h&&(S=h)}if(w=0!=m?S:x,!e.ATHonly&&!e.ATHshort){f=t.en.s[v][y];if(f>0)h=M*t.thm.s[v][y]*p/f,0!=m&&(h*=i.nsPsy.shortfact[v]),w<h&&(w=h)}a[r++]=0!=m?w:w*i.nsPsy.shortfact[v]}e.useTemporal&&(a[r-3]>a[r-3+1]&&(a[r-3+1]+=(a[r-3]-a[r-3+1])*i.decay),a[r-3+1]>a[r-3+2]&&(a[r-3+2]+=(a[r-3+1]-a[r-3+2])*i.decay))}return c},this.calc_noise_core=function(e,t,s,a){var o=0,n=t.s,r=e.l3_enc;if(n>e.count1)while(0!=s--){l=e.xr[n],n++,o+=l*l,l=e.xr[n],n++,o+=l*l}else if(n>e.big_values){var i=J_(2);i[0]=0,i[1]=a;while(0!=s--){l=Math.abs(e.xr[n])-i[r[n]],n++,o+=l*l,l=Math.abs(e.xr[n])-i[r[n]],n++,o+=l*l}}else while(0!=s--){var l;l=Math.abs(e.xr[n])-p[r[n]]*a,n++,o+=l*l,l=Math.abs(e.xr[n])-p[r[n]]*a,n++,o+=l*l}return t.s=n,o},this.calc_noise=function(e,t,s,o,n){var r,i,l=0,c=0,u=0,m=0,p=0,h=-20,f=0,g=e.scalefac,v=0;for(o.over_SSD=0,r=0;r<e.psymax;r++){var b,y=e.global_gain-(g[v++]+(0!=e.preflag?d[r]:0)<<e.scalefac_scale+1)-8*e.subblock_gain[e.window[r]],x=0;if(null!=n&&n.step[r]==y)x=n.noise[r],f+=e.width[r],s[l++]=x/t[c++],x=n.noise_log[r];else{var w,k=a(y);if(i=e.width[r]>>1,f+e.width[r]>e.max_nonzero_coeff)w=e.max_nonzero_coeff-f+1,i=w>0?w>>1:0;var S=new _(f);x=this.calc_noise_core(e,S,i,k),f=S.s,null!=n&&(n.step[r]=y,n.noise[r]=x),x=s[l++]=x/t[c++],x=Q_.FAST_LOG10(Math.max(x,1e-20)),null!=n&&(n.noise_log[r]=x)}if(null!=n&&(n.global_gain=e.global_gain),p+=x,x>0)b=Math.max(0|10*x+.5,1),o.over_SSD+=b*b,u++,m+=x;h=Math.max(h,x)}return o.over_count=u,o.tot_noise=p,o.over_noise=m,o.max_noise=h,u},this.set_pinfo=function(e,t,s,a,o){var n,r,i,l,c,u=e.internal_flags,m=0==t.scalefac_scale?.5:1,p=t.scalefac,h=J_(L3Side.SFBMAX),f=J_(L3Side.SFBMAX),g=new CalcNoiseResult;calc_xmin(e,s,t,h),calc_noise(t,h,f,g,null);var _=0;for(r=t.sfb_lmax,t.block_type!=Jg.SHORT_TYPE&&0==t.mixed_block_flag&&(r=22),n=0;n<r;n++){var v=u.scalefac_band.l[n],b=u.scalefac_band.l[n+1],y=b-v;for(l=0;_<b;_++)l+=t.xr[_]*t.xr[_];l/=y,c=1e15,u.pinfo.en[a][o][n]=c*l,u.pinfo.xfsf[a][o][n]=c*h[n]*f[n]/y,s.en.l[n]>0&&!e.ATHonly?l/=s.en.l[n]:l=0,u.pinfo.thr[a][o][n]=c*Math.max(l*s.thm.l[n],u.ATH.l[n]),u.pinfo.LAMEsfb[a][o][n]=0,0!=t.preflag&&n>=11&&(u.pinfo.LAMEsfb[a][o][n]=-m*d[n]),n<Jg.SBPSY_l&&(tv(p[n]>=0),u.pinfo.LAMEsfb[a][o][n]-=m*p[n])}if(t.block_type==Jg.SHORT_TYPE)for(r=n,n=t.sfb_smin;n<Jg.SBMAX_s;n++){v=u.scalefac_band.s[n],b=u.scalefac_band.s[n+1],y=b-v;for(var x=0;x<3;x++){for(l=0,i=v;i<b;i++)l+=t.xr[_]*t.xr[_],_++;l=Math.max(l/y,1e-20),c=1e15,u.pinfo.en_s[a][o][3*n+x]=c*l,u.pinfo.xfsf_s[a][o][3*n+x]=c*h[r]*f[r]/y,s.en.s[n][x]>0?l/=s.en.s[n][x]:l=0,(e.ATHonly||e.ATHshort)&&(l=0),u.pinfo.thr_s[a][o][3*n+x]=c*Math.max(l*s.thm.s[n][x],u.ATH.s[n]),u.pinfo.LAMEsfb_s[a][o][3*n+x]=-2*t.subblock_gain[x],n<Jg.SBPSY_s&&(u.pinfo.LAMEsfb_s[a][o][3*n+x]-=m*p[r]),r++}}u.pinfo.LAMEqss[a][o]=t.global_gain,u.pinfo.LAMEmainbits[a][o]=t.part2_3_length+t.part2_length,u.pinfo.LAMEsfbits[a][o]=t.part2_length,u.pinfo.over[a][o]=g.over_count,u.pinfo.max_noise[a][o]=10*g.max_noise,u.pinfo.over_noise[a][o]=10*g.over_noise,u.pinfo.tot_noise[a][o]=10*g.tot_noise,u.pinfo.over_SSD[a][o]=g.over_SSD}}sv.Q_MAX=257,sv.Q_MAX2=116,sv.LARGE_BITS=1e5,sv.IXMAX_VAL=8206;var av=Ig.System,ov=Ig.Arrays,nv=Ig.new_int,rv=Ig.assert;function iv(){var e=null;function t(e){this.bits=0|e}this.qupvt=null,this.setModules=function(t){this.qupvt=t,e=t};var s=[[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[1,1],[1,1],[1,2],[2,2],[2,3],[2,3],[3,4],[3,4],[3,4],[4,5],[4,5],[4,6],[5,6],[5,6],[5,7],[6,7],[6,7]];function a(e,t,s,a,o,n){var r=.5946/t;e>>=1;while(0!=e--)o[n++]=r>s[a++]?0:1,o[n++]=r>s[a++]?0:1}function o(t,s,a,o,n,r){t>>=1;var i=t%2;t>>=1;while(0!=t--){var l,c,d,u,m,p,h,f;l=a[o++]*s,c=a[o++]*s,m=0|l,d=a[o++]*s,p=0|c,u=a[o++]*s,h=0|d,l+=e.adj43[m],f=0|u,c+=e.adj43[p],n[r++]=0|l,d+=e.adj43[h],n[r++]=0|c,u+=e.adj43[f],n[r++]=0|d,n[r++]=0|u}0!=i&&(l=a[o++]*s,c=a[o++]*s,m=0|l,p=0|c,l+=e.adj43[m],c+=e.adj43[p],n[r++]=0|l,n[r++]=0|c)}function n(t,s,n,r,i){var l,c,d,u=0,m=0,p=0,h=0,f=s,g=0,_=f,v=0,b=t,y=0;for(d=null!=i&&r.global_gain==i.global_gain,c=r.block_type==Jg.SHORT_TYPE?38:21,l=0;l<=c;l++){var x=-1;if((d||r.block_type==Jg.NORM_TYPE)&&(x=r.global_gain-(r.scalefac[l]+(0!=r.preflag?e.pretab[l]:0)<<r.scalefac_scale+1)-8*r.subblock_gain[r.window[l]]),rv(r.width[l]>=0),d&&i.step[l]==x)0!=m&&(o(m,n,b,y,_,v),m=0),0!=p&&(a(p,n,b,y,_,v),p=0);else{var w,k=r.width[l];if(u+r.width[l]>r.max_nonzero_coeff)w=r.max_nonzero_coeff-u+1,ov.fill(s,r.max_nonzero_coeff,576,0),k=w,k<0&&(k=0),l=c+1;if(0==m&&0==p&&(_=f,v=g,b=t,y=h),null!=i&&i.sfb_count1>0&&l>=i.sfb_count1&&i.step[l]>0&&x>=i.step[l]?(0!=m&&(o(m,n,b,y,_,v),m=0,_=f,v=g,b=t,y=h),p+=k):(0!=p&&(a(p,n,b,y,_,v),p=0,_=f,v=g,b=t,y=h),m+=k),k<=0){0!=p&&(a(p,n,b,y,_,v),p=0),0!=m&&(o(m,n,b,y,_,v),m=0);break}}l<=c&&(g+=r.width[l],h+=r.width[l],u+=r.width[l])}0!=m&&(o(m,n,b,y,_,v),m=0),0!=p&&(a(p,n,b,y,_,v),p=0)}function r(e,t,s){var a=0,o=0;do{var n=e[t++],r=e[t++];a<n&&(a=n),o<r&&(o=r)}while(t<s);return a<o&&(a=o),a}function i(e,t,s,a,o,n){var r,i=65536*G_.ht[a].xlen+G_.ht[o].xlen,l=0;do{var c=e[t++],d=e[t++];0!=c&&(c>14&&(c=15,l+=i),c*=16),0!=d&&(d>14&&(d=15,l+=i),c+=d),l+=G_.largetbl[c]}while(t<s);return r=65535&l,l>>=16,l>r&&(l=r,a=o),n.bits+=l,a}function l(e,t,s,a){var o=0,n=G_.ht[1].hlen;do{var r=2*e[t+0]+e[t+1];t+=2,o+=n[r]}while(t<s);return a.bits+=o,1}function c(e,t,s,a,o){var n,r,i=0,l=G_.ht[a].xlen;r=2==a?G_.table23:G_.table56;do{var c=e[t+0]*l+e[t+1];t+=2,i+=r[c]}while(t<s);return n=65535&i,i>>=16,i>n&&(i=n,a++),o.bits+=i,a}function d(e,t,s,a,o){var n=0,r=0,i=0,l=G_.ht[a].xlen,c=G_.ht[a].hlen,d=G_.ht[a+1].hlen,u=G_.ht[a+2].hlen;do{var m=e[t+0]*l+e[t+1];t+=2,n+=c[m],r+=d[m],i+=u[m]}while(t<s);var p=a;return n>r&&(n=r,p++),n>i&&(n=i,p=a+2),o.bits+=n,p}var u=[1,2,5,7,7,10,10,13,13,13,13,13,13,13,13];function m(e,t,s,a){var o=r(e,t,s);switch(o){case 0:return o;case 1:return l(e,t,s,a);case 2:case 3:return c(e,t,s,u[o-1],a);case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:return d(e,t,s,u[o-1],a);default:if(o>sv.IXMAX_VAL)return a.bits=sv.LARGE_BITS,-1;var n,m;for(o-=15,n=24;n<32;n++)if(G_.ht[n].linmax>=o)break;for(m=n-8;m<24;m++)if(G_.ht[m].linmax>=o)break;return i(e,t,s,m,n,a)}}function p(e,s,a,o,n,r,i){for(var l=s.big_values,c=0;c<=22;c++)o[c]=sv.LARGE_BITS;for(c=0;c<16;c++){var d=e.scalefac_band.l[c+1];if(d>=l)break;var u=0,p=new t(u),h=m(a,0,d,p);u=p.bits;for(var f=0;f<8;f++){var g=e.scalefac_band.l[c+f+2];if(g>=l)break;var _=u;p=new t(_);var v=m(a,d,g,p);_=p.bits,o[c+f]>_&&(o[c+f]=_,n[c+f]=c,r[c+f]=h,i[c+f]=v)}}}function h(e,s,a,o,n,r,i,l){for(var c=s.big_values,d=2;d<Jg.SBMAX_l+1;d++){var u=e.scalefac_band.l[d];if(u>=c)break;var p=n[d-2]+s.count1bits;if(a.part2_3_length<=p)break;var h=new t(p),f=m(o,u,c,h);p=h.bits,a.part2_3_length<=p||(a.assign(s),a.part2_3_length=p,a.region0_count=r[d-2],a.region1_count=d-2-r[d-2],a.table_select[0]=i[d-2],a.table_select[1]=l[d-2],a.table_select[2]=f)}}this.noquant_count_bits=function(e,s,a){var o=s.l3_enc,n=Math.min(576,s.max_nonzero_coeff+2>>1<<1);for(null!=a&&(a.sfb_count1=0);n>1;n-=2)if(0!=(o[n-1]|o[n-2]))break;s.count1=n;for(var r=0,i=0;n>3;n-=4){var l;if((2147483647&(o[n-1]|o[n-2]|o[n-3]|o[n-4]))>1)break;l=2*(2*(2*o[n-4]+o[n-3])+o[n-2])+o[n-1],r+=G_.t32l[l],i+=G_.t33l[l]}var c=r;if(s.count1table_select=0,r>i&&(c=i,s.count1table_select=1),s.count1bits=c,s.big_values=n,0==n)return c;if(s.block_type==Jg.SHORT_TYPE)r=3*e.scalefac_band.s[3],r>s.big_values&&(r=s.big_values),i=s.big_values;else if(s.block_type==Jg.NORM_TYPE){if(r=s.region0_count=e.bv_scf[n-2],i=s.region1_count=e.bv_scf[n-1],i=e.scalefac_band.l[r+i+2],r=e.scalefac_band.l[r+1],i<n){var d=new t(c);s.table_select[2]=m(o,i,n,d),c=d.bits}}else s.region0_count=7,s.region1_count=Jg.SBMAX_l-1-7-1,r=e.scalefac_band.l[8],i=n,r>i&&(r=i);if(r=Math.min(r,n),i=Math.min(i,n),r>0){d=new t(c);s.table_select[0]=m(o,0,r,d),c=d.bits}if(r<i){d=new t(c);s.table_select[1]=m(o,r,i,d),c=d.bits}if(2==e.use_best_huffman&&(s.part2_3_length=c,best_huffman_divide(e,s),c=s.part2_3_length),null!=a&&s.block_type==Jg.NORM_TYPE){var u=0;while(e.scalefac_band.l[u]<s.big_values)u++;a.sfb_count1=u}return c},this.count_bits=function(t,s,a,o){var r=a.l3_enc,i=sv.IXMAX_VAL/e.IPOW20(a.global_gain);if(a.xrpow_max>i)return sv.LARGE_BITS;if(n(s,r,e.IPOW20(a.global_gain),a,o),0!=(2&t.substep_shaping))for(var l=0,c=a.global_gain+a.scalefac_scale,d=.634521682242439/e.IPOW20(c),u=0;u<a.sfbmax;u++){var m,p=a.width[u];if(0==t.pseudohalf[u])l+=p;else for(m=l,l+=p;m<l;++m)r[m]=s[m]>=d?r[m]:0}return this.noquant_count_bits(t,a,o)},this.best_huffman_divide=function(e,s){var a=new __,o=s.l3_enc,n=nv(23),r=nv(23),i=nv(23),l=nv(23);if(s.block_type!=Jg.SHORT_TYPE||1!=e.mode_gr){a.assign(s),s.block_type==Jg.NORM_TYPE&&(p(e,s,o,n,r,i,l),h(e,a,s,o,n,r,i,l));var c=a.big_values;if(!(0==c||(o[c-2]|o[c-1])>1)&&(c=s.count1+2,!(c>576))){a.assign(s),a.count1=c;for(var d=0,u=0;c>a.big_values;c-=4){var f=2*(2*(2*o[c-4]+o[c-3])+o[c-2])+o[c-1];d+=G_.t32l[f],u+=G_.t33l[f]}if(a.big_values=c,a.count1table_select=0,d>u&&(d=u,a.count1table_select=1),a.count1bits=d,a.block_type==Jg.NORM_TYPE)h(e,a,s,o,n,r,i,l);else{if(a.part2_3_length=d,d=e.scalefac_band.l[8],d>c&&(d=c),d>0){var g=new t(a.part2_3_length);a.table_select[0]=m(o,0,d,g),a.part2_3_length=g.bits}if(c>d){g=new t(a.part2_3_length);a.table_select[1]=m(o,d,c,g),a.part2_3_length=g.bits}s.part2_3_length>a.part2_3_length&&s.assign(a)}}}};var f=[1,1,1,1,8,2,2,2,4,4,4,8,8,8,16,16],g=[1,2,4,8,1,2,4,8,2,4,8,2,4,8,4,8],_=[0,0,0,0,3,1,1,1,2,2,2,3,3,3,4,4],v=[0,1,2,3,0,1,2,3,1,2,3,1,2,3,2,3];function b(e,t){for(var s,a=t.tt[1][e],o=t.tt[0][e],n=0;n<G_.scfsi_band.length-1;n++){for(s=G_.scfsi_band[n];s<G_.scfsi_band[n+1];s++)if(o.scalefac[s]!=a.scalefac[s]&&a.scalefac[s]>=0)break;if(s==G_.scfsi_band[n+1]){for(s=G_.scfsi_band[n];s<G_.scfsi_band[n+1];s++)a.scalefac[s]=-1;t.scfsi[e][n]=1}}var r=0,i=0;for(s=0;s<11;s++)-1!=a.scalefac[s]&&(i++,r<a.scalefac[s]&&(r=a.scalefac[s]));for(var l=0,c=0;s<Jg.SBPSY_l;s++)-1!=a.scalefac[s]&&(c++,l<a.scalefac[s]&&(l=a.scalefac[s]));for(n=0;n<16;n++)if(r<f[n]&&l<g[n]){var d=_[n]*i+v[n]*c;a.part2_length>d&&(a.part2_length=d,a.scalefac_compress=n)}}function y(e,t){for(var s=0;s<t;++s)if(e[s]<0)return!1;return!0}iv.slen1_tab=_,iv.slen2_tab=v,this.best_scalefac_store=function(t,s,a,o){var n,r,i,l,c=o.tt[s][a],d=0;for(i=0,n=0;n<c.sfbmax;n++){var u=c.width[n];for(i+=u,l=-u;l<0;l++)if(0!=c.l3_enc[l+i])break;0==l&&(c.scalefac[n]=d=-2)}if(0==c.scalefac_scale&&0==c.preflag){var m=0;for(n=0;n<c.sfbmax;n++)c.scalefac[n]>0&&(m|=c.scalefac[n]);if(0==(1&m)&&0!=m){for(n=0;n<c.sfbmax;n++)c.scalefac[n]>0&&(c.scalefac[n]>>=1);c.scalefac_scale=d=1}}if(0==c.preflag&&c.block_type!=Jg.SHORT_TYPE&&2==t.mode_gr){for(n=11;n<Jg.SBPSY_l;n++)if(c.scalefac[n]<e.pretab[n]&&-2!=c.scalefac[n])break;if(n==Jg.SBPSY_l){for(n=11;n<Jg.SBPSY_l;n++)c.scalefac[n]>0&&(c.scalefac[n]-=e.pretab[n]);c.preflag=d=1}}for(r=0;r<4;r++)o.scfsi[a][r]=0;for(2==t.mode_gr&&1==s&&o.tt[0][a].block_type!=Jg.SHORT_TYPE&&o.tt[1][a].block_type!=Jg.SHORT_TYPE&&(b(a,o),d=0),n=0;n<c.sfbmax;n++)-2==c.scalefac[n]&&(c.scalefac[n]=0);0!=d&&(2==t.mode_gr?this.scale_bitcount(c):this.scale_bitcount_lsf(t,c))};var x=[0,18,36,54,54,36,54,72,54,72,90,72,90,108,108,126],w=[0,18,36,54,51,35,53,71,52,70,88,69,87,105,104,122],k=[0,10,20,30,33,21,31,41,32,42,52,43,53,63,64,74];this.scale_bitcount=function(t){var s,a,o,n=0,r=0,i=t.scalefac;if(rv(y(i,t.sfbmax)),t.block_type==Jg.SHORT_TYPE)o=x,0!=t.mixed_block_flag&&(o=w);else if(o=k,0==t.preflag){for(a=11;a<Jg.SBPSY_l;a++)if(i[a]<e.pretab[a])break;if(a==Jg.SBPSY_l)for(t.preflag=1,a=11;a<Jg.SBPSY_l;a++)i[a]-=e.pretab[a]}for(a=0;a<t.sfbdivide;a++)n<i[a]&&(n=i[a]);for(;a<t.sfbmax;a++)r<i[a]&&(r=i[a]);for(t.part2_length=sv.LARGE_BITS,s=0;s<16;s++)n<f[s]&&r<g[s]&&t.part2_length>o[s]&&(t.part2_length=o[s],t.scalefac_compress=s);return t.part2_length==sv.LARGE_BITS};var S=[[15,15,7,7],[15,15,7,0],[7,3,0,0],[15,31,31,0],[7,7,7,0],[3,3,0,0]];this.scale_bitcount_lsf=function(t,s){var a,o,n,r,i,l,c,d,u=nv(4),m=s.scalefac;for(a=0!=s.preflag?2:0,c=0;c<4;c++)u[c]=0;if(s.block_type==Jg.SHORT_TYPE){o=1;var p=e.nr_of_sfb_block[a][o];for(d=0,n=0;n<4;n++)for(r=p[n]/3,c=0;c<r;c++,d++)for(i=0;i<3;i++)m[3*d+i]>u[n]&&(u[n]=m[3*d+i])}else{o=0;p=e.nr_of_sfb_block[a][o];for(d=0,n=0;n<4;n++)for(r=p[n],c=0;c<r;c++,d++)m[d]>u[n]&&(u[n]=m[d])}for(l=!1,n=0;n<4;n++)u[n]>S[a][n]&&(l=!0);if(!l){var h,f,g,_;for(s.sfb_partition_table=e.nr_of_sfb_block[a][o],n=0;n<4;n++)s.slen[n]=M[u[n]];switch(h=s.slen[0],f=s.slen[1],g=s.slen[2],_=s.slen[3],a){case 0:s.scalefac_compress=(5*h+f<<4)+(g<<2)+_;break;case 1:s.scalefac_compress=400+(5*h+f<<2)+g;break;case 2:s.scalefac_compress=500+3*h+f;break;default:av.err.printf("intensity stereo not implemented yet\n");break}}if(!l)for(rv(null!=s.sfb_partition_table),s.part2_length=0,n=0;n<4;n++)s.part2_length+=s.slen[n]*s.sfb_partition_table[n];return l};var M=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];this.huffman_init=function(e){for(var t=2;t<=576;t+=2){var a,o=0;while(e.scalefac_band.l[++o]<t);a=s[o][0];while(e.scalefac_band.l[a+1]>t)a--;a<0&&(a=s[o][0]),e.bv_scf[t-2]=a,a=s[o][1];while(e.scalefac_band.l[a+e.bv_scf[t-2]+2]>t)a--;a<0&&(a=s[o][1]),e.bv_scf[t-1]=a}}}var lv=Ig.System,cv=Ig.Arrays,dv=Ig.new_byte,uv=Ig.new_float_n,mv=Ig.new_int,pv=Ig.assert;function hv(){var e=this,t=32773,s=null,a=null,o=null,n=null;this.setModules=function(e,t,r,i){s=e,a=t,o=r,n=i};var r=null,i=0,l=0,c=0;function d(e){lv.arraycopy(e.header[e.w_ptr].buf,0,r,l,e.sideinfo_len),l+=e.sideinfo_len,i+=8*e.sideinfo_len,e.w_ptr=e.w_ptr+1&I_.MAX_HEADER_BUF-1}function u(e,t,s){while(s>0){var a;0==c&&(c=8,l++,pv(e.header[e.w_ptr].write_timing>=i),e.header[e.w_ptr].write_timing==i&&d(e),r[l]=0),a=Math.min(s,c),s-=a,c-=a,r[l]|=t>>s<<c,i+=a}}function m(e,t,s){while(s>0){var a;0==c&&(c=8,l++,r[l]=0),a=Math.min(s,c),s-=a,c-=a,r[l]|=t>>s<<c,i+=a}}function p(e,t){var s,a=e.internal_flags;if(t>=8&&(u(a,76,8),t-=8),t>=8&&(u(a,65,8),t-=8),t>=8&&(u(a,77,8),t-=8),t>=8&&(u(a,69,8),t-=8),t>=32){var n=o.getLameShortVersion();if(t>=32)for(s=0;s<n.length&&t>=8;++s)t-=8,u(a,n.charAt(s),8)}for(;t>=1;t-=1)u(a,a.ancillary_flag,1),a.ancillary_flag^=e.disable_reservoir?0:1}function h(e,t,s){var a=e.header[e.h_ptr].ptr;while(s>0){var o=Math.min(s,8-(7&a));s-=o,e.header[e.h_ptr].buf[a>>3]|=t>>s<<8-(7&a)-o,a+=o}e.header[e.h_ptr].ptr=a}function f(e,s){e<<=8;for(var a=0;a<8;a++)e<<=1,s<<=1,0!=(65536&(s^e))&&(s^=t);return s}function g(e,t){var s,a,o,n=e.internal_flags;if(s=n.l3_side,n.header[n.h_ptr].ptr=0,cv.fill(n.header[n.h_ptr].buf,0,n.sideinfo_len,0),e.out_samplerate<16e3?h(n,4094,12):h(n,4095,12),h(n,e.version,1),h(n,1,2),h(n,e.error_protection?0:1,1),h(n,n.bitrate_index,4),h(n,n.samplerate_index,2),h(n,n.padding,1),h(n,e.extension,1),h(n,e.mode.ordinal(),2),h(n,n.mode_ext,2),h(n,e.copyright,1),h(n,e.original,1),h(n,e.emphasis,2),e.error_protection&&h(n,0,16),1==e.version){for(pv(s.main_data_begin>=0),h(n,s.main_data_begin,9),2==n.channels_out?h(n,s.private_bits,3):h(n,s.private_bits,5),o=0;o<n.channels_out;o++){var r;for(r=0;r<4;r++)h(n,s.scfsi[o][r],1)}for(a=0;a<2;a++)for(o=0;o<n.channels_out;o++){var i=s.tt[a][o];h(n,i.part2_3_length+i.part2_length,12),h(n,i.big_values/2,9),h(n,i.global_gain,8),h(n,i.scalefac_compress,4),i.block_type!=Jg.NORM_TYPE?(h(n,1,1),h(n,i.block_type,2),h(n,i.mixed_block_flag,1),14==i.table_select[0]&&(i.table_select[0]=16),h(n,i.table_select[0],5),14==i.table_select[1]&&(i.table_select[1]=16),h(n,i.table_select[1],5),h(n,i.subblock_gain[0],3),h(n,i.subblock_gain[1],3),h(n,i.subblock_gain[2],3)):(h(n,0,1),14==i.table_select[0]&&(i.table_select[0]=16),h(n,i.table_select[0],5),14==i.table_select[1]&&(i.table_select[1]=16),h(n,i.table_select[1],5),14==i.table_select[2]&&(i.table_select[2]=16),h(n,i.table_select[2],5),pv(i.region0_count>=0&&i.region0_count<16),pv(i.region1_count>=0&&i.region1_count<8),h(n,i.region0_count,4),h(n,i.region1_count,3)),h(n,i.preflag,1),h(n,i.scalefac_scale,1),h(n,i.count1table_select,1)}}else for(pv(s.main_data_begin>=0),h(n,s.main_data_begin,8),h(n,s.private_bits,n.channels_out),a=0,o=0;o<n.channels_out;o++){i=s.tt[a][o];h(n,i.part2_3_length+i.part2_length,12),h(n,i.big_values/2,9),h(n,i.global_gain,8),h(n,i.scalefac_compress,9),i.block_type!=Jg.NORM_TYPE?(h(n,1,1),h(n,i.block_type,2),h(n,i.mixed_block_flag,1),14==i.table_select[0]&&(i.table_select[0]=16),h(n,i.table_select[0],5),14==i.table_select[1]&&(i.table_select[1]=16),h(n,i.table_select[1],5),h(n,i.subblock_gain[0],3),h(n,i.subblock_gain[1],3),h(n,i.subblock_gain[2],3)):(h(n,0,1),14==i.table_select[0]&&(i.table_select[0]=16),h(n,i.table_select[0],5),14==i.table_select[1]&&(i.table_select[1]=16),h(n,i.table_select[1],5),14==i.table_select[2]&&(i.table_select[2]=16),h(n,i.table_select[2],5),pv(i.region0_count>=0&&i.region0_count<16),pv(i.region1_count>=0&&i.region1_count<8),h(n,i.region0_count,4),h(n,i.region1_count,3)),h(n,i.scalefac_scale,1),h(n,i.count1table_select,1)}e.error_protection&&CRC_writeheader(n,n.header[n.h_ptr].buf);var l=n.h_ptr;pv(n.header[l].ptr==8*n.sideinfo_len),n.h_ptr=l+1&I_.MAX_HEADER_BUF-1,n.header[n.h_ptr].write_timing=n.header[l].write_timing+t,n.h_ptr==n.w_ptr&&lv.err.println("Error: MAX_HEADER_BUF too small in bitstream.c \n")}function _(e,t){var s,a=G_.ht[t.count1table_select+32],o=0,n=t.big_values,r=t.big_values;for(pv(t.count1table_select<2),s=(t.count1-t.big_values)/4;s>0;--s){var i,l=0,c=0;i=t.l3_enc[n+0],0!=i&&(c+=8,t.xr[r+0]<0&&l++),i=t.l3_enc[n+1],0!=i&&(c+=4,l*=2,t.xr[r+1]<0&&l++),i=t.l3_enc[n+2],0!=i&&(c+=2,l*=2,t.xr[r+2]<0&&l++),i=t.l3_enc[n+3],0!=i&&(c++,l*=2,t.xr[r+3]<0&&l++),n+=4,r+=4,u(e,l+a.table[c],a.hlen[c]),o+=a.hlen[c]}return o}function v(e,t,s,a,o){var n=G_.ht[t],r=0;if(0==t)return r;for(var i=s;i<a;i+=2){var l=0,c=0,d=n.xlen,m=n.xlen,p=0,h=o.l3_enc[i],f=o.l3_enc[i+1];if(0!=h&&(o.xr[i]<0&&p++,l--),t>15){if(h>14){var g=h-15;pv(g<=n.linmax),p|=g<<1,c=d,h=15}if(f>14){var _=f-15;pv(_<=n.linmax),p<<=d,p|=_,c+=d,f=15}m=16}0!=f&&(p<<=1,o.xr[i+1]<0&&p++,l--),h=h*m+f,c-=l,l+=n.hlen[h],u(e,n.table[h],l),u(e,p,c),r+=l+c}return r}function b(e,t){var s=3*e.scalefac_band.s[3];s>t.big_values&&(s=t.big_values);var a=v(e,t.table_select[0],0,s,t);return a+=v(e,t.table_select[1],s,t.big_values,t),a}function y(e,t){var s,a,o,n;s=t.big_values;var r=t.region0_count+1;return pv(r<e.scalefac_band.l.length),o=e.scalefac_band.l[r],r+=t.region1_count+1,pv(r<e.scalefac_band.l.length),n=e.scalefac_band.l[r],o>s&&(o=s),n>s&&(n=s),a=v(e,t.table_select[0],0,o,t),a+=v(e,t.table_select[1],o,n,t),a+=v(e,t.table_select[2],n,s,t),a}function x(e){var t,s,a,o,n=0,r=e.internal_flags,i=r.l3_side;if(1==e.version)for(t=0;t<2;t++)for(s=0;s<r.channels_out;s++){var l=i.tt[t][s],c=iv.slen1_tab[l.scalefac_compress],d=iv.slen2_tab[l.scalefac_compress];for(o=0,a=0;a<l.sfbdivide;a++)-1!=l.scalefac[a]&&(u(r,l.scalefac[a],c),o+=c);for(;a<l.sfbmax;a++)-1!=l.scalefac[a]&&(u(r,l.scalefac[a],d),o+=d);pv(o==l.part2_length),l.block_type==Jg.SHORT_TYPE?o+=b(r,l):o+=y(r,l),o+=_(r,l),pv(o==l.part2_3_length+l.part2_length),n+=o}else for(t=0,s=0;s<r.channels_out;s++){l=i.tt[t][s];var m,p,h=0;if(pv(null!=l.sfb_partition_table),o=0,a=0,p=0,l.block_type==Jg.SHORT_TYPE){for(;p<4;p++){var f=l.sfb_partition_table[p]/3,g=l.slen[p];for(m=0;m<f;m++,a++)u(r,Math.max(l.scalefac[3*a+0],0),g),u(r,Math.max(l.scalefac[3*a+1],0),g),u(r,Math.max(l.scalefac[3*a+2],0),g),h+=3*g}o+=b(r,l)}else{for(;p<4;p++){f=l.sfb_partition_table[p],g=l.slen[p];for(m=0;m<f;m++,a++)u(r,Math.max(l.scalefac[a],0),g),h+=g}o+=y(r,l)}o+=_(r,l),pv(o==l.part2_3_length),pv(h==l.part2_length),n+=h+o}return n}function w(){this.total=0}function k(t,s){var a,o,n,r,c,d=t.internal_flags;return c=d.w_ptr,r=d.h_ptr-1,-1==r&&(r=I_.MAX_HEADER_BUF-1),a=d.header[r].write_timing-i,s.total=a,a>=0&&(o=1+r-c,r<c&&(o=1+r-c+I_.MAX_HEADER_BUF),a-=8*o*d.sideinfo_len),n=e.getframebits(t),a+=n,s.total+=n,s.total%8!=0?s.total=1+s.total/8:s.total=s.total/8,s.total+=l+1,a<0&&lv.err.println("strange error flushing buffer ... \n"),a}this.getframebits=function(e){var t,s=e.internal_flags;t=0!=s.bitrate_index?G_.bitrate_table[e.version][s.bitrate_index]:e.brate;var a=0|72e3*(e.version+1)*t/e.out_samplerate+s.padding;return 8*a},this.CRC_writeheader=function(e,t){var s=65535;s=f(255&t[2],s),s=f(255&t[3],s);for(var a=6;a<e.sideinfo_len;a++)s=f(255&t[a],s);t[4]=byte(s>>8),t[5]=byte(255&s)},this.flush_bitstream=function(e){var t,a,o=e.internal_flags,n=o.h_ptr-1;if(-1==n&&(n=I_.MAX_HEADER_BUF-1),t=o.l3_side,!((a=k(e,new w))<0)){if(p(e,a),pv(o.header[n].write_timing+this.getframebits(e)==i),o.ResvSize=0,t.main_data_begin=0,o.findReplayGain){var r=s.GetTitleGain(o.rgdata);pv(NEQ(r,GainAnalysis.GAIN_NOT_ENOUGH_SAMPLES)),o.RadioGain=0|Math.floor(10*r+.5)}o.findPeakSample&&(o.noclipGainChange=0|Math.ceil(20*Math.log10(o.PeakSample/32767)*10),o.noclipGainChange>0&&(EQ(e.scale,1)||EQ(e.scale,0))?o.noclipScale=Math.floor(32767/o.PeakSample*100)/100:o.noclipScale=-1)}},this.add_dummy_byte=function(e,t,s){var a,o=e.internal_flags;while(s-- >0)for(m(o,t,8),a=0;a<I_.MAX_HEADER_BUF;++a)o.header[a].write_timing+=8},this.format_bitstream=function(e){var t,s=e.internal_flags;t=s.l3_side;var a=this.getframebits(e);p(e,t.resvDrain_pre),g(e,a);var o=8*s.sideinfo_len;if(o+=x(e),p(e,t.resvDrain_post),o+=t.resvDrain_post,t.main_data_begin+=(a-o)/8,k(e,new w)!=s.ResvSize&&lv.err.println("Internal buffer inconsistency. flushbits <> ResvSize"),8*t.main_data_begin!=s.ResvSize&&(lv.err.printf("bit reservoir error: \nl3_side.main_data_begin: %d \nResvoir size:             %d \nresv drain (post)         %d \nresv drain (pre)          %d \nheader and sideinfo:      %d \ndata bits:                %d \ntotal bits:               %d (remainder: %d) \nbitsperframe:             %d \n",8*t.main_data_begin,s.ResvSize,t.resvDrain_post,t.resvDrain_pre,8*s.sideinfo_len,o-t.resvDrain_post-8*s.sideinfo_len,o,o%8,a),lv.err.println("This is a fatal error.  It has several possible causes:"),lv.err.println("90%%  LAME compiled with buggy version of gcc using advanced optimizations"),lv.err.println(" 9%%  Your system is overclocked"),lv.err.println(" 1%%  bug in LAME encoding library"),s.ResvSize=8*t.main_data_begin),i>1e9){var n;for(n=0;n<I_.MAX_HEADER_BUF;++n)s.header[n].write_timing-=i;i=0}return 0},this.copy_buffer=function(e,t,o,i,d){var u=l+1;if(u<=0)return 0;if(0!=i&&u>i)return-1;if(lv.arraycopy(r,0,t,o,u),l=-1,c=0,0!=d){var m=mv(1);if(m[0]=e.nMusicCRC,n.updateMusicCRC(m,t,o,u),e.nMusicCRC=m[0],u>0&&(e.VBR_seek_table.nBytesWritten+=u),e.decode_on_the_fly){var p,h=uv([2,1152]),f=u,g=-1;while(0!=g)if(g=a.hip_decode1_unclipped(e.hip,t,o,f,h[0],h[1]),f=0,-1==g&&(g=0),g>0){if(e.findPeakSample){for(p=0;p<g;p++)h[0][p]>e.PeakSample?e.PeakSample=h[0][p]:-h[0][p]>e.PeakSample&&(e.PeakSample=-h[0][p]);if(e.channels_out>1)for(p=0;p<g;p++)h[1][p]>e.PeakSample?e.PeakSample=h[1][p]:-h[1][p]>e.PeakSample&&(e.PeakSample=-h[1][p])}if(e.findReplayGain&&s.AnalyzeSamples(e.rgdata,h[0],0,h[1],0,g,e.channels_out)==GainAnalysis.GAIN_ANALYSIS_ERROR)return-6}}}return u},this.init_bit_stream_w=function(e){r=dv(wv.LAME_MAXMP3BUFFER),e.h_ptr=e.w_ptr=0,e.header[e.h_ptr].write_timing=0,l=-1,c=0,i=0}}hv.EQ=function(e,t){return Math.abs(e)>Math.abs(t)?Math.abs(e-t)<=1e-6*Math.abs(e):Math.abs(e-t)<=1e-6*Math.abs(t)},hv.NEQ=function(e,t){return!hv.EQ(e,t)};var fv=Ig.System,gv=Ig.VbrMode,_v=Ig.ShortBlock,vv=Ig.new_float,bv=Ig.new_int_n,yv=Ig.new_short_n,xv=Ig.assert;function wv(){var e=this,t=131072;wv.V9=410,wv.V8=420,wv.V7=430,wv.V6=440,wv.V5=450,wv.V4=460,wv.V3=470,wv.V2=480,wv.V1=490,wv.V0=500,wv.R3MIX=1e3,wv.STANDARD=1001,wv.EXTREME=1002,wv.INSANE=1003,wv.STANDARD_FAST=1004,wv.EXTREME_FAST=1005,wv.MEDIUM=1006,wv.MEDIUM_FAST=1007;var s,a,o,n,r,i=16384+t;wv.LAME_MAXMP3BUFFER=i;var l,c,d,u=new m_;function m(){this.mask_adjust=0,this.mask_adjust_short=0,this.bo_l_weight=vv(Jg.SBMAX_l),this.bo_s_weight=vv(Jg.SBMAX_s)}function p(){this.lowerlimit=0}function h(e,t){this.lowpass=t}this.enc=new Jg,this.setModules=function(e,t,i,m,p,h,f,g,_){s=e,a=t,o=i,n=m,r=p,l=h,c=g,d=_,this.enc.setModules(a,u,n,l)};var f=4294479419;function g(e){var t;return e.class_id=f,t=e.internal_flags=new I_,e.mode=zg.NOT_SET,e.original=1,e.in_samplerate=44100,e.num_channels=2,e.num_samples=-1,e.bWriteVbrTag=!0,e.quality=-1,e.short_blocks=null,t.subblock_gain=-1,e.lowpassfreq=0,e.highpassfreq=0,e.lowpasswidth=-1,e.highpasswidth=-1,e.VBR=gv.vbr_off,e.VBR_q=4,e.ATHcurve=-1,e.VBR_mean_bitrate_kbps=128,e.VBR_min_bitrate_kbps=0,e.VBR_max_bitrate_kbps=0,e.VBR_hard_min=0,t.VBR_min_bitrate=1,t.VBR_max_bitrate=13,e.quant_comp=-1,e.quant_comp_short=-1,e.msfix=-1,t.resample_ratio=1,t.OldValue[0]=180,t.OldValue[1]=180,t.CurrentStep[0]=4,t.CurrentStep[1]=4,t.masking_lower=1,t.nsPsy.attackthre=-1,t.nsPsy.attackthre_s=-1,e.scale=-1,e.athaa_type=-1,e.ATHtype=-1,e.athaa_loudapprox=-1,e.athaa_sensitivity=0,e.useTemporal=null,e.interChRatio=-1,t.mf_samples_to_encode=Jg.ENCDELAY+Jg.POSTDELAY,e.encoder_padding=0,t.mf_size=Jg.ENCDELAY-Jg.MDCTDELAY,e.findReplayGain=!1,e.decode_on_the_fly=!1,t.decode_on_the_fly=!1,t.findReplayGain=!1,t.findPeakSample=!1,t.RadioGain=0,t.AudiophileGain=0,t.noclipGainChange=0,t.noclipScale=-1,e.preset=0,e.write_id3tag_automatic=!0,0}function _(e){return e>1?0:e<=0?1:Math.cos(Math.PI/2*e)}function v(e,t){var s=44100;return t>=48e3?s=48e3:t>=44100?s=44100:t>=32e3?s=32e3:t>=24e3?s=24e3:t>=22050?s=22050:t>=16e3?s=16e3:t>=12e3?s=12e3:t>=11025?s=11025:t>=8e3&&(s=8e3),-1==e?s:(e<=15960&&(s=44100),e<=15250&&(s=32e3),e<=11220&&(s=24e3),e<=9970&&(s=22050),e<=7230&&(s=16e3),e<=5420&&(s=12e3),e<=4510&&(s=11025),e<=3970&&(s=8e3),t<s?t>44100?48e3:t>32e3?44100:t>24e3?32e3:t>22050?24e3:t>16e3?22050:t>12e3?16e3:t>11025?12e3:t>8e3?11025:8e3:s)}function b(e,t){switch(e){case 44100:return t.version=1,0;case 48e3:return t.version=1,1;case 32e3:return t.version=1,2;case 22050:return t.version=0,0;case 24e3:return t.version=0,1;case 16e3:return t.version=0,2;case 11025:return t.version=0,0;case 12e3:return t.version=0,1;case 8e3:return t.version=0,2;default:return t.version=0,-1}}function y(e,t,s){s<16e3&&(t=2);for(var a=G_.bitrate_table[t][1],o=2;o<=14;o++)G_.bitrate_table[t][o]>0&&Math.abs(G_.bitrate_table[t][o]-e)<Math.abs(a-e)&&(a=G_.bitrate_table[t][o]);return a}function x(e,t,s){s<16e3&&(t=2);for(var a=0;a<=14;a++)if(G_.bitrate_table[t][a]>0&&G_.bitrate_table[t][a]==e)return a;return-1}function w(t,s){var a=[new h(8,2e3),new h(16,3700),new h(24,3900),new h(32,5500),new h(40,7e3),new h(48,7500),new h(56,1e4),new h(64,11e3),new h(80,13500),new h(96,15100),new h(112,15600),new h(128,17e3),new h(160,17500),new h(192,18600),new h(224,19400),new h(256,19700),new h(320,20500)],o=e.nearestBitrateFullIndex(s);t.lowerlimit=a[o].lowpass}function k(e){var t=e.internal_flags,s=32,a=-1;if(t.lowpass1>0){for(var o=999,n=0;n<=31;n++){var r=n/31;r>=t.lowpass2&&(s=Math.min(s,n)),t.lowpass1<r&&r<t.lowpass2&&(o=Math.min(o,n))}t.lowpass1=999==o?(s-.75)/31:(o-.75)/31,t.lowpass2=s/31}if(t.highpass2>0&&t.highpass2<.75/31*.9&&(t.highpass1=0,t.highpass2=0,fv.err.println("Warning: highpass filter disabled.  highpass frequency too small\n")),t.highpass2>0){var i=-1;for(n=0;n<=31;n++){r=n/31;r<=t.highpass1&&(a=Math.max(a,n)),t.highpass1<r&&r<t.highpass2&&(i=Math.max(i,n))}t.highpass1=a/31,t.highpass2=-1==i?(a+.75)/31:(i+.75)/31}for(n=0;n<32;n++){var l,c;r=n/31;l=t.highpass2>t.highpass1?_((t.highpass2-r)/(t.highpass2-t.highpass1+1e-20)):1,c=t.lowpass2>t.lowpass1?_((r-t.lowpass1)/(t.lowpass2-t.lowpass1+1e-20)):1,t.amp_filter[n]=l*c}}function S(e){var t=e.internal_flags;switch(e.quality){default:case 9:t.psymodel=0,t.noise_shaping=0,t.noise_shaping_amp=0,t.noise_shaping_stop=0,t.use_best_huffman=0,t.full_outer_loop=0;break;case 8:e.quality=7;case 7:t.psymodel=1,t.noise_shaping=0,t.noise_shaping_amp=0,t.noise_shaping_stop=0,t.use_best_huffman=0,t.full_outer_loop=0;break;case 6:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),t.noise_shaping_amp=0,t.noise_shaping_stop=0,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=0,t.full_outer_loop=0;break;case 5:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),t.noise_shaping_amp=0,t.noise_shaping_stop=0,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=0,t.full_outer_loop=0;break;case 4:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),t.noise_shaping_amp=0,t.noise_shaping_stop=0,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=1,t.full_outer_loop=0;break;case 3:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),t.noise_shaping_amp=1,t.noise_shaping_stop=1,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=1,t.full_outer_loop=0;break;case 2:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),0==t.substep_shaping&&(t.substep_shaping=2),t.noise_shaping_amp=1,t.noise_shaping_stop=1,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=1,t.full_outer_loop=0;break;case 1:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),0==t.substep_shaping&&(t.substep_shaping=2),t.noise_shaping_amp=2,t.noise_shaping_stop=1,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=1,t.full_outer_loop=0;break;case 0:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),0==t.substep_shaping&&(t.substep_shaping=2),t.noise_shaping_amp=2,t.noise_shaping_stop=1,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=1,t.full_outer_loop=0;break}}function M(e){var t=e.internal_flags;e.frameNum=0,e.write_id3tag_automatic&&c.id3tag_write_v2(e),t.bitrate_stereoMode_Hist=bv([16,5]),t.bitrate_blockType_Hist=bv([16,6]),t.PeakSample=0,e.bWriteVbrTag&&l.InitVbrTag(e)}function A(e,t){(null==e.in_buffer_0||e.in_buffer_nsamples<t)&&(e.in_buffer_0=vv(t),e.in_buffer_1=vv(t),e.in_buffer_nsamples=t)}function R(e){var t=Jg.BLKSIZE+e.framesize-Jg.FFTOFFSET;return t=Math.max(t,512+e.framesize-32),t}function T(e,t,o,n,r,i,l){var c,d,u,m,p,h=e.internal_flags,g=0,_=[null,null],v=[null,null];if(h.Class_ID!=f)return-3;if(0==n)return 0;if(p=a.copy_buffer(h,r,i,l,0),p<0)return p;if(i+=p,g+=p,v[0]=t,v[1]=o,hv.NEQ(e.scale,0)&&hv.NEQ(e.scale,1))for(d=0;d<n;++d)v[0][d]*=e.scale,2==h.channels_out&&(v[1][d]*=e.scale);if(hv.NEQ(e.scale_left,0)&&hv.NEQ(e.scale_left,1))for(d=0;d<n;++d)v[0][d]*=e.scale_left;if(hv.NEQ(e.scale_right,0)&&hv.NEQ(e.scale_right,1))for(d=0;d<n;++d)v[1][d]*=e.scale_right;if(2==e.num_channels&&1==h.channels_out)for(d=0;d<n;++d)v[0][d]=.5*(v[0][d]+v[1][d]),v[1][d]=0;m=R(e),_[0]=h.mfbuf[0],_[1]=h.mfbuf[1];var b=0;while(n>0){var y=[null,null],x=0,w=0;y[0]=v[0],y[1]=v[1];var k=new B;if(L(e,_,y,b,n,k),x=k.n_in,w=k.n_out,h.findReplayGain&&!h.decode_on_the_fly&&s.AnalyzeSamples(h.rgdata,_[0],h.mf_size,_[1],h.mf_size,w,h.channels_out)==GainAnalysis.GAIN_ANALYSIS_ERROR)return-6;if(n-=x,b+=x,h.channels_out,h.mf_size+=w,xv(h.mf_size<=I_.MFSIZE),h.mf_samples_to_encode<1&&(h.mf_samples_to_encode=Jg.ENCDELAY+Jg.POSTDELAY),h.mf_samples_to_encode+=w,h.mf_size>=m){var S=l-g;if(0==l&&(S=0),c=E(e,_[0],_[1],r,i,S),c<0)return c;for(i+=c,g+=c,h.mf_size-=e.framesize,h.mf_samples_to_encode-=e.framesize,u=0;u<h.channels_out;u++)for(d=0;d<h.mf_size;d++)_[u][d]=_[u][d+e.framesize]}}return g}function E(t,s,a,o,n,r){var i=e.enc.lame_encode_mp3_frame(t,s,a,o,n,r);return t.frameNum++,i}function B(){this.n_in=0,this.n_out=0}function O(){this.num_used=0}function C(e,t){return 0!=t?C(t,e%t):e}function j(e,t,s){var a=Math.PI*t;e/=s,e<0&&(e=0),e>1&&(e=1);var o=e-.5,n=.42-.5*Math.cos(2*e*Math.PI)+.08*Math.cos(4*e*Math.PI);return Math.abs(o)<1e-9?a/Math.PI:n*Math.sin(s*a*o)/(Math.PI*s*o)}function I(e,t,s,a,o,n,r,i,l){var c,d,u=e.internal_flags,m=0,p=e.out_samplerate/C(e.out_samplerate,e.in_samplerate);p>I_.BPC&&(p=I_.BPC);var h=Math.abs(u.resample_ratio-Math.floor(.5+u.resample_ratio))<1e-4?1:0,f=1/u.resample_ratio;f>1&&(f=1);var g=31;g%2==0&&--g,g+=h;var _=g+1;if(0==u.fill_buffer_resample_init){for(u.inbuf_old[0]=vv(_),u.inbuf_old[1]=vv(_),c=0;c<=2*p;++c)u.blackfilt[c]=vv(_);for(u.itime[0]=0,u.itime[1]=0,m=0;m<=2*p;m++){var v=0,b=(m-p)/(2*p);for(c=0;c<=g;c++)v+=u.blackfilt[m][c]=j(c-b,f,g);for(c=0;c<=g;c++)u.blackfilt[m][c]/=v}u.fill_buffer_resample_init=1}var y=u.inbuf_old[l];for(d=0;d<a;d++){var x,w;if(x=d*u.resample_ratio,m=0|Math.floor(x-u.itime[l]),g+m-g/2>=r)break;b=x-u.itime[l]-(m+g%2*.5);w=0|Math.floor(2*b*p+p+.5);var k=0;for(c=0;c<=g;++c){var S,M=0|c+m-g/2;S=M<0?y[_+M]:o[n+M],k+=S*u.blackfilt[w][c]}t[s+d]=k}if(i.num_used=Math.min(r,g+m-g/2),u.itime[l]+=i.num_used-d*u.resample_ratio,i.num_used>=_)for(c=0;c<_;c++)y[c]=o[n+i.num_used+c-_];else{var A=_-i.num_used;for(c=0;c<A;++c)y[c]=y[c+i.num_used];for(m=0;c<_;++c,++m)y[c]=o[n+m];xv(m==i.num_used)}return d}function L(e,t,s,a,o,n){var r=e.internal_flags;if(r.resample_ratio<.9999||r.resample_ratio>1.0001)for(var i=0;i<r.channels_out;i++){var l=new O;n.n_out=I(e,t[i],r.mf_size,e.framesize,s[i],a,o,l,i),n.n_in=l.num_used}else{n.n_out=Math.min(e.framesize,o),n.n_in=n.n_out;for(var c=0;c<n.n_out;++c)t[0][r.mf_size+c]=s[0][a+c],2==r.channels_out&&(t[1][r.mf_size+c]=s[1][a+c])}}this.lame_init=function(){var e=new p_;return g(e),e.lame_allocated_gfp=1,e},this.nearestBitrateFullIndex=function(e){var t=[8,16,24,32,40,48,56,64,80,96,112,128,160,192,224,256,320],s=0,a=0,o=0,n=0;n=t[16],o=16,a=t[16],s=16;for(var r=0;r<16;r++)if(Math.max(e,t[r+1])!=e){n=t[r+1],o=r+1,a=t[r],s=r;break}return n-e>e-a?s:o},this.lame_init_params=function(e){var t=e.internal_flags;if(t.Class_ID=0,null==t.ATH&&(t.ATH=new P_),null==t.PSY&&(t.PSY=new m),null==t.rgdata&&(t.rgdata=new U_),t.channels_in=e.num_channels,1==t.channels_in&&(e.mode=zg.MONO),t.channels_out=e.mode==zg.MONO?1:2,t.mode_ext=Jg.MPG_MD_MS_LR,e.mode==zg.MONO&&(e.force_ms=!1),e.VBR==gv.vbr_off&&128!=e.VBR_mean_bitrate_kbps&&0==e.brate&&(e.brate=e.VBR_mean_bitrate_kbps),e.VBR==gv.vbr_off||e.VBR==gv.vbr_mtrh||e.VBR==gv.vbr_mt||(e.free_format=!1),e.VBR==gv.vbr_off&&0==e.brate&&hv.EQ(e.compression_ratio,0)&&(e.compression_ratio=11.025),e.VBR==gv.vbr_off&&e.compression_ratio>0&&(0==e.out_samplerate&&(e.out_samplerate=map2MP3Frequency(int(.97*e.in_samplerate))),e.brate=0|16*e.out_samplerate*t.channels_out/(1e3*e.compression_ratio),t.samplerate_index=b(e.out_samplerate,e),e.free_format||(e.brate=y(e.brate,e.version,e.out_samplerate))),0!=e.out_samplerate&&(e.out_samplerate<16e3?(e.VBR_mean_bitrate_kbps=Math.max(e.VBR_mean_bitrate_kbps,8),e.VBR_mean_bitrate_kbps=Math.min(e.VBR_mean_bitrate_kbps,64)):e.out_samplerate<32e3?(e.VBR_mean_bitrate_kbps=Math.max(e.VBR_mean_bitrate_kbps,8),e.VBR_mean_bitrate_kbps=Math.min(e.VBR_mean_bitrate_kbps,160)):(e.VBR_mean_bitrate_kbps=Math.max(e.VBR_mean_bitrate_kbps,32),e.VBR_mean_bitrate_kbps=Math.min(e.VBR_mean_bitrate_kbps,320))),0==e.lowpassfreq){var i=16e3;switch(e.VBR){case gv.vbr_off:var l=new p;w(l,e.brate),i=l.lowerlimit;break;case gv.vbr_abr:l=new p;w(l,e.VBR_mean_bitrate_kbps),i=l.lowerlimit;break;case gv.vbr_rh:var c=[19500,19e3,18600,18e3,17500,16e3,15600,14900,12500,1e4,3950];if(e.VBR_q>=0&&e.VBR_q<=9){var h=c[e.VBR_q],g=c[e.VBR_q+1],_=e.VBR_q_frac;i=linear_int(h,g,_)}else i=19500;break;default:c=[19500,19e3,18500,18e3,17500,16500,15500,14500,12500,9500,3950];if(e.VBR_q>=0&&e.VBR_q<=9){h=c[e.VBR_q],g=c[e.VBR_q+1],_=e.VBR_q_frac;i=linear_int(h,g,_)}else i=19500}e.mode!=zg.MONO||e.VBR!=gv.vbr_off&&e.VBR!=gv.vbr_abr||(i*=1.5),e.lowpassfreq=0|i}if(0==e.out_samplerate&&(2*e.lowpassfreq>e.in_samplerate&&(e.lowpassfreq=e.in_samplerate/2),e.out_samplerate=v(0|e.lowpassfreq,e.in_samplerate)),e.lowpassfreq=Math.min(20500,e.lowpassfreq),e.lowpassfreq=Math.min(e.out_samplerate/2,e.lowpassfreq),e.VBR==gv.vbr_off&&(e.compression_ratio=16*e.out_samplerate*t.channels_out/(1e3*e.brate)),e.VBR==gv.vbr_abr&&(e.compression_ratio=16*e.out_samplerate*t.channels_out/(1e3*e.VBR_mean_bitrate_kbps)),e.bWriteVbrTag||(e.findReplayGain=!1,e.decode_on_the_fly=!1,t.findPeakSample=!1),t.findReplayGain=e.findReplayGain,t.decode_on_the_fly=e.decode_on_the_fly,t.decode_on_the_fly&&(t.findPeakSample=!0),t.findReplayGain&&s.InitGainAnalysis(t.rgdata,e.out_samplerate)==GainAnalysis.INIT_GAIN_ANALYSIS_ERROR)return e.internal_flags=null,-6;switch(t.decode_on_the_fly&&!e.decode_only&&(null!=t.hip&&d.hip_decode_exit(t.hip),t.hip=d.hip_decode_init()),t.mode_gr=e.out_samplerate<=24e3?1:2,e.framesize=576*t.mode_gr,e.encoder_delay=Jg.ENCDELAY,t.resample_ratio=e.in_samplerate/e.out_samplerate,e.VBR){case gv.vbr_mt:case gv.vbr_rh:case gv.vbr_mtrh:var A=[5.7,6.5,7.3,8.2,10,11.9,13,14,15,16.5];e.compression_ratio=A[e.VBR_q];break;case gv.vbr_abr:e.compression_ratio=16*e.out_samplerate*t.channels_out/(1e3*e.VBR_mean_bitrate_kbps);break;default:e.compression_ratio=16*e.out_samplerate*t.channels_out/(1e3*e.brate);break}if(e.mode==zg.NOT_SET&&(e.mode=zg.JOINT_STEREO),e.highpassfreq>0?(t.highpass1=2*e.highpassfreq,e.highpasswidth>=0?t.highpass2=2*(e.highpassfreq+e.highpasswidth):t.highpass2=2*e.highpassfreq,t.highpass1/=e.out_samplerate,t.highpass2/=e.out_samplerate):(t.highpass1=0,t.highpass2=0),e.lowpassfreq>0?(t.lowpass2=2*e.lowpassfreq,e.lowpasswidth>=0?(t.lowpass1=2*(e.lowpassfreq-e.lowpasswidth),t.lowpass1<0&&(t.lowpass1=0)):t.lowpass1=2*e.lowpassfreq,t.lowpass1/=e.out_samplerate,t.lowpass2/=e.out_samplerate):(t.lowpass1=0,t.lowpass2=0),k(e),t.samplerate_index=b(e.out_samplerate,e),t.samplerate_index<0)return e.internal_flags=null,-1;if(e.VBR==gv.vbr_off){if(e.free_format)t.bitrate_index=0;else if(e.brate=y(e.brate,e.version,e.out_samplerate),t.bitrate_index=x(e.brate,e.version,e.out_samplerate),t.bitrate_index<=0)return e.internal_flags=null,-1}else t.bitrate_index=1;e.analysis&&(e.bWriteVbrTag=!1),null!=t.pinfo&&(e.bWriteVbrTag=!1),a.init_bit_stream_w(t);for(var R,T=t.samplerate_index+3*e.version+6*(e.out_samplerate<16e3?1:0),E=0;E<Jg.SBMAX_l+1;E++)t.scalefac_band.l[E]=n.sfBandIndex[T].l[E];for(E=0;E<Jg.PSFB21+1;E++){var B=(t.scalefac_band.l[22]-t.scalefac_band.l[21])/Jg.PSFB21,O=t.scalefac_band.l[21]+E*B;t.scalefac_band.psfb21[E]=O}t.scalefac_band.psfb21[Jg.PSFB21]=576;for(E=0;E<Jg.SBMAX_s+1;E++)t.scalefac_band.s[E]=n.sfBandIndex[T].s[E];for(E=0;E<Jg.PSFB12+1;E++){B=(t.scalefac_band.s[13]-t.scalefac_band.s[12])/Jg.PSFB12,O=t.scalefac_band.s[12]+E*B;t.scalefac_band.psfb12[E]=O}for(t.scalefac_band.psfb12[Jg.PSFB12]=192,1==e.version?t.sideinfo_len=1==t.channels_out?21:36:t.sideinfo_len=1==t.channels_out?13:21,e.error_protection&&(t.sideinfo_len+=2),M(e),t.Class_ID=f,R=0;R<19;R++)t.nsPsy.pefirbuf[R]=700*t.mode_gr*t.channels_out;switch(-1==e.ATHtype&&(e.ATHtype=4),xv(e.VBR_q<=9),xv(e.VBR_q>=0),e.VBR){case gv.vbr_mt:e.VBR=gv.vbr_mtrh;case gv.vbr_mtrh:null==e.useTemporal&&(e.useTemporal=!1),o.apply_preset(e,500-10*e.VBR_q,0),e.quality<0&&(e.quality=LAME_DEFAULT_QUALITY),e.quality<5&&(e.quality=0),e.quality>5&&(e.quality=5),t.PSY.mask_adjust=e.maskingadjust,t.PSY.mask_adjust_short=e.maskingadjust_short,e.experimentalY?t.sfb21_extra=!1:t.sfb21_extra=e.out_samplerate>44e3,t.iteration_loop=new VBRNewIterationLoop(r);break;case gv.vbr_rh:o.apply_preset(e,500-10*e.VBR_q,0),t.PSY.mask_adjust=e.maskingadjust,t.PSY.mask_adjust_short=e.maskingadjust_short,e.experimentalY?t.sfb21_extra=!1:t.sfb21_extra=e.out_samplerate>44e3,e.quality>6&&(e.quality=6),e.quality<0&&(e.quality=LAME_DEFAULT_QUALITY),t.iteration_loop=new VBROldIterationLoop(r);break;default:var C;t.sfb21_extra=!1,e.quality<0&&(e.quality=LAME_DEFAULT_QUALITY),C=e.VBR,C==gv.vbr_off&&(e.VBR_mean_bitrate_kbps=e.brate),o.apply_preset(e,e.VBR_mean_bitrate_kbps,0),e.VBR=C,t.PSY.mask_adjust=e.maskingadjust,t.PSY.mask_adjust_short=e.maskingadjust_short,C==gv.vbr_off?t.iteration_loop=new Y_(r):t.iteration_loop=new ABRIterationLoop(r);break}if(xv(e.scale>=0),e.VBR!=gv.vbr_off){if(t.VBR_min_bitrate=1,t.VBR_max_bitrate=14,e.out_samplerate<16e3&&(t.VBR_max_bitrate=8),0!=e.VBR_min_bitrate_kbps&&(e.VBR_min_bitrate_kbps=y(e.VBR_min_bitrate_kbps,e.version,e.out_samplerate),t.VBR_min_bitrate=x(e.VBR_min_bitrate_kbps,e.version,e.out_samplerate),t.VBR_min_bitrate<0))return-1;if(0!=e.VBR_max_bitrate_kbps&&(e.VBR_max_bitrate_kbps=y(e.VBR_max_bitrate_kbps,e.version,e.out_samplerate),t.VBR_max_bitrate=x(e.VBR_max_bitrate_kbps,e.version,e.out_samplerate),t.VBR_max_bitrate<0))return-1;e.VBR_min_bitrate_kbps=G_.bitrate_table[e.version][t.VBR_min_bitrate],e.VBR_max_bitrate_kbps=G_.bitrate_table[e.version][t.VBR_max_bitrate],e.VBR_mean_bitrate_kbps=Math.min(G_.bitrate_table[e.version][t.VBR_max_bitrate],e.VBR_mean_bitrate_kbps),e.VBR_mean_bitrate_kbps=Math.max(G_.bitrate_table[e.version][t.VBR_min_bitrate],e.VBR_mean_bitrate_kbps)}return e.tune&&(t.PSY.mask_adjust+=e.tune_value_a,t.PSY.mask_adjust_short+=e.tune_value_a),S(e),xv(e.scale>=0),e.athaa_type<0?t.ATH.useAdjust=3:t.ATH.useAdjust=e.athaa_type,t.ATH.aaSensitivityP=Math.pow(10,e.athaa_sensitivity/-10),null==e.short_blocks&&(e.short_blocks=_v.short_block_allowed),e.short_blocks!=_v.short_block_allowed||e.mode!=zg.JOINT_STEREO&&e.mode!=zg.STEREO||(e.short_blocks=_v.short_block_coupled),e.quant_comp<0&&(e.quant_comp=1),e.quant_comp_short<0&&(e.quant_comp_short=0),e.msfix<0&&(e.msfix=0),e.exp_nspsytune=1|e.exp_nspsytune,e.internal_flags.nsPsy.attackthre<0&&(e.internal_flags.nsPsy.attackthre=m_.NSATTACKTHRE),e.internal_flags.nsPsy.attackthre_s<0&&(e.internal_flags.nsPsy.attackthre_s=m_.NSATTACKTHRE_S),xv(e.scale>=0),e.scale<0&&(e.scale=1),e.ATHtype<0&&(e.ATHtype=4),e.ATHcurve<0&&(e.ATHcurve=4),e.athaa_loudapprox<0&&(e.athaa_loudapprox=2),e.interChRatio<0&&(e.interChRatio=0),null==e.useTemporal&&(e.useTemporal=!0),t.slot_lag=t.frac_SpF=0,e.VBR==gv.vbr_off&&(t.slot_lag=t.frac_SpF=72e3*(e.version+1)*e.brate%e.out_samplerate|0),n.iteration_init(e),u.psymodel_init(e),xv(e.scale>=0),0},this.lame_encode_flush=function(e,t,s,o){var n,r,i,l,d=e.internal_flags,u=yv([2,1152]),m=0,p=d.mf_samples_to_encode-Jg.POSTDELAY,h=R(e);if(d.mf_samples_to_encode<1)return 0;n=0,e.in_samplerate!=e.out_samplerate&&(p+=16*e.out_samplerate/e.in_samplerate),i=e.framesize-p%e.framesize,i<576&&(i+=e.framesize),e.encoder_padding=i,l=(p+i)/e.framesize;while(l>0&&m>=0){var f=h-d.mf_size,g=e.frameNum;f*=e.in_samplerate,f/=e.out_samplerate,f>1152&&(f=1152),f<1&&(f=1),r=o-n,0==o&&(r=0),m=this.lame_encode_buffer(e,u[0],u[1],f,t,s,r),s+=m,n+=m,l-=g!=e.frameNum?1:0}if(d.mf_samples_to_encode=0,m<0)return m;if(r=o-n,0==o&&(r=0),a.flush_bitstream(e),m=a.copy_buffer(d,t,s,r,1),m<0)return m;if(s+=m,n+=m,r=o-n,0==o&&(r=0),e.write_id3tag_automatic){if(c.id3tag_write_v1(e),m=a.copy_buffer(d,t,s,r,0),m<0)return m;n+=m}return n},this.lame_encode_buffer=function(e,t,s,a,o,n,r){var i=e.internal_flags,l=[null,null];if(i.Class_ID!=f)return-3;if(0==a)return 0;A(i,a),l[0]=i.in_buffer_0,l[1]=i.in_buffer_1;for(var c=0;c<a;c++)l[0][c]=t[c],i.channels_in>1&&(l[1][c]=s[c]);return T(e,l[0],l[1],a,o,n,r)}}var kv=Ig.VbrMode;function Sv(){function e(e,t,s,a,o,n,r,i,l,c,d,u,m,p,h){this.vbr_q=e,this.quant_comp=t,this.quant_comp_s=s,this.expY=a,this.st_lrm=o,this.st_s=n,this.masking_adj=r,this.masking_adj_short=i,this.ath_lower=l,this.ath_curve=c,this.ath_sensitivity=d,this.interch=u,this.safejoint=m,this.sfb21mod=p,this.msfix=h}function t(e,t,s,a,o,n,r,i,l,c,d,u,m,p){this.quant_comp=t,this.quant_comp_s=s,this.safejoint=a,this.nsmsfix=o,this.st_lrm=n,this.st_s=r,this.nsbass=i,this.scale=l,this.masking_adj=c,this.ath_lower=d,this.ath_curve=u,this.interch=m,this.sfscale=p}var s;this.setModules=function(e){s=e};var a=[new e(0,9,9,0,5.2,125,-4.2,-6.3,4.8,1,0,0,2,21,.97),new e(1,9,9,0,5.3,125,-3.6,-5.6,4.5,1.5,0,0,2,21,1.35),new e(2,9,9,0,5.6,125,-2.2,-3.5,2.8,2,0,0,2,21,1.49),new e(3,9,9,1,5.8,130,-1.8,-2.8,2.6,3,-4,0,2,20,1.64),new e(4,9,9,1,6,135,-.7,-1.1,1.1,3.5,-8,0,2,0,1.79),new e(5,9,9,1,6.4,140,.5,.4,-7.5,4,-12,2e-4,0,0,1.95),new e(6,9,9,1,6.6,145,.67,.65,-14.7,6.5,-19,4e-4,0,0,2.3),new e(7,9,9,1,6.6,145,.8,.75,-19.7,8,-22,6e-4,0,0,2.7),new e(8,9,9,1,6.6,145,1.2,1.15,-27.5,10,-23,7e-4,0,0,0),new e(9,9,9,1,6.6,145,1.6,1.6,-36,11,-25,8e-4,0,0,0),new e(10,9,9,1,6.6,145,2,2,-36,12,-25,8e-4,0,0,0)],o=[new e(0,9,9,0,4.2,25,-7,-4,7.5,1,0,0,2,26,.97),new e(1,9,9,0,4.2,25,-5.6,-3.6,4.5,1.5,0,0,2,21,1.35),new e(2,9,9,0,4.2,25,-4.4,-1.8,2,2,0,0,2,18,1.49),new e(3,9,9,1,4.2,25,-3.4,-1.25,1.1,3,-4,0,2,15,1.64),new e(4,9,9,1,4.2,25,-2.2,.1,0,3.5,-8,0,2,0,1.79),new e(5,9,9,1,4.2,25,-1,1.65,-7.7,4,-12,2e-4,0,0,1.95),new e(6,9,9,1,4.2,25,-0,2.47,-7.7,6.5,-19,4e-4,0,0,2),new e(7,9,9,1,4.2,25,.5,2,-14.5,8,-22,6e-4,0,0,2),new e(8,9,9,1,4.2,25,1,2.4,-22,10,-23,7e-4,0,0,2),new e(9,9,9,1,4.2,25,1.5,2.95,-30,11,-25,8e-4,0,0,2),new e(10,9,9,1,4.2,25,2,2.95,-36,12,-30,8e-4,0,0,2)];function n(e,t,s){var n=e.VBR==kv.vbr_rh?a:o,r=e.VBR_q_frac,i=n[t],c=n[t+1],d=i;i.st_lrm=i.st_lrm+r*(c.st_lrm-i.st_lrm),i.st_s=i.st_s+r*(c.st_s-i.st_s),i.masking_adj=i.masking_adj+r*(c.masking_adj-i.masking_adj),i.masking_adj_short=i.masking_adj_short+r*(c.masking_adj_short-i.masking_adj_short),i.ath_lower=i.ath_lower+r*(c.ath_lower-i.ath_lower),i.ath_curve=i.ath_curve+r*(c.ath_curve-i.ath_curve),i.ath_sensitivity=i.ath_sensitivity+r*(c.ath_sensitivity-i.ath_sensitivity),i.interch=i.interch+r*(c.interch-i.interch),i.msfix=i.msfix+r*(c.msfix-i.msfix),l(e,d.vbr_q),0!=s?e.quant_comp=d.quant_comp:Math.abs(e.quant_comp- -1)>0||(e.quant_comp=d.quant_comp),0!=s?e.quant_comp_short=d.quant_comp_s:Math.abs(e.quant_comp_short- -1)>0||(e.quant_comp_short=d.quant_comp_s),0!=d.expY&&(e.experimentalY=0!=d.expY),0!=s?e.internal_flags.nsPsy.attackthre=d.st_lrm:Math.abs(e.internal_flags.nsPsy.attackthre- -1)>0||(e.internal_flags.nsPsy.attackthre=d.st_lrm),0!=s?e.internal_flags.nsPsy.attackthre_s=d.st_s:Math.abs(e.internal_flags.nsPsy.attackthre_s- -1)>0||(e.internal_flags.nsPsy.attackthre_s=d.st_s),0!=s?e.maskingadjust=d.masking_adj:Math.abs(e.maskingadjust-0)>0||(e.maskingadjust=d.masking_adj),0!=s?e.maskingadjust_short=d.masking_adj_short:Math.abs(e.maskingadjust_short-0)>0||(e.maskingadjust_short=d.masking_adj_short),0!=s?e.ATHlower=-d.ath_lower/10:Math.abs(10*-e.ATHlower-0)>0||(e.ATHlower=-d.ath_lower/10),0!=s?e.ATHcurve=d.ath_curve:Math.abs(e.ATHcurve- -1)>0||(e.ATHcurve=d.ath_curve),0!=s?e.athaa_sensitivity=d.ath_sensitivity:Math.abs(e.athaa_sensitivity- -1)>0||(e.athaa_sensitivity=d.ath_sensitivity),d.interch>0&&(0!=s?e.interChRatio=d.interch:Math.abs(e.interChRatio- -1)>0||(e.interChRatio=d.interch)),d.safejoint>0&&(e.exp_nspsytune=e.exp_nspsytune|d.safejoint),d.sfb21mod>0&&(e.exp_nspsytune=e.exp_nspsytune|d.sfb21mod<<20),0!=s?e.msfix=d.msfix:Math.abs(e.msfix- -1)>0||(e.msfix=d.msfix),0==s&&(e.VBR_q=t,e.VBR_q_frac=r)}var r=[new t(8,9,9,0,0,6.6,145,0,.95,0,-30,11,.0012,1),new t(16,9,9,0,0,6.6,145,0,.95,0,-25,11,.001,1),new t(24,9,9,0,0,6.6,145,0,.95,0,-20,11,.001,1),new t(32,9,9,0,0,6.6,145,0,.95,0,-15,11,.001,1),new t(40,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new t(48,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new t(56,9,9,0,0,6.6,145,0,.95,0,-6,11,8e-4,1),new t(64,9,9,0,0,6.6,145,0,.95,0,-2,11,8e-4,1),new t(80,9,9,0,0,6.6,145,0,.95,0,0,8,7e-4,1),new t(96,9,9,0,2.5,6.6,145,0,.95,0,1,5.5,6e-4,1),new t(112,9,9,0,2.25,6.6,145,0,.95,0,2,4.5,5e-4,1),new t(128,9,9,0,1.95,6.4,140,0,.95,0,3,4,2e-4,1),new t(160,9,9,1,1.79,6,135,0,.95,-2,5,3.5,0,1),new t(192,9,9,1,1.49,5.6,125,0,.97,-4,7,3,0,0),new t(224,9,9,1,1.25,5.2,125,0,.98,-6,9,2,0,0),new t(256,9,9,1,.97,5.2,125,0,1,-8,10,1,0,0),new t(320,9,9,1,.9,5.2,125,0,1,-10,12,0,0,0)];function i(e,t,a){var o=t,n=s.nearestBitrateFullIndex(t);if(e.VBR=kv.vbr_abr,e.VBR_mean_bitrate_kbps=o,e.VBR_mean_bitrate_kbps=Math.min(e.VBR_mean_bitrate_kbps,320),e.VBR_mean_bitrate_kbps=Math.max(e.VBR_mean_bitrate_kbps,8),e.brate=e.VBR_mean_bitrate_kbps,e.VBR_mean_bitrate_kbps>320&&(e.disable_reservoir=!0),r[n].safejoint>0&&(e.exp_nspsytune=2|e.exp_nspsytune),r[n].sfscale>0&&(e.internal_flags.noise_shaping=2),Math.abs(r[n].nsbass)>0){var i=int(4*r[n].nsbass);i<0&&(i+=64),e.exp_nspsytune=e.exp_nspsytune|i<<2}return 0!=a?e.quant_comp=r[n].quant_comp:Math.abs(e.quant_comp- -1)>0||(e.quant_comp=r[n].quant_comp),0!=a?e.quant_comp_short=r[n].quant_comp_s:Math.abs(e.quant_comp_short- -1)>0||(e.quant_comp_short=r[n].quant_comp_s),0!=a?e.msfix=r[n].nsmsfix:Math.abs(e.msfix- -1)>0||(e.msfix=r[n].nsmsfix),0!=a?e.internal_flags.nsPsy.attackthre=r[n].st_lrm:Math.abs(e.internal_flags.nsPsy.attackthre- -1)>0||(e.internal_flags.nsPsy.attackthre=r[n].st_lrm),0!=a?e.internal_flags.nsPsy.attackthre_s=r[n].st_s:Math.abs(e.internal_flags.nsPsy.attackthre_s- -1)>0||(e.internal_flags.nsPsy.attackthre_s=r[n].st_s),0!=a?e.scale=r[n].scale:Math.abs(e.scale- -1)>0||(e.scale=r[n].scale),0!=a?e.maskingadjust=r[n].masking_adj:Math.abs(e.maskingadjust-0)>0||(e.maskingadjust=r[n].masking_adj),r[n].masking_adj>0?0!=a?e.maskingadjust_short=.9*r[n].masking_adj:Math.abs(e.maskingadjust_short-0)>0||(e.maskingadjust_short=.9*r[n].masking_adj):0!=a?e.maskingadjust_short=1.1*r[n].masking_adj:Math.abs(e.maskingadjust_short-0)>0||(e.maskingadjust_short=1.1*r[n].masking_adj),0!=a?e.ATHlower=-r[n].ath_lower/10:Math.abs(10*-e.ATHlower-0)>0||(e.ATHlower=-r[n].ath_lower/10),0!=a?e.ATHcurve=r[n].ath_curve:Math.abs(e.ATHcurve- -1)>0||(e.ATHcurve=r[n].ath_curve),0!=a?e.interChRatio=r[n].interch:Math.abs(e.interChRatio- -1)>0||(e.interChRatio=r[n].interch),t}function l(e,t){var s=0;return t<0&&(s=-1,t=0),t>9&&(s=-1,t=9),e.VBR_q=t,e.VBR_q_frac=0,s}this.apply_preset=function(e,t,s){switch(t){case wv.R3MIX:t=wv.V3,e.VBR=kv.vbr_mtrh;break;case wv.MEDIUM:t=wv.V4,e.VBR=kv.vbr_rh;break;case wv.MEDIUM_FAST:t=wv.V4,e.VBR=kv.vbr_mtrh;break;case wv.STANDARD:t=wv.V2,e.VBR=kv.vbr_rh;break;case wv.STANDARD_FAST:t=wv.V2,e.VBR=kv.vbr_mtrh;break;case wv.EXTREME:t=wv.V0,e.VBR=kv.vbr_rh;break;case wv.EXTREME_FAST:t=wv.V0,e.VBR=kv.vbr_mtrh;break;case wv.INSANE:return t=320,e.preset=t,i(e,t,s),e.VBR=kv.vbr_off,t}switch(e.preset=t,t){case wv.V9:return n(e,9,s),t;case wv.V8:return n(e,8,s),t;case wv.V7:return n(e,7,s),t;case wv.V6:return n(e,6,s),t;case wv.V5:return n(e,5,s),t;case wv.V4:return n(e,4,s),t;case wv.V3:return n(e,3,s),t;case wv.V2:return n(e,2,s),t;case wv.V1:return n(e,1,s),t;case wv.V0:return n(e,0,s),t}return t>=8&&t<=320?i(e,t,s):(e.preset=0,t)}}function Mv(){this.setModules=function(e,t){}}function Av(){this.over_noise=0,this.tot_noise=0,this.max_noise=0,this.over_count=0,this.over_SSD=0,this.bits=0}var Rv=Ig.new_float,Tv=Ig.new_int;function Ev(){this.global_gain=0,this.sfb_count1=0,this.step=Tv(39),this.noise=Rv(39),this.noise_log=Rv(39)}var Bv=Ig.System,Ov=Ig.VbrMode,Cv=Ig.Util,jv=Ig.Arrays,Iv=Ig.new_float,Lv=Ig.assert;function Pv(){var e,t,s;this.rv=null,this.qupvt=null;var a,o=new Mv;function n(e,t,s,a){a=0;for(var o=0;o<=s;++o){var n=Math.abs(e.xr[o]);a+=n,t[o]=Math.sqrt(n*Math.sqrt(n)),t[o]>e.xrpow_max&&(e.xrpow_max=t[o])}return a}function r(e,t){var a=e.ATH,o=t.xr;if(t.block_type!=Jg.SHORT_TYPE)for(var n=!1,r=Jg.PSFB21-1;r>=0&&!n;r--){var i=e.scalefac_band.psfb21[r],l=e.scalefac_band.psfb21[r+1],c=s.athAdjust(a.adjust,a.psfb21[r],a.floor);e.nsPsy.longfact[21]>1e-12&&(c*=e.nsPsy.longfact[21]);for(var d=l-1;d>=i;d--){if(!(Math.abs(o[d])<c)){n=!0;break}o[d]=0}}else for(var u=0;u<3;u++)for(n=!1,r=Jg.PSFB12-1;r>=0&&!n;r--){i=3*e.scalefac_band.s[12]+(e.scalefac_band.s[13]-e.scalefac_band.s[12])*u+(e.scalefac_band.psfb12[r]-e.scalefac_band.psfb12[0]),l=i+(e.scalefac_band.psfb12[r+1]-e.scalefac_band.psfb12[r]);var m=s.athAdjust(a.adjust,a.psfb12[r],a.floor);e.nsPsy.shortfact[12]>1e-12&&(m*=e.nsPsy.shortfact[12]);for(d=l-1;d>=i;d--){if(!(Math.abs(o[d])<m)){n=!0;break}o[d]=0}}}function i(e){this.ordinal=e}function l(e,t,s,o,n){var r,l=e.CurrentStep[o],c=!1,d=e.OldValue[o],u=i.BINSEARCH_NONE;for(t.global_gain=d,s-=t.part2_length;;){var m;if(r=a.count_bits(e,n,t,null),1==l||r==s)break;r>s?(u==i.BINSEARCH_DOWN&&(c=!0),c&&(l/=2),u=i.BINSEARCH_UP,m=l):(u==i.BINSEARCH_UP&&(c=!0),c&&(l/=2),u=i.BINSEARCH_DOWN,m=-l),t.global_gain+=m,t.global_gain<0&&(t.global_gain=0,c=!0),t.global_gain>255&&(t.global_gain=255,c=!0)}Lv(t.global_gain>=0),Lv(t.global_gain<256);while(r>s&&t.global_gain<255)t.global_gain++,r=a.count_bits(e,n,t,null);return e.CurrentStep[o]=d-t.global_gain>=4?4:2,e.OldValue[o]=t.global_gain,t.part2_3_length=r,r}function c(e){for(var t=0;t<e.sfbmax;t++)if(e.scalefac[t]+e.subblock_gain[e.window[t]]==0)return!1;return!0}function d(e){return Cv.FAST_LOG10(.368+.632*e*e*e)}function u(e,t){for(var s=1e-37,a=0;a<t.psymax;a++)s+=d(e[a]);return Math.max(1e-20,s)}function m(e,t,s,a,o){var n;switch(e){default:case 9:t.over_count>0?(n=s.over_SSD<=t.over_SSD,s.over_SSD==t.over_SSD&&(n=s.bits<t.bits)):n=s.max_noise<0&&10*s.max_noise+s.bits<=10*t.max_noise+t.bits;break;case 0:n=s.over_count<t.over_count||s.over_count==t.over_count&&s.over_noise<t.over_noise||s.over_count==t.over_count&&BitStream.EQ(s.over_noise,t.over_noise)&&s.tot_noise<t.tot_noise;break;case 8:s.max_noise=u(o,a);case 1:n=s.max_noise<t.max_noise;break;case 2:n=s.tot_noise<t.tot_noise;break;case 3:n=s.tot_noise<t.tot_noise&&s.max_noise<t.max_noise;break;case 4:n=s.max_noise<=0&&t.max_noise>.2||s.max_noise<=0&&t.max_noise<0&&t.max_noise>s.max_noise-.2&&s.tot_noise<t.tot_noise||s.max_noise<=0&&t.max_noise>0&&t.max_noise>s.max_noise-.2&&s.tot_noise<t.tot_noise+t.over_noise||s.max_noise>0&&t.max_noise>-.05&&t.max_noise>s.max_noise-.1&&s.tot_noise+s.over_noise<t.tot_noise+t.over_noise||s.max_noise>0&&t.max_noise>-.1&&t.max_noise>s.max_noise-.15&&s.tot_noise+s.over_noise+s.over_noise<t.tot_noise+t.over_noise+t.over_noise;break;case 5:n=s.over_noise<t.over_noise||BitStream.EQ(s.over_noise,t.over_noise)&&s.tot_noise<t.tot_noise;break;case 6:n=s.over_noise<t.over_noise||BitStream.EQ(s.over_noise,t.over_noise)&&(s.max_noise<t.max_noise||BitStream.EQ(s.max_noise,t.max_noise)&&s.tot_noise<=t.tot_noise);break;case 7:n=s.over_count<t.over_count||s.over_noise<t.over_noise;break}return 0==t.over_count&&(n=n&&s.bits<t.bits),n}function p(e,t,s,a,o){var n,r=e.internal_flags;n=0==t.scalefac_scale?1.2968395546510096:1.6817928305074292;for(var i=0,l=0;l<t.sfbmax;l++)i<s[l]&&(i=s[l]);var c=r.noise_shaping_amp;switch(3==c&&(c=o?2:1),c){case 2:break;case 1:i>1?i=Math.pow(i,.5):i*=.95;break;case 0:default:i>1?i=1:i*=.95;break}var d=0;for(l=0;l<t.sfbmax;l++){var u,m=t.width[l];if(d+=m,!(s[l]<i)){if(0!=(2&r.substep_shaping)&&(r.pseudohalf[l]=0==r.pseudohalf[l]?1:0,0==r.pseudohalf[l]&&2==r.noise_shaping_amp))return;for(t.scalefac[l]++,u=-m;u<0;u++)a[d+u]*=n,a[d+u]>t.xrpow_max&&(t.xrpow_max=a[d+u]);if(2==r.noise_shaping_amp)return}}}function h(e,t){for(var a=1.2968395546510096,o=0,n=0;n<e.sfbmax;n++){var r=e.width[n],i=e.scalefac[n];if(0!=e.preflag&&(i+=s.pretab[n]),o+=r,0!=(1&i)){i++;for(var l=-r;l<0;l++)t[o+l]*=a,t[o+l]>e.xrpow_max&&(e.xrpow_max=t[o+l])}e.scalefac[n]=i>>1}e.preflag=0,e.scalefac_scale=1}function f(e,t,a){var o,n=t.scalefac;for(o=0;o<t.sfb_lmax;o++)if(n[o]>=16)return!0;for(var r=0;r<3;r++){var i=0,l=0;for(o=t.sfb_lmax+r;o<t.sfbdivide;o+=3)i<n[o]&&(i=n[o]);for(;o<t.sfbmax;o+=3)l<n[o]&&(l=n[o]);if(!(i<16&&l<8)){if(t.subblock_gain[r]>=7)return!0;t.subblock_gain[r]++;var c=e.scalefac_band.l[t.sfb_lmax];for(o=t.sfb_lmax+r;o<t.sfbmax;o+=3){var d=t.width[o],u=n[o];if(u-=4>>t.scalefac_scale,u>=0)n[o]=u,c+=3*d;else{n[o]=0;var m=210+(u<<t.scalefac_scale+1);h=s.IPOW20(m),c+=d*(r+1);for(var p=-d;p<0;p++)a[c+p]*=h,a[c+p]>t.xrpow_max&&(t.xrpow_max=a[c+p]);c+=d*(3-r-1)}}var h=s.IPOW20(202);c+=t.width[o]*(r+1);for(p=-t.width[o];p<0;p++)a[c+p]*=h,a[c+p]>t.xrpow_max&&(t.xrpow_max=a[c+p])}}return!1}function g(e,t,s,o,n){var r=e.internal_flags;p(e,t,s,o,n);var i=c(t);return!i&&(i=2==r.mode_gr?a.scale_bitcount(t):a.scale_bitcount_lsf(r,t),!i||(r.noise_shaping>1&&(jv.fill(r.pseudohalf,0),0==t.scalefac_scale?(h(t,o),i=!1):t.block_type==Jg.SHORT_TYPE&&r.subblock_gain>0&&(i=f(r,t,o)||c(t))),i||(i=2==r.mode_gr?a.scale_bitcount(t):a.scale_bitcount_lsf(r,t)),!i))}this.setModules=function(n,r,i,l){e=n,t=r,this.rv=r,s=i,this.qupvt=i,a=l,o.setModules(s,a)},this.ms_convert=function(e,t){for(var s=0;s<576;++s){var a=e.tt[t][0].xr[s],o=e.tt[t][1].xr[s];e.tt[t][0].xr[s]=(a+o)*(.5*Cv.SQRT2),e.tt[t][1].xr[s]=(a-o)*(.5*Cv.SQRT2)}},this.init_xrpow=function(e,t,s){var a=0,o=0|t.max_nonzero_coeff;if(t.xrpow_max=0,jv.fill(s,o,576,0),a=n(t,s,o,a),a>1e-20){var r=0;0!=(2&e.substep_shaping)&&(r=1);for(var i=0;i<t.psymax;i++)e.pseudohalf[i]=r;return!0}return jv.fill(t.l3_enc,0,576,0),!1},this.init_outer_loop=function(e,t){t.part2_3_length=0,t.big_values=0,t.count1=0,t.global_gain=210,t.scalefac_compress=0,t.table_select[0]=0,t.table_select[1]=0,t.table_select[2]=0,t.subblock_gain[0]=0,t.subblock_gain[1]=0,t.subblock_gain[2]=0,t.subblock_gain[3]=0,t.region0_count=0,t.region1_count=0,t.preflag=0,t.scalefac_scale=0,t.count1table_select=0,t.part2_length=0,t.sfb_lmax=Jg.SBPSY_l,t.sfb_smin=Jg.SBPSY_s,t.psy_lmax=e.sfb21_extra?Jg.SBMAX_l:Jg.SBPSY_l,t.psymax=t.psy_lmax,t.sfbmax=t.sfb_lmax,t.sfbdivide=11;for(var a=0;a<Jg.SBMAX_l;a++)t.width[a]=e.scalefac_band.l[a+1]-e.scalefac_band.l[a],t.window[a]=3;if(t.block_type==Jg.SHORT_TYPE){var o=Iv(576);t.sfb_smin=0,t.sfb_lmax=0,0!=t.mixed_block_flag&&(t.sfb_smin=3,t.sfb_lmax=2*e.mode_gr+4),t.psymax=t.sfb_lmax+3*((e.sfb21_extra?Jg.SBMAX_s:Jg.SBPSY_s)-t.sfb_smin),t.sfbmax=t.sfb_lmax+3*(Jg.SBPSY_s-t.sfb_smin),t.sfbdivide=t.sfbmax-18,t.psy_lmax=t.sfb_lmax;var n=e.scalefac_band.l[t.sfb_lmax];Bv.arraycopy(t.xr,0,o,0,576);for(a=t.sfb_smin;a<Jg.SBMAX_s;a++)for(var i=e.scalefac_band.s[a],l=e.scalefac_band.s[a+1],c=0;c<3;c++)for(var d=i;d<l;d++)t.xr[n++]=o[3*d+c];var u=t.sfb_lmax;for(a=t.sfb_smin;a<Jg.SBMAX_s;a++)t.width[u]=t.width[u+1]=t.width[u+2]=e.scalefac_band.s[a+1]-e.scalefac_band.s[a],t.window[u]=0,t.window[u+1]=1,t.window[u+2]=2,u+=3}t.count1bits=0,t.sfb_partition_table=s.nr_of_sfb_block[0][0],t.slen[0]=0,t.slen[1]=0,t.slen[2]=0,t.slen[3]=0,t.max_nonzero_coeff=575,jv.fill(t.scalefac,0),r(e,t)},i.BINSEARCH_NONE=new i(0),i.BINSEARCH_UP=new i(1),i.BINSEARCH_DOWN=new i(2),this.trancate_smallspectrums=function(e,t,o,n){var r=Iv(h_.SFBMAX);if((0!=(4&e.substep_shaping)||t.block_type!=Jg.SHORT_TYPE)&&0==(128&e.substep_shaping)){s.calc_noise(t,o,r,new Av,null);for(var i=0;i<576;i++){var l=0;0!=t.l3_enc[i]&&(l=Math.abs(t.xr[i])),n[i]=l}i=0;var c=8;t.block_type==Jg.SHORT_TYPE&&(c=6);do{var d,u,m,p,h=t.width[c];if(i+=h,!(r[c]>=1)&&(jv.sort(n,i-h,h),!BitStream.EQ(n[i-1],0))){d=(1-r[c])*o[c],u=0,p=0;do{var f;for(m=1;p+m<h;m++)if(BitStream.NEQ(n[p+i-h],n[p+i+m-h]))break;if(f=n[p+i-h]*n[p+i-h]*m,d<f){0!=p&&(u=n[p+i-h-1]);break}d-=f,p+=m}while(p<h);if(!BitStream.EQ(u,0))do{Math.abs(t.xr[i-h])<=u&&(t.l3_enc[i-h]=0)}while(--h>0)}}while(++c<t.psymax);t.part2_3_length=a.noquant_count_bits(e,t,null)}},this.outer_loop=function(e,t,o,n,r,i){var c,d=e.internal_flags,u=new __,p=Iv(576),h=Iv(h_.SFBMAX),f=new Av,_=new Ev,v=9999999,b=!1,y=!1,x=0;if(l(d,t,i,r,n),0==d.noise_shaping)return 100;s.calc_noise(t,o,h,f,_),f.bits=t.part2_3_length,u.assign(t);var w=0;Bv.arraycopy(n,0,p,0,576);while(!b){do{var k,S=new Av,M=255;if(k=0!=(2&d.substep_shaping)?20:3,d.sfb21_extra){if(h[u.sfbmax]>1)break;if(u.block_type==Jg.SHORT_TYPE&&(h[u.sfbmax+1]>1||h[u.sfbmax+2]>1))break}if(!g(e,u,h,n,y))break;0!=u.scalefac_scale&&(M=254);var A=i-u.part2_length;if(A<=0)break;while((u.part2_3_length=a.count_bits(d,n,u,_))>A&&u.global_gain<=M)u.global_gain++;if(u.global_gain>M)break;if(0==f.over_count){while((u.part2_3_length=a.count_bits(d,n,u,_))>v&&u.global_gain<=M)u.global_gain++;if(u.global_gain>M)break}if(s.calc_noise(u,o,h,S,_),S.bits=u.part2_3_length,c=t.block_type!=Jg.SHORT_TYPE?e.quant_comp:e.quant_comp_short,c=m(c,f,S,u,h)?1:0,0!=c)v=t.part2_3_length,f=S,t.assign(u),w=0,Bv.arraycopy(n,0,p,0,576);else if(0==d.full_outer_loop){if(++w>k&&0==f.over_count)break;if(3==d.noise_shaping_amp&&y&&w>30)break;if(3==d.noise_shaping_amp&&y&&u.global_gain-x>15)break}}while(u.global_gain+u.scalefac_scale<255);3==d.noise_shaping_amp?y?b=!0:(u.assign(t),Bv.arraycopy(p,0,n,0,576),w=0,x=u.global_gain,y=!0):b=!0}return Lv(t.global_gain+t.scalefac_scale<=255),e.VBR==Ov.vbr_rh||e.VBR==Ov.vbr_mtrh?Bv.arraycopy(p,0,n,0,576):0!=(1&d.substep_shaping)&&trancate_smallspectrums(d,t,o,n),f.over_count},this.iteration_finish_one=function(e,s,o){var n=e.l3_side,r=n.tt[s][o];a.best_scalefac_store(e,s,o,n),1==e.use_best_huffman&&a.best_huffman_divide(e,r),t.ResvAdjust(e,r)},this.VBR_encode_granule=function(e,t,s,a,o,n,r){var i,l,c=e.internal_flags,d=new __,u=Iv(576),m=r,p=r+1,h=(r+n)/2,f=0,g=c.sfb21_extra;Lv(m<=LameInternalFlags.MAX_BITS_PER_CHANNEL),jv.fill(d.l3_enc,0);do{c.sfb21_extra=!(h>m-42)&&g,l=outer_loop(e,t,s,a,o,h),l<=0?(f=1,p=t.part2_3_length,d.assign(t),Bv.arraycopy(a,0,u,0,576),r=p-32,i=r-n,h=(r+n)/2):(n=h+32,i=r-n,h=(r+n)/2,0!=f&&(f=2,t.assign(d),Bv.arraycopy(u,0,a,0,576)))}while(i>12);c.sfb21_extra=g,2==f&&Bv.arraycopy(d.l3_enc,0,t.l3_enc,0,576),Lv(t.part2_3_length<=m)},this.get_framebits=function(s,a){var o=s.internal_flags;o.bitrate_index=o.VBR_min_bitrate;var n=e.getframebits(s);o.bitrate_index=1,n=e.getframebits(s);for(var r=1;r<=o.VBR_max_bitrate;r++){o.bitrate_index=r;var i=new MeanBits(n);a[r]=t.ResvFrameBegin(s,i),n=i.bits}},this.VBR_old_prepare=function(e,a,o,n,r,i,l,c,d){var u,m=e.internal_flags,p=0,h=1,f=0;m.bitrate_index=m.VBR_max_bitrate;var g=t.ResvFrameBegin(e,new MeanBits(0))/m.mode_gr;get_framebits(e,i);for(var _=0;_<m.mode_gr;_++){var v=s.on_pe(e,a,c[_],g,_,0);m.mode_ext==Jg.MPG_MD_MS_LR&&(ms_convert(m.l3_side,_),s.reduce_side(c[_],o[_],g,v));for(var b=0;b<m.channels_out;++b){var y=m.l3_side.tt[_][b];y.block_type!=Jg.SHORT_TYPE?(p=1.28/(1+Math.exp(3.5-a[_][b]/300))-.05,u=m.PSY.mask_adjust-p):(p=2.56/(1+Math.exp(3.5-a[_][b]/300))-.14,u=m.PSY.mask_adjust_short-p),m.masking_lower=Math.pow(10,.1*u),init_outer_loop(m,y),d[_][b]=s.calc_xmin(e,n[_][b],y,r[_][b]),0!=d[_][b]&&(h=0),l[_][b]=126,f+=c[_][b]}}for(_=0;_<m.mode_gr;_++)for(b=0;b<m.channels_out;b++)f>i[m.VBR_max_bitrate]&&(c[_][b]*=i[m.VBR_max_bitrate],c[_][b]/=f),l[_][b]>c[_][b]&&(l[_][b]=c[_][b]);return h},this.bitpressure_strategy=function(e,t,s,a){for(var o=0;o<e.mode_gr;o++)for(var n=0;n<e.channels_out;n++){for(var r=e.l3_side.tt[o][n],i=t[o][n],l=0,c=0;c<r.psy_lmax;c++)i[l++]*=1+.029*c*c/Jg.SBMAX_l/Jg.SBMAX_l;if(r.block_type==Jg.SHORT_TYPE)for(c=r.sfb_smin;c<Jg.SBMAX_s;c++)i[l++]*=1+.029*c*c/Jg.SBMAX_s/Jg.SBMAX_s,i[l++]*=1+.029*c*c/Jg.SBMAX_s/Jg.SBMAX_s,i[l++]*=1+.029*c*c/Jg.SBMAX_s/Jg.SBMAX_s;a[o][n]=0|Math.max(s[o][n],.9*a[o][n])}},this.VBR_new_prepare=function(e,a,o,n,r,i){var l,c=e.internal_flags,d=1,u=0,m=0;if(e.free_format){c.bitrate_index=0;p=new MeanBits(u);l=t.ResvFrameBegin(e,p),u=p.bits,r[0]=l}else{c.bitrate_index=c.VBR_max_bitrate;var p=new MeanBits(u);t.ResvFrameBegin(e,p),u=p.bits,get_framebits(e,r),l=r[c.VBR_max_bitrate]}for(var h=0;h<c.mode_gr;h++){s.on_pe(e,a,i[h],u,h,0),c.mode_ext==Jg.MPG_MD_MS_LR&&ms_convert(c.l3_side,h);for(var f=0;f<c.channels_out;++f){var g=c.l3_side.tt[h][f];c.masking_lower=Math.pow(10,.1*c.PSY.mask_adjust),init_outer_loop(c,g),0!=s.calc_xmin(e,o[h][f],g,n[h][f])&&(d=0),m+=i[h][f]}}for(h=0;h<c.mode_gr;h++)for(f=0;f<c.channels_out;f++)m>l&&(i[h][f]*=l,i[h][f]/=m);return d},this.calc_target_bits=function(a,o,n,r,i,l){var c,d,u,m,p=a.internal_flags,h=p.l3_side,f=0;p.bitrate_index=p.VBR_max_bitrate;var g=new MeanBits(f);for(l[0]=t.ResvFrameBegin(a,g),f=g.bits,p.bitrate_index=1,f=e.getframebits(a)-8*p.sideinfo_len,i[0]=f/(p.mode_gr*p.channels_out),f=a.VBR_mean_bitrate_kbps*a.framesize*1e3,0!=(1&p.substep_shaping)&&(f*=1.09),f/=a.out_samplerate,f-=8*p.sideinfo_len,f/=p.mode_gr*p.channels_out,c=.93+.07*(11-a.compression_ratio)/5.5,c<.9&&(c=.9),c>1&&(c=1),d=0;d<p.mode_gr;d++){var _=0;for(u=0;u<p.channels_out;u++){if(r[d][u]=int(c*f),o[d][u]>700){var v=int((o[d][u]-700)/1.4),b=h.tt[d][u];r[d][u]=int(c*f),b.block_type==Jg.SHORT_TYPE&&v<f/2&&(v=f/2),v>3*f/2?v=3*f/2:v<0&&(v=0),r[d][u]+=v}r[d][u]>LameInternalFlags.MAX_BITS_PER_CHANNEL&&(r[d][u]=LameInternalFlags.MAX_BITS_PER_CHANNEL),_+=r[d][u]}if(_>LameInternalFlags.MAX_BITS_PER_GRANULE)for(u=0;u<p.channels_out;++u)r[d][u]*=LameInternalFlags.MAX_BITS_PER_GRANULE,r[d][u]/=_}if(p.mode_ext==Jg.MPG_MD_MS_LR)for(d=0;d<p.mode_gr;d++)s.reduce_side(r[d],n[d],f*p.channels_out,LameInternalFlags.MAX_BITS_PER_GRANULE);for(m=0,d=0;d<p.mode_gr;d++)for(u=0;u<p.channels_out;u++)r[d][u]>LameInternalFlags.MAX_BITS_PER_CHANNEL&&(r[d][u]=LameInternalFlags.MAX_BITS_PER_CHANNEL),m+=r[d][u];if(m>l[0])for(d=0;d<p.mode_gr;d++)for(u=0;u<p.channels_out;u++)r[d][u]*=l[0],r[d][u]/=m}}var Nv=Ig.assert;function Hv(){var e;this.setModules=function(t){e=t},this.ResvFrameBegin=function(t,s){var a,o=t.internal_flags,n=o.l3_side,r=e.getframebits(t);s.bits=(r-8*o.sideinfo_len)/o.mode_gr;var i=2048*o.mode_gr-8;t.brate>320?a=8*int(1e3*t.brate/(t.out_samplerate/1152)/8+.5):(a=11520,t.strict_ISO&&(a=8*int(32e4/(t.out_samplerate/1152)/8+.5))),o.ResvMax=a-r,o.ResvMax>i&&(o.ResvMax=i),(o.ResvMax<0||t.disable_reservoir)&&(o.ResvMax=0);var l=s.bits*o.mode_gr+Math.min(o.ResvSize,o.ResvMax);return l>a&&(l=a),Nv(o.ResvMax%8==0),Nv(o.ResvMax>=0),n.resvDrain_pre=0,null!=o.pinfo&&(o.pinfo.mean_bits=s.bits/2,o.pinfo.resvsize=o.ResvSize),l},this.ResvMaxBits=function(e,t,s,a){var o,n=e.internal_flags,r=n.ResvSize,i=n.ResvMax;0!=a&&(r+=t),0!=(1&n.substep_shaping)&&(i*=.9),s.bits=t,10*r>9*i?(o=r-9*i/10,s.bits+=o,n.substep_shaping|=128):(o=0,n.substep_shaping&=127,e.disable_reservoir||0!=(1&n.substep_shaping)||(s.bits-=.1*t));var l=r<6*n.ResvMax/10?r:6*n.ResvMax/10;return l-=o,l<0&&(l=0),l},this.ResvAdjust=function(e,t){e.ResvSize-=t.part2_3_length+t.part2_length},this.ResvFrameEnd=function(e,t){var s,a=e.l3_side;e.ResvSize+=t*e.mode_gr;var o=0;a.resvDrain_post=0,a.resvDrain_pre=0,0!=(s=e.ResvSize%8)&&(o+=s),s=e.ResvSize-o-e.ResvMax,s>0&&(o+=s);var n=Math.min(8*a.main_data_begin,o)/8;a.resvDrain_pre+=8*n,o-=8*n,e.ResvSize-=8*n,a.main_data_begin-=n,a.resvDrain_post+=o,e.ResvSize-=o}}function Fv(){var e="http://www.mp3dev.org/",t=3,s=98,a=4,o=0,n=93;this.getLameVersion=function(){return t+"."+s+"."+a},this.getLameShortVersion=function(){return t+"."+s+"."+a},this.getLameVeryShortVersion=function(){return"LAME"+t+"."+s+"r"},this.getPsyVersion=function(){return o+"."+n},this.getLameUrl=function(){return e},this.getLameOsBitness=function(){return"32bits"}}var Dv=Ig.System,$v=Ig.VbrMode,Uv=Ig.ShortBlock,qv=Ig.Arrays,Vv=Ig.new_byte,zv=Ig.assert;function Xv(){var e,t,s;this.setModules=function(a,o,n){e=a,t=o,s=n};var a=1,o=2,n=4,r=8,i=Xv.NUMTOCENTRIES,l=Xv.MAXFRAMESIZE,c=i+4+4+4+4+4,d=c+9+1+1+8+1+1+3+1+1+2+4+2+2,u=128,m=64,p=32,h=null,f="Xing",g="Info",_=[0,49345,49537,320,49921,960,640,49729,50689,1728,1920,51009,1280,50625,50305,1088,52225,3264,3456,52545,3840,53185,52865,3648,2560,51905,52097,2880,51457,2496,2176,51265,55297,6336,6528,55617,6912,56257,55937,6720,7680,57025,57217,8e3,56577,7616,7296,56385,5120,54465,54657,5440,55041,6080,5760,54849,53761,4800,4992,54081,4352,53697,53377,4160,61441,12480,12672,61761,13056,62401,62081,12864,13824,63169,63361,14144,62721,13760,13440,62529,15360,64705,64897,15680,65281,16320,16e3,65089,64001,15040,15232,64321,14592,63937,63617,14400,10240,59585,59777,10560,60161,11200,10880,59969,60929,11968,12160,61249,11520,60865,60545,11328,58369,9408,9600,58689,9984,59329,59009,9792,8704,58049,58241,9024,57601,8640,8320,57409,40961,24768,24960,41281,25344,41921,41601,25152,26112,42689,42881,26432,42241,26048,25728,42049,27648,44225,44417,27968,44801,28608,28288,44609,43521,27328,27520,43841,26880,43457,43137,26688,30720,47297,47489,31040,47873,31680,31360,47681,48641,32448,32640,48961,32e3,48577,48257,31808,46081,29888,30080,46401,30464,47041,46721,30272,29184,45761,45953,29504,45313,29120,28800,45121,20480,37057,37249,20800,37633,21440,21120,37441,38401,22208,22400,38721,21760,38337,38017,21568,39937,23744,23936,40257,24320,40897,40577,24128,23040,39617,39809,23360,39169,22976,22656,38977,34817,18624,18816,35137,19200,35777,35457,19008,19968,36545,36737,20288,36097,19904,19584,35905,17408,33985,34177,17728,34561,18368,18048,34369,33281,17088,17280,33601,16640,33217,32897,16448];function v(e,t){if(e.nVbrNumFrames++,e.sum+=t,e.seen++,!(e.seen<e.want)&&(e.pos<e.size&&(e.bag[e.pos]=e.sum,e.pos++,e.seen=0),e.pos==e.size)){for(var s=1;s<e.size;s+=2)e.bag[s/2]=e.bag[s];e.want*=2,e.pos/=2}}function b(e,t){if(!(e.pos<=0))for(var s=1;s<i;++s){var a,o,n=s/i,r=0|Math.floor(n*e.pos);r>e.pos-1&&(r=e.pos-1),a=e.bag[r],o=e.sum;var l=0|256*a/o;l>255&&(l=255),t[s]=255&l}}function y(e,t){var s=255&e[t+0];return s<<=8,s|=255&e[t+1],s<<=8,s|=255&e[t+2],s<<=8,s|=255&e[t+3],s}function x(e,t,s){e[t+0]=255&s>>24,e[t+1]=255&s>>16,e[t+2]=255&s>>8,e[t+3]=255&s}function w(e,t,s){e[t+0]=255&s>>8,e[t+1]=255&s}function k(e,t){return new String(e,t,f.length(),h).equals(f)||new String(e,t,g.length(),h).equals(g)}function S(e,t,s){return 255&(e<<t|s&~(-1<<t))}function M(t,s){var a=t.internal_flags;s[0]=S(s[0],8,255),s[1]=S(s[1],3,7),s[1]=S(s[1],1,t.out_samplerate<16e3?0:1),s[1]=S(s[1],1,t.version),s[1]=S(s[1],2,1),s[1]=S(s[1],1,t.error_protection?0:1),s[2]=S(s[2],4,a.bitrate_index),s[2]=S(s[2],2,a.samplerate_index),s[2]=S(s[2],1,0),s[2]=S(s[2],1,t.extension),s[3]=S(s[3],2,t.mode.ordinal()),s[3]=S(s[3],2,a.mode_ext),s[3]=S(s[3],1,t.copyright),s[3]=S(s[3],1,t.original),s[3]=S(s[3],2,t.emphasis),s[0]=255;var o,n,r=241&s[1];o=1==t.version?u:t.out_samplerate<16e3?p:m,t.VBR==$v.vbr_off&&(o=t.brate),n=t.free_format?0:255&16*e.BitrateIndex(o,t.version,t.out_samplerate),1==t.version?(s[1]=255&(10|r),r=13&s[2],s[2]=255&(n|r)):(s[1]=255&(2|r),r=13&s[2],s[2]=255&(n|r))}function A(e,t){var s=t^e;return t=t>>8^_[255&s],t}function R(e,t,a,o,n){var r,i,l,c=e.internal_flags,d=0,u=e.encoder_delay,m=e.encoder_padding,p=100-10*e.VBR_q-e.quality,h=s.getLameVeryShortVersion(),f=0,g=[1,5,3,2,4,0,3],_=0|(e.lowpassfreq/100+.5>255?255:e.lowpassfreq/100+.5),v=0,b=0,y=0,k=e.internal_flags.noise_shaping,S=0,M=0,R=0,T=0,E=0,B=0!=(1&e.exp_nspsytune),O=0!=(2&e.exp_nspsytune),C=!1,j=!1,I=e.internal_flags.nogap_total,L=e.internal_flags.nogap_current,P=e.ATHtype,N=0;switch(e.VBR){case vbr_abr:l=e.VBR_mean_bitrate_kbps;break;case vbr_off:l=e.brate;break;default:l=e.VBR_min_bitrate_kbps}switch(r=e.VBR.ordinal()<g.length?g[e.VBR.ordinal()]:0,i=16*f+r,c.findReplayGain&&(c.RadioGain>510&&(c.RadioGain=510),c.RadioGain<-510&&(c.RadioGain=-510),b=8192,b|=3072,c.RadioGain>=0?b|=c.RadioGain:(b|=512,b|=-c.RadioGain)),c.findPeakSample&&(v=Math.abs(0|c.PeakSample/32767*Math.pow(2,23)+.5)),-1!=I&&(L>0&&(j=!0),L<I-1&&(C=!0)),N=P+((B?1:0)<<4)+((O?1:0)<<5)+((C?1:0)<<6)+((j?1:0)<<7),p<0&&(p=0),e.mode){case MONO:S=0;break;case STEREO:S=1;break;case DUAL_CHANNEL:S=2;break;case JOINT_STEREO:S=e.force_ms?4:3;break;case NOT_SET:default:S=7;break}R=e.in_samplerate<=32e3?0:48e3==e.in_samplerate?2:e.in_samplerate>48e3?3:1,(e.short_blocks==Uv.short_block_forced||e.short_blocks==Uv.short_block_dispensed||-1==e.lowpassfreq&&-1==e.highpassfreq||e.scale_left<e.scale_right||e.scale_left>e.scale_right||e.disable_reservoir&&e.brate<320||e.noATH||e.ATHonly||0==P||e.in_samplerate<=32e3)&&(M=1),T=k+(S<<2)+(M<<5)+(R<<6),E=c.nMusicCRC,x(a,o+d,p),d+=4;for(var H=0;H<9;H++)a[o+d+H]=255&h.charAt(H);d+=9,a[o+d]=255&i,d++,a[o+d]=255&_,d++,x(a,o+d,v),d+=4,w(a,o+d,b),d+=2,w(a,o+d,y),d+=2,a[o+d]=255&N,d++,a[o+d]=l>=255?255:255&l,d++,a[o+d]=255&u>>4,a[o+d+1]=255&(u<<4)+(m>>8),a[o+d+2]=255&m,d+=3,a[o+d]=255&T,d++,a[o+d++]=0,w(a,o+d,e.preset),d+=2,x(a,o+d,t),d+=4,w(a,o+d,E),d+=2;for(var F=0;F<d;F++)n=A(a[o+F],n);return w(a,o+d,n),d+=2,d}function T(e){e.seek(0);var t,s=Vv(10);return e.readFully(s),t=new String(s,"ISO-8859-1").startsWith("ID3")?0:((127&s[6])<<21|(127&s[7])<<14|(127&s[8])<<7|127&s[9])+s.length,t}this.addVbrFrame=function(e){var t=e.internal_flags,s=Tables.bitrate_table[e.version][t.bitrate_index];zv(null!=t.VBR_seek_table.bag),v(t.VBR_seek_table,s)},this.getVbrTag=function(e){var t=new VBRTagData,s=0;t.flags=0;var l=e[s+1]>>3&1,c=e[s+2]>>2&3,d=e[s+3]>>6&3,u=e[s+2]>>4&15;if(u=Tables.bitrate_table[l][u],e[s+1]>>4==14?t.samprate=Tables.samplerate_table[2][c]:t.samprate=Tables.samplerate_table[l][c],s+=0!=l?3!=d?36:21:3!=d?21:13,!k(e,s))return null;s+=4,t.hId=l;var m=t.flags=y(e,s);if(s+=4,0!=(m&a)&&(t.frames=y(e,s),s+=4),0!=(m&o)&&(t.bytes=y(e,s),s+=4),0!=(m&n)){if(null!=t.toc)for(var p=0;p<i;p++)t.toc[p]=e[s+p];s+=i}t.vbrScale=-1,0!=(m&r)&&(t.vbrScale=y(e,s),s+=4),t.headersize=72e3*(l+1)*u/t.samprate,s+=21;var h=e[s+0]<<4;h+=e[s+1]>>4;var f=(15&e[s+1])<<8;return f+=255&e[s+2],(h<0||h>3e3)&&(h=-1),(f<0||f>3e3)&&(f=-1),t.encDelay=h,t.encPadding=f,t},this.InitVbrTag=function(e){var s,a=e.internal_flags;s=1==e.version?u:e.out_samplerate<16e3?p:m,e.VBR==$v.vbr_off&&(s=e.brate);var o=72e3*(e.version+1)*s/e.out_samplerate,n=a.sideinfo_len+d;if(a.VBR_seek_table.TotalFrameSize=o,o<n||o>l)e.bWriteVbrTag=!1;else{a.VBR_seek_table.nVbrNumFrames=0,a.VBR_seek_table.nBytesWritten=0,a.VBR_seek_table.sum=0,a.VBR_seek_table.seen=0,a.VBR_seek_table.want=1,a.VBR_seek_table.pos=0,null==a.VBR_seek_table.bag&&(a.VBR_seek_table.bag=new int[400],a.VBR_seek_table.size=400);var r=Vv(l);M(e,r);for(var i=a.VBR_seek_table.TotalFrameSize,c=0;c<i;++c)t.add_dummy_byte(e,255&r[c],1)}},this.updateMusicCRC=function(e,t,s,a){for(var o=0;o<a;++o)e[0]=A(t[s+o],e[0])},this.getLameTagFrame=function(e,s){var l=e.internal_flags;if(!e.bWriteVbrTag)return 0;if(l.Class_ID!=Lame.LAME_ID)return 0;if(l.VBR_seek_table.pos<=0)return 0;if(s.length<l.VBR_seek_table.TotalFrameSize)return l.VBR_seek_table.TotalFrameSize;qv.fill(s,0,l.VBR_seek_table.TotalFrameSize,0),M(e,s);var c=Vv(i);if(e.free_format)for(var d=1;d<i;++d)c[d]=255&255*d/100;else b(l.VBR_seek_table,c);var u=l.sideinfo_len;e.error_protection&&(u-=2),e.VBR==$v.vbr_off?(s[u++]=255&g.charAt(0),s[u++]=255&g.charAt(1),s[u++]=255&g.charAt(2),s[u++]=255&g.charAt(3)):(s[u++]=255&f.charAt(0),s[u++]=255&f.charAt(1),s[u++]=255&f.charAt(2),s[u++]=255&f.charAt(3)),x(s,u,a+o+n+r),u+=4,x(s,u,l.VBR_seek_table.nVbrNumFrames),u+=4;var m=l.VBR_seek_table.nBytesWritten+l.VBR_seek_table.TotalFrameSize;x(s,u,0|m),u+=4,Dv.arraycopy(c,0,s,u,c.length),u+=c.length,e.error_protection&&t.CRC_writeheader(l,s);var p=0;for(d=0;d<u;d++)p=A(s[d],p);return u+=R(e,m,s,u,p),l.VBR_seek_table.TotalFrameSize},this.putVbrTag=function(e,t){var s=e.internal_flags;if(s.VBR_seek_table.pos<=0)return-1;if(t.seek(t.length()),0==t.length())return-1;var a=T(t);t.seek(a);var o=Vv(l),n=getLameTagFrame(e,o);return n>o.length?-1:(n<1||t.write(o,0,n),0)}}Xv.NUMTOCENTRIES=100,Xv.MAXFRAMESIZE=2880;var Yv=Ig.new_byte,Kv=Ig.assert;function Gv(){this.setModules=function(e,t){}}function Zv(){this.setModules=function(e,t,s){}}function Wv(){}function Qv(){this.setModules=function(e,t){}}function Jv(e,t,s){3!=arguments.length&&(console.error("WARN: Mp3Encoder(channels, samplerate, kbps) not specified"),e=1,t=44100,s=128);var a=new wv,o=new Gv,n=new F_,r=new hv,i=new Sv,l=new sv,c=new Pv,d=new Xv,u=new Fv,m=new Qv,p=new Hv,h=new iv,f=new Zv,g=new Wv;a.setModules(n,r,i,l,c,d,u,m,g),r.setModules(n,g,u,d),m.setModules(r,u),i.setModules(a),c.setModules(r,p,l,h),l.setModules(h,p,a.enc.psy),p.setModules(r),h.setModules(l),d.setModules(a,r,u),o.setModules(f,g),f.setModules(u,m,i);var _=a.lame_init();_.num_channels=e,_.in_samplerate=t,_.brate=s,_.mode=zg.STEREO,_.quality=3,_.bWriteVbrTag=!1,_.disable_reservoir=!0,_.write_id3tag_automatic=!1,a.lame_init_params(_);var v=1152,b=0|1.25*v+7200,y=Yv(b);this.encodeBuffer=function(t,s){1==e&&(s=t),Kv(t.length==s.length),t.length>v&&(v=t.length,b=0|1.25*v+7200,y=Yv(b));var o=a.lame_encode_buffer(_,t,s,t.length,y,0,b);return new Int8Array(y.subarray(0,o))},this.flush=function(){var e=a.lame_encode_flush(_,y,0,b);return new Int8Array(y.subarray(0,e))}}function eb(e){return e.charCodeAt(0)<<24|e.charCodeAt(1)<<16|e.charCodeAt(2)<<8|e.charCodeAt(3)}eb("RIFF"),eb("WAVE"),eb("fmt "),eb("data");class tb{constructor(e){this.bitRate=e.bitRate,this.sampleRate=e.sampleRate,this.dataBuffer=[],this.encoder=new Jv(1,this.sampleRate,this.bitRate)}encode(e){const t=1152,s=this._convertBuffer(e);let a=s.length;for(let o=0;a>=0;o+=t){const e=s.subarray(o,o+t),n=this.encoder.encodeBuffer(e);this.dataBuffer.push(new Int8Array(n)),a-=t}}finish(){this.dataBuffer.push(this.encoder.flush());const e=new Blob(this.dataBuffer,{type:"audio/mp3"});return this.dataBuffer=[],{id:Date.now(),blob:e,url:URL.createObjectURL(e)}}_floatTo16BitPCM(e,t){for(let s=0;s<e.length;s++){const a=Math.max(-1,Math.min(1,e[s]));t[s]=a<0?32768*a:32767*a}}_convertBuffer(e){const t=new Float32Array(e),s=new Int16Array(e.length);return this._floatTo16BitPCM(t,s),s}}class sb{constructor(e={}){this.beforeRecording=e.beforeRecording,this.pauseRecording=e.pauseRecording,this.afterRecording=e.afterRecording,this.micFailed=e.micFailed,this.encoderOptions={bitRate:e.bitRate,sampleRate:e.sampleRate},this.bufferSize=4096,this.records=[],this.isPause=!1,this.isRecording=!1,this.duration=0,this.volume=0,this._duration=0}start(){const e={video:!1,audio:{channelCount:1,echoCancellation:!1}};this.beforeRecording&&this.beforeRecording("start recording"),navigator.mediaDevices.getUserMedia(e).then(this._micCaptured.bind(this)).catch(this._micError.bind(this)),this.isPause=!1,this.isRecording=!0,this.lameEncoder||(this.lameEncoder=new tb(this.encoderOptions))}stop(){this.stream.getTracks().forEach(e=>e.stop()),this.input.disconnect(),this.processor.disconnect(),this.context.close();let e=null;e=this.lameEncoder.finish(),e.duration=this.duration,this.records.push(e),this._duration=0,this.duration=0,this.isPause=!1,this.isRecording=!1,this.afterRecording&&this.afterRecording(e)}pause(){this.stream.getTracks().forEach(e=>e.stop()),this.input.disconnect(),this.processor.disconnect(),this._duration=this.duration,this.isPause=!0,this.pauseRecording&&this.pauseRecording("pause recording")}_micCaptured(e){this.context=new(window.AudioContext||window.webkitAudioContext),this.duration=this._duration,this.input=this.context.createMediaStreamSource(e),this.processor=this.context.createScriptProcessor(this.bufferSize,1,1),this.stream=e,this.processor.onaudioprocess=e=>{const t=e.inputBuffer.getChannelData(0);let s=0;this.lameEncoder&&this.lameEncoder.encode(t);for(let a=0;a<t.length;++a)s+=t[a]*t[a];this.duration=parseFloat(this._duration)+parseFloat(this.context.currentTime.toFixed(2)),this.volume=Math.sqrt(s/t.length).toFixed(2)},this.input.connect(this.processor),this.processor.connect(this.context.destination)}_micError(e){this.micFailed&&this.micFailed(e)}}var ab=window.chrome,ob=window.navigator,nb=ob.vendor,rb="undefined"!==typeof window.opr,ib=ob.userAgent.indexOf("Edg")>-1,lb=ob.userAgent.match("CriOS");function cb(){return!!lb||null!==ab&&"undefined"!==typeof ab&&"Google Inc."===nb&&!1===rb&&!1===ib}function db(){var e=ub(),t=e.substr(0,4);return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw(n|u)|c55\/|capi|ccwa|cdm|cell|chtm|cldc|cmd|co(mp|nd)|craw|da(it|ll|ng)|dbte|dcs|devi|dica|dmob|do(c|p)o|ds(12|d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(|_)|g1 u|g560|gene|gf5|gmo|go(\.w|od)|gr(ad|un)|haie|hcit|hd(m|p|t)|hei|hi(pt|ta)|hp( i|ip)|hsc|ht(c(| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i(20|go|ma)|i230|iac( ||\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|[a-w])|libw|lynx|m1w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|mcr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|([1-8]|c))|phil|pire|pl(ay|uc)|pn2|po(ck|rt|se)|prox|psio|ptg|qaa|qc(07|12|21|32|60|[2-7]|i)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h|oo|p)|sdk\/|se(c(|0|1)|47|mc|nd|ri)|sgh|shar|sie(|m)|sk0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h|v|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl|tdg|tel(i|m)|tim|tmo|to(pl|sh)|ts(70|m|m3|m5)|tx9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas|your|zeto|zte/i.test(t)}function ub(){var e=navigator.userAgent||navigator.vendor||window.opera||null;if(!e)throw new Error("Failed to look for user agent information.");return e}const mb={name:"RoomFooter",components:{SvgIcon:yi,EmojiPickerContainer:pf,RoomFiles:Af,RoomMessageReply:Wf,RoomUsersTag:og,RoomEmojis:cg,RoomTemplatesText:_g},directives:{clickOutside:Yd},props:{room:{type:Object,required:!0},roomId:{type:[String,Number],required:!0},roomMessage:{type:String,default:null},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},textMessages:{type:Object,required:!0},showSendIcon:{type:Boolean,required:!0},showFiles:{type:Boolean,required:!0},showAudio:{type:Boolean,required:!0},showEmojis:{type:Boolean,required:!0},showFooter:{type:Boolean,required:!0},acceptedFiles:{type:String,required:!0},textareaActionEnabled:{type:Boolean,required:!0},textareaAutoFocus:{type:Boolean,required:!0},userTagsEnabled:{type:Boolean,required:!0},emojisSuggestionEnabled:{type:Boolean,required:!0},templatesText:{type:Array,default:null},audioBitRate:{type:Number,required:!0},audioSampleRate:{type:Number,required:!0},initReplyMessage:{type:Object,default:null},initEditMessage:{type:Object,default:null},droppedFiles:{type:Array,default:null},emojiDataSource:{type:String,default:void 0}},emits:["edit-message","send-message","update-edited-message-id","textarea-action-handler","typing-message"],data(){return{message:"",editedMessage:{},messageReply:null,cursorRangePosition:null,files:[],fileDialog:!1,selectUsersTagItem:null,selectEmojiItem:null,selectTemplatesTextItem:null,format:"mp3",activeUpOrDownEmojis:null,activeUpOrDownUsersTag:null,activeUpOrDownTemplatesText:null,emojisDB:new cp({dataSource:this.emojiDataSource}),emojiOpened:!1,keepKeyboardOpen:!1,filteredEmojis:[],filteredUsersTag:[],selectedUsersTag:[],filteredTemplatesText:[],recorder:this.initRecorder(),isRecording:!1}},computed:{isMessageEmpty(){return!this.files.length&&!this.message.trim()},isFileLoading(){return this.files.some(e=>e.loading)},recordedTime(){return new Date(1e3*this.recorder.duration).toISOString().substr(14,5)},shadowFooter(){return!!this.filteredEmojis.length||!!this.filteredUsersTag.length||!!this.filteredTemplatesText.length||!!this.files.length||!!this.messageReply}},watch:{roomId(){this.resetMessage(!0,!0),this.roomMessage&&(this.message=this.roomMessage,setTimeout(()=>this.onChangeInput()))},message(e){this.getTextareaRef().value=e},roomMessage:{immediate:!0,handler(e){e&&(this.message=this.roomMessage)}},editedMessage(e){this.$emit("update-edited-message-id",e._id)},initReplyMessage(e){e&&this.replyMessage(e)},initEditMessage(e){e&&this.editMessage(e)},droppedFiles(e){e&&this.onFileChange(e)}},mounted(){const e=db();let t=!0;this.getTextareaRef().addEventListener("keyup",s=>{"Enter"!==s.key||s.shiftKey||this.fileDialog||(e?(this.message=this.message+"\n",setTimeout(()=>this.onChangeInput())):!t||this.filteredEmojis.length||this.filteredUsersTag.length||this.filteredTemplatesText.length||this.sendMessage()),t=!s.isComposing,setTimeout(()=>{this.updateFooterLists()},60)}),this.getTextareaRef().addEventListener("click",()=>{e&&(this.keepKeyboardOpen=!0),this.updateFooterLists()}),this.getTextareaRef().addEventListener("blur",()=>{setTimeout(()=>{this.resetFooterList()},100),e&&setTimeout(()=>this.keepKeyboardOpen=!1)})},beforeUnmount(){this.stopRecorder()},methods:{getTextareaRef(){return this.$refs.roomTextarea},focusTextarea(e){db()&&e||this.getTextareaRef()&&(this.getTextareaRef().focus(),this.cursorRangePosition&&setTimeout(()=>{const e=cb()?0:1;this.getTextareaRef().setSelectionRange(this.cursorRangePosition+e,this.cursorRangePosition+e),this.cursorRangePosition=null}))},onChangeInput(){var e,t,s;((null==(e=this.getTextareaRef())?void 0:e.value)||""===(null==(t=this.getTextareaRef())?void 0:t.value))&&(this.message=null==(s=this.getTextareaRef())?void 0:s.value),this.keepKeyboardOpen=!0,this.resizeTextarea(),this.$emit("typing-message",this.message)},resizeTextarea(){const e=this.getTextareaRef();if(!e)return;const t=window.getComputedStyle(e,null).getPropertyValue("padding-top").replace("px","");e.style.height=0,e.style.height=e.scrollHeight-2*t+"px"},escapeTextarea(){this.filteredEmojis.length?this.filteredEmojis=[]:this.filteredUsersTag.length?this.filteredUsersTag=[]:this.filteredTemplatesText.length?this.filteredTemplatesText=[]:this.resetMessage()},onPasteImage(e){var t;const s=null==(t=e.clipboardData)?void 0:t.items;s&&Array.from(s).forEach(e=>{if(e.type.includes("image")){const t=e.getAsFile();this.onFileChange([t])}})},updateActiveUpOrDown(e,t){this.filteredEmojis.length?(this.activeUpOrDownEmojis=t,e.preventDefault()):this.filteredUsersTag.length?(this.activeUpOrDownUsersTag=t,e.preventDefault()):this.filteredTemplatesText.length&&(this.activeUpOrDownTemplatesText=t,e.preventDefault())},selectItem(){this.filteredEmojis.length?this.selectEmojiItem=!0:this.filteredUsersTag.length?this.selectUsersTagItem=!0:this.filteredTemplatesText.length&&(this.selectTemplatesTextItem=!0)},selectEmoji(e){if(this.selectEmojiItem=!1,!e)return;const{position:t,endPosition:s}=this.getCharPosition(":");this.message=this.message.substr(0,t-1)+e+this.message.substr(s,this.message.length-1),this.cursorRangePosition=t,this.focusTextarea()},selectTemplateText(e){if(this.selectTemplatesTextItem=!1,!e)return;const{position:t,endPosition:s}=this.getCharPosition("/"),a=this.message.substr(s,s).length?"":" ";this.message=this.message.substr(0,t-1)+e.text+a+this.message.substr(s,this.message.length-1),this.cursorRangePosition=t+e.text.length+a.length+1,this.focusTextarea()},addEmoji(e){this.message+=e.unicode,this.focusTextarea(!0)},launchFilePicker(){this.$refs.file.value="",this.$refs.file.click()},async onFileChange(e){this.fileDialog=!0,this.focusTextarea(),Array.from(e).forEach(async e=>{const t=URL.createObjectURL(e),s=e.name.lastIndexOf(".");this.files.push({loading:!0,name:e.name.substring(0,s),size:e.size,type:e.type,extension:e.name.substring(s+1),localUrl:t});const a=await fetch(t).then(e=>e.blob());let o=this.files.find(e=>e.localUrl===t);o&&(o.blob=a,o.loading=!1,delete o.loading)}),setTimeout(()=>this.fileDialog=!1,500)},removeFile(e){this.files.splice(e,1),this.focusTextarea()},toggleRecorder(e){if(this.isRecording=e,this.recorder.isRecording)try{this.recorder.stop();const e=this.recorder.records[0];this.files.push({blob:e.blob,name:"audio."+this.format,size:e.blob.size,duration:e.duration,type:e.blob.type,audio:!0,localUrl:URL.createObjectURL(e.blob)}),this.recorder=this.initRecorder(),this.sendMessage()}catch{setTimeout(()=>this.stopRecorder(),100)}else setTimeout(()=>this.recorder.start(),200)},stopRecorder(){if(this.recorder.isRecording)try{this.recorder.stop(),this.recorder=this.initRecorder()}catch{setTimeout(()=>this.stopRecorder(),100)}},textareaActionHandler(){this.$emit("textarea-action-handler",this.message)},sendMessage(){var e;let t=this.message.trim();if(!this.files.length&&!t)return;if(this.isFileLoading)return;this.selectedUsersTag.forEach(e=>{t=t.replace("@"+e.username,`<usertag>${e._id}</usertag>`)});const s=this.files.length?this.files:null;this.editedMessage._id?(this.editedMessage.content!==t||(null==(e=this.editedMessage.files)?void 0:e.length)||this.files.length)&&this.$emit("edit-message",{messageId:this.editedMessage._id,newContent:t,files:s,replyMessage:this.messageReply,usersTag:this.selectedUsersTag}):this.$emit("send-message",{content:t,files:s,replyMessage:this.messageReply,usersTag:this.selectedUsersTag}),this.resetMessage(!0)},editMessage(e){this.resetMessage(),this.editedMessage={...e};let t=e.content;const s=t,a="<usertag>",o="</usertag>",n=[...t.matchAll(new RegExp(a,"gi"))].map(e=>e.index);n.forEach(e=>{const n=s.substring(e+a.length,s.indexOf(o,e)),r=this.room.users.find(e=>e._id===n);t=t.replace(`${a}${n}${o}`,"@"+((null==r?void 0:r.username)||"unknown")),this.selectUserTag(r,!0)}),this.message=t,e.files&&(this.files=[...e.files]),setTimeout(()=>this.resizeTextarea())},replyMessage(e){this.editedMessage={},this.messageReply=e,this.focusTextarea()},updateFooterLists(){this.updateFooterList("@"),this.updateFooterList(":"),this.updateFooterList("/")},updateFooterList(e){if(!this.getTextareaRef())return;if(":"===e&&!this.emojisSuggestionEnabled)return;if("@"===e&&(!this.userTagsEnabled||!this.room.users))return;if("/"===e&&!this.templatesText)return;const t=this.getTextareaRef().selectionStart;let s=t;while(s>0&&this.message.charAt(s-1)!==e&&(" "!==this.message.charAt(s-1)||":"!==e))s--;const a=this.message.charAt(s-2),o=!a.match(/^[0-9a-zA-Z]+$/);if(this.message.charAt(s-1)!==e||a&&" "!==a&&!o)this.resetFooterList(e);else{const a=this.message.substring(s,t);":"===e?this.updateEmojis(a):"@"===e?this.updateShowUsersTag(a):"/"===e&&this.updateShowTemplatesText(a)}},updateShowUsersTag(e){this.filteredUsersTag=gu(this.room.users,"username",e,!0).filter(e=>e._id!==this.currentUserId)},selectUserTag(e,t=!1){if(this.selectUsersTagItem=!1,!e)return;const{position:s,endPosition:a}=this.getCharPosition("@"),o=this.message.substr(a,a).length?"":" ";this.message=this.message.substr(0,s)+e.username+o+this.message.substr(a,this.message.length-1),this.selectedUsersTag=[...this.selectedUsersTag,{...e}],t||(this.cursorRangePosition=s+e.username.length+o.length+1),this.focusTextarea()},updateShowTemplatesText(e){this.filteredTemplatesText=gu(this.templatesText,"tag",e,!0)},getCharPosition(e){const t=this.getTextareaRef().selectionStart;let s=t;while(s>0&&this.message.charAt(s-1)!==e)s--;const a=this.getTextareaRef().selectionEnd;return{position:s,endPosition:a}},async updateEmojis(e){if(!e)return;const t=await this.emojisDB.getEmojiBySearchQuery(e);this.filteredEmojis=t.map(e=>e.unicode)},resetFooterList(e=null){":"===e?this.filteredEmojis=[]:"@"===e?this.filteredUsersTag=[]:("/"===e||(this.filteredEmojis=[],this.filteredUsersTag=[]),this.filteredTemplatesText=[])},resetMessage(e=!1,t=!1){t||this.$emit("typing-message",null),this.selectedUsersTag=[],this.resetFooterList(),this.resetTextareaSize(),this.message="",this.editedMessage={},this.messageReply=null,this.files=[],this.emojiOpened=!1,this.preventKeyboardFromClosing(),!this.textareaAutoFocus&&t||setTimeout(()=>this.focusTextarea(e))},resetTextareaSize(){this.getTextareaRef()&&(this.getTextareaRef().style.height="20px")},preventKeyboardFromClosing(){this.keepKeyboardOpen&&this.getTextareaRef().focus()},initRecorder(){return this.isRecording=!1,new sb({bitRate:Number(this.audioBitRate),sampleRate:Number(this.audioSampleRate),beforeRecording:null,afterRecording:null,pauseRecording:null,micFailed:this.micFailed})},micFailed(){this.isRecording=!1,this.recorder=this.initRecorder()}}},pb={key:0,class:"vac-icon-textarea-left"},hb=Uo("div",{class:"vac-dot-audio-record"},null,-1),fb={class:"vac-dot-audio-record-time"},gb=["placeholder"],_b={class:"vac-icon-textarea"},vb={key:1},bb=["accept"];function yb(e,t,s,a,o,n){const r=ka("room-emojis"),i=ka("room-users-tag"),l=ka("room-templates-text"),c=ka("room-message-reply"),d=ka("room-files"),u=ka("svg-icon"),m=ka("emoji-picker-container"),p=Aa("click-outside");return ba((Bo(),Lo("div",{id:"room-footer",class:it(["vac-room-footer",{"vac-app-box-shadow":n.shadowFooter}])},[qo(r,{"filtered-emojis":o.filteredEmojis,"select-item":o.selectEmojiItem,"active-up-or-down":o.activeUpOrDownEmojis,onSelectEmoji:t[0]||(t[0]=e=>n.selectEmoji(e)),onActivateItem:t[1]||(t[1]=e=>o.activeUpOrDownEmojis=0)},null,8,["filtered-emojis","select-item","active-up-or-down"]),qo(i,{"filtered-users-tag":o.filteredUsersTag,"select-item":o.selectUsersTagItem,"active-up-or-down":o.activeUpOrDownUsersTag,onSelectUserTag:t[2]||(t[2]=e=>n.selectUserTag(e)),onActivateItem:t[3]||(t[3]=e=>o.activeUpOrDownUsersTag=0)},null,8,["filtered-users-tag","select-item","active-up-or-down"]),qo(l,{"filtered-templates-text":o.filteredTemplatesText,"select-item":o.selectTemplatesTextItem,"active-up-or-down":o.activeUpOrDownTemplatesText,onSelectTemplateText:t[4]||(t[4]=e=>n.selectTemplateText(e)),onActivateItem:t[5]||(t[5]=e=>o.activeUpOrDownTemplatesText=0)},null,8,["filtered-templates-text","select-item","active-up-or-down"]),qo(c,{room:s.room,"message-reply":o.messageReply,"text-formatting":s.textFormatting,"link-options":s.linkOptions,onResetMessage:n.resetMessage},Ba({_:2},[Ea(e.$slots,(t,s)=>({name:s,fn:Rs(t=>[Oa(e.$slots,s,lt(zo(t)))])}))]),1032,["room","message-reply","text-formatting","link-options","onResetMessage"]),qo(d,{files:o.files,onRemoveFile:n.removeFile,onResetMessage:n.resetMessage},Ba({_:2},[Ea(e.$slots,(t,s)=>({name:s,fn:Rs(t=>[Oa(e.$slots,s,lt(zo(t)))])}))]),1032,["files","onRemoveFile","onResetMessage"]),Uo("div",{class:it(["vac-box-footer",{"vac-box-footer-border":!o.files.length}])},[s.showAudio&&!o.files.length?(Bo(),Lo("div",pb,[o.isRecording?(Bo(),Lo(So,{key:0},[Uo("div",{class:"vac-svg-button vac-icon-audio-stop",onClick:t[6]||(t[6]=(...e)=>n.stopRecorder&&n.stopRecorder(...e))},[Oa(e.$slots,"audio-stop-icon",{},()=>[qo(u,{name:"close-outline"})])]),hb,Uo("div",fb,ct(n.recordedTime),1),Uo("div",{class:"vac-svg-button vac-icon-audio-confirm",onClick:t[7]||(t[7]=e=>n.toggleRecorder(!1))},[Oa(e.$slots,"audio-check-icon",{},()=>[qo(u,{name:"checkmark"})])])],64)):(Bo(),Lo("div",{key:1,class:"vac-svg-button",onClick:t[8]||(t[8]=e=>n.toggleRecorder(!0))},[Oa(e.$slots,"microphone-icon",{},()=>[qo(u,{name:"microphone",class:"vac-icon-microphone"})])]))])):Ko("",!0),Uo("textarea",{id:"roomTextarea",ref:"roomTextarea",placeholder:s.textMessages.TYPE_MESSAGE,class:it(["vac-textarea",{"vac-textarea-outline":o.editedMessage._id}]),style:{"min-height":"20px","padding-left":"12px"},onInput:t[9]||(t[9]=(...e)=>n.onChangeInput&&n.onChangeInput(...e)),onKeydown:[t[10]||(t[10]=Qr((...e)=>n.escapeTextarea&&n.escapeTextarea(...e),["esc"])),t[11]||(t[11]=Qr(Zr((...e)=>n.selectItem&&n.selectItem(...e),["exact","prevent"]),["enter"])),t[13]||(t[13]=Qr(Zr(()=>{},["exact","prevent"]),["tab"])),t[14]||(t[14]=Qr((...e)=>n.selectItem&&n.selectItem(...e),["tab"])),t[15]||(t[15]=Qr(e=>n.updateActiveUpOrDown(e,-1),["up"])),t[16]||(t[16]=Qr(e=>n.updateActiveUpOrDown(e,1),["down"]))],onPaste:t[12]||(t[12]=(...e)=>n.onPasteImage&&n.onPasteImage(...e))},null,42,gb),Uo("div",_b,[o.editedMessage._id?(Bo(),Lo("div",{key:0,class:"vac-svg-button",onClick:t[17]||(t[17]=(...e)=>n.resetMessage&&n.resetMessage(...e))},[Oa(e.$slots,"edit-close-icon",{},()=>[qo(u,{name:"close-outline"})])])):Ko("",!0),s.showEmojis?ba((Bo(),Lo("div",vb,[Oa(e.$slots,"emoji-picker",Qo({emojiOpened:o.emojiOpened},{addEmoji:n.addEmoji}),()=>[qo(m,{"emoji-opened":o.emojiOpened,"position-top":!0,"emoji-data-source":s.emojiDataSource,onAddEmoji:n.addEmoji,onOpenEmoji:t[18]||(t[18]=e=>o.emojiOpened=e)},{"emoji-picker-icon":Rs(()=>[Oa(e.$slots,"emoji-picker-icon")]),_:3},8,["emoji-opened","emoji-data-source","onAddEmoji"])])])),[[p,()=>o.emojiOpened=!1]]):Ko("",!0),s.showFiles?(Bo(),Lo("div",{key:2,class:"vac-svg-button",onClick:t[19]||(t[19]=(...e)=>n.launchFilePicker&&n.launchFilePicker(...e))},[Oa(e.$slots,"paperclip-icon",{},()=>[qo(u,{name:"paperclip"})])])):Ko("",!0),s.textareaActionEnabled?(Bo(),Lo("div",{key:3,class:"vac-svg-button",onClick:t[20]||(t[20]=(...e)=>n.textareaActionHandler&&n.textareaActionHandler(...e))},[Oa(e.$slots,"custom-action-icon",{},()=>[qo(u,{name:"deleted"})])])):Ko("",!0),s.showFiles?(Bo(),Lo("input",{key:4,ref:"file",type:"file",multiple:"",accept:s.acceptedFiles,style:{display:"none"},onChange:t[21]||(t[21]=e=>n.onFileChange(e.target.files))},null,40,bb)):Ko("",!0),s.showSendIcon?(Bo(),Lo("div",{key:5,class:it(["vac-svg-button",{"vac-send-disabled":n.isMessageEmpty}]),onClick:t[22]||(t[22]=(...e)=>n.sendMessage&&n.sendMessage(...e))},[Oa(e.$slots,"send-icon",{},()=>[qo(u,{name:"send",param:n.isMessageEmpty||n.isFileLoading?"disabled":""},null,8,["param"])])],2)):Ko("",!0)])],2)],2)),[[Jr,Object.keys(s.room).length&&s.showFooter]])}var xb=ni(mb,[["render",yb]]);const wb={name:"MessageReply",components:{AudioPlayer:Pf,SvgIcon:yi,FormatMessage:jd},props:{message:{type:Object,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},roomUsers:{type:Array,required:!0}},computed:{replyUsername(){const{senderId:e}=this.message.replyMessage,t=this.roomUsers.find(t=>t._id===e);return t?t.username:""},firstFile(){var e,t;return(null==(t=null==(e=this.message.replyMessage)?void 0:e.files)?void 0:t.length)?this.message.replyMessage.files[0]:{}},isAudio(){return Jd(this.firstFile)},isImage(){return Zd(this.firstFile)},isVideo(){return Wd(this.firstFile)},isOtherFile(){var e;return(null==(e=this.message.replyMessage.files)?void 0:e.length)&&!this.isAudio&&!this.isVideo&&!this.isImage}}},kb={class:"vac-reply-message"},Sb={class:"vac-reply-username"},Mb={key:0,class:"vac-image-reply-container"},Ab={key:1,class:"vac-video-reply-container"},Rb={controls:""},Tb=["src"],Eb={key:3,class:"vac-file-container"},Bb={class:"vac-text-ellipsis"},Ob={key:0,class:"vac-text-ellipsis vac-text-extension"},Cb={class:"vac-reply-content"};function jb(e,t,s,a,o,n){const r=ka("audio-player"),i=ka("svg-icon"),l=ka("format-message");return Bo(),Lo("div",kb,[Uo("div",Sb,ct(n.replyUsername),1),n.isImage?(Bo(),Lo("div",Mb,[Uo("div",{class:"vac-message-image vac-message-image-reply",style:at({"background-image":`url('${n.firstFile.url}')`})},null,4)])):n.isVideo?(Bo(),Lo("div",Ab,[Uo("video",Rb,[Uo("source",{src:n.firstFile.url},null,8,Tb)])])):n.isAudio?(Bo(),Po(r,{key:2,src:n.firstFile.url,"message-selection-enabled":!1,onUpdateProgressTime:t[0]||(t[0]=t=>e.progressTime=t),onHoverAudioProgress:t[1]||(t[1]=t=>e.hoverAudioProgress=t)},Ba({_:2},[Ea(e.$slots,(t,s)=>({name:s,fn:Rs(t=>[Oa(e.$slots,s,lt(zo(t)))])}))]),1032,["src"])):n.isOtherFile?(Bo(),Lo("div",Eb,[Uo("div",null,[Oa(e.$slots,"file-icon",{},()=>[qo(i,{name:"file"})])]),Uo("div",Bb,ct(n.firstFile.name),1),n.firstFile.extension?(Bo(),Lo("div",Ob,ct(n.firstFile.extension),1)):Ko("",!0)])):Ko("",!0),Uo("div",Cb,[qo(l,{"message-id":s.message.replyMessage._id,content:s.message.replyMessage.content,users:s.roomUsers,"text-formatting":s.textFormatting,"link-options":s.linkOptions,reply:!0},null,8,["message-id","content","users","text-formatting","link-options"])])])}var Ib=ni(wb,[["render",jb]]);const Lb={name:"ProgressBar",props:{progress:{type:Number,default:0}},data(){const e=35,t=4,s=e-2*t,a=2*s*Math.PI;return{radius:e,stroke:t,normalizedRadius:s,circumference:a}},computed:{strokeDashoffset(){return this.circumference-this.progress/100*this.circumference}}},Pb={ref:"progress",class:"vac-progress-wrapper"},Nb=["height","width"],Hb=["stroke-dasharray","stroke-width","r","cx","cy"],Fb={class:"vac-progress-text"},Db=Uo("span",{class:"vac-progress-pourcent"},"%",-1);function $b(e,t,s,a,o,n){return Bo(),Po(kr,{name:"vac-fade-spinner",appear:""},{default:Rs(()=>[Uo("div",Pb,[(Bo(),Lo("svg",{height:2*o.radius,width:2*o.radius},[Uo("circle",{stroke:"rgba(255, 255, 255, 0.7)","stroke-dasharray":o.circumference+" "+o.circumference,style:at({strokeDashoffset:n.strokeDashoffset,strokeLinecap:"round"}),"stroke-width":o.stroke,fill:"transparent",r:o.normalizedRadius,cx:o.radius,cy:o.radius},null,12,Hb)],8,Nb)),Uo("div",{class:"vac-progress-content",style:at({height:2*o.radius-19+"px",width:2*o.radius-19+"px"})},[Uo("div",Fb,[Yo(ct(s.progress),1),Db])],4)],512)]),_:1})}var Ub=ni(Lb,[["render",$b]]);const qb={name:"MessageFile",components:{SvgIcon:yi,Loader:hi,ProgressBar:Ub},props:{currentUserId:{type:[String,Number],required:!0},message:{type:Object,required:!0},file:{type:Object,required:!0},index:{type:Number,required:!0},messageSelectionEnabled:{type:Boolean,required:!0}},emits:["open-file"],data(){return{imageResponsive:"",imageLoading:!1,imageHover:!1}},computed:{isImageLoading(){return-1!==this.file.url.indexOf("blob:http")||this.imageLoading},isImage(){return Zd(this.file)},isVideo(){return Wd(this.file)}},watch:{file:{immediate:!0,handler(){this.checkImgLoad()}}},mounted(){const e=this.$refs["imageRef"+this.index];e&&(this.imageResponsive={maxHeight:e.clientWidth-18,loaderTop:e.clientHeight/2-9})},methods:{checkImgLoad(){if(!Zd(this.file))return;this.imageLoading=!0;const e=new Image;e.src=this.file.url,e.addEventListener("load",()=>this.imageLoading=!1)},openFile(e,t){this.messageSelectionEnabled||(e.stopPropagation(),this.$emit("open-file",{file:this.file,action:t}))}}},Vb={class:"vac-message-file-container"},zb={key:0,class:"vac-image-buttons"},Xb={controls:""},Yb=["src"];function Kb(e,t,s,a,o,n){const r=ka("progress-bar"),i=ka("loader"),l=ka("svg-icon");return Bo(),Lo("div",Vb,[n.isImage?(Bo(),Lo("div",{key:0,ref:"imageRef"+s.index,class:"vac-message-image-container",onMouseover:t[2]||(t[2]=e=>o.imageHover=!0),onMouseleave:t[3]||(t[3]=e=>o.imageHover=!1),onClick:t[4]||(t[4]=e=>n.openFile(e,"preview"))},[s.file.progress>=0?(Bo(),Po(r,{key:0,progress:s.file.progress,style:at({top:o.imageResponsive.loaderTop+"px"})},null,8,["progress","style"])):(Bo(),Po(i,{key:1,show:n.isImageLoading,type:"message-file","message-id":s.message._id,style:at({top:o.imageResponsive.loaderTop+"px"})},Ba({_:2},[Ea(e.$slots,(t,s)=>({name:s,fn:Rs(t=>[Oa(e.$slots,s,lt(zo(t)))])}))]),1032,["show","message-id","style"])),Uo("div",{class:it(["vac-message-image",{"vac-blur-loading":n.isImageLoading&&s.message.senderId===s.currentUserId}]),style:at({"background-image":`url('${n.isImageLoading&&s.file.preview||s.file.url}')`,"max-height":o.imageResponsive.maxHeight+"px"})},[qo(kr,{name:"vac-fade-image"},{default:Rs(()=>[s.messageSelectionEnabled||!o.imageHover||n.isImageLoading?Ko("",!0):(Bo(),Lo("div",zb,[Uo("div",{class:"vac-svg-button vac-button-view",onClick:t[0]||(t[0]=e=>n.openFile(e,"preview"))},[Oa(e.$slots,"eye-icon_"+s.message._id,{},()=>[qo(l,{name:"eye"})])]),Uo("div",{class:"vac-svg-button vac-button-download",onClick:t[1]||(t[1]=e=>n.openFile(e,"download"))},[Oa(e.$slots,"document-icon_"+s.message._id,{},()=>[qo(l,{name:"document"})])])]))]),_:3})],6)],544)):n.isVideo?(Bo(),Lo("div",{key:1,class:"vac-video-container",onClick:t[5]||(t[5]=Zr(e=>n.openFile(e,"preview"),["prevent"]))},[s.file.progress>=0?(Bo(),Po(r,{key:0,progress:s.file.progress},null,8,["progress"])):Ko("",!0),Uo("video",Xb,[Uo("source",{src:s.file.url},null,8,Yb)])])):Ko("",!0)])}var Gb=ni(qb,[["render",Kb]]);const Zb={name:"MessageFiles",components:{SvgIcon:yi,FormatMessage:jd,ProgressBar:Ub,MessageFile:Gb},props:{currentUserId:{type:[String,Number],required:!0},message:{type:Object,required:!0},roomUsers:{type:Array,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},messageSelectionEnabled:{type:Boolean,required:!0}},emits:["open-file","open-user-tag"],computed:{imageVideoFiles(){return this.message.files.filter(e=>Qd(e))},otherFiles(){return this.message.files.filter(e=>!Qd(e))}},methods:{openFile(e,t,s){this.messageSelectionEnabled||(e.stopPropagation(),this.$emit("open-file",{file:t,action:s}))}}},Wb={class:"vac-message-files-container"},Qb=["onClick"],Jb={class:"vac-svg-button"},ey={class:"vac-text-ellipsis"},ty={key:0,class:"vac-text-ellipsis vac-text-extension"};function sy(e,t,s,a,o,n){const r=ka("message-file"),i=ka("progress-bar"),l=ka("svg-icon"),c=ka("format-message");return Bo(),Lo("div",Wb,[(Bo(!0),Lo(So,null,Ea(n.imageVideoFiles,(a,o)=>(Bo(),Lo("div",{key:o+"iv"},[qo(r,{file:a,"current-user-id":s.currentUserId,message:s.message,index:o,"message-selection-enabled":s.messageSelectionEnabled,onOpenFile:t[0]||(t[0]=t=>e.$emit("open-file",t))},Ba({_:2},[Ea(e.$slots,(t,s)=>({name:s,fn:Rs(t=>[Oa(e.$slots,s,lt(zo(t)))])}))]),1032,["file","current-user-id","message","index","message-selection-enabled"])]))),128)),(Bo(!0),Lo(So,null,Ea(n.otherFiles,(t,s)=>(Bo(),Lo("div",{key:s+"a",class:"vac-file-wrapper"},[t.progress>=0?(Bo(),Po(i,{key:0,progress:t.progress,style:{top:"44px"}},null,8,["progress"])):Ko("",!0),Uo("div",{class:it(["vac-file-container",{"vac-file-container-progress":t.progress>=0}]),onClick:e=>n.openFile(e,t,"download")},[Uo("div",Jb,[Oa(e.$slots,"document-icon",{},()=>[qo(l,{name:"document"})])]),Uo("div",ey,ct(t.name),1),t.extension?(Bo(),Lo("div",ty,ct(t.extension),1)):Ko("",!0)],10,Qb)]))),128)),qo(c,{"message-id":s.message._id,content:s.message.content,users:s.roomUsers,"text-formatting":s.textFormatting,"link-options":s.linkOptions,onOpenUserTag:t[1]||(t[1]=t=>e.$emit("open-user-tag",t))},null,8,["message-id","content","users","text-formatting","link-options"])])}var ay=ni(Zb,[["render",sy]]);const oy={name:"MessageActions",components:{SvgIcon:yi,EmojiPickerContainer:pf},directives:{clickOutside:Yd},props:{currentUserId:{type:[String,Number],required:!0},message:{type:Object,required:!0},messageActions:{type:Array,required:!0},showReactionEmojis:{type:Boolean,required:!0},messageHover:{type:Boolean,required:!0},hoverMessageId:{type:[String,Number],default:null},hoverAudioProgress:{type:Boolean,required:!0},emojiDataSource:{type:String,default:void 0}},emits:["update-emoji-opened","update-options-opened","update-message-hover","message-action-handler","send-message-reaction"],data(){return{menuOptionsTop:0,optionsOpened:!1,optionsClosing:!1,emojiOpened:!1}},computed:{isMessageActions(){return this.filteredMessageActions.length&&this.messageHover&&!this.message.deleted&&!this.message.disableActions&&!this.hoverAudioProgress},isMessageReactions(){return this.showReactionEmojis&&this.messageHover&&!this.message.deleted&&!this.message.disableReactions&&!this.hoverAudioProgress},filteredMessageActions(){return this.message.senderId===this.currentUserId?this.messageActions:this.messageActions.filter(e=>!e.onlyMe)}},watch:{emojiOpened(e){this.$emit("update-emoji-opened",e),e&&(this.optionsOpened=!1)},optionsOpened(e){this.$emit("update-options-opened",e)}},methods:{openOptions(){this.optionsClosing||(this.optionsOpened=!this.optionsOpened,this.optionsOpened&&setTimeout(()=>{const e=cf(this.$el,"#room-footer");if(!e||!this.$refs.menuOptions||!this.$refs.actionIcon)return;const t=this.$refs.menuOptions.getBoundingClientRect().height,s=this.$refs.actionIcon.getBoundingClientRect().top,a=e.getBoundingClientRect().top,o=a-s>t+50;this.menuOptionsTop=o?30:-t}))},closeOptions(){this.optionsOpened=!1,this.optionsClosing=!0,this.updateMessageHover(),setTimeout(()=>this.optionsClosing=!1,100)},openEmoji(){this.emojiOpened=!this.emojiOpened},closeEmoji(){this.emojiOpened=!1,this.updateMessageHover()},updateMessageHover(){this.hoverMessageId!==this.message._id&&this.$emit("update-message-hover",!1)},messageActionHandler(e){this.closeOptions(),this.$emit("message-action-handler",e)},sendMessageReaction(e,t){this.$emit("send-message-reaction",{emoji:e,reaction:t}),this.closeEmoji()}}},ny={class:"vac-message-actions-wrapper"},ry={key:"3"},iy={class:"vac-menu-list"},ly=["onClick"];function cy(e,t,s,a,o,n){const r=ka("svg-icon"),i=ka("emoji-picker-container"),l=Aa("click-outside");return Bo(),Lo("div",ny,[Uo("div",{class:"vac-options-container",style:at({display:s.hoverAudioProgress?"none":"initial",width:n.filteredMessageActions.length&&s.showReactionEmojis?"70px":"45px"})},[qo(qr,{name:"vac-slide-left",tag:"span"},{default:Rs(()=>[n.isMessageActions||n.isMessageReactions?(Bo(),Lo("div",{key:"1",class:it(["vac-blur-container",{"vac-options-me":s.message.senderId===s.currentUserId}])},null,2)):Ko("",!0),n.isMessageActions?(Bo(),Lo("div",{ref:"actionIcon",key:"2",class:"vac-svg-button vac-message-options",onClick:t[0]||(t[0]=(...e)=>n.openOptions&&n.openOptions(...e))},[Oa(e.$slots,"dropdown-icon_"+s.message._id,{},()=>[qo(r,{name:"dropdown",param:"message"})])],512)):Ko("",!0),n.isMessageReactions?ba((Bo(),Lo("div",ry,[Oa(e.$slots,"emoji-picker",Qo({emojiOpened:o.emojiOpened},{addEmoji:n.sendMessageReaction}),()=>[qo(i,{class:"vac-message-emojis",style:at({right:n.isMessageActions?"30px":"5px"}),"emoji-opened":o.emojiOpened,"emoji-reaction":!0,"position-right":s.message.senderId===s.currentUserId,"message-id":s.message._id,"emoji-data-source":s.emojiDataSource,onAddEmoji:n.sendMessageReaction,onOpenEmoji:n.openEmoji},Ba({_:2},[Ea(e.$slots,(t,s)=>({name:s,fn:Rs(t=>[Oa(e.$slots,s,lt(zo(t)))])}))]),1032,["style","emoji-opened","position-right","message-id","emoji-data-source","onAddEmoji","onOpenEmoji"])])])),[[l,n.closeEmoji]]):Ko("",!0)]),_:3})],4),n.filteredMessageActions.length?(Bo(),Po(kr,{key:0,name:s.message.senderId===s.currentUserId?"vac-slide-left":"vac-slide-right"},{default:Rs(()=>[o.optionsOpened?ba((Bo(),Lo("div",{key:0,ref:"menuOptions",class:it(["vac-menu-options",{"vac-menu-left":s.message.senderId!==s.currentUserId}]),style:at({top:o.menuOptionsTop+"px"})},[Uo("div",iy,[(Bo(!0),Lo(So,null,Ea(n.filteredMessageActions,e=>(Bo(),Lo("div",{key:e.name},[Uo("div",{class:"vac-menu-item",onClick:t=>n.messageActionHandler(e)},ct(e.title),9,ly)]))),128))])],6)),[[l,n.closeOptions]]):Ko("",!0)]),_:1},8,["name"])):Ko("",!0)])}var dy=ni(oy,[["render",cy]]);const uy={name:"MessageReactions",props:{currentUserId:{type:[String,Number],required:!0},message:{type:Object,required:!0}},emits:["send-message-reaction"],methods:{sendMessageReaction(e,t){this.$emit("send-message-reaction",{emoji:e,reaction:t})}}},my=["onClick"];function py(e,t,s,a,o,n){return s.message.deleted?Ko("",!0):(Bo(),Po(qr,{key:0,name:"vac-slide-left",tag:"span"},{default:Rs(()=>[(Bo(!0),Lo(So,null,Ea(s.message.reactions,(e,t)=>ba((Bo(),Lo("button",{key:t+0,class:it(["vac-button-reaction",{"vac-reaction-me":-1!==e.indexOf(s.currentUserId)}]),style:at({float:s.message.senderId===s.currentUserId?"right":"left"}),onClick:s=>n.sendMessageReaction({unicode:t},e)},[Yo(ct(t),1),Uo("span",null,ct(e.length),1)],14,my)),[[Jr,e.length]])),128))]),_:1}))}var hy=ni(uy,[["render",py]]);function fy(e){const t=[{key:"roomId",type:["string","number"]},{key:"roomName",type:["string"]},{key:"users",type:["array"]}],s=(e,t)=>t.every(t=>{let s=!1;return("array"===t.type[0]&&Array.isArray(e[t.key])||t.type.find(s=>s===typeof e[t.key]))&&(s=!0),s&&vy(e,t.key)});if(!s(e,t))throw new Error("Rooms object is not valid! Must contain at least roomId[String, Number], roomName[String] and users[Array]")}function gy(e){const t=[{key:"_id",type:["string","number"]},{key:"username",type:["string"]}],s=(e,t)=>t.every(t=>{const s=t.type.find(s=>s===typeof e[t.key]);return s&&vy(e,t.key)});if(!s(e,t))throw new Error("Participants object is not valid! Must contain at least _id[String, Number] and username[String]")}function _y(e){const t=[{key:"_id",type:["string","number"]},{key:"senderId",type:["string","number"]}],s=(e,t)=>t.every(t=>{const s=t.type.find(s=>s===typeof e[t.key]);return s&&vy(e,t.key)});if(!s(e,t))throw new Error("Messages object is not valid! Must contain at least _id[String, Number] and senderId[String, Number]")}function vy(e,t){return Object.prototype.hasOwnProperty.call(e,t)&&null!==e[t]&&void 0!==e[t]}const by={name:"RoomMessage",components:{SvgIcon:yi,FormatMessage:jd,AudioPlayer:Pf,MessageReply:Ib,MessageFiles:ay,MessageActions:dy,MessageReactions:hy},props:{currentUserId:{type:[String,Number],required:!0},textMessages:{type:Object,required:!0},index:{type:Number,required:!0},message:{type:Object,required:!0},messages:{type:Array,required:!0},editedMessageId:{type:[String,Number],default:null},roomUsers:{type:Array,default:()=>[]},messageActions:{type:Array,required:!0},newMessages:{type:Array,default:()=>[]},showReactionEmojis:{type:Boolean,required:!0},showNewMessagesDivider:{type:Boolean,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},usernameOptions:{type:Object,required:!0},messageSelectionEnabled:{type:Boolean,required:!0},selectedMessages:{type:Array,default:()=>[]},emojiDataSource:{type:String,default:void 0}},emits:["message-added","open-file","open-user-tag","open-failed-message","message-action-handler","send-message-reaction","select-message","unselect-message"],data(){return{hoverMessageId:null,messageHover:!1,optionsOpened:!1,emojiOpened:!1,newMessage:{},progressTime:"- : -",hoverAudioProgress:!1}},computed:{showUsername(){return!(!this.usernameOptions.currentUser&&this.message.senderId===this.currentUserId)&&this.roomUsers.length>=this.usernameOptions.minUsers},showDate(){return this.index>0&&this.message.date!==this.messages[this.index-1].date},messageOffset(){return this.index>0&&this.message.senderId!==this.messages[this.index-1].senderId},isMessageHover(){return this.editedMessageId===this.message._id||this.hoverMessageId===this.message._id},isAudio(){var e;return null==(e=this.message.files)?void 0:e.some(e=>Jd(e))},isCheckmarkVisible(){return this.message.senderId===this.currentUserId&&!this.message.deleted&&(this.message.saved||this.message.distributed||this.message.seen)},hasCurrentUserAvatar(){return this.messages.some(e=>e.senderId===this.currentUserId&&e.avatar)},hasSenderUserAvatar(){return this.messages.some(e=>e.senderId!==this.currentUserId&&e.avatar)},isMessageSelected(){return this.messageSelectionEnabled&&!!this.selectedMessages.find(e=>e._id===this.message._id)}},watch:{newMessages:{immediate:!0,deep:!0,handler(e){e.length&&this.showNewMessagesDivider?this.newMessage=e.reduce((e,t)=>t.index<e.index?t:e):this.newMessage={}}},messageSelectionEnabled(){this.resetMessageHover()}},mounted(){_y(this.message),this.$emit("message-added",{message:this.message,index:this.index,ref:this.$refs.message})},methods:{onHoverMessage(){this.messageSelectionEnabled||(this.messageHover=!0,this.canEditMessage()&&(this.hoverMessageId=this.message._id))},canEditMessage(){return!this.message.deleted},onLeaveMessage(){this.messageSelectionEnabled||(this.optionsOpened||this.emojiOpened||(this.messageHover=!1),this.hoverMessageId=null)},resetMessageHover(){this.messageHover=!1,this.hoverMessageId=null},openFile(e){this.$emit("open-file",{message:this.message,file:e})},openUserTag(e){this.$emit("open-user-tag",{user:e})},messageActionHandler(e){this.resetMessageHover(),setTimeout(()=>{this.$emit("message-action-handler",{action:e,message:this.message})},300)},sendMessageReaction({emoji:e,reaction:t}){this.$emit("send-message-reaction",{messageId:this.message._id,reaction:e,remove:t&&-1!==t.indexOf(this.currentUserId)}),this.messageHover=!1},selectMessage(){this.messageSelectionEnabled&&(this.isMessageSelected?this.$emit("unselect-message",this.message._id):this.$emit("select-message",this.message))}}},yy=["id"],xy={key:0,class:"vac-card-info vac-card-date"},wy={key:1,class:"vac-line-new"},ky={key:2,class:"vac-card-info vac-card-system"},Sy={key:1,class:"vac-avatar-offset"},My={key:0,class:"vac-progress-time"},Ay={class:"vac-text-timestamp"},Ry={key:0,class:"vac-icon-edited"},Ty={key:1},Ey=Uo("div",{class:"vac-failure-text"},"!",-1),By=[Ey],Oy={key:3,class:"vac-avatar-current-offset"};function Cy(e,t,s,a,o,n){const r=ka("format-message"),i=ka("message-reply"),l=ka("message-files"),c=ka("audio-player"),d=ka("svg-icon"),u=ka("message-actions"),m=ka("message-reactions");return Bo(),Lo("div",{id:s.message._id,ref:"message",class:"vac-message-wrapper"},[n.showDate?(Bo(),Lo("div",xy,ct(s.message.date),1)):Ko("",!0),o.newMessage._id===s.message._id?(Bo(),Lo("div",wy,ct(s.textMessages.NEW_MESSAGES),1)):Ko("",!0),s.message.system?(Bo(),Lo("div",ky,[Oa(e.$slots,"message_"+s.message._id,{},()=>[qo(r,{"message-id":s.message._id,content:s.message.content,deleted:!!s.message.deleted,users:s.roomUsers,"text-messages":s.textMessages,"text-formatting":s.textFormatting,"link-options":s.linkOptions,onOpenUserTag:n.openUserTag},Ba({_:2},[Ea(e.$slots,(t,s)=>({name:s,fn:Rs(t=>[Oa(e.$slots,s,lt(zo(t)))])}))]),1032,["message-id","content","deleted","users","text-messages","text-formatting","link-options","onOpenUserTag"])])])):(Bo(),Lo("div",{key:3,class:it(["vac-message-box",{"vac-offset-current":s.message.senderId===s.currentUserId}]),onClick:t[8]||(t[8]=(...e)=>n.selectMessage&&n.selectMessage(...e))},[Oa(e.$slots,"message_"+s.message._id,{},()=>[s.message.senderId!==s.currentUserId?Oa(e.$slots,"message-avatar_"+s.message._id,{key:0},()=>[s.message.avatar?(Bo(),Lo("div",{key:0,class:"vac-avatar",style:at({"background-image":`url('${s.message.avatar}')`})},null,4)):Ko("",!0)]):Ko("",!0),n.hasSenderUserAvatar&&!s.message.avatar?(Bo(),Lo("div",Sy)):Ko("",!0),Uo("div",{class:it(["vac-message-container",{"vac-message-container-offset":n.messageOffset}])},[Uo("div",{class:it(["vac-message-card",{"vac-message-highlight":n.isMessageHover,"vac-message-current":s.message.senderId===s.currentUserId,"vac-message-deleted":s.message.deleted,"vac-item-clickable":s.messageSelectionEnabled,"vac-message-selected":n.isMessageSelected}]),onMouseover:t[5]||(t[5]=(...e)=>n.onHoverMessage&&n.onHoverMessage(...e)),onMouseleave:t[6]||(t[6]=(...e)=>n.onLeaveMessage&&n.onLeaveMessage(...e))},[n.showUsername?(Bo(),Lo("div",{key:0,class:it(["vac-text-username",{"vac-username-reply":!s.message.deleted&&s.message.replyMessage}])},[Uo("span",null,ct(s.message.username),1)],2)):Ko("",!0),!s.message.deleted&&s.message.replyMessage?(Bo(),Po(i,{key:1,message:s.message,"room-users":s.roomUsers,"text-formatting":s.textFormatting,"link-options":s.linkOptions},Ba({_:2},[Ea(e.$slots,(t,s)=>({name:s,fn:Rs(t=>[Oa(e.$slots,s,lt(zo(t)))])}))]),1032,["message","room-users","text-formatting","link-options"])):Ko("",!0),!s.message.deleted&&s.message.files&&s.message.files.length?!n.isAudio||s.message.files.length>1?(Bo(),Po(l,{key:3,"current-user-id":s.currentUserId,message:s.message,"room-users":s.roomUsers,"text-formatting":s.textFormatting,"link-options":s.linkOptions,"message-selection-enabled":s.messageSelectionEnabled,onOpenFile:n.openFile,onOpenUserTag:n.openUserTag},Ba({_:2},[Ea(e.$slots,(t,s)=>({name:s,fn:Rs(t=>[Oa(e.$slots,s,lt(zo(t)))])}))]),1032,["current-user-id","message","room-users","text-formatting","link-options","message-selection-enabled","onOpenFile","onOpenUserTag"])):(Bo(),Lo(So,{key:4},[qo(c,{"message-id":s.message._id,src:s.message.files[0].url,"message-selection-enabled":s.messageSelectionEnabled,onUpdateProgressTime:t[0]||(t[0]=e=>o.progressTime=e),onHoverAudioProgress:t[1]||(t[1]=e=>o.hoverAudioProgress=e)},Ba({_:2},[Ea(e.$slots,(t,s)=>({name:s,fn:Rs(t=>[Oa(e.$slots,s,lt(zo(t)))])}))]),1032,["message-id","src","message-selection-enabled"]),s.message.deleted?Ko("",!0):(Bo(),Lo("div",My,ct(o.progressTime),1))],64)):(Bo(),Po(r,{key:2,"message-id":s.message._id,content:s.message.content,deleted:!!s.message.deleted,users:s.roomUsers,"text-formatting":s.textFormatting,"text-messages":s.textMessages,"link-options":s.linkOptions,onOpenUserTag:n.openUserTag},Ba({_:2},[Ea(e.$slots,(t,s)=>({name:s,fn:Rs(t=>[Oa(e.$slots,s,lt(zo(t)))])}))]),1032,["message-id","content","deleted","users","text-formatting","text-messages","link-options","onOpenUserTag"])),Uo("div",Ay,[s.message.edited&&!s.message.deleted?(Bo(),Lo("div",Ry,[Oa(e.$slots,"pencil-icon_"+s.message._id,{},()=>[qo(d,{name:"pencil"})])])):Ko("",!0),Uo("span",null,ct(s.message.timestamp),1),n.isCheckmarkVisible?(Bo(),Lo("span",Ty,[Oa(e.$slots,"checkmark-icon_"+s.message._id,{},()=>[qo(d,{name:s.message.distributed?"double-checkmark":"checkmark",param:s.message.seen?"seen":"",class:"vac-icon-check"},null,8,["name","param"])])])):Ko("",!0)]),qo(u,{"current-user-id":s.currentUserId,message:s.message,"message-actions":s.messageActions,"show-reaction-emojis":s.showReactionEmojis,"message-hover":o.messageHover,"hover-message-id":o.hoverMessageId,"hover-audio-progress":o.hoverAudioProgress,"emoji-data-source":s.emojiDataSource,onUpdateMessageHover:t[2]||(t[2]=e=>o.messageHover=e),onUpdateOptionsOpened:t[3]||(t[3]=e=>o.optionsOpened=e),onUpdateEmojiOpened:t[4]||(t[4]=e=>o.emojiOpened=e),onMessageActionHandler:n.messageActionHandler,onSendMessageReaction:n.sendMessageReaction},Ba({_:2},[Ea(e.$slots,(t,s)=>({name:s,fn:Rs(t=>[Oa(e.$slots,s,lt(zo(t)))])}))]),1032,["current-user-id","message","message-actions","show-reaction-emojis","message-hover","hover-message-id","hover-audio-progress","emoji-data-source","onMessageActionHandler","onSendMessageReaction"])],34),qo(m,{"current-user-id":s.currentUserId,message:s.message,onSendMessageReaction:n.sendMessageReaction},null,8,["current-user-id","message","onSendMessageReaction"])],2),Oa(e.$slots,"message-failure_"+s.message._id,{},()=>[s.message.failure&&s.message.senderId===s.currentUserId?(Bo(),Lo("div",{key:0,class:it(["vac-failure-container vac-svg-button",{"vac-failure-container-avatar":s.message.avatar&&s.message.senderId===s.currentUserId}]),onClick:t[7]||(t[7]=t=>e.$emit("open-failed-message",{message:s.message}))},By,2)):Ko("",!0)]),s.message.senderId===s.currentUserId?Oa(e.$slots,"message-avatar_"+s.message._id,{key:2},()=>[s.message.avatar?(Bo(),Lo("div",{key:0,class:"vac-avatar vac-avatar-current",style:at({"background-image":`url('${s.message.avatar}')`})},null,4)):Ko("",!0)]):Ko("",!0),n.hasCurrentUserAvatar&&!s.message.avatar?(Bo(),Lo("div",Oy)):Ko("",!0)])],2))],8,yy)}var jy=ni(by,[["render",Cy]]);const Iy={name:"ChatRoom",components:{Loader:hi,SvgIcon:yi,RoomHeader:Du,RoomFooter:xb,RoomMessage:jy},props:{currentUserId:{type:[String,Number],required:!0},textMessages:{type:Object,required:!0},singleRoom:{type:Boolean,required:!0},showRoomsList:{type:Boolean,required:!0},isMobile:{type:Boolean,required:!0},rooms:{type:Array,required:!0},roomId:{type:[String,Number],required:!0},loadFirstRoom:{type:Boolean,required:!0},messages:{type:Array,required:!0},roomMessage:{type:String,default:null},messagesLoaded:{type:Boolean,required:!0},menuActions:{type:Array,required:!0},messageActions:{type:Array,required:!0},messageSelectionActions:{type:Array,required:!0},autoScroll:{type:Object,required:!0},showSendIcon:{type:Boolean,required:!0},showFiles:{type:Boolean,required:!0},showAudio:{type:Boolean,required:!0},audioBitRate:{type:Number,required:!0},audioSampleRate:{type:Number,required:!0},showEmojis:{type:Boolean,required:!0},showReactionEmojis:{type:Boolean,required:!0},showNewMessagesDivider:{type:Boolean,required:!0},showFooter:{type:Boolean,required:!0},acceptedFiles:{type:String,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},loadingRooms:{type:Boolean,required:!0},roomInfoEnabled:{type:Boolean,required:!0},textareaActionEnabled:{type:Boolean,required:!0},textareaAutoFocus:{type:Boolean,required:!0},userTagsEnabled:{type:Boolean,required:!0},emojisSuggestionEnabled:{type:Boolean,required:!0},scrollDistance:{type:Number,required:!0},templatesText:{type:Array,default:null},usernameOptions:{type:Object,required:!0},emojiDataSource:{type:String,default:void 0}},emits:["toggle-rooms-list","room-info","menu-action-handler","message-selection-action-handler","edit-message","send-message","delete-message","message-action-handler","fetch-messages","send-message-reaction","typing-message","open-file","open-user-tag","open-failed-message","textarea-action-handler"],data(){return{editedMessageId:null,initReplyMessage:null,initEditMessage:null,loadingMessages:!1,observer:null,showLoader:!0,loadingMoreMessages:!1,scrollIcon:!1,scrollMessagesCount:0,newMessages:[],messageSelectionEnabled:!1,selectedMessages:[],droppedFiles:[]}},computed:{room(){return this.rooms.find(e=>e.roomId===this.roomId)||{}},showNoMessages(){return this.roomId&&!this.messages.length&&!this.loadingMessages&&!this.loadingRooms},showNoRoom(){const e=!this.rooms.length&&!this.loadingRooms||!this.roomId&&!this.loadFirstRoom;return e&&this.updateLoadingMessages(!1),e},showMessagesStarted(){return this.messages.length&&this.messagesLoaded}},watch:{roomId:{immediate:!0,handler(){this.onRoomChanged()}},messages:{deep:!0,handler(e,t){e.forEach((e,t)=>{this.showNewMessagesDivider&&!e.seen&&e.senderId!==this.currentUserId&&this.newMessages.push({_id:e._id,index:t})}),(null==t?void 0:t.length)===(null==e?void 0:e.length)-1&&(this.newMessages=[]),setTimeout(()=>this.loadingMoreMessages=!1)}},messagesLoaded(e){e&&this.updateLoadingMessages(!1)}},mounted(){this.newMessages=[]},methods:{updateLoadingMessages(e){this.loadingMessages=e,e||setTimeout(()=>this.initIntersectionObserver())},initIntersectionObserver(){this.observer&&(this.showLoader=!0,this.observer.disconnect());const e=this.$el.querySelector("#infinite-loader-messages");if(e){const t={root:this.$el.querySelector("#messages-list"),rootMargin:this.scrollDistance+"px",threshold:0};this.observer=new IntersectionObserver(e=>{e[0].isIntersecting&&this.loadMoreMessages()},t),this.observer.observe(e)}},preventTopScroll(){const e=this.$refs.scrollContainer,t=e.scrollHeight,s=new ResizeObserver(a=>{e.scrollHeight!==t&&this.$refs.scrollContainer&&(this.$refs.scrollContainer.scrollTo({top:e.scrollHeight-t}),s.disconnect())});for(var a=0;a<e.children.length;a++)s.observe(e.children[a])},touchStart(e){if(!this.singleRoom&&1===e.changedTouches.length){const t=e.changedTouches[0].clientX,s=e.changedTouches[0].clientY;addEventListener("touchend",e=>this.touchEnd(e,t,s),{once:!0})}},touchEnd(e,t,s){if(1===e.changedTouches.length){const a=e.changedTouches[0].clientX,o=e.changedTouches[0].clientY,n=a-t>100,r=Math.abs(o-s)>50;n&&!r&&this.$emit("toggle-rooms-list")}},onRoomChanged(){this.updateLoadingMessages(!0),this.scrollIcon=!1,this.scrollMessagesCount=0,this.resetMessageSelection();const e=this.$watch(()=>this.messages,t=>{if(!t||!t.length)return;const s=this.$refs.scrollContainer;s&&(e(),setTimeout(()=>{s.scrollTo({top:s.scrollHeight}),this.updateLoadingMessages(!1)}))})},resetMessageSelection(){this.messageSelectionEnabled=!1,this.selectedMessages=[]},selectMessage(e){this.selectedMessages.push(e)},unselectMessage(e){this.selectedMessages=this.selectedMessages.filter(t=>t._id!==e)},onMessageAdded({message:e,index:t,ref:s}){if(t!==this.messages.length-1)return;const a=s.offsetHeight+60;setTimeout(()=>{const t=this.getBottomScroll(this.$refs.scrollContainer)>a;e.senderId===this.currentUserId?t?this.autoScroll.send.newAfterScrollUp&&this.scrollToBottom():this.autoScroll.send.new&&this.scrollToBottom():t?this.autoScroll.receive.newAfterScrollUp?this.scrollToBottom():(this.scrollIcon=!0,this.scrollMessagesCount++):this.autoScroll.receive.new?this.scrollToBottom():(this.scrollIcon=!0,this.scrollMessagesCount++)})},onContainerScroll(e){if(!e.target)return;const t=this.getBottomScroll(e.target);t<60&&(this.scrollMessagesCount=0),this.scrollIcon=t>500||this.scrollMessagesCount},loadMoreMessages(){this.loadingMessages||setTimeout(()=>{if(!this.loadingMoreMessages){if(this.messagesLoaded||!this.roomId)return this.loadingMoreMessages=!1,void(this.showLoader=!1);this.preventTopScroll(),this.$emit("fetch-messages"),this.loadingMoreMessages=!0}},500)},messageActionHandler({action:e,message:t}){switch(e.name){case"replyMessage":return this.initReplyMessage=t,void setTimeout(()=>{this.initReplyMessage=null});case"editMessage":return this.initEditMessage=t,void setTimeout(()=>{this.initEditMessage=null});case"deleteMessage":return this.$emit("delete-message",t);case"selectMessages":return this.selectedMessages=[t],void(this.messageSelectionEnabled=!0);default:return this.$emit("message-action-handler",{action:e,message:t})}},messageSelectionActionHandler(e){this.$emit("message-selection-action-handler",{action:e,messages:this.selectedMessages}),this.resetMessageSelection()},sendMessageReaction(e){this.$emit("send-message-reaction",e)},getBottomScroll(e){const{scrollHeight:t,clientHeight:s,scrollTop:a}=e;return t-s-a},scrollToBottom(){setTimeout(()=>{const e=this.$refs.scrollContainer;e.classList.add("vac-scroll-smooth"),e.scrollTo({top:e.scrollHeight,behavior:"smooth"}),setTimeout(()=>e.classList.remove("vac-scroll-smooth"))},50)},openFile({message:e,file:t}){this.$emit("open-file",{message:e,file:t})},openUserTag(e){this.$emit("open-user-tag",e)},onDropFiles(e){this.showFiles&&(this.droppedFiles=e.dataTransfer.files)}}},Ly={class:"vac-container-center vac-room-empty"},Py={class:"vac-messages-container"},Ny={key:0,class:"vac-text-started"},Hy={key:1,class:"vac-text-started"},Fy={key:0,id:"infinite-loader-messages"},Dy={key:2},$y={key:0,class:"vac-badge-counter vac-messages-count"};function Uy(e,t,s,a,o,n){const r=ka("room-header"),i=ka("loader"),l=ka("room-message"),c=ka("svg-icon"),d=ka("room-footer");return ba((Bo(),Lo("div",{class:"vac-col-messages",onDrop:t[12]||(t[12]=Zr((...e)=>n.onDropFiles&&n.onDropFiles(...e),["prevent"])),onDragenter:t[13]||(t[13]=Zr(()=>{},["prevent"])),onDragover:t[14]||(t[14]=Zr(()=>{},["prevent"])),onDragleave:t[15]||(t[15]=Zr(()=>{},["prevent"])),onTouchstart:t[16]||(t[16]=(...e)=>n.touchStart&&n.touchStart(...e))},[n.showNoRoom?Oa(e.$slots,"no-room-selected",{key:0},()=>[Uo("div",Ly,[Uo("div",null,ct(s.textMessages.ROOM_EMPTY),1)])]):(Bo(),Po(r,{key:1,"current-user-id":s.currentUserId,"text-messages":s.textMessages,"single-room":s.singleRoom,"show-rooms-list":s.showRoomsList,"is-mobile":s.isMobile,"room-info-enabled":s.roomInfoEnabled,"menu-actions":s.menuActions,room:n.room,"message-selection-enabled":o.messageSelectionEnabled,"message-selection-actions":s.messageSelectionActions,"selected-messages-total":o.selectedMessages.length,onToggleRoomsList:t[0]||(t[0]=t=>e.$emit("toggle-rooms-list")),onRoomInfo:t[1]||(t[1]=t=>e.$emit("room-info")),onMenuActionHandler:t[2]||(t[2]=t=>e.$emit("menu-action-handler",t)),onMessageSelectionActionHandler:n.messageSelectionActionHandler,onCancelMessageSelection:t[3]||(t[3]=e=>o.messageSelectionEnabled=!1)},Ba({_:2},[Ea(e.$slots,(t,s)=>({name:s,fn:Rs(t=>[Oa(e.$slots,s,lt(zo(t)))])}))]),1032,["current-user-id","text-messages","single-room","show-rooms-list","is-mobile","room-info-enabled","menu-actions","room","message-selection-enabled","message-selection-actions","selected-messages-total","onMessageSelectionActionHandler"])),Uo("div",{id:"messages-list",ref:"scrollContainer",class:"vac-container-scroll",onScroll:t[5]||(t[5]=(...e)=>n.onContainerScroll&&n.onContainerScroll(...e))},[qo(i,{show:o.loadingMessages,type:"messages"},Ba({_:2},[Ea(e.$slots,(t,s)=>({name:s,fn:Rs(t=>[Oa(e.$slots,s,lt(zo(t)))])}))]),1032,["show"]),Uo("div",Py,[Uo("div",{class:it({"vac-messages-hidden":o.loadingMessages})},[qo(kr,{name:"vac-fade-message"},{default:Rs(()=>[Uo("div",null,[n.showNoMessages?(Bo(),Lo("div",Ny,[Oa(e.$slots,"messages-empty",{},()=>[Yo(ct(s.textMessages.MESSAGES_EMPTY),1)])])):Ko("",!0),n.showMessagesStarted?(Bo(),Lo("div",Hy,ct(s.textMessages.CONVERSATION_STARTED)+" "+ct(s.messages[0].date),1)):Ko("",!0)])]),_:3}),s.messages.length&&!s.messagesLoaded?(Bo(),Lo("div",Fy,[qo(i,{show:!0,infinite:!0,type:"infinite-messages"},Ba({_:2},[Ea(e.$slots,(t,s)=>({name:s,fn:Rs(t=>[Oa(e.$slots,s,lt(zo(t)))])}))]),1024)])):Ko("",!0),(Bo(),Po(qr,{key:s.roomId,name:"vac-fade-message",tag:"span"},{default:Rs(()=>[(Bo(!0),Lo(So,null,Ea(s.messages,(a,r)=>(Bo(),Lo("div",{key:a.indexId||a._id},[qo(l,{"current-user-id":s.currentUserId,message:a,index:r,messages:s.messages,"edited-message-id":o.editedMessageId,"message-actions":s.messageActions,"room-users":n.room.users,"text-messages":s.textMessages,"new-messages":o.newMessages,"show-reaction-emojis":s.showReactionEmojis,"show-new-messages-divider":s.showNewMessagesDivider,"text-formatting":s.textFormatting,"link-options":s.linkOptions,"username-options":s.usernameOptions,"message-selection-enabled":o.messageSelectionEnabled,"selected-messages":o.selectedMessages,"emoji-data-source":s.emojiDataSource,onMessageAdded:n.onMessageAdded,onMessageActionHandler:n.messageActionHandler,onOpenFile:n.openFile,onOpenUserTag:n.openUserTag,onOpenFailedMessage:t[4]||(t[4]=t=>e.$emit("open-failed-message",t)),onSendMessageReaction:n.sendMessageReaction,onSelectMessage:n.selectMessage,onUnselectMessage:n.unselectMessage},Ba({_:2},[Ea(e.$slots,(t,s)=>({name:s,fn:Rs(t=>[Oa(e.$slots,s,lt(zo(t)))])}))]),1032,["current-user-id","message","index","messages","edited-message-id","message-actions","room-users","text-messages","new-messages","show-reaction-emojis","show-new-messages-divider","text-formatting","link-options","username-options","message-selection-enabled","selected-messages","emoji-data-source","onMessageAdded","onMessageActionHandler","onOpenFile","onOpenUserTag","onSendMessageReaction","onSelectMessage","onUnselectMessage"])]))),128))]),_:3}))],2)])],544),o.loadingMessages?Ko("",!0):(Bo(),Lo("div",Dy,[qo(kr,{name:"vac-bounce"},{default:Rs(()=>[o.scrollIcon?(Bo(),Lo("div",{key:0,class:"vac-icon-scroll",onClick:t[6]||(t[6]=(...e)=>n.scrollToBottom&&n.scrollToBottom(...e))},[qo(kr,{name:"vac-bounce"},{default:Rs(()=>[o.scrollMessagesCount?(Bo(),Lo("div",$y,ct(o.scrollMessagesCount),1)):Ko("",!0)]),_:1}),Oa(e.$slots,"scroll-icon",{},()=>[qo(c,{name:"dropdown",param:"scroll"})])])):Ko("",!0)]),_:3})])),qo(d,{room:n.room,"room-id":s.roomId,"room-message":s.roomMessage,"text-messages":s.textMessages,"show-send-icon":s.showSendIcon,"show-files":s.showFiles,"show-audio":s.showAudio,"show-emojis":s.showEmojis,"show-footer":s.showFooter,"accepted-files":s.acceptedFiles,"textarea-action-enabled":s.textareaActionEnabled,"textarea-auto-focus":s.textareaAutoFocus,"user-tags-enabled":s.userTagsEnabled,"emojis-suggestion-enabled":s.emojisSuggestionEnabled,"templates-text":s.templatesText,"text-formatting":s.textFormatting,"link-options":s.linkOptions,"audio-bit-rate":s.audioBitRate,"audio-sample-rate":s.audioSampleRate,"init-reply-message":o.initReplyMessage,"init-edit-message":o.initEditMessage,"dropped-files":o.droppedFiles,"emoji-data-source":s.emojiDataSource,onUpdateEditedMessageId:t[7]||(t[7]=e=>o.editedMessageId=e),onEditMessage:t[8]||(t[8]=t=>e.$emit("edit-message",t)),onSendMessage:t[9]||(t[9]=t=>e.$emit("send-message",t)),onTypingMessage:t[10]||(t[10]=t=>e.$emit("typing-message",t)),onTextareaActionHandler:t[11]||(t[11]=t=>e.$emit("textarea-action-handler",t))},Ba({_:2},[Ea(e.$slots,(t,s)=>({name:s,fn:Rs(t=>[Oa(e.$slots,s,lt(zo(t)))])}))]),1032,["room","room-id","room-message","text-messages","show-send-icon","show-files","show-audio","show-emojis","show-footer","accepted-files","textarea-action-enabled","textarea-auto-focus","user-tags-enabled","emojis-suggestion-enabled","templates-text","text-formatting","link-options","audio-bit-rate","audio-sample-rate","init-reply-message","init-edit-message","dropped-files","emoji-data-source"])],544)),[[Jr,s.isMobile&&!s.showRoomsList||!s.isMobile||s.singleRoom]])}var qy=ni(Iy,[["render",Uy]]);const Vy={name:"MediaPreview",components:{SvgIcon:yi},props:{file:{type:Object,required:!0}},emits:["close-media-preview"],computed:{isImage(){return Zd(this.file)},isVideo(){return Wd(this.file)}},mounted(){this.$refs.modal.focus()},methods:{closeModal(){this.$emit("close-media-preview")}}},zy={key:0,class:"vac-media-preview-container"},Xy={key:1,class:"vac-media-preview-container"},Yy={controls:"",autoplay:""},Ky=["src"],Gy={class:"vac-svg-button"};function Zy(e,t,s,a,o,n){const r=ka("svg-icon");return Bo(),Lo("div",{ref:"modal",tabindex:"0",class:"vac-media-preview",onClick:t[0]||(t[0]=Zr((...e)=>n.closeModal&&n.closeModal(...e),["stop"])),onKeydown:t[1]||(t[1]=Qr((...e)=>n.closeModal&&n.closeModal(...e),["esc"]))},[qo(kr,{name:"vac-bounce-preview",appear:""},{default:Rs(()=>[n.isImage?(Bo(),Lo("div",zy,[Uo("div",{class:"vac-image-preview",style:at({"background-image":`url('${s.file.url}')`})},null,4)])):n.isVideo?(Bo(),Lo("div",Xy,[Uo("video",Yy,[Uo("source",{src:s.file.url},null,8,Ky)])])):Ko("",!0)]),_:1}),Uo("div",Gy,[Oa(e.$slots,"preview-close-icon",{},()=>[qo(r,{name:"close-outline",param:"preview"})])])],544)}var Wy=ni(Vy,[["render",Zy]]),Qy={ROOMS_EMPTY:"No rooms",ROOM_EMPTY:"No room selected",NEW_MESSAGES:"New Messages",MESSAGE_DELETED:"This message was deleted",MESSAGES_EMPTY:"No messages",CONVERSATION_STARTED:"Conversation started on:",TYPE_MESSAGE:"Type message",SEARCH:"Search",IS_ONLINE:"is online",LAST_SEEN:"last seen ",IS_TYPING:"is writing...",CANCEL_SELECT_MESSAGE:"Cancel"};const Jy={light:{general:{color:"#0a0a0a",colorButtonClear:"#1976d2",colorButton:"#fff",backgroundColorButton:"#1976d2",backgroundInput:"#fff",colorPlaceholder:"#9ca6af",colorCaret:"#1976d2",colorSpinner:"#333",borderStyle:"1px solid #e1e4e8",backgroundScrollIcon:"#fff"},container:{border:"none",borderRadius:"4px",boxShadow:"0px 1px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12)"},header:{background:"#fff",colorRoomName:"#0a0a0a",colorRoomInfo:"#9ca6af"},footer:{background:"#f8f9fa",borderStyleInput:"1px solid #e1e4e8",borderInputSelected:"#1976d2",backgroundReply:"#e5e5e6",backgroundTagActive:"#e5e5e6",backgroundTag:"#f8f9fa"},content:{background:"#f8f9fa"},sidemenu:{background:"#fff",backgroundHover:"#f6f6f6",backgroundActive:"#e5effa",colorActive:"#1976d2",borderColorSearch:"#e1e5e8"},dropdown:{background:"#fff",backgroundHover:"#f6f6f6"},message:{background:"#fff",backgroundMe:"#ccf2cf",color:"#0a0a0a",colorStarted:"#9ca6af",backgroundDeleted:"#dadfe2",backgroundSelected:"#c2dcf2",colorDeleted:"#757e85",colorUsername:"#9ca6af",colorTimestamp:"#828c94",backgroundDate:"#e5effa",colorDate:"#505a62",backgroundSystem:"#e5effa",colorSystem:"#505a62",backgroundMedia:"rgba(0, 0, 0, 0.15)",backgroundReply:"rgba(0, 0, 0, 0.08)",colorReplyUsername:"#0a0a0a",colorReply:"#6e6e6e",colorTag:"#0d579c",backgroundImage:"#ddd",colorNewMessages:"#1976d2",backgroundScrollCounter:"#0696c7",colorScrollCounter:"#fff",backgroundReaction:"#eee",borderStyleReaction:"1px solid #eee",backgroundReactionHover:"#fff",borderStyleReactionHover:"1px solid #ddd",colorReactionCounter:"#0a0a0a",backgroundReactionMe:"#cfecf5",borderStyleReactionMe:"1px solid #3b98b8",backgroundReactionHoverMe:"#cfecf5",borderStyleReactionHoverMe:"1px solid #3b98b8",colorReactionCounterMe:"#0b59b3",backgroundAudioRecord:"#eb4034",backgroundAudioLine:"rgba(0, 0, 0, 0.15)",backgroundAudioProgress:"#455247",backgroundAudioProgressSelector:"#455247",colorFileExtension:"#757e85"},markdown:{background:"rgba(239, 239, 239, 0.7)",border:"rgba(212, 212, 212, 0.9)",color:"#e01e5a",colorMulti:"#0a0a0a"},room:{colorUsername:"#0a0a0a",colorMessage:"#67717a",colorTimestamp:"#a2aeb8",colorStateOnline:"#4caf50",colorStateOffline:"#9ca6af",backgroundCounterBadge:"#0696c7",colorCounterBadge:"#fff"},emoji:{background:"#fff"},icons:{search:"#9ca6af",add:"#1976d2",toggle:"#0a0a0a",menu:"#0a0a0a",close:"#9ca6af",closeImage:"#fff",file:"#1976d2",paperclip:"#1976d2",closeOutline:"#000",closePreview:"#fff",send:"#1976d2",sendDisabled:"#9ca6af",emoji:"#1976d2",emojiReaction:"rgba(0, 0, 0, 0.3)",document:"#1976d2",pencil:"#9e9e9e",checkmark:"#9e9e9e",checkmarkSeen:"#0696c7",eye:"#fff",dropdownMessage:"#fff",dropdownMessageBackground:"rgba(0, 0, 0, 0.25)",dropdownRoom:"#9e9e9e",dropdownScroll:"#0a0a0a",microphone:"#1976d2",audioPlay:"#455247",audioPause:"#455247",audioCancel:"#eb4034",audioConfirm:"#1ba65b"}},dark:{general:{color:"#fff",colorButtonClear:"#fff",colorButton:"#fff",backgroundColorButton:"#1976d2",backgroundInput:"#202223",colorPlaceholder:"#596269",colorCaret:"#fff",colorSpinner:"#fff",borderStyle:"none",backgroundScrollIcon:"#fff"},container:{border:"none",borderRadius:"4px",boxShadow:"0px 1px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12)"},header:{background:"#181a1b",colorRoomName:"#fff",colorRoomInfo:"#9ca6af"},footer:{background:"#131415",borderStyleInput:"none",borderInputSelected:"#1976d2",backgroundReply:"#1b1c1c",backgroundTagActive:"#1b1c1c",backgroundTag:"#131415"},content:{background:"#131415"},sidemenu:{background:"#181a1b",backgroundHover:"#202224",backgroundActive:"#151617",colorActive:"#fff",borderColorSearch:"#181a1b"},dropdown:{background:"#2a2c33",backgroundHover:"#26282e"},message:{background:"#22242a",backgroundMe:"#1f7e80",color:"#fff",colorStarted:"#9ca6af",backgroundDeleted:"#1b1c21",backgroundSelected:"#c2dcf2",colorDeleted:"#a2a5a8",colorUsername:"#b3bac9",colorTimestamp:"#ebedf2",backgroundDate:"rgba(0, 0, 0, 0.3)",colorDate:"#bec5cc",backgroundSystem:"rgba(0, 0, 0, 0.3)",colorSystem:"#bec5cc",backgroundMedia:"rgba(0, 0, 0, 0.18)",backgroundReply:"rgba(0, 0, 0, 0.18)",colorReplyUsername:"#fff",colorReply:"#d6d6d6",colorTag:"#f0c60a",backgroundImage:"#ddd",colorNewMessages:"#fff",backgroundScrollCounter:"#1976d2",colorScrollCounter:"#fff",backgroundReaction:"none",borderStyleReaction:"none",backgroundReactionHover:"#202223",borderStyleReactionHover:"none",colorReactionCounter:"#fff",backgroundReactionMe:"#4e9ad1",borderStyleReactionMe:"none",backgroundReactionHoverMe:"#4e9ad1",borderStyleReactionHoverMe:"none",colorReactionCounterMe:"#fff",backgroundAudioRecord:"#eb4034",backgroundAudioLine:"rgba(255, 255, 255, 0.15)",backgroundAudioProgress:"#b7d4d3",backgroundAudioProgressSelector:"#b7d4d3",colorFileExtension:"#a2a5a8"},markdown:{background:"rgba(239, 239, 239, 0.7)",border:"rgba(212, 212, 212, 0.9)",color:"#e01e5a",colorMulti:"#0a0a0a"},room:{colorUsername:"#fff",colorMessage:"#6c7278",colorTimestamp:"#6c7278",colorStateOnline:"#4caf50",colorStateOffline:"#596269",backgroundCounterBadge:"#1976d2",colorCounterBadge:"#fff"},emoji:{background:"#343740"},icons:{search:"#596269",add:"#fff",toggle:"#fff",menu:"#fff",close:"#9ca6af",closeImage:"#fff",file:"#1976d2",paperclip:"#fff",closeOutline:"#fff",closePreview:"#fff",send:"#fff",sendDisabled:"#646a70",emoji:"#fff",emojiReaction:"#fff",document:"#1976d2",pencil:"#ebedf2",checkmark:"#ebedf2",checkmarkSeen:"#f0d90a",eye:"#fff",dropdownMessage:"#fff",dropdownMessageBackground:"rgba(0, 0, 0, 0.25)",dropdownRoom:"#fff",dropdownScroll:"#0a0a0a",microphone:"#fff",audioPlay:"#b7d4d3",audioPause:"#b7d4d3",audioCancel:"#eb4034",audioConfirm:"#1ba65b"}}},ex=({general:e,container:t,header:s,footer:a,sidemenu:o,content:n,dropdown:r,message:i,markdown:l,room:c,emoji:d,icons:u})=>({"--chat-color":e.color,"--chat-color-button-clear":e.colorButtonClear,"--chat-color-button":e.colorButton,"--chat-bg-color-button":e.backgroundColorButton,"--chat-bg-color-input":e.backgroundInput,"--chat-color-spinner":e.colorSpinner,"--chat-color-placeholder":e.colorPlaceholder,"--chat-color-caret":e.colorCaret,"--chat-border-style":e.borderStyle,"--chat-bg-scroll-icon":e.backgroundScrollIcon,"--chat-container-border":t.border,"--chat-container-border-radius":t.borderRadius,"--chat-container-box-shadow":t.boxShadow,"--chat-header-bg-color":s.background,"--chat-header-color-name":s.colorRoomName,"--chat-header-color-info":s.colorRoomInfo,"--chat-footer-bg-color":a.background,"--chat-border-style-input":a.borderStyleInput,"--chat-border-color-input-selected":a.borderInputSelected,"--chat-footer-bg-color-reply":a.backgroundReply,"--chat-footer-bg-color-tag-active":a.backgroundTagActive,"--chat-footer-bg-color-tag":a.backgroundTag,"--chat-content-bg-color":n.background,"--chat-sidemenu-bg-color":o.background,"--chat-sidemenu-bg-color-hover":o.backgroundHover,"--chat-sidemenu-bg-color-active":o.backgroundActive,"--chat-sidemenu-color-active":o.colorActive,"--chat-sidemenu-border-color-search":o.borderColorSearch,"--chat-dropdown-bg-color":r.background,"--chat-dropdown-bg-color-hover":r.backgroundHover,"--chat-message-bg-color":i.background,"--chat-message-bg-color-me":i.backgroundMe,"--chat-message-color-started":i.colorStarted,"--chat-message-bg-color-deleted":i.backgroundDeleted,"--chat-message-bg-color-selected":i.backgroundSelected,"--chat-message-color-deleted":i.colorDeleted,"--chat-message-color-username":i.colorUsername,"--chat-message-color-timestamp":i.colorTimestamp,"--chat-message-bg-color-date":i.backgroundDate,"--chat-message-color-date":i.colorDate,"--chat-message-bg-color-system":i.backgroundSystem,"--chat-message-color-system":i.colorSystem,"--chat-message-color":i.color,"--chat-message-bg-color-media":i.backgroundMedia,"--chat-message-bg-color-reply":i.backgroundReply,"--chat-message-color-reply-username":i.colorReplyUsername,"--chat-message-color-reply-content":i.colorReply,"--chat-message-color-tag":i.colorTag,"--chat-message-bg-color-image":i.backgroundImage,"--chat-message-color-new-messages":i.colorNewMessages,"--chat-message-bg-color-scroll-counter":i.backgroundScrollCounter,"--chat-message-color-scroll-counter":i.colorScrollCounter,"--chat-message-bg-color-reaction":i.backgroundReaction,"--chat-message-border-style-reaction":i.borderStyleReaction,"--chat-message-bg-color-reaction-hover":i.backgroundReactionHover,"--chat-message-border-style-reaction-hover":i.borderStyleReactionHover,"--chat-message-color-reaction-counter":i.colorReactionCounter,"--chat-message-bg-color-reaction-me":i.backgroundReactionMe,"--chat-message-border-style-reaction-me":i.borderStyleReactionMe,"--chat-message-bg-color-reaction-hover-me":i.backgroundReactionHoverMe,"--chat-message-border-style-reaction-hover-me":i.borderStyleReactionHoverMe,"--chat-message-color-reaction-counter-me":i.colorReactionCounterMe,"--chat-message-bg-color-audio-record":i.backgroundAudioRecord,"--chat-message-bg-color-audio-line":i.backgroundAudioLine,"--chat-message-bg-color-audio-progress":i.backgroundAudioProgress,"--chat-message-bg-color-audio-progress-selector":i.backgroundAudioProgressSelector,"--chat-message-color-file-extension":i.colorFileExtension,"--chat-markdown-bg":l.background,"--chat-markdown-border":l.border,"--chat-markdown-color":l.color,"--chat-markdown-color-multi":l.colorMulti,"--chat-room-color-username":c.colorUsername,"--chat-room-color-message":c.colorMessage,"--chat-room-color-timestamp":c.colorTimestamp,"--chat-room-color-online":c.colorStateOnline,"--chat-room-color-offline":c.colorStateOffline,"--chat-room-bg-color-badge":c.backgroundCounterBadge,"--chat-room-color-badge":c.colorCounterBadge,"--chat-emoji-bg-color":d.background,"--chat-icon-color-search":u.search,"--chat-icon-color-add":u.add,"--chat-icon-color-toggle":u.toggle,"--chat-icon-color-menu":u.menu,"--chat-icon-color-close":u.close,"--chat-icon-color-close-image":u.closeImage,"--chat-icon-color-file":u.file,"--chat-icon-color-paperclip":u.paperclip,"--chat-icon-color-close-outline":u.closeOutline,"--chat-icon-color-close-preview":u.closePreview,"--chat-icon-color-send":u.send,"--chat-icon-color-send-disabled":u.sendDisabled,"--chat-icon-color-emoji":u.emoji,"--chat-icon-color-emoji-reaction":u.emojiReaction,"--chat-icon-color-document":u.document,"--chat-icon-color-pencil":u.pencil,"--chat-icon-color-checkmark":u.checkmark,"--chat-icon-color-checkmark-seen":u.checkmarkSeen,"--chat-icon-color-eye":u.eye,"--chat-icon-color-dropdown-message":u.dropdownMessage,"--chat-icon-bg-dropdown-message":u.dropdownMessageBackground,"--chat-icon-color-dropdown-room":u.dropdownRoom,"--chat-icon-color-dropdown-scroll":u.dropdownScroll,"--chat-icon-color-microphone":u.microphone,"--chat-icon-color-audio-play":u.audioPlay,"--chat-icon-color-audio-pause":u.audioPause,"--chat-icon-color-audio-cancel":u.audioCancel,"--chat-icon-color-audio-confirm":u.audioConfirm});var tx='.vac-fade-spinner-enter-from{opacity:0}.vac-fade-spinner-enter-active{transition:opacity .8s}.vac-fade-spinner-leave-active{transition:opacity .2s;opacity:0}.vac-fade-image-enter-from{opacity:0}.vac-fade-image-enter-active{transition:opacity 1s}.vac-fade-image-leave-active{transition:opacity .5s;opacity:0}.vac-fade-message-enter-from{opacity:0}.vac-fade-message-enter-active{transition:opacity .5s}.vac-fade-message-leave-active{transition:opacity .2s;opacity:0}.vac-slide-left-enter-active,.vac-slide-right-enter-active{transition:all .3s ease;transition-property:transform,opacity}.vac-slide-left-leave-active,.vac-slide-right-leave-active{transition:all .2s cubic-bezier(1,.5,.8,1)!important;transition-property:transform,opacity}.vac-slide-left-enter-from,.vac-slide-left-leave-to{transform:translate(10px);opacity:0}.vac-slide-right-enter-from,.vac-slide-right-leave-to{transform:translate(-10px);opacity:0}.vac-slide-up-enter-active{transition:all .3s ease}.vac-slide-up-leave-active{transition:all .2s cubic-bezier(1,.5,.8,1)}.vac-slide-up-enter-from,.vac-slide-up-leave-to{transform:translateY(10px);opacity:0}.vac-bounce-enter-active{animation:vac-bounce-in .5s}.vac-bounce-leave-active{animation:vac-bounce-in .3s reverse}@keyframes vac-bounce-in{0%{transform:scale(0)}50%{transform:scale(1.05)}to{transform:scale(1)}}.vac-fade-preview-enter{opacity:0}.vac-fade-preview-enter-active{transition:opacity .1s}.vac-fade-preview-leave-active{transition:opacity .2s;opacity:0}.vac-bounce-preview-enter-active{animation:vac-bounce-image-in .4s}.vac-bounce-preview-leave-active{animation:vac-bounce-image-in .3s reverse}@keyframes vac-bounce-image-in{0%{transform:scale(.6)}to{transform:scale(1)}}.vac-menu-list{border-radius:4px;display:block;cursor:pointer;background:var(--chat-dropdown-bg-color);padding:6px 0}.vac-menu-list :hover{background:var(--chat-dropdown-bg-color-hover);transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-menu-list :not(:hover){transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-menu-item{-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-ms-flex:1 1 100%;flex:1 1 100%;min-height:30px;padding:5px 16px;position:relative;white-space:nowrap;line-height:30px}.vac-menu-options{position:absolute;right:10px;top:20px;z-index:9999;min-width:150px;display:inline-block;border-radius:4px;font-size:14px;color:var(--chat-color);overflow-y:auto;overflow-x:hidden;contain:content;box-shadow:0 2px 2px -4px #0000001a,0 2px 2px 1px #0000001f,0 1px 8px 1px #0000001f}.vac-app-border{border:var(--chat-border-style)}.vac-app-border-t{border-top:var(--chat-border-style)}.vac-app-border-r{border-right:var(--chat-border-style)}.vac-app-border-b{border-bottom:var(--chat-border-style)}.vac-app-box-shadow{transition:all .5s;box-shadow:0 2px 2px -4px #0000001a,0 2px 2px 1px #0000001f,0 1px 8px 1px #0000001f}.vac-item-clickable{cursor:pointer}.vac-vertical-center{display:flex;align-items:center;height:100%}.vac-vertical-center .vac-vertical-container{width:100%;text-align:center}.vac-svg-button{max-height:30px;display:flex;cursor:pointer;transition:all .2s}.vac-svg-button:hover{transform:scale(1.1);opacity:.7}.vac-avatar{background-size:cover;background-position:center center;background-repeat:no-repeat;background-color:#ddd;height:42px;width:42px;min-height:42px;min-width:42px;margin-right:15px;border-radius:50%}.vac-blur-loading{filter:blur(3px)}.vac-badge-counter{height:13px;width:auto;min-width:13px;border-radius:50%;display:flex;align-items:center;justify-content:center;padding:3px;font-size:11px;font-weight:500}.vac-text-ellipsis{width:100%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.vac-text-bold{font-weight:700}.vac-text-italic{font-style:italic}.vac-text-strike{text-decoration:line-through}.vac-text-underline{text-decoration:underline}.vac-text-inline-code{display:inline-block;font-size:12px;color:var(--chat-markdown-color);background:var(--chat-markdown-bg);border:1px solid var(--chat-markdown-border);border-radius:3px;margin:2px 0;padding:2px 3px}.vac-text-multiline-code{display:block;font-size:12px;color:var(--chat-markdown-color-multi);background:var(--chat-markdown-bg);border:1px solid var(--chat-markdown-border);border-radius:3px;margin:4px 0;padding:7px}.vac-text-tag{color:var(--chat-message-color-tag);cursor:pointer}.vac-file-container{display:flex;align-content:center;justify-content:center;flex-wrap:wrap;text-align:center;background:var(--chat-bg-color-input);border:var(--chat-border-style-input);border-radius:4px;padding:10px}.vac-file-container svg{height:28px;width:28px}.vac-file-container .vac-text-extension{font-size:12px;color:var(--chat-message-color-file-extension);margin-top:-2px}.vac-card-window{width:100%;display:block;max-width:100%;background:var(--chat-content-bg-color);color:var(--chat-color);overflow-wrap:break-word;white-space:normal;border:var(--chat-container-border);border-radius:var(--chat-container-border-radius);box-shadow:var(--chat-container-box-shadow);-webkit-tap-highlight-color:transparent}.vac-card-window *{font-family:inherit}.vac-card-window a{color:#0d579c;font-weight:500}.vac-card-window .vac-chat-container{height:100%;display:flex}.vac-card-window .vac-chat-container input{min-width:10px}.vac-card-window .vac-chat-container textarea,.vac-card-window .vac-chat-container input[type=text],.vac-card-window .vac-chat-container input[type=search]{-webkit-appearance:none}.vac-media-preview{position:fixed;top:0;left:0;z-index:99;width:100vw;height:100vh;display:flex;align-items:center;background-color:#000c;outline:none}.vac-media-preview .vac-media-preview-container{height:calc(100% - 140px);width:calc(100% - 80px);padding:70px 40px;margin:0 auto}.vac-media-preview .vac-image-preview{width:100%;height:100%;background-size:contain;background-repeat:no-repeat;background-position:center}.vac-media-preview video{width:100%;height:100%}.vac-media-preview .vac-svg-button{position:absolute;top:30px;right:30px;transform:scale(1.4)}@media only screen and (max-width: 768px){.vac-media-preview .vac-svg-button{top:20px;right:20px;transform:scale(1.2)}.vac-media-preview .vac-media-preview-container{width:calc(100% - 40px);padding:70px 20px}}.vac-col-messages{position:relative;height:100%;flex:1;overflow:hidden;display:flex;flex-flow:column}.vac-col-messages .vac-container-center{height:100%;width:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center}.vac-col-messages .vac-room-empty{font-size:14px;color:#9ca6af;font-style:italic;line-height:20px;white-space:pre-line}.vac-col-messages .vac-room-empty div{padding:0 10%}.vac-col-messages .vac-container-scroll{background:var(--chat-content-bg-color);flex:1;overflow-y:auto;margin-right:1px;margin-top:65px;-webkit-overflow-scrolling:touch}.vac-col-messages .vac-container-scroll.vac-scroll-smooth{scroll-behavior:smooth}.vac-col-messages .vac-messages-container{padding:0 5px 5px}.vac-col-messages .vac-text-started{font-size:14px;color:var(--chat-message-color-started);font-style:italic;text-align:center;margin-top:25px;margin-bottom:20px}.vac-col-messages .vac-icon-scroll{position:absolute;bottom:80px;right:20px;padding:8px;background:var(--chat-bg-scroll-icon);border-radius:50%;box-shadow:0 1px 1px -1px #0003,0 1px 1px #00000024,0 1px 2px #0000001f;display:flex;cursor:pointer;z-index:10}.vac-col-messages .vac-icon-scroll svg{height:25px;width:25px}.vac-col-messages .vac-messages-count{position:absolute;top:-8px;left:11px;background-color:var(--chat-message-bg-color-scroll-counter);color:var(--chat-message-color-scroll-counter)}.vac-col-messages .vac-messages-hidden{opacity:0}@media only screen and (max-width: 768px){.vac-col-messages .vac-container-scroll{margin-top:50px}.vac-col-messages .vac-text-started{margin-top:20px}.vac-col-messages .vac-icon-scroll{bottom:70px}}.vac-room-header{position:absolute;display:flex;align-items:center;height:64px;width:100%;z-index:10;margin-right:1px;background:var(--chat-header-bg-color);border-top-right-radius:var(--chat-container-border-radius)}.vac-room-header .vac-room-wrapper{display:flex;align-items:center;min-width:0;height:100%;width:100%;padding:0 16px}.vac-room-header .vac-toggle-button{margin-right:15px}.vac-room-header .vac-toggle-button svg{height:26px;width:26px}.vac-room-header .vac-rotate-icon{transform:rotate(180deg)!important}.vac-room-header .vac-rotate-icon-init{transform:rotate(360deg)}.vac-room-header .vac-info-wrapper,.vac-room-header .vac-room-selection{display:flex;align-items:center;min-width:0;width:100%;height:100%}.vac-room-header .vac-room-selection .vac-selection-button{padding:8px 16px;color:var(--chat-color-button);background-color:var(--chat-bg-color-button);border-radius:4px;margin-right:10px;cursor:pointer;transition:all .2s}.vac-room-header .vac-room-selection .vac-selection-button:hover{opacity:.7}.vac-room-header .vac-room-selection .vac-selection-button:active{opacity:.9}.vac-room-header .vac-room-selection .vac-selection-button .vac-selection-button-count{margin-left:6px;opacity:.9}.vac-room-header .vac-room-selection .vac-selection-cancel{display:flex;align-items:center;margin-left:auto;white-space:nowrap;color:var(--chat-color-button-clear);transition:all .2s}.vac-room-header .vac-room-selection .vac-selection-cancel:hover{opacity:.7}.vac-room-header .vac-room-name{font-size:17px;font-weight:500;line-height:22px;color:var(--chat-header-color-name)}.vac-room-header .vac-room-info{font-size:13px;line-height:18px;color:var(--chat-header-color-info)}.vac-room-header .vac-room-options{margin-left:auto}@media only screen and (max-width: 768px){.vac-room-header{height:50px}.vac-room-header .vac-room-wrapper{padding:0 10px}.vac-room-header .vac-room-name{font-size:16px;line-height:22px}.vac-room-header .vac-room-info{font-size:12px;line-height:16px}.vac-room-header .vac-avatar{height:37px;width:37px;min-height:37px;min-width:37px}}.vac-room-footer{width:100%;border-bottom-right-radius:4px;z-index:10}.vac-box-footer{display:flex;position:relative;background:var(--chat-footer-bg-color);padding:10px 8px}.vac-textarea{max-height:300px;overflow-y:auto;height:20px;width:100%;line-height:20px;outline:0;resize:none;border-radius:20px;padding:12px 16px;box-sizing:content-box;font-size:16px;background:var(--chat-bg-color-input);color:var(--chat-color);caret-color:var(--chat-color-caret);border:var(--chat-border-style-input)}.vac-textarea::placeholder{color:var(--chat-color-placeholder);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.vac-textarea-outline{border:1px solid var(--chat-border-color-input-selected);box-shadow:inset 0 0 0 1px var(--chat-border-color-input-selected)}.vac-icon-textarea,.vac-icon-textarea-left{display:flex;align-items:center}.vac-icon-textarea svg,.vac-icon-textarea .vac-wrapper,.vac-icon-textarea-left svg,.vac-icon-textarea-left .vac-wrapper{margin:0 7px}.vac-icon-textarea{margin-left:5px}.vac-icon-textarea-left{display:flex;align-items:center;margin-right:5px}.vac-icon-textarea-left svg,.vac-icon-textarea-left .vac-wrapper{margin:0 7px}.vac-icon-textarea-left .vac-icon-microphone{fill:var(--chat-icon-color-microphone);margin:0 7px}.vac-icon-textarea-left .vac-dot-audio-record{height:15px;width:15px;border-radius:50%;background-color:var(--chat-message-bg-color-audio-record);animation:vac-scaling .8s ease-in-out infinite alternate}@keyframes vac-scaling{0%{transform:scale(1);opacity:.4}to{transform:scale(1.1);opacity:1}}.vac-icon-textarea-left .vac-dot-audio-record-time{font-size:16px;color:var(--chat-color);margin-left:8px;width:45px}.vac-icon-textarea-left .vac-icon-audio-stop,.vac-icon-textarea-left .vac-icon-audio-confirm{min-height:28px;min-width:28px}.vac-icon-textarea-left .vac-icon-audio-stop svg,.vac-icon-textarea-left .vac-icon-audio-confirm svg{min-height:28px;min-width:28px}.vac-icon-textarea-left .vac-icon-audio-stop{margin-right:20px}.vac-icon-textarea-left .vac-icon-audio-stop #vac-icon-close-outline{fill:var(--chat-icon-color-audio-cancel)}.vac-icon-textarea-left .vac-icon-audio-confirm{margin-right:3px;margin-left:12px}.vac-icon-textarea-left .vac-icon-audio-confirm #vac-icon-checkmark{fill:var(--chat-icon-color-audio-confirm)}.vac-send-disabled,.vac-send-disabled svg{cursor:none!important;pointer-events:none!important;transform:none!important}@media only screen and (max-width: 768px){.vac-room-footer{width:100%}.vac-box-footer{padding:7px 2px 7px 7px}.vac-box-footer.vac-box-footer-border{border-top:var(--chat-border-style-input)}.vac-textarea{padding:7px;line-height:18px}.vac-textarea::placeholder{color:transparent}.vac-icon-textarea svg,.vac-icon-textarea .vac-wrapper,.vac-icon-textarea-left svg,.vac-icon-textarea-left .vac-wrapper{margin:0 5px!important}}@media only screen and (max-height: 768px){.vac-textarea{max-height:120px}}.vac-emojis-container{width:calc(100% - 16px);padding:10px 8px;background:var(--chat-footer-bg-color);display:flex;align-items:center;overflow:auto}.vac-emojis-container .vac-emoji-element{padding:0 8px;font-size:30px;border-radius:4px;cursor:pointer;background:var(--chat-footer-bg-color-tag);transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-emojis-container .vac-emoji-element-active{background:var(--chat-footer-bg-color-tag-active)}@media only screen and (max-width: 768px){.vac-emojis-container{width:calc(100% - 10px);padding:7px 5px}.vac-emojis-container .vac-emoji-element{padding:0 7px;font-size:26px}}.vac-reply-container{display:flex;padding:10px 10px 0;background:var(--chat-footer-bg-color);align-items:center;width:calc(100% - 20px)}.vac-reply-container .vac-reply-box{width:100%;overflow:hidden;background:var(--chat-footer-bg-color-reply);border-radius:4px;padding:8px 10px}.vac-reply-container .vac-reply-info{overflow:hidden}.vac-reply-container .vac-reply-username{color:var(--chat-message-color-reply-username);font-size:12px;line-height:15px;margin-bottom:2px}.vac-reply-container .vac-reply-content{font-size:12px;color:var(--chat-message-color-reply-content);white-space:pre-line}.vac-reply-container .vac-icon-reply{margin-left:10px}.vac-reply-container .vac-icon-reply svg{height:20px;width:20px}.vac-reply-container .vac-image-reply{max-height:100px;max-width:200px;margin:4px 10px 0 0;border-radius:4px}.vac-reply-container .vac-audio-reply{margin-right:10px}.vac-reply-container .vac-file-container{max-width:80px}@media only screen and (max-width: 768px){.vac-reply-container{padding:5px 8px;width:calc(100% - 16px)}}.vac-room-files-container{display:flex;align-items:center;padding:10px 6px 0;background:var(--chat-footer-bg-color)}.vac-room-files-container .vac-files-box{display:flex;overflow:auto;width:calc(100% - 30px)}.vac-room-files-container video{height:100px;border:var(--chat-border-style-input);border-radius:4px}.vac-room-files-container .vac-icon-close{margin-left:auto}.vac-room-files-container .vac-icon-close svg{height:20px;width:20px}@media only screen and (max-width: 768px){.vac-files-container{padding:6px 4px 4px 2px}}.vac-room-file-container{display:flex;position:relative;margin:0 4px}.vac-room-file-container .vac-message-image{position:relative;background-color:var(--chat-message-bg-color-image)!important;background-size:cover!important;background-position:center center!important;background-repeat:no-repeat!important;height:100px;width:100px;border:var(--chat-border-style-input);border-radius:4px}.vac-room-file-container .vac-file-container{height:80px;width:80px}.vac-room-file-container .vac-icon-remove{position:absolute;top:6px;left:6px;z-index:10}.vac-room-file-container .vac-icon-remove svg{height:20px;width:20px;border-radius:50%}.vac-room-file-container .vac-icon-remove:before{content:" ";position:absolute;width:100%;height:100%;background:rgba(0,0,0,.5);border-radius:50%;z-index:-1}.vac-tags-container{display:flex;flex-direction:column;align-items:center;width:100%}.vac-tags-container .vac-tags-box{display:flex;width:100%;height:54px;overflow:hidden;cursor:pointer;background:var(--chat-footer-bg-color-tag);transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-tags-container .vac-tags-box-active{background:var(--chat-footer-bg-color-tag-active)}.vac-tags-container .vac-tags-info{display:flex;overflow:hidden;padding:0 20px;align-items:center}.vac-tags-container .vac-tags-avatar{height:34px;width:34px;min-height:34px;min-width:34px}.vac-tags-container .vac-tags-username{font-size:14px}@media only screen and (max-width: 768px){.vac-tags-container .vac-tags-box{height:50px}.vac-tags-container .vac-tags-info{padding:0 12px}}.vac-template-container{display:flex;flex-direction:column;align-items:center;width:100%}.vac-template-container .vac-template-box{display:flex;width:100%;height:54px;overflow:hidden;cursor:pointer;background:var(--chat-footer-bg-color-tag);transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-template-container .vac-template-active{background:var(--chat-footer-bg-color-tag-active)}.vac-template-container .vac-template-info{display:flex;overflow:hidden;padding:0 20px;align-items:center}.vac-template-container .vac-template-tag{font-size:14px;font-weight:700;margin-right:10px}.vac-template-container .vac-template-text{font-size:14px}@media only screen and (max-width: 768px){.vac-template-container .vac-template-box{height:50px}.vac-template-container .vac-template-info{padding:0 12px}}.vac-rooms-container{display:flex;flex-flow:column;flex:0 0 25%;min-width:260px;max-width:500px;position:relative;background:var(--chat-sidemenu-bg-color);height:100%;border-top-left-radius:var(--chat-container-border-radius);border-bottom-left-radius:var(--chat-container-border-radius)}.vac-rooms-container.vac-rooms-container-full{flex:0 0 100%;max-width:100%}.vac-rooms-container .vac-rooms-empty{font-size:14px;color:#9ca6af;font-style:italic;text-align:center;margin:40px 0;line-height:20px;white-space:pre-line}.vac-rooms-container .vac-room-list{flex:1;position:relative;max-width:100%;cursor:pointer;padding:0 10px 5px;overflow-y:auto}.vac-rooms-container .vac-room-item{border-radius:8px;align-items:center;display:flex;flex:1 1 100%;margin-bottom:5px;padding:0 14px;position:relative;min-height:71px;transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-rooms-container .vac-room-item:hover{background:var(--chat-sidemenu-bg-color-hover)}.vac-rooms-container .vac-room-selected{color:var(--chat-sidemenu-color-active)!important;background:var(--chat-sidemenu-bg-color-active)!important}.vac-rooms-container .vac-room-selected:hover{background:var(--chat-sidemenu-bg-color-active)!important}@media only screen and (max-width: 768px){.vac-rooms-container .vac-room-list{padding:0 7px 5px}.vac-rooms-container .vac-room-item{min-height:60px;padding:0 8px}}.vac-room-container{display:flex;flex:1;align-items:center;width:100%}.vac-room-container .vac-name-container{flex:1}.vac-room-container .vac-title-container{display:flex;align-items:center;line-height:25px}.vac-room-container .vac-state-circle{width:9px;height:9px;border-radius:50%;background-color:var(--chat-room-color-offline);margin-right:6px;transition:.3s}.vac-room-container .vac-state-online{background-color:var(--chat-room-color-online)}.vac-room-container .vac-room-name{flex:1;color:var(--chat-room-color-username);font-weight:500}.vac-room-container .vac-text-date{margin-left:5px;font-size:11px;color:var(--chat-room-color-timestamp)}.vac-room-container .vac-text-last{display:flex;align-items:center;font-size:12px;line-height:19px;color:var(--chat-room-color-message)}.vac-room-container .vac-message-new{color:var(--chat-room-color-username);font-weight:500}.vac-room-container .vac-icon-check{display:flex;vertical-align:middle;height:14px;width:14px;margin-top:-2px;margin-right:2px}.vac-room-container .vac-icon-microphone{height:15px;width:15px;vertical-align:middle;margin:-3px 1px 0 -2px;fill:var(--chat-room-color-message)}.vac-room-container .vac-room-options-container{display:flex;margin-left:auto}.vac-room-container .vac-room-badge{background-color:var(--chat-room-bg-color-badge);color:var(--chat-room-color-badge);margin-left:5px}.vac-room-container .vac-list-room-options{height:19px;width:19px;align-items:center;margin-left:5px}.vac-box-empty{margin-top:10px}@media only screen and (max-width: 768px){.vac-box-empty{margin-top:7px}}.vac-box-search{position:sticky;display:flex;align-items:center;height:64px;padding:0 15px}.vac-box-search .vac-icon-search{display:flex;position:absolute;left:30px}.vac-box-search .vac-icon-search svg{width:18px;height:18px}.vac-box-search .vac-input{height:38px;width:100%;background:var(--chat-bg-color-input);color:var(--chat-color);font-size:15px;outline:0;caret-color:var(--chat-color-caret);padding:10px 10px 10px 40px;border:1px solid var(--chat-sidemenu-border-color-search);border-radius:20px}.vac-box-search .vac-input::placeholder{color:var(--chat-color-placeholder)}.vac-box-search .vac-add-icon{margin-left:auto;padding-left:10px}@media only screen and (max-width: 768px){.vac-box-search{height:58px}}.vac-message-wrapper .vac-card-info{border-radius:4px;text-align:center;margin:10px auto;font-size:12px;padding:4px;display:block;overflow-wrap:break-word;position:relative;white-space:normal;box-shadow:0 1px 1px -1px #0000001a,0 1px 1px -1px #0000001c,0 1px 2px -1px #0000001c}.vac-message-wrapper .vac-card-date{max-width:150px;font-weight:500;text-transform:uppercase;color:var(--chat-message-color-date);background-color:var(--chat-message-bg-color-date)}.vac-message-wrapper .vac-card-system{max-width:250px;padding:8px 4px;color:var(--chat-message-color-system);background-color:var(--chat-message-bg-color-system)}.vac-message-wrapper .vac-line-new{color:var(--chat-message-color-new-messages);position:relative;text-align:center;font-size:13px;padding:10px 0}.vac-message-wrapper .vac-line-new:after,.vac-message-wrapper .vac-line-new:before{border-top:1px solid var(--chat-message-color-new-messages);content:"";left:0;position:absolute;top:50%;width:calc(50% - 60px)}.vac-message-wrapper .vac-line-new:before{left:auto;right:0}.vac-message-wrapper .vac-message-box{display:flex;flex:0 0 50%;max-width:50%;justify-content:flex-start;line-height:1.4}.vac-message-wrapper .vac-avatar{height:28px;width:28px;min-height:28px;min-width:28px;margin:0 0 2px;align-self:flex-end}.vac-message-wrapper .vac-avatar-current-offset{margin-right:28px}.vac-message-wrapper .vac-avatar-offset{margin-left:28px}.vac-message-wrapper .vac-failure-container{position:relative;align-self:flex-end;height:20px;width:20px;margin:0 0 2px -4px;border-radius:50%;background-color:#f44336}.vac-message-wrapper .vac-failure-container.vac-failure-container-avatar{margin-right:6px}.vac-message-wrapper .vac-failure-container .vac-failure-text{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:#fff;font-size:15px;font-weight:700}.vac-message-wrapper .vac-message-container{position:relative;padding:2px 10px;align-items:end;min-width:100px;box-sizing:content-box}.vac-message-wrapper .vac-message-container-offset{margin-top:10px}.vac-message-wrapper .vac-offset-current{margin-left:50%;justify-content:flex-end}.vac-message-wrapper .vac-message-card{background-color:var(--chat-message-bg-color);color:var(--chat-message-color);border-radius:8px;font-size:14px;padding:6px 9px 3px;white-space:pre-line;max-width:100%;-webkit-transition-property:box-shadow,opacity;transition-property:box-shadow,opacity;transition:box-shadow .28s cubic-bezier(.4,0,.2,1);will-change:box-shadow;box-shadow:0 1px 1px -1px #0000001a,0 1px 1px -1px #0000001c,0 1px 2px -1px #0000001c}.vac-message-wrapper .vac-message-highlight{box-shadow:0 1px 2px -1px #0000001a,0 1px 2px -1px #0000001c,0 1px 5px -1px #0000001c}.vac-message-wrapper .vac-message-current{background-color:var(--chat-message-bg-color-me)!important}.vac-message-wrapper .vac-message-deleted{color:var(--chat-message-color-deleted)!important;font-size:13px!important;font-style:italic!important;background-color:var(--chat-message-bg-color-deleted)!important}.vac-message-wrapper .vac-message-selected{background-color:var(--chat-message-bg-color-selected)!important;transition:background-color .2s}.vac-message-wrapper .vac-message-image{position:relative;background-color:var(--chat-message-bg-color-image)!important;background-size:cover!important;background-position:center center!important;background-repeat:no-repeat!important;height:250px;width:250px;max-width:100%;border-radius:4px;margin:4px auto 5px;transition:.4s filter linear}.vac-message-wrapper .vac-text-username{font-size:13px;color:var(--chat-message-color-username);margin-bottom:2px}.vac-message-wrapper .vac-username-reply{margin-bottom:5px}.vac-message-wrapper .vac-text-timestamp{font-size:10px;color:var(--chat-message-color-timestamp);text-align:right}.vac-message-wrapper .vac-progress-time{float:left;margin:-2px 0 0 40px;color:var(--chat-color);font-size:12px}.vac-message-wrapper .vac-icon-edited{-webkit-box-align:center;align-items:center;display:-webkit-inline-box;display:inline-flex;justify-content:center;letter-spacing:normal;line-height:1;text-indent:0;vertical-align:middle;margin:0 4px 2px}.vac-message-wrapper .vac-icon-edited svg{height:12px;width:12px}.vac-message-wrapper .vac-icon-check{height:14px;width:14px;vertical-align:middle;margin:-3px -3px 0 3px}@media only screen and (max-width: 768px){.vac-message-wrapper .vac-message-container{padding:2px 3px 1px}.vac-message-wrapper .vac-message-container-offset{margin-top:10px}.vac-message-wrapper .vac-message-box{flex:0 0 80%;max-width:80%}.vac-message-wrapper .vac-avatar{height:25px;width:25px;min-height:25px;min-width:25px;margin:0 6px 1px 0}.vac-message-wrapper .vac-avatar.vac-avatar-current{margin:0 0 1px 6px}.vac-message-wrapper .vac-avatar-current-offset{margin-right:31px}.vac-message-wrapper .vac-avatar-offset{margin-left:31px}.vac-message-wrapper .vac-failure-container{margin-left:2px}.vac-message-wrapper .vac-failure-container.vac-failure-container-avatar{margin-right:0}.vac-message-wrapper .vac-offset-current{margin-left:20%}.vac-message-wrapper .vac-progress-time{margin-left:37px}}.vac-audio-player{display:flex;margin:8px 0 5px}.vac-audio-player .vac-svg-button{max-width:18px;margin-left:7px}@media only screen and (max-width: 768px){.vac-audio-player{margin:4px 0 0}.vac-audio-player .vac-svg-button{max-width:16px;margin-left:5px}}.vac-player-bar{display:flex;align-items:center;max-width:calc(100% - 18px);margin-right:7px;margin-left:20px}.vac-player-bar .vac-player-progress{width:190px}.vac-player-bar .vac-player-progress .vac-line-container{position:relative;height:4px;border-radius:5px;background-color:var(--chat-message-bg-color-audio-line)}.vac-player-bar .vac-player-progress .vac-line-container .vac-line-progress{position:absolute;height:inherit;background-color:var(--chat-message-bg-color-audio-progress);border-radius:inherit}.vac-player-bar .vac-player-progress .vac-line-container .vac-line-dot{position:absolute;top:-5px;margin-left:-7px;height:14px;width:14px;border-radius:50%;background-color:var(--chat-message-bg-color-audio-progress-selector);transition:transform .25s}.vac-player-bar .vac-player-progress .vac-line-container .vac-line-dot__active{transform:scale(1.2)}@media only screen and (max-width: 768px){.vac-player-bar{margin-right:5px}.vac-player-bar .vac-player-progress .vac-line-container{height:3px}.vac-player-bar .vac-player-progress .vac-line-container .vac-line-dot{height:12px;width:12px;top:-5px;margin-left:-5px}}.vac-message-actions-wrapper .vac-options-container{position:absolute;top:2px;right:10px;height:40px;width:70px;overflow:hidden;border-top-right-radius:8px}.vac-message-actions-wrapper .vac-blur-container{position:absolute;height:100%;width:100%;left:8px;bottom:10px;background:var(--chat-message-bg-color);filter:blur(3px);border-bottom-left-radius:8px}.vac-message-actions-wrapper .vac-options-me{background:var(--chat-message-bg-color-me)}.vac-message-actions-wrapper .vac-message-options{background:var(--chat-icon-bg-dropdown-message);border-radius:50%;position:absolute;top:7px;right:7px}.vac-message-actions-wrapper .vac-message-options svg{height:17px;width:17px;padding:5px;margin:-5px}.vac-message-actions-wrapper .vac-message-emojis{position:absolute;top:6px;right:30px}.vac-message-actions-wrapper .vac-menu-options{right:15px}.vac-message-actions-wrapper .vac-menu-left{right:-118px}@media only screen and (max-width: 768px){.vac-message-actions-wrapper .vac-options-container{right:3px}.vac-message-actions-wrapper .vac-menu-left{right:-50px}}.vac-message-files-container .vac-file-wrapper{position:relative;width:fit-content}.vac-message-files-container .vac-file-wrapper .vac-file-container{height:60px;width:60px;margin:3px 0 5px;cursor:pointer;transition:all .6s}.vac-message-files-container .vac-file-wrapper .vac-file-container:hover{opacity:.85}.vac-message-files-container .vac-file-wrapper .vac-file-container svg{height:30px;width:30px}.vac-message-files-container .vac-file-wrapper .vac-file-container.vac-file-container-progress{background-color:#0000004d}.vac-message-file-container{position:relative;z-index:0}.vac-message-file-container .vac-message-image-container{cursor:pointer}.vac-message-file-container .vac-image-buttons{position:absolute;width:100%;height:100%;border-radius:4px;background:linear-gradient(to bottom,rgba(0,0,0,0) 55%,rgba(0,0,0,.02) 60%,rgba(0,0,0,.05) 65%,rgba(0,0,0,.1) 70%,rgba(0,0,0,.2) 75%,rgba(0,0,0,.3) 80%,rgba(0,0,0,.5) 85%,rgba(0,0,0,.6) 90%,rgba(0,0,0,.7) 95%,rgba(0,0,0,.8) 100%)}.vac-message-file-container .vac-image-buttons svg{height:26px;width:26px}.vac-message-file-container .vac-image-buttons .vac-button-view,.vac-message-file-container .vac-image-buttons .vac-button-download{position:absolute;bottom:6px;left:7px}.vac-message-file-container .vac-image-buttons :first-child{left:40px}.vac-message-file-container .vac-image-buttons .vac-button-view{max-width:18px;bottom:8px}.vac-message-file-container .vac-video-container{width:350px;max-width:100%;margin:4px auto 5px;cursor:pointer}.vac-message-file-container .vac-video-container video{width:100%;height:100%;border-radius:4px}.vac-button-reaction{display:inline-flex;align-items:center;border:var(--chat-message-border-style-reaction);outline:none;background:var(--chat-message-bg-color-reaction);border-radius:4px;margin:4px 2px 0;transition:.3s;padding:0 5px;font-size:18px;line-height:23px}.vac-button-reaction span{font-size:11px;font-weight:500;min-width:7px;color:var(--chat-message-color-reaction-counter)}.vac-button-reaction:hover{border:var(--chat-message-border-style-reaction-hover);background:var(--chat-message-bg-color-reaction-hover);cursor:pointer}.vac-button-reaction.vac-reaction-me{border:var(--chat-message-border-style-reaction-me);background:var(--chat-message-bg-color-reaction-me)}.vac-button-reaction.vac-reaction-me span{color:var(--chat-message-color-reaction-counter-me)}.vac-button-reaction.vac-reaction-me:hover{border:var(--chat-message-border-style-reaction-hover-me);background:var(--chat-message-bg-color-reaction-hover-me)}.vac-reply-message{background:var(--chat-message-bg-color-reply);border-radius:4px;margin:-1px -5px 8px;padding:8px 10px}.vac-reply-message .vac-reply-username{color:var(--chat-message-color-reply-username);font-size:12px;line-height:15px;margin-bottom:2px}.vac-reply-message .vac-image-reply-container{width:70px}.vac-reply-message .vac-image-reply-container .vac-message-image-reply{height:70px;width:70px;margin:4px auto 3px}.vac-reply-message .vac-video-reply-container{width:200px;max-width:100%}.vac-reply-message .vac-video-reply-container video{width:100%;height:100%;border-radius:4px}.vac-reply-message .vac-reply-content{font-size:12px;color:var(--chat-message-color-reply-content)}.vac-reply-message .vac-file-container{height:60px;width:60px}.vac-emoji-wrapper{position:relative;display:flex}.vac-emoji-wrapper .vac-emoji-reaction svg{height:19px;width:19px}.vac-emoji-wrapper .vac-emoji-picker{position:absolute;z-index:9999;bottom:32px;right:10px;width:300px;padding-top:4px;overflow:scroll;box-sizing:border-box;border-radius:.5rem;background:var(--chat-emoji-bg-color);box-shadow:0 1px 2px -2px #0000001a,0 1px 2px -1px #0000001a,0 1px 2px 1px #0000001a;scrollbar-width:none}.vac-emoji-wrapper .vac-emoji-picker::-webkit-scrollbar{display:none}.vac-emoji-wrapper .vac-emoji-picker.vac-picker-reaction{position:fixed;top:initial;right:initial}.vac-emoji-wrapper .vac-emoji-picker emoji-picker{height:100%;width:100%;--emoji-size: 1.2rem;--background: var(--chat-emoji-bg-color);--emoji-padding: .4rem;--border-color: var(--chat-sidemenu-border-color-search);--button-hover-background: var(--chat-sidemenu-bg-color-hover);--button-active-background: var(--chat-sidemenu-bg-color-hover)}.vac-format-message-wrapper .vac-format-container{display:inline}.vac-format-message-wrapper .vac-icon-deleted{height:14px;width:14px;vertical-align:middle;margin:-2px 2px 0 0;fill:var(--chat-message-color-deleted)}.vac-format-message-wrapper .vac-icon-deleted.vac-icon-deleted-room{margin:-3px 1px 0 0;fill:var(--chat-room-color-message)}.vac-format-message-wrapper .vac-image-link-container{background-color:var(--chat-message-bg-color-media);padding:8px;margin:2px auto;border-radius:4px}.vac-format-message-wrapper .vac-image-link{position:relative;background-color:var(--chat-message-bg-color-image)!important;background-size:contain;background-position:center center!important;background-repeat:no-repeat!important;height:150px;width:150px;max-width:100%;border-radius:4px;margin:0 auto}.vac-format-message-wrapper .vac-image-link-message{max-width:166px;font-size:12px}.vac-loader-wrapper.vac-container-center{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);z-index:9}.vac-loader-wrapper.vac-container-top{padding:21px}.vac-loader-wrapper.vac-container-top #vac-circle{height:20px;width:20px}.vac-loader-wrapper #vac-circle{margin:auto;height:28px;width:28px;border:3px rgba(0,0,0,.25) solid;border-top:3px var(--chat-color-spinner) solid;border-right:3px var(--chat-color-spinner) solid;border-bottom:3px var(--chat-color-spinner) solid;border-radius:50%;-webkit-animation:vac-spin 1s infinite linear;animation:vac-spin 1s infinite linear}@media only screen and (max-width: 768px){.vac-loader-wrapper #vac-circle{height:24px;width:24px}.vac-loader-wrapper.vac-container-top{padding:18px}.vac-loader-wrapper.vac-container-top #vac-circle{height:16px;width:16px}}@-webkit-keyframes vac-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0)}to{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}@keyframes vac-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0)}to{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}#vac-icon-search{fill:var(--chat-icon-color-search)}#vac-icon-add{fill:var(--chat-icon-color-add)}#vac-icon-toggle{fill:var(--chat-icon-color-toggle)}#vac-icon-menu{fill:var(--chat-icon-color-menu)}#vac-icon-close{fill:var(--chat-icon-color-close)}#vac-icon-close-image{fill:var(--chat-icon-color-close-image)}#vac-icon-file{fill:var(--chat-icon-color-file)}#vac-icon-paperclip{fill:var(--chat-icon-color-paperclip)}#vac-icon-close-outline{fill:var(--chat-icon-color-close-outline)}#vac-icon-close-outline-preview{fill:var(--chat-icon-color-close-preview)}#vac-icon-send{fill:var(--chat-icon-color-send)}#vac-icon-send-disabled{fill:var(--chat-icon-color-send-disabled)}#vac-icon-emoji{fill:var(--chat-icon-color-emoji)}#vac-icon-emoji-reaction{fill:var(--chat-icon-color-emoji-reaction)}#vac-icon-document{fill:var(--chat-icon-color-document)}#vac-icon-pencil{fill:var(--chat-icon-color-pencil)}#vac-icon-checkmark,#vac-icon-double-checkmark{fill:var(--chat-icon-color-checkmark)}#vac-icon-checkmark-seen,#vac-icon-double-checkmark-seen{fill:var(--chat-icon-color-checkmark-seen)}#vac-icon-eye{fill:var(--chat-icon-color-eye)}#vac-icon-dropdown-message{fill:var(--chat-icon-color-dropdown-message)}#vac-icon-dropdown-room{fill:var(--chat-icon-color-dropdown-room)}#vac-icon-dropdown-scroll{fill:var(--chat-icon-color-dropdown-scroll)}#vac-icon-audio-play{fill:var(--chat-icon-color-audio-play)}#vac-icon-audio-pause{fill:var(--chat-icon-color-audio-pause)}.vac-progress-wrapper{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);z-index:9}.vac-progress-wrapper circle{transition:stroke-dashoffset .35s;transform:rotate(-90deg);transform-origin:50% 50%}.vac-progress-wrapper .vac-progress-content{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);z-index:-1;margin-top:-2px;background-color:#000000b3;border-radius:50%}.vac-progress-wrapper .vac-progress-content .vac-progress-text{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);font-weight:700;color:#fff}.vac-progress-wrapper .vac-progress-content .vac-progress-text .vac-progress-pourcent{font-size:9px;font-weight:400}\n';const sx={name:"ChatContainer",components:{RoomsList:Su,Room:qy,MediaPreview:Wy},props:{height:{type:String,default:"600px"},theme:{type:String,default:"light"},styles:{type:[Object,String],default:()=>({})},responsiveBreakpoint:{type:Number,default:900},singleRoom:{type:[Boolean,String],default:!1},roomsListOpened:{type:[Boolean,String],default:!0},textMessages:{type:[Object,String],default:()=>({})},currentUserId:{type:String,default:""},rooms:{type:[Array,String],default:()=>[]},roomsOrder:{type:String,default:"desc"},loadingRooms:{type:[Boolean,String],default:!1},roomsLoaded:{type:[Boolean,String],default:!1},roomId:{type:String,default:null},loadFirstRoom:{type:[Boolean,String],default:!0},messages:{type:[Array,String],default:()=>[]},messagesLoaded:{type:[Boolean,String],default:!1},roomActions:{type:[Array,String],default:()=>[]},menuActions:{type:[Array,String],default:()=>[]},messageActions:{type:[Array,String],default:()=>[{name:"replyMessage",title:"Reply"},{name:"editMessage",title:"Edit Message",onlyMe:!0},{name:"deleteMessage",title:"Delete Message",onlyMe:!0},{name:"selectMessages",title:"Select"}]},messageSelectionActions:{type:[Array,String],default:()=>[]},autoScroll:{type:[Object,String],default:()=>({send:{new:!0,newAfterScrollUp:!0},receive:{new:!0,newAfterScrollUp:!1}})},customSearchRoomEnabled:{type:[Boolean,String],default:!1},showSearch:{type:[Boolean,String],default:!0},showAddRoom:{type:[Boolean,String],default:!0},showSendIcon:{type:[Boolean,String],default:!0},showFiles:{type:[Boolean,String],default:!0},showAudio:{type:[Boolean,String],default:!0},audioBitRate:{type:Number,default:128},audioSampleRate:{type:Number,default:44100},showEmojis:{type:[Boolean,String],default:!0},showReactionEmojis:{type:[Boolean,String],default:!0},showNewMessagesDivider:{type:[Boolean,String],default:!0},showFooter:{type:[Boolean,String],default:!0},textFormatting:{type:[Object,String],default:()=>({disabled:!1,italic:"_",bold:"*",strike:"~",underline:"°",multilineCode:"```",inlineCode:"`"})},linkOptions:{type:[Object,String],default:()=>({disabled:!1,target:"_blank",rel:null})},roomInfoEnabled:{type:[Boolean,String],default:!1},textareaActionEnabled:{type:[Boolean,String],default:!1},textareaAutoFocus:{type:[Boolean,String],default:!0},userTagsEnabled:{type:[Boolean,String],default:!0},emojisSuggestionEnabled:{type:[Boolean,String],default:!0},roomMessage:{type:String,default:""},scrollDistance:{type:Number,default:60},acceptedFiles:{type:String,default:"*"},templatesText:{type:[Array,String],default:()=>[]},mediaPreviewEnabled:{type:[Boolean,String],default:!0},usernameOptions:{type:[Object,String],default:()=>({minUsers:3,currentUser:!1})},emojiDataSource:{type:String,default:void 0}},emits:["toggle-rooms-list","room-info","fetch-messages","send-message","edit-message","delete-message","open-file","open-user-tag","open-failed-message","menu-action-handler","message-action-handler","send-message-reaction","typing-message","textarea-action-handler","fetch-more-rooms","add-room","search-room","room-action-handler","message-selection-action-handler"],data(){return{slots:[],room:{},loadingMoreRooms:!1,showRoomsList:!0,isMobile:!1,showMediaPreview:!1,previewFile:{}}},computed:{t(){return{...Qy,...this.textMessagesCasted}},cssVars(){const e=Jy[this.theme],t={};return Object.keys(e).map(s=>{t[s]={...e[s],...this.stylesCasted[s]||{}}}),ex(t)},orderedRooms(){return this.roomsCasted.slice().sort((e,t)=>{const s=e.index||0,a=t.index||0;return"asc"===this.roomsOrder?s<a?-1:a<s?1:0:s>a?-1:a>s?1:0})},singleRoomCasted(){return this.castBoolean(this.singleRoom)},roomsListOpenedCasted(){return this.castBoolean(this.roomsListOpened)},loadingRoomsCasted(){return this.castBoolean(this.loadingRooms)},roomsLoadedCasted(){return this.castBoolean(this.roomsLoaded)},loadFirstRoomCasted(){return this.castBoolean(this.loadFirstRoom)},messagesLoadedCasted(){return this.castBoolean(this.messagesLoaded)},showSearchCasted(){return this.castBoolean(this.showSearch)},showAddRoomCasted(){return this.castBoolean(this.showAddRoom)},showSendIconCasted(){return this.castBoolean(this.showSendIcon)},showFilesCasted(){return this.castBoolean(this.showFiles)},showAudioCasted(){return this.castBoolean(this.showAudio)},showEmojisCasted(){return this.castBoolean(this.showEmojis)},showReactionEmojisCasted(){return this.castBoolean(this.showReactionEmojis)},showNewMessagesDividerCasted(){return this.castBoolean(this.showNewMessagesDivider)},showFooterCasted(){return this.castBoolean(this.showFooter)},roomInfoEnabledCasted(){return this.castBoolean(this.roomInfoEnabled)},textareaActionEnabledCasted(){return this.castBoolean(this.textareaActionEnabled)},textareaAutoFocusCasted(){return this.castBoolean(this.textareaAutoFocus)},userTagsEnabledCasted(){return this.castBoolean(this.userTagsEnabled)},emojisSuggestionEnabledCasted(){return this.castBoolean(this.emojisSuggestionEnabled)},mediaPreviewEnabledCasted(){return this.castBoolean(this.mediaPreviewEnabled)},roomsCasted(){return this.castArray(this.rooms)},messagesCasted(){return this.castArray(this.messages)},roomActionsCasted(){return this.castArray(this.roomActions)},menuActionsCasted(){return this.castArray(this.menuActions)},messageActionsCasted(){return this.castArray(this.messageActions)},messageSelectionActionsCasted(){return this.castArray(this.messageSelectionActions)},templatesTextCasted(){return this.castArray(this.templatesText)},stylesCasted(){return this.castObject(this.styles)},textMessagesCasted(){return this.castObject(this.textMessages)},autoScrollCasted(){return this.castObject(this.autoScroll)},textFormattingCasted(){return this.castObject(this.textFormatting)},linkOptionsCasted(){return this.castObject(this.linkOptions)},usernameOptionsCasted(){return this.castObject(this.usernameOptions)}},watch:{roomsCasted:{immediate:!0,deep:!0,handler(e,t){if(e[0]&&e.find(e=>e.roomId===this.room.roomId)||(this.showRoomsList=!0),!this.loadingMoreRooms&&this.loadFirstRoomCasted&&e[0]&&(!t||e.length!==t.length))if(this.roomId){const t=e.find(e=>e.roomId===this.roomId)||{};this.fetchRoom({room:t})}else!this.isMobile||this.singleRoomCasted?this.fetchRoom({room:this.orderedRooms[0]}):this.showRoomsList=!0}},loadingRoomsCasted(e){e&&(this.room={})},roomId:{immediate:!0,handler(e,t){if(e&&!this.loadingRoomsCasted&&this.roomsCasted.length){const t=this.roomsCasted.find(t=>t.roomId===e);this.fetchRoom({room:t})}else t&&!e&&(this.room={})}},room(e){e&&0!==Object.entries(e).length&&(fy(e),e.users.forEach(e=>{gy(e)}))},roomsListOpenedCasted:{immediate:!0,handler(e){this.showRoomsList=e}}},created(){this.updateResponsive(),window.addEventListener("resize",e=>{e.isTrusted&&this.updateResponsive()})},updated(){const e=document.querySelectorAll("[slot]");this.slots.length!==e.length&&(this.slots=e)},methods:{castBoolean(e){return"true"===e||!0===e},castArray(e){return e?Array.isArray(e)?e:JSON.parse(e):[]},castObject(e){return e?"object"===typeof e?e:JSON.parse(e):{}},updateResponsive(){this.isMobile=window.innerWidth<Number(this.responsiveBreakpoint)},toggleRoomsList(){this.showRoomsList=!this.showRoomsList,this.isMobile&&(this.room={}),this.$emit("toggle-rooms-list",{opened:this.showRoomsList})},fetchRoom({room:e}){this.room=e,this.fetchMessages({reset:!0}),this.isMobile&&(this.showRoomsList=!1)},fetchMoreRooms(){this.$emit("fetch-more-rooms")},roomInfo(){this.$emit("room-info",this.room)},addRoom(){this.$emit("add-room")},searchRoom(e){this.$emit("search-room",{value:e,roomId:this.room.roomId})},fetchMessages(e){this.$emit("fetch-messages",{room:this.room,options:e})},sendMessage(e){this.$emit("send-message",{...e,roomId:this.room.roomId})},editMessage(e){this.$emit("edit-message",{...e,roomId:this.room.roomId})},deleteMessage(e){this.$emit("delete-message",{message:e,roomId:this.room.roomId})},openFile({message:e,file:t}){this.mediaPreviewEnabledCasted&&"preview"===t.action?(this.previewFile=t.file,this.showMediaPreview=!0):this.$emit("open-file",{message:e,file:t})},openUserTag({user:e}){this.$emit("open-user-tag",{user:e})},openFailedMessage({message:e}){this.$emit("open-failed-message",{message:e,roomId:this.room.roomId})},menuActionHandler(e){this.$emit("menu-action-handler",{action:e,roomId:this.room.roomId})},roomActionHandler({action:e,roomId:t}){this.$emit("room-action-handler",{action:e,roomId:t})},messageActionHandler(e){this.$emit("message-action-handler",{...e,roomId:this.room.roomId})},messageSelectionActionHandler(e){this.$emit("message-selection-action-handler",{...e,roomId:this.room.roomId})},sendMessageReaction(e){this.$emit("send-message-reaction",{...e,roomId:this.room.roomId})},typingMessage(e){this.$emit("typing-message",{message:e,roomId:this.room.roomId})},textareaActionHandler(e){this.$emit("textarea-action-handler",{message:e,roomId:this.room.roomId})}}},ax={class:"vac-chat-container"};function ox(e,t,s,a,o,n){const r=ka("rooms-list"),i=ka("room"),l=ka("media-preview");return Bo(),Lo("div",{class:"vac-card-window",style:at([{height:s.height},n.cssVars])},[Uo("div",ax,[n.singleRoomCasted?Ko("",!0):(Bo(),Po(r,{key:0,"current-user-id":s.currentUserId,rooms:n.orderedRooms,"loading-rooms":n.loadingRoomsCasted,"rooms-loaded":n.roomsLoadedCasted,room:o.room,"room-actions":n.roomActionsCasted,"custom-search-room-enabled":s.customSearchRoomEnabled,"text-messages":n.t,"show-search":n.showSearchCasted,"show-add-room":n.showAddRoomCasted,"show-rooms-list":o.showRoomsList&&n.roomsListOpenedCasted,"text-formatting":n.textFormattingCasted,"link-options":n.linkOptionsCasted,"is-mobile":o.isMobile,"scroll-distance":s.scrollDistance,onFetchRoom:n.fetchRoom,onFetchMoreRooms:n.fetchMoreRooms,onLoadingMoreRooms:t[0]||(t[0]=e=>o.loadingMoreRooms=e),onAddRoom:n.addRoom,onSearchRoom:n.searchRoom,onRoomActionHandler:n.roomActionHandler},Ba({_:2},[Ea(o.slots,t=>({name:t.slot,fn:Rs(s=>[Oa(e.$slots,t.slot,lt(zo(s)))])}))]),1032,["current-user-id","rooms","loading-rooms","rooms-loaded","room","room-actions","custom-search-room-enabled","text-messages","show-search","show-add-room","show-rooms-list","text-formatting","link-options","is-mobile","scroll-distance","onFetchRoom","onFetchMoreRooms","onAddRoom","onSearchRoom","onRoomActionHandler"])),qo(i,{"current-user-id":s.currentUserId,rooms:n.roomsCasted,"room-id":o.room.roomId||"","load-first-room":n.loadFirstRoomCasted,messages:n.messagesCasted,"room-message":s.roomMessage,"messages-loaded":n.messagesLoadedCasted,"menu-actions":n.menuActionsCasted,"message-actions":n.messageActionsCasted,"message-selection-actions":n.messageSelectionActionsCasted,"auto-scroll":n.autoScrollCasted,"show-send-icon":n.showSendIconCasted,"show-files":n.showFilesCasted,"show-audio":n.showAudioCasted,"audio-bit-rate":s.audioBitRate,"audio-sample-rate":s.audioSampleRate,"show-emojis":n.showEmojisCasted,"show-reaction-emojis":n.showReactionEmojisCasted,"show-new-messages-divider":n.showNewMessagesDividerCasted,"show-footer":n.showFooterCasted,"text-messages":n.t,"single-room":n.singleRoomCasted,"show-rooms-list":o.showRoomsList&&n.roomsListOpenedCasted,"text-formatting":n.textFormattingCasted,"link-options":n.linkOptionsCasted,"is-mobile":o.isMobile,"loading-rooms":n.loadingRoomsCasted,"room-info-enabled":n.roomInfoEnabledCasted,"textarea-action-enabled":n.textareaActionEnabledCasted,"textarea-auto-focus":n.textareaAutoFocusCasted,"user-tags-enabled":n.userTagsEnabledCasted,"emojis-suggestion-enabled":n.emojisSuggestionEnabledCasted,"scroll-distance":s.scrollDistance,"accepted-files":s.acceptedFiles,"templates-text":n.templatesTextCasted,"username-options":n.usernameOptionsCasted,"emoji-data-source":s.emojiDataSource,onToggleRoomsList:n.toggleRoomsList,onRoomInfo:n.roomInfo,onFetchMessages:n.fetchMessages,onSendMessage:n.sendMessage,onEditMessage:n.editMessage,onDeleteMessage:n.deleteMessage,onOpenFile:n.openFile,onOpenUserTag:n.openUserTag,onOpenFailedMessage:n.openFailedMessage,onMenuActionHandler:n.menuActionHandler,onMessageActionHandler:n.messageActionHandler,onMessageSelectionActionHandler:n.messageSelectionActionHandler,onSendMessageReaction:n.sendMessageReaction,onTypingMessage:n.typingMessage,onTextareaActionHandler:n.textareaActionHandler},Ba({_:2},[Ea(o.slots,t=>({name:t.slot,fn:Rs(s=>[Oa(e.$slots,t.slot,lt(zo(s)))])}))]),1032,["current-user-id","rooms","room-id","load-first-room","messages","room-message","messages-loaded","menu-actions","message-actions","message-selection-actions","auto-scroll","show-send-icon","show-files","show-audio","audio-bit-rate","audio-sample-rate","show-emojis","show-reaction-emojis","show-new-messages-divider","show-footer","text-messages","single-room","show-rooms-list","text-formatting","link-options","is-mobile","loading-rooms","room-info-enabled","textarea-action-enabled","textarea-auto-focus","user-tags-enabled","emojis-suggestion-enabled","scroll-distance","accepted-files","templates-text","username-options","emoji-data-source","onToggleRoomsList","onRoomInfo","onFetchMessages","onSendMessage","onEditMessage","onDeleteMessage","onOpenFile","onOpenUserTag","onOpenFailedMessage","onMenuActionHandler","onMessageActionHandler","onMessageSelectionActionHandler","onSendMessageReaction","onTypingMessage","onTextareaActionHandler"])]),qo(kr,{name:"vac-fade-preview",appear:""},{default:Rs(()=>[o.showMediaPreview?(Bo(),Po(l,{key:0,file:o.previewFile,onCloseMediaPreview:t[1]||(t[1]=e=>o.showMediaPreview=!1)},Ba({_:2},[Ea(o.slots,t=>({name:t.slot,fn:Rs(s=>[Oa(e.$slots,t.slot,lt(zo(s)))])}))]),1032,["file"])):Ko("",!0)]),_:3})],4)}var nx=ni(sx,[["render",ox],["styles",[tx]]]);const rx=vr(nx),ix="vue-advanced-chat";function lx(){customElements.get(ix)||customElements.define(ix,rx)}}).call(this,s("c8ba"))}}]);